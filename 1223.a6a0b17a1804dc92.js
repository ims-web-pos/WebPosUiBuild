"use strict";(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[1223],{33612:(S,M,a)=>{a.d(M,{i:()=>A});var h=a(92340),O=a(42326),m=a(36336),_=a(67297),b=a(69389),g=a(3629),P=a(87584),p=a(53074);let A=(()=>{class f{constructor(d,C,u,x,l){this.authservice=d,this.setting=C,this.arouter=u,this._trnMainService=x,this.masterService=l,this.AppSettings=C.appSetting,this.userprofile=d.getUserProfile(),this.userSetting=d.getSetting(),this.AppMode=h.N.appMode}afterEnterFocousItem(d,C,u){this.activerowIndex=C,1!=d||"add-sales-invoice"!=u&&"abbreviated-sales-invoice"!=u&&"quotation"!=u&&"performa-invoice"!=u&&"salesorder"!=u?"requisition-entry"==u?setTimeout(()=>{document.getElementById("alternateQty"+C).focus()},5):(this._trnMainService.allowDescriptionEdit=!1,this.focusAfterItemSelect(C)):(this._trnMainService.allowDescriptionEdit=!0,setTimeout(()=>{document.getElementById("itemDesc"+C).focus()},5))}focusAfterItemSelect(d){2==this.userSetting.EnableBatch||this._trnMainService.TrnMainObj.VoucherType==O.Km.BatchAdjustment?null!=document.getElementById("batch"+d)&&setTimeout(()=>{document.getElementById("batch"+d).focus()},20):(null!=document.getElementById("alternateunit"+d)&&setTimeout(()=>{document.getElementById("alternateunit"+d).focus()},20),74===this._trnMainService.TrnMainObj.VoucherType&&null!=document.getElementById("alternateqty"+d)&&setTimeout(()=>{document.getElementById("alternateqty"+d).focus()},20))}autoFocus(d,C,u={},x){this.getTableRowByIndex(d,C,u,x)}getTableRowByIndex(d,C,u={},x="productinserttable"){let l=document.getElementById(x);if(!((d+=1)>=1&&d<l.rows.length))return null;this.focusFirstFocusableElement(l.rows[d],C,u)}isFocusable(d){const C="function"==typeof d.focus,u=!0===d.disabled,x=!0===d.readOnly,l=null===d.offsetParent||"hidden"===d.style.visibility,w=d.hasAttribute("tabindex")&&"-1"!==d.getAttribute("tabindex"),R=["input","select","textarea","a"].includes(d.tagName.toLowerCase());return C&&!u&&!x&&!l&&(R||w)}removeElementsById(d,C){return d.filter(u=>!C.includes(u.id))}removeElementsBefore(d,C){const u=d.indexOf(C);return-1===u?d:d.slice(u+1)}focusFirstFocusableElement(d,C,u={}){const x=Array.from(d.querySelectorAll("input, button, a, select, textarea, [tabindex]:not([tabindex='-1'])")),l=this.removeElementsBefore(x,C);for(const D of l)if(this.isFocusable(D)){D.focus(),u.isFocusAchieved=!0;break}}}return f.\u0275fac=function(d){return new(d||f)(m.LFG(_.e),m.LFG(b.R),m.LFG(g.gz),m.LFG(P.p),m.LFG(p.P))},f.\u0275prov=m.Yz7({token:f,factory:f.\u0275fac}),f})()},71459:(S,M,a)=>{a.d(M,{J:()=>m});var h=a(63504),O=a(36336);let m=(()=>{class _{}return _.\u0275fac=function(g){return new(g||_)},_.\u0275mod=O.oAB({type:_}),_.\u0275inj=O.cJS({imports:[h.UX,h.u5]}),_})()},55618:(S,M,a)=>{a.d(M,{c:()=>t});var h=a(92752),O=a(71800),m=a(72533),_=a(18488),b=a(53074),g=a(63504),P=a(47766),p=a(36336);let A=(()=>{class d{static forRoot(){return{ngModule:d}}}return d.\u0275fac=function(u){return new(u||d)},d.\u0275mod=p.oAB({type:d}),d.\u0275inj=p.cJS({imports:[h.ez,g.u5,g.UX,m.JX]}),d})();var f=a(48496);let t=(()=>{class d{static forRoot(){return{ngModule:d,providers:[b.P,_.G]}}}return d.\u0275fac=function(u){return new(u||d)},d.\u0275mod=p.oAB({type:d}),d.\u0275inj=p.cJS({imports:[h.ez,O.zk.forRoot(),m.JX,h.ez,g.u5,g.UX,P.e,A.forRoot(),f.z.forRoot()]}),d})()},48496:(S,M,a)=>{a.d(M,{z:()=>P});var h=a(92752),O=a(71800),m=a(72533),_=a(83972),b=a(63504),g=a(36336);let P=(()=>{class p{static forRoot(){return{ngModule:p}}}return p.\u0275fac=function(f){return new(f||p)},p.\u0275mod=g.oAB({type:p}),p.\u0275inj=g.cJS({imports:[h.ez,O.zk.forRoot(),m.JX,_.Cl,b.u5]}),p})()},82738:(S,M,a)=>{a.d(M,{b:()=>P});var h=a(92752),O=a(72533),m=a(87584),_=a(71800),b=a(53074),g=a(36336);let P=(()=>{class p{static forRoot(){return{ngModule:p,providers:[b.P,m.p]}}}return p.\u0275fac=function(f){return new(f||p)},p.\u0275mod=g.oAB({type:p}),p.\u0275inj=g.cJS({imports:[h.ez,_.zk.forRoot(),O.JX]}),p})()},77879:(S,M,a)=>{a.d(M,{H:()=>m});var h=a(36336),O=a(53074);let m=(()=>{class _{constructor(g){this.masterRepo=g}ngOnInit(){}isOldFYearDB(){return 1===this.masterRepo.userSetting.IsOldFyearDB}}return _.\u0275fac=function(g){return new(g||_)(h.Y36(O.P))},_.\u0275dir=h.lG2({type:_,selectors:[["","appOldFYearDB",""]],exportAs:["appOldFYearDB"]}),_})()},41223:(S,M,a)=>{a.r(M),a.d(M,{ContractPriceModule:()=>te});var h=a(92752),O=a(53181),m=a(82738),_=a(69401),b=a(72533),g=a(12640),P=a(59629),p=a(3629),A=a(19102),f=a(40216),t=a(36336),d=a(67311),C=a(14970),u=a(53074),x=a(87584),l=a(63504),D=a(28698),w=a(77879),R=a(23470),y=a(25917),U=a(19773),Z=a(88002),N=a(33612),v=a(83972);let j=(()=>{class r{transform(e,n){if(e)return n?e.filter(i=>{const o=n.replace(/[^A-Z0-9]/gi,"").toLowerCase();if(-1!==(i.ITEMNAME?i.ITEMNAME.replace(/[^A-Z0-9]/gi,"").toLowerCase():"").indexOf(o))return i}):e}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275pipe=t.Yjl({name:"searchId",type:r,pure:!0}),r})();const L=["genericGridProduct"];function k(r,s){1&r&&(t.TgZ(0,"th",24),t._uU(1,"Edit Checkbox"),t.qZA())}function B(r,s){1&r&&(t.TgZ(0,"th",32),t._uU(1,"ITEM NAME"),t.qZA())}function V(r,s){1&r&&(t.TgZ(0,"th",32),t._uU(1,"GROUP NAME"),t.qZA())}function F(r,s){1&r&&(t.TgZ(0,"th"),t._uU(1,"UNIT"),t.qZA())}function J(r,s){1&r&&(t.TgZ(0,"th"),t._uU(1,"RATE"),t._UZ(2,"br"),t._uU(3,"(EX-VAT)"),t.qZA())}function G(r,s){1&r&&(t.TgZ(0,"th"),t._uU(1,"MRP"),t.qZA())}function W(r,s){1&r&&(t.TgZ(0,"th"),t._uU(1,"CONTRACT S-PRICE"),t._UZ(2,"br"),t._uU(3,"(EX-VAT)"),t.qZA())}function z(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"td")(1,"input",46),t.NdJ("change",function(i){t.CHM(e);const o=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.checkBoxEvent(i,o))}),t.qZA()()}if(2&r){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("checked",e.checked)}}function Y(r,s){1&r&&(t.TgZ(0,"option",47),t._uU(1,"Flat rate"),t.qZA())}function Q(r,s){if(1&r&&(t.TgZ(0,"td",34),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.UNIT)}}function K(r,s){if(1&r&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.RATE," ")}}function H(r,s){if(1&r&&(t.TgZ(0,"td",49),t._uU(1),t.ALo(2,"number"),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.MRP,"1.2-2")," ")}}function q(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"td",49)(1,"input",50),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.CONTRACT_SPRICE=i)}),t.qZA()()}if(2&r){const e=t.oxw(),n=e.index,i=e.$implicit,o=t.oxw(2);t.xp6(1),t.MGl("id","contractSprice",n,""),t.Q6J("disabled","VIEW"==o.MODE||!(null!=i&&i.checked)||"DISCOUNT"==i.DiscountType)("ngModel",i.CONTRACT_SPRICE)}}function $(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"tr",33),t.NdJ("click",function(){const o=t.CHM(e).index,c=t.oxw(2);return t.KtG(c.rowClick(o))}),t.YNc(1,z,2,1,"td",26),t.TgZ(2,"td",34),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td",35)(7,"select",36),t.NdJ("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.DiscountType=i)})("change",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onChangeMode("ExistingBulkEditTable"))}),t.YNc(8,Y,2,0,"option",37),t.TgZ(9,"option",38),t._uU(10,"Discount"),t.qZA()()(),t.YNc(11,Q,2,1,"td",39),t.YNc(12,K,2,1,"td",40),t.YNc(13,H,3,4,"td",41),t.TgZ(14,"td",42)(15,"input",43),t.NdJ("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.DISCOUNT=i)}),t.qZA()(),t.YNc(16,q,2,3,"td",44),t.TgZ(17,"td",34)(18,"input",45),t.NdJ("change",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.ISACTIVE=i.target.checked?1:0)})("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.ISACTIVE=i)}),t.qZA()()()}if(2&r){const e=s.$implicit,n=s.index,i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",i.editLargeEntry),t.xp6(2),t.hij(" ",n+1," "),t.xp6(2),t.Oqu(e.ITEMNAME),t.xp6(2),t.MGl("id","discountType",n,""),t.Q6J("ngModel",e.DiscountType)("disabled",!(null!=e&&e.checked)),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(2),t.MGl("id","discount",n,""),t.Q6J("ngModel",e.DISCOUNT)("disabled",!(null!=e&&e.checked)||"FLAT"==e.DiscountType),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(2),t.MGl("id","isactive",n,""),t.Q6J("ngModel",e.ISACTIVE)("disabled","VIEW"==i.MODE||!(null!=e&&e.checked))}}function X(r,s){1&r&&(t.TgZ(0,"th",32),t._uU(1,"ITEM NAME"),t.qZA())}function tt(r,s){1&r&&(t.TgZ(0,"th",32),t._uU(1,"GROUP NAME"),t.qZA())}function et(r,s){1&r&&(t.TgZ(0,"th"),t._uU(1,"UNIT"),t.qZA())}function it(r,s){1&r&&(t.TgZ(0,"th"),t._uU(1,"RATE"),t._UZ(2,"br"),t._uU(3,"(EX-VAT)"),t.qZA())}function nt(r,s){1&r&&(t.TgZ(0,"th"),t._uU(1,"MRP"),t.qZA())}function ot(r,s){1&r&&(t.TgZ(0,"th"),t._uU(1,"CONTRACT S-PRICE"),t._UZ(2,"br"),t._uU(3,"(EX-VAT)"),t.qZA())}function rt(r,s){1&r&&(t.TgZ(0,"option",56),t._uU(1,"Flat rate"),t.qZA())}function ct(r,s){if(1&r&&(t.TgZ(0,"td",34),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.UNIT)}}function st(r,s){if(1&r&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.RATE," ")}}function at(r,s){if(1&r&&(t.TgZ(0,"td",49),t._uU(1),t.ALo(2,"number"),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.MRP,"1.2-2")," ")}}function dt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"td",49)(1,"input",57),t.NdJ("keydown.enter",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.addRow())})("keydown.tab",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.addRow())})("ngModelChange",function(i){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.CONTRACT_SPRICE=i)}),t.qZA()()}if(2&r){const e=t.oxw(),n=e.index,i=e.$implicit,o=t.oxw(2);t.xp6(1),t.MGl("id","addcontractSprice",n,""),t.Q6J("disabled","VIEW"==o.MODE||"DISCOUNT"==i.DiscountType)("ngModel",i.CONTRACT_SPRICE)}}function lt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"tr",33),t.NdJ("click",function(){const o=t.CHM(e).index,c=t.oxw(2);return t.KtG(c.rowClick(o))}),t.TgZ(1,"td",34),t._uU(2),t.qZA(),t.TgZ(3,"td")(4,"input",51),t.NdJ("keydown.enter",function(){const o=t.CHM(e).index,c=t.oxw(2);return t.KtG(c.ProductList(o))})("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.ITEMNAME=i)})("keydown.Shift.Delete",function(i){t.CHM(e);const o=t.oxw(2);return t.KtG(o.clearRow(i))}),t.qZA()(),t.TgZ(5,"td",35)(6,"select",52),t.NdJ("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.DiscountType=i)})("keydown.enter",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onChangeModeEnter("NewBulkEditTable"))})("change",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onChangeMode("NewBulkEditTable"))}),t.YNc(7,rt,2,0,"option",53),t.TgZ(8,"option",54),t._uU(9,"Discount"),t.qZA()()(),t.YNc(10,ct,2,1,"td",39),t.YNc(11,st,2,1,"td",40),t.YNc(12,at,3,4,"td",41),t.TgZ(13,"td",42)(14,"input",55),t.NdJ("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.DISCOUNT=i)})("keydown.enter",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addRow())})("keydown.tab",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addRow())}),t.qZA()(),t.YNc(15,dt,2,3,"td",44),t.TgZ(16,"td",34)(17,"input",45),t.NdJ("change",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.ISACTIVE=i.target.checked?1:0)})("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.ISACTIVE=i)}),t.qZA()()()}if(2&r){const e=s.$implicit,n=s.index,i=t.oxw(2);t.xp6(2),t.hij(" ",n+1," "),t.xp6(2),t.MGl("id","additemname",n,""),t.Q6J("ngModel",e.ITEMNAME)("disabled","VIEW"==i.MODE),t.xp6(2),t.MGl("id","adddiscountType",n,""),t.Q6J("ngModel",e.DiscountType)("disabled","VIEW"==i.MODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(2),t.MGl("id","adddiscount",n,""),t.Q6J("ngModel",e.DISCOUNT)("disabled","VIEW"==i.MODE||"FLAT"==e.DiscountType&&"1"==i.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(2),t.MGl("id","addisactive",n,""),t.Q6J("ngModel",e.ISACTIVE)("disabled","VIEW"==i.MODE)}}function pt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"div",8)(6,"div",9)(7,"h5",10),t._uU(8,"Contract Price"),t.qZA()(),t.TgZ(9,"div",11)(10,"input",12),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.searchbyid=i)}),t.qZA(),t.TgZ(11,"button",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.hide())}),t._uU(12," \xd7 "),t.qZA()()()()(),t._UZ(13,"hr"),t.qZA(),t.TgZ(14,"div",5)(15,"ul",14)(16,"li",15)(17,"a",16),t._uU(18,"Existing Items"),t.qZA()(),t.TgZ(19,"li",15)(20,"a",17),t._uU(21,"Add Product"),t.qZA()()(),t.TgZ(22,"div",18)(23,"div",19)(24,"cdk-virtual-scroll-viewport",20)(25,"table",21)(26,"thead")(27,"tr",22),t.YNc(28,k,2,0,"th",23),t.TgZ(29,"th",24),t._uU(30,"S.No."),t.qZA(),t.YNc(31,B,2,0,"th",25),t.YNc(32,V,2,0,"th",25),t.TgZ(33,"th"),t._uU(34,"PRICING MODE"),t.qZA(),t.YNc(35,F,2,0,"th",26),t.YNc(36,J,4,0,"th",26),t.YNc(37,G,2,0,"th",26),t.TgZ(38,"th"),t._uU(39,"DISCOUNT(%)"),t.qZA(),t.YNc(40,W,4,0,"th",26),t.TgZ(41,"th"),t._uU(42,"IS-ACTIVE"),t.qZA()()(),t.TgZ(43,"tbody",27),t.YNc(44,$,19,17,"tr",28),t.ALo(45,"searchId"),t.qZA()()()(),t.TgZ(46,"div",29)(47,"cdk-virtual-scroll-viewport",20)(48,"table",30)(49,"thead")(50,"tr",22)(51,"th",24),t._uU(52,"S.No."),t.qZA(),t.YNc(53,X,2,0,"th",25),t.YNc(54,tt,2,0,"th",25),t.TgZ(55,"th"),t._uU(56,"PRICING MODE"),t.qZA(),t.YNc(57,et,2,0,"th",26),t.YNc(58,it,4,0,"th",26),t.YNc(59,nt,2,0,"th",26),t.TgZ(60,"th"),t._uU(61,"DISCOUNT(%)"),t.qZA(),t.YNc(62,ot,4,0,"th",26),t.TgZ(63,"th"),t._uU(64,"IS-ACTIVE"),t.qZA()()(),t.TgZ(65,"tbody",27),t.YNc(66,lt,18,18,"tr",31),t.ALo(67,"searchId"),t.qZA()()()()()()()()}if(2&r){const e=t.oxw();t.xp6(10),t.Q6J("ngModel",e.searchbyid),t.xp6(14),t.Q6J("itemSize",20),t.xp6(4),t.Q6J("ngIf",e.editLargeEntry),t.xp6(3),t.Q6J("ngIf",1==e.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",2==e.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf",1==e.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",1==e.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",1==e.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf",1==e.contractpriceObj.PRICEMODE),t.xp6(4),t.Q6J("cdkVirtualForOf",t.xi3(45,18,e.OpeningList,e.searchbyid)),t.xp6(3),t.Q6J("itemSize",20),t.xp6(6),t.Q6J("ngIf",1==e.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",2==e.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf",1==e.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",1==e.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",1==e.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf",1==e.contractpriceObj.PRICEMODE),t.xp6(4),t.Q6J("ngForOf",t.xi3(67,21,e.AddingList,e.searchbyid))}}let ut=(()=>{class r{constructor(e,n,i,o,c,E){this._transactionService=e,this.masterService=n,this.alert=i,this.spinnerService=o,this.focusService=c,this.cdr=E,this.isActive=!1,this.activerowIndex=0,this.showStockedQuantityOnly=0,this.OpeningList=[],this.AddingList=[],this.editLargeEntry=!1,this.dataToBeSent=[],this.activeTab="existingItems",this.resetParent=new t.vpe,this.gridPopupSettingsForproduct=new D.im}ngOnInit(){this._transactionService.TrnMainObj.contractPriceBulk=!1,this.subscription=this.masterService.saveButtonClickedSubject$.pipe((0,U.zg)(e=>{if(this.AddingList.length>0&&this.AddingList.forEach(n=>{let i={};i.CMID=n.CMID,i.CUSTID=n.CUSTID,i.ITEMCODE=n.ITEMCODE,i.MCODE=n.MCODE,i.ITEMNAME=n.ITEMNAME,i.UNIT=n.UNIT,i.MRP=n.MRP,i.ISACTIVE=n.ISACTIVE,i.ISVAT=n.ISVAT,i.DiscountType=n.DiscountType,i.DISCOUNT=n.DISCOUNT,i.CONTRACT_SPRICE=n.CONTRACT_SPRICE,i.RATE=n.RATE,this.dataToBeSent.push(i)}),this.removeInvalidRows(),0===this.dataToBeSent.length)return this.alert.warning("No product is selected, First select a product and then only you can proceed"),(0,y.of)("end");{this.contractpriceObj.CList=[];let n=this.dataToBeSent;if(n.length>0&&n.forEach(o=>{o.checked=void 0;let c={};c.CMID=o.CMID,c.CUSTID=o.CUSTID,c.ITEMCODE=o.ITEMCODE,c.MCODE=o.MCODE,c.ITEMNAME=o.ITEMNAME,c.UNIT=o.UNIT,c.MRP=o.MRP,c.ISACTIVE=o.ISACTIVE,c.ISVAT=o.VAT,c.DiscountType=o.DISCOUNTTYPE,c.DISCOUNT=o.DISCOUNT,c.CONTRACT_SPRICE=o.CONTRACT_SPRICE,c.RATE=o.RATE_A,this.OpeningList.push(c)}),this.contractpriceObj.CList=this.dataToBeSent,0===this.contractpriceObj.CList.length)return void this.alert.warning("No product is selected or added, First select a product and then only you can proceed");const i=this.MODE;return this.contractpriceObj.isBulkEdit=this.contractpriceObj.CList.length>0,this.spinnerService.show("Saving Contract Price, Please Wait..."),this.masterService.saveContractPrice(i,this.contractpriceObj).pipe((0,Z.U)(o=>{"ok"==o.status?(this.spinnerService.hide(),this.alert.success(o.result)):(this.spinnerService.hide(),this.alert.info(o.result.error))}))}})).subscribe({next:e=>{"end"!==e&&"Error"!==e&&(this.spinnerService.hide(),this.dataToBeSent=[],this.hide())}})}createNewRow(){return{CMID:null,CUSTID:null,ITEMCODE:"",MCODE:"",ITEMNAME:"",UNIT:"",MRP:0,ISACTIVE:1,ISVAT:0,DiscountType:2===this.contractpriceObj.PRICEMODE?"DISCOUNT":"FLAT",DISCOUNT:0,CONTRACT_SPRICE:0,RATE:0,Current_SRate:0,Current_DisRate:0,New_SRate:0,New_DisRate:0,PRATE:0}}show(e,n,i,o){"ContractBulkEdit"===i&&(this.editLargeEntry=!0);let c="";this.MODE=o,this.isActive=!0,this.contractpriceObj=e,this.OpeningList=[],this.AddingList=[],this.VoucherCMID=this.contractpriceObj.CMID,this.contractList=n,this.contractList.length>0&&(this.contractList.forEach(T=>{T.checked=void 0;let I={};I.CMID=T.CMID,I.CUSTID=T.CUSTID,I.ITEMCODE=T.ITEMCODE,I.MCODE=T.ITEMCODE,I.ITEMNAME=T.ITEMNAME,I.UNIT=T.UNIT,I.MRP=T.MRP,I.ISACTIVE=T.ISACTIVE,I.ISVAT=T.VAT,I.DiscountType=T.DISCOUNTTYPE,I.DISCOUNT=T.DISCOUNT,I.CONTRACT_SPRICE=T.CONTRACT_SPRICE,I.RATE=T.RATE_A,this.OpeningList.push(I)}),console.log("listing",this.OpeningList,this._transactionService.TrnMainObj.Mode)),c=2==this.contractpriceObj.PRICEMODE?"DISCOUNT":"FLAT";const E=this.createNewRow();this.AddingList.push(E),this._transactionService.TrnMainObj.contractPriceBulk="ContractBulkEdit"===i}rowClick(e){this.activerowIndex=e}onChangeMode(e){const n=this.activerowIndex,o=E=>{"adddiscountType"==E?setTimeout(()=>{this.focusService.autoFocus(n,document.getElementById(E+n),{},"NewBulkEditTable")},50):setTimeout(()=>{this.focusService.autoFocus(n,document.getElementById(E+n),{},"ExistingBulkEditTable")},50)},c=(E,T,I,ee)=>{E[n].DiscountType===T&&(E[n][I]=0,o(ee))};"ExistingBulkEditTable"===e?("FLAT"==this.OpeningList[n].DiscountType&&c(this.OpeningList,"FLAT","DISCOUNT","discountType"),c(this.OpeningList,"DISCOUNT","CONTRACT_SPRICE","discountType")):"NewBulkEditTable"===e?("FLAT"==this.AddingList[n].DiscountType&&c(this.AddingList,"FLAT","DISCOUNT","adddiscountType"),c(this.AddingList,"DISCOUNT","CONTRACT_SPRICE","adddiscountType")):console.warn("Unsupported table ID:",e)}onChangeModeEnter(e){const n=this.activerowIndex,i=(o,c,E)=>{o[n].DiscountType===c&&("adddiscountType"==E?setTimeout(()=>{this.focusService.autoFocus(n,document.getElementById(E+n),{},"NewBulkEditTable")},50):setTimeout(()=>{this.focusService.autoFocus(n,document.getElementById(E+n),{},"ExistingBulkEditTable")},50))};"ExistingBulkEditTable"===e?("FLAT"==this.OpeningList[n].DiscountType&&i(this.OpeningList,"FLAT","discountType"),i(this.OpeningList,"DISCOUNT","discountType")):"NewBulkEditTable"===e?("FLAT"==this.AddingList[n].DiscountType&&i(this.AddingList,"FLAT","adddiscountType"),i(this.AddingList,"DISCOUNT","adddiscountType")):console.warn("Unsupported table ID:",e)}hide(){this.dataToBeSent=[],this.isActive=!1,this._transactionService.TrnMainObj.contractPriceBulk=!1,this.resetParent.emit()}setActiveTab(e){this.activeTab=e}removeInvalidRows(){this.dataToBeSent=this.dataToBeSent.filter(e=>null!=e.MCODE&&""!==e.MCODE),this.dataToBeSent=this.dataToBeSent.filter(e=>null!=e.ITEMCODE&&""!==e.ITEMCODE)}checkBoxEvent(e,n){e.target.checked?(this.dataToBeSent.push(n),n.checked=!0):(n.checked=void 0,this.dataToBeSent=this.dataToBeSent.filter(i=>i?.MCODE!==n.MCODE))}ProductList(e){this.activerowIndex=e,this.getProductList()}getProductList(){this.gridPopupSettingsForproduct={title:1==this.contractpriceObj.PRICEMODE?"PRODUCTS":"GROUPS",apiEndpoints:1==this.contractpriceObj.PRICEMODE?`/getMenuitemWithStockPagedList/${this.showStockedQuantityOnly}/A/all/NO/${this._transactionService.userProfile.userWarehouse}`:"/getItemGroupListExceptService",defaultFilterIndex:1,userDefinefilterValue:"",columns:[{key:"MENUCODE",title:1==this.contractpriceObj.PRICEMODE?"PRODUCT CODE":"GROUP CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"DESCRIPTION",hidden:!1,noSearch:!1},{key:"BASEUNIT",title:"UNIT",hidden:1!=this.contractpriceObj.PRICEMODE,noSearch:!0},{key:"MRP",title:"MRP",hidden:!1,noSearch:!0,alignment:"right",pipe:!0}]},console.log("sss",this.genericGridProduct),console.log("sds",this.genericGridProduct.show),this.genericGridProduct.show()}onProductSelected(e){if(this.finds=this.AddingList.find(i=>i.MCODE==e.MCODE),void 0!==this.finds)return void this.alert.info("The Items cannot be selected twice");if(this.finds=this.OpeningList.find(i=>i.MCODE==e.MCODE),void 0!==this.finds)return void this.alert.info("The Items already exist in the list cannot be selected twice");this.AddingList[this.activerowIndex].CMID=this.VoucherCMID,this.AddingList[this.activerowIndex].MCODE=e.MCODE,this.AddingList[this.activerowIndex].ITEMCODE=e.MENUCODE,this.AddingList[this.activerowIndex].MCODE=e.MCODE,this.AddingList[this.activerowIndex].ITEMNAME=e.DESCA,this.AddingList[this.activerowIndex].UNIT=e.BASEUNIT,this.AddingList[this.activerowIndex].MRP=e.MRP,this.AddingList[this.activerowIndex].ISVAT=e.ISVAT,this.AddingList[this.activerowIndex].PRATE=e.PRATE,this.AddingList[this.activerowIndex].RATE=e.RATE,this.AddingList[this.activerowIndex].CUSTID=this.contractpriceObj.CustID,2==this.contractpriceObj.PRICEMODE&&(this.AddingList[this.activerowIndex].DiscountType="DISCOUNT",this.AddingList[this.activerowIndex].CONTRACT_SPRICE=0);let n=this.activerowIndex;setTimeout(()=>{this.focusService.autoFocus(n,document.getElementById("additemname"+n),{},"NewBulkEditTable"),document.getElementById("adddiscountType"+n)?.focus()},100)}addRow(){if(""==this.AddingList[this.activerowIndex].ITEMNAME||null==this.AddingList[this.activerowIndex].ITEMNAME||null==this.AddingList[this.activerowIndex].ITEMNAME||null==this.AddingList[this.activerowIndex].MRP||null==this.AddingList[this.activerowIndex].MRP)return void this.alert.warning("Please Select the Item Name.");if("FLAT"==this.AddingList[this.activerowIndex].DiscountType)if(this.AddingList[this.activerowIndex].PRATE>this.AddingList[this.activerowIndex].CONTRACT_SPRICE||null==this.AddingList[this.activerowIndex].CONTRACT_SPRICE){let i=this.checkForUserRigths("AllowContractPriceBelowPRate");if(i&&0==i?.value)return void this.alert.info("Contract Price cannot be less than "+this.AddingList[this.activerowIndex].PRATE)}else{if(this.AddingList[this.activerowIndex].CONTRACT_SPRICE<0)return void this.alert.info("Contract Price Cannot be negative");if(this.AddingList[this.activerowIndex].CONTRACT_SPRICE<0)return void this.alert.info("Contract Price Cannot be negative")}if("DISCOUNT"==this.AddingList[this.activerowIndex].DiscountType){if(this.AddingList[this.activerowIndex].DISCOUNT>=100)return void this.alert.info("The discount cannot be more than 100");if(this.AddingList[this.activerowIndex].DISCOUNT<0)return void this.alert.info("The discount cannot be in negative")}null==this.AddingList&&(this.AddingList=[]);try{var e=this.createNewRow();this.AddingList||(this.AddingList=[]),this.AddingList?.push(e)}catch(i){console.log(i),alert(i)}const n=this.AddingList.length-1;setTimeout(()=>{document.getElementById("additemname"+n)?.focus()}),console.log("addinglist",this.AddingList),this.AddingList.forEach(i=>{i.ISACTIVE=1})}checkForUserRigths(e){if(e)return this.masterService.userProfile.userRights.find(n=>n.right==e)}nextRow(){null==this.AddingList&&(this.AddingList=[]);try{var e=this.createNewRow();this.AddingList.push(e)}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n).focus()},50),this.contractpriceObj.CList.forEach(i=>{i.ISACTIVE=1})}clearRow(){confirm("Are you sure you want to delete the Row? ")&&(this.AddingList.splice(this.activerowIndex,1),0===this.AddingList.length&&this.nextRow())}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe(),this._transactionService.TrnMainObj.contractPriceBulk=!1}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(x.p),t.Y36(u.P),t.Y36(d.c),t.Y36(C.V),t.Y36(N.i),t.Y36(t.sBO))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-contract-price-visualization"]],viewQuery:function(e,n){if(1&e&&t.Gf(L,5),2&e){let i;t.iGM(i=t.CRH())&&(n.genericGridProduct=i.first)}},outputs:{resetParent:"resetParent"},decls:3,vars:2,consts:[["class","opening-container",4,"ngIf"],[3,"popupsettings","onItemDoubleClick"],["genericGridProduct",""],[1,"opening-container"],[1,"row",2,"width","100%"],[1,"col-12","col-md-12"],[2,"background-color","#ffffff"],[1,"row"],[1,"modal-header","col-md-12",2,"border","0px"],[1,"col-md-6",2,"display","flex","align-items","baseline"],[1,"modal-title"],[1,"col-md-6"],["type","text","placeholder","Search by Item Name","name","searchbyid",1,"container-input","ms-2",3,"ngModel","ngModelChange"],["type","button","data-dismiss","modal","aria-hidden","true",1,"close",3,"click"],[1,"nav","nav-tabs"],[1,"nav-item"],["id","existingItems1","data-toggle","tab","href","#existingItems","role","tab",1,"nav-link","active"],["id","addProduct1","data-toggle","tab","href","#addProduct","role","tab",1,"nav-link"],[1,"tab-content"],["id","existingItems",1,"tab-pane","active"],[1,"mb-4",3,"itemSize"],["id","ExistingBulkEditTable",2,"width","100%"],[2,"background","#eeeeee","color","black"],["scope","col",4,"ngIf"],["scope","col"],["style","width: 28%",4,"ngIf"],[4,"ngIf"],[2,"border","1px"],["style","border: 1px solid #e6e6e6",3,"click",4,"cdkVirtualFor","cdkVirtualForOf"],["id","addProduct",1,"tab-pane"],["id","NewBulkEditTable",2,"width","100%"],["style","border: 1px solid #e6e6e6",3,"click",4,"ngFor","ngForOf"],[2,"width","28%"],[2,"border","1px solid #e6e6e6",3,"click"],[2,"border","1px solid #e6e6e6","text-align","center"],[2,"border","1px solid #e6e6e6"],[2,"width","95%","height","25px",3,"id","ngModel","disabled","ngModelChange","change"],["value","FLAT",4,"ngIf"],["value","DISCOUNT"],["style","border: 1px solid #e6e6e6;text-align: center;",4,"ngIf"],["style","border: 1px solid #e6e6e6; width: 10%; text-align: right;",4,"ngIf"],["style","border: 1px solid #e6e6e6 ; text-align: right;",4,"ngIf"],[2,"border","1px solid #e6e6e6","width","10px","text-align","right"],["type","number",3,"id","ngModel","disabled","ngModelChange"],["style","border: 1px solid #e6e6e6; text-align: right;",4,"ngIf"],["type","checkbox",2,"height","18px","width","19% !important",3,"id","ngModel","disabled","change","ngModelChange"],["type","checkbox",3,"checked","change"],["value","FLAT"],[2,"border","1px solid #e6e6e6","width","10%","text-align","right"],[2,"border","1px solid #e6e6e6","text-align","right"],["type","number","autocomplete","off",2,"height","25px","width","100% !important",3,"id","disabled","ngModel","ngModelChange"],["type","text","placeholder","Please Enter to Select","autocomplete","off","readonly","true",2,"height","25px","width","100% !important",3,"id","ngModel","disabled","keydown.enter","ngModelChange","keydown.Shift.Delete"],[2,"width","95%","height","25px",3,"id","ngModel","disabled","ngModelChange","keydown.enter","change"],["id","FLAT","value","FLAT",4,"ngIf"],["id","DISCOUNT","value","DISCOUNT"],["type","number","autocomplete","off",3,"id","ngModel","disabled","ngModelChange","keydown.enter","keydown.tab"],["id","FLAT","value","FLAT"],["type","number","autocomplete","off",2,"height","25px","width","100% !important",3,"id","disabled","ngModel","keydown.enter","keydown.tab","ngModelChange"]],template:function(e,n){1&e&&(t.YNc(0,pt,68,24,"div",0),t.TgZ(1,"generic-popup-grid",1,2),t.NdJ("onItemDoubleClick",function(o){return n.onProductSelected(o)}),t.qZA()),2&e&&(t.Q6J("ngIf",n.isActive),t.xp6(1),t.Q6J("popupsettings",n.gridPopupSettingsForproduct))},dependencies:[h.sg,h.O5,D.Zl,v.xd,v.x0,v.N7,l.YN,l.Kr,l.Fj,l.wV,l.Wl,l.EJ,l.JJ,l.On,h.JJ,j],styles:[".opening-container[_ngcontent-%COMP%]{position:fixed!important;transform:translate(-50px,-50px);background:#ffffff;z-index:99999;width:98.4%;top:30%;left:4%;box-shadow:#3c40434d 0 1px 2px,#3c404326 0 2px 6px 2px}.opening-container[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{margin-left:0}.opening-container[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{padding:0}@media (min-width: 768px) and (max-width: 1024px){.opening-container[_ngcontent-%COMP%]{left:5.6%}}.close[_ngcontent-%COMP%]{padding:2px;right:26px;position:absolute;margin:2px}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{font-size:13px}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:1rem .3rem;text-align:center}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.3rem}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{height:26rem;border:1px solid #D1D6D8;width:100%;margin-left:auto;margin-right:auto}tbody[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}hr[_ngcontent-%COMP%]{margin-top:.2rem;margin-bottom:.5rem}.container-input[_ngcontent-%COMP%]{margin-top:7px;right:65px;width:35%;position:absolute}"]}),r})(),ht=(()=>{class r{transform(e,n){if(e)return n?e.filter(i=>{const o=n.replace(/[^A-Z0-9]/gi,"").toLowerCase();if(-1!==(i.ITEMNAME?i.ITEMNAME.replace(/[^A-Z0-9]/gi,"").toLowerCase():"").indexOf(o))return i}):e}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275pipe=t.Yjl({name:"searchDatas",type:r,pure:!1}),r})();const Ct=["genericGridCustomer"],_t=["genericGridProduct"],gt=["genericGridViewEdit"],Tt=["genericGridSupplier"],mt=["fileUploadPopup"],Et=["ContractPriceVisualization"];function ft(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.Reset())}),t._uU(1,"Reset F3"),t.qZA()}}function It(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"button",36,37),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSave())}),t._uU(2,"Save F6"),t.qZA()}if(2&r){const e=t.MAs(1),n=t.oxw();t.Q6J("disabled",n.disableOnSave||e.isOldFYearDB())}}function Mt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"button",36,37),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onEditclicked())}),t._uU(2,"Edit F7"),t.qZA()}if(2&r){const e=t.MAs(1);t.Q6J("disabled",e.isOldFYearDB())}}function Ot(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onBulkEditclicked())}),t._uU(1,"Bulk Edit"),t.qZA()}}function bt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onViewclicked())}),t._uU(1,"View F4"),t.qZA()}}function xt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"button",38,37),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onDeleteClick())}),t._uU(2,"Delete"),t.qZA()}if(2&r){const e=t.MAs(1);t.Q6J("disabled",e.isOldFYearDB())}}function At(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.showFileUploadPopUp())}),t._uU(1,"Import Contract Price F2"),t.qZA()}}function Dt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"div",40)(1,"div",1)(2,"div",41)(3,"div")(4,"label",42),t._uU(5,"Price Name:"),t.qZA(),t.TgZ(6,"input",43),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.PRICENAME=i)}),t.qZA()(),t.TgZ(7,"div",44)(8,"label",42),t._uU(9,"Pricing Type:"),t.qZA(),t.TgZ(10,"select",45),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.CONTRACTPRICETYPE=i)}),t.TgZ(11,"option",46),t._uU(12,"Customer Contract Pricing"),t.qZA(),t.TgZ(13,"option",47),t._uU(14,"Supplier Contract Pricing"),t.qZA()()()()(),t.TgZ(15,"div",48)(16,"div",49)(17,"div",50)(18,"label",51),t._uU(19,"Start Date:"),t.qZA(),t.TgZ(20,"input",52),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.STARTDATE=i)})("change",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.changeEntryDate(i.target.value,"AD"))}),t.qZA(),t.TgZ(21,"div",53)(22,"nepali-date-picker",54),t.NdJ("change",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.changeEntryDate(i.detail.value,"BS"))})("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.STARTBSDATE=i)}),t.qZA()()(),t.TgZ(23,"div",55)(24,"label",51),t._uU(25,"Expiry Date:"),t.qZA(),t.TgZ(26,"input",52),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.ENDDATE=i)})("change",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.changeEndDate(i.target.value,"AD"))}),t.qZA(),t.TgZ(27,"div",53)(28,"nepali-date-picker",56),t.NdJ("change",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.changeEndDate(i.detail.value,"BS"))})("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.ENDBSDATE=i)}),t.qZA()()()()(),t.TgZ(29,"div",1)(30,"input",57),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.PRICEMODE=i)})("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSelectMode())}),t.qZA(),t._uU(31," Load Item \xa0 "),t.TgZ(32,"input",57),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.PRICEMODE=i)})("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSelectMode())}),t.qZA(),t._uU(33," Load Group \xa0 "),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(6),t.Q6J("ngModel",e.contractpriceObj.PRICENAME)("disabled","VIEW"==e.Mode),t.xp6(4),t.Q6J("ngModel",e.contractpriceObj.CONTRACTPRICETYPE)("disabled","VIEW"==e.Mode||e.contractpriceObj.CustName),t.xp6(10),t.Q6J("ngModel",e.contractpriceObj.STARTDATE)("disabled","VIEW"==e.Mode),t.xp6(2),t.Q6J("id","nepaliDatefrom")("label","From")("ngModel",e.contractpriceObj.STARTBSDATE)("disable",e._trnMainService.disableNepaliDate),t.xp6(4),t.Q6J("ngModel",e.contractpriceObj.ENDDATE)("disabled","VIEW"==e.Mode),t.xp6(2),t.Q6J("id","nepaliDateto")("disable",e._trnMainService.disableNepaliDate)("label","From")("ngModel",e.contractpriceObj.ENDBSDATE),t.xp6(2),t.Q6J("ngModel",e.contractpriceObj.PRICEMODE)("value",1)("disabled","VIEW"==e.Mode||"EDIT"==e.Mode&&2==e.contractpriceObj.PRICEMODE),t.xp6(2),t.Q6J("ngModel",e.contractpriceObj.PRICEMODE)("value",2)("disabled","VIEW"==e.Mode||"EDIT"==e.Mode&&1==e.contractpriceObj.PRICEMODE)}}function Pt(r,s){1&r&&(t.TgZ(0,"th",58),t._uU(1,"ITEM NAME"),t.qZA())}function St(r,s){1&r&&(t.TgZ(0,"th",58),t._uU(1,"GROUP NAME"),t.qZA())}function vt(r,s){1&r&&(t.TgZ(0,"th",59),t._uU(1,"UNIT"),t.qZA())}function wt(r,s){1&r&&(t.TgZ(0,"th",60),t._uU(1,"RATE"),t._UZ(2,"br"),t._uU(3,"(EX-VAT)"),t.qZA())}function Rt(r,s){1&r&&(t.TgZ(0,"th",60),t._uU(1,"MRP"),t.qZA())}function Nt(r,s){1&r&&(t.TgZ(0,"th",25),t._uU(1,"CONTRACT S-PRICE"),t._UZ(2,"br"),t._uU(3,"(EX-VAT)"),t.qZA())}function yt(r,s){1&r&&(t.TgZ(0,"option",73),t._uU(1,"Flat rate"),t.qZA())}function Ut(r,s){if(1&r&&(t.TgZ(0,"td",63),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.UNIT,"")}}function Zt(r,s){if(1&r&&(t.TgZ(0,"td",70),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.RATE)}}function jt(r,s){if(1&r&&(t.TgZ(0,"td",70),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.MRP)}}function Lt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"td",70)(1,"input",74),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.CONTRACT_SPRICE=i)})("keydown.enter",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addRow())})("keydown.tab",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addRow())}),t.qZA()()}if(2&r){const e=t.oxw(),n=e.index,i=e.$implicit,o=t.oxw();t.xp6(1),t.MGl("id","contractSprice",n,""),t.Q6J("disabled","VIEW"==o.Mode||"DISCOUNT"==i.DiscountType)("ngModel",i.CONTRACT_SPRICE)}}function kt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"tr",61),t.NdJ("click",function(){const o=t.CHM(e).index,c=t.oxw();return t.KtG(c.rowClick(o))}),t.TgZ(1,"td",62),t._uU(2),t.qZA(),t.TgZ(3,"td",63)(4,"input",64),t.NdJ("keydown.enter",function(){const o=t.CHM(e).index,c=t.oxw();return t.KtG(c.ProductList(o))})("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.ITEMNAME=i)})("keydown.Shift.Delete",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.clearRow(i))}),t.qZA()(),t.TgZ(5,"td",63)(6,"select",65),t.NdJ("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.DiscountType=i)})("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChangeMode())}),t.YNc(7,yt,2,0,"option",66),t.TgZ(8,"option",67),t._uU(9,"Discount"),t.qZA()()(),t.YNc(10,Ut,2,1,"td",68),t.YNc(11,Zt,2,1,"td",69),t.YNc(12,jt,2,1,"td",69),t.TgZ(13,"td",70)(14,"input",71),t.NdJ("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.DISCOUNT=i)})("keydown.enter",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addRow())})("keydown.tab",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addRow())}),t.qZA()(),t.YNc(15,Lt,2,3,"td",69),t.TgZ(16,"td",63)(17,"input",72),t.NdJ("change",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.ISACTIVE=i.target.checked?1:0)})("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.ISACTIVE=i)}),t.qZA()()()}if(2&r){const e=s.$implicit,n=s.index,i=t.oxw();t.xp6(2),t.hij(" ",n+1," "),t.xp6(2),t.MGl("id","itemname",n,""),t.Q6J("ngModel",e.ITEMNAME)("disabled","VIEW"==i.Mode),t.xp6(2),t.MGl("id","discountType",n,""),t.Q6J("ngModel",e.DiscountType)("disabled","VIEW"==i.Mode),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(2),t.MGl("id","discount",n,""),t.Q6J("ngModel",e.DISCOUNT)("disabled","VIEW"==i.Mode||"FLAT"==e.DiscountType&&"1"==i.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(2),t.MGl("id","contractSprice",n,""),t.Q6J("ngModel",e.ISACTIVE)("disabled","VIEW"==i.Mode)}}const Vt=["genericGridCustomer"],Ft=["genericGridProduct"];function Jt(r,s){1&r&&(t.TgZ(0,"button",8),t._uU(1,"Export"),t.qZA())}function Gt(r,s){1&r&&(t.TgZ(0,"button",8),t._uU(1,"Excel"),t.qZA())}function Wt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"div",25)(1,"div",26)(2,"div",27)(3,"div")(4,"label",28),t._uU(5,"Item Name:"),t.qZA(),t.TgZ(6,"input",29),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.itemWiseObj.ITEMNAME=i)})("keydown.enter",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.itemEnterCommand())}),t.qZA()()()(),t.TgZ(7,"div",26)(8,"div",30)(9,"div")(10,"label",31),t._uU(11,"Contract Pricing Type:"),t.qZA(),t.TgZ(12,"select",32),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.itemWiseObj.CONTRACTPRICETYPE=i)}),t.TgZ(13,"option",33),t._uU(14,"Customer Contract Pricing"),t.qZA(),t.TgZ(15,"option",34),t._uU(16,"Supplier Contract Pricing"),t.qZA()()()()(),t.TgZ(17,"div",26)(18,"fieldset",35)(19,"legend",36),t._uU(20,"MRP :"),t.qZA(),t.TgZ(21,"div",37),t._uU(22),t.qZA()()()()}if(2&r){const e=t.oxw();t.xp6(6),t.Q6J("ngModel",e.itemWiseObj.ITEMNAME),t.xp6(6),t.Q6J("ngModel",e.itemWiseObj.CONTRACTPRICETYPE),t.xp6(10),t.Oqu(e.itemWiseObj.MRP)}}function zt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"tr",38),t.NdJ("click",function(){const o=t.CHM(e).index,c=t.oxw();return t.KtG(c.rowClick(o))}),t.TgZ(1,"td",39),t._uU(2),t.qZA(),t.TgZ(3,"td",40),t._uU(4),t.qZA(),t.TgZ(5,"td",40),t._uU(6),t.qZA(),t.TgZ(7,"td",41),t._uU(8),t.qZA(),t.TgZ(9,"td",41),t._uU(10),t.qZA(),t.TgZ(11,"td",42),t._uU(12),t.qZA(),t.TgZ(13,"td",41),t._uU(14),t.qZA(),t.TgZ(15,"td",41),t._uU(16),t.qZA(),t.TgZ(17,"td",41)(18,"input",43),t.NdJ("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.NEW_SRATE=i)})("ngModelChange",function(){const o=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.onNewSRateEntry(o.NEW_SRATE))}),t.qZA()(),t.TgZ(19,"td",41)(20,"input",43),t.NdJ("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.NEW_DRATE=i)})("ngModelChange",function(){const o=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.onNewDisRateEntry(o.NEW_DRATE))}),t.qZA()(),t.TgZ(21,"td",42)(22,"input",44),t.NdJ("change",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.ISACTIVE=i.target.checked?1:0)})("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.ISACTIVE=i)}),t.qZA()()()}if(2&r){const e=s.$implicit,n=s.index,i=t.oxw();t.xp6(2),t.hij(" ",n+1," "),t.xp6(2),t.hij("",e.CUSTNAME," "),t.xp6(2),t.hij("",e.ADDRESS," "),t.xp6(2),t.hij("",e.VATNO," "),t.xp6(2),t.hij("",e.MRP," "),t.xp6(2),t.hij("",e.DISCOUNTTYPE," "),t.xp6(2),t.hij("",e.CURRENT_SRATE," "),t.xp6(2),t.hij("",e.CURRENT_DRATE," "),t.xp6(2),t.MGl("id","NewSrate",n,""),t.Q6J("ngModel",e.NEW_SRATE),t.xp6(2),t.MGl("id","NewDisrate",n,""),t.Q6J("ngModel",e.NEW_DRATE),t.xp6(2),t.MGl("id","isactive",n,""),t.Q6J("ngModel",e.ISACTIVE)("disabled","VIEW"==i.Mode)}}const Yt=[{path:"",component:(()=>{class r{constructor(e,n,i,o,c,E){this.alertService=e,this.loadingService=n,this.masterService=i,this._trnMainService=o,this._alertService=c,this.router=E,this.ShowMore=!1,this.showStockedQuantityOnly=0,this.activerowIndex=0,this.contractpriceObj={},this.hidecontractPrice=!0,this.userProfile={},this.gridPopupSettingsForCustomer=new A.sG,this.gridPopupSettingsForproduct=new A.sG,this.gridPopupSettingsForView=new A.sG,this.gridPopupSettingsForSupplier=new A.sG,this.fileUploadPopupSettings=new f.s,this.fileUpload=!1;var T=this.masterService.PhiscalObj.BeginDate;T=T.substring(0,10),this.date2=T,console.log(this.date2),this.showSecondaryButtons=!1}ngOnInit(){const e=new Date;this.currDate=(0,h.p6)(e,"yyyy-MM-dd","en-US"),this.Reset(),this.contractpriceObj.CList[this.activerowIndex].ISACTIVE=1,this.contractpriceObj.CONTRACTPRICETYPE="CUSTOMER",this.Mode="ADD",this.fileUploadPopupSettings=Object.assign(new f.s,{title:"Import Contract Price",sampleFileUrl:"/downloadSampleExcelforMasterMigration?importName=Contract Price",uploadEndpoints:"/importExcelForContractPrice",allowMultiple:!1,acceptFormat:".xlsx",filename:"Import Contract Price Sample"})}showMore(){this.ShowMore=!this.ShowMore}itemWiseEntry(){try{this.router.navigate(["./pages/masters/Contract-price/item-wise-entry",{mode:"add",returnUrl:this.router.url}])}catch{}}CusWiseEntry(){try{this.router.navigate(["/pages/masters/Contract-price"])}catch{}}hide(){}rowClick(e){this.activerowIndex=e}getBsDate(e){let n=a(10484),i=e.replace("-","/").replace("-","/"),o=n.ad2bs(i);return("1"==o.en.day||"2"==o.en.day||"3"==o.en.day||"4"==o.en.day||"5"==o.en.day||"6"==o.en.day||"7"==o.en.day||"8"==o.en.day||"9"==o.en.day?"0"+o.en.day:o.en.day)+"/"+("1"==o.en.month||"2"==o.en.month||"3"==o.en.month||"4"==o.en.month||"5"==o.en.month||"6"==o.en.month||"7"==o.en.month||"8"==o.en.month||"9"==o.en.month?"0"+o.en.month:o.en.month)+"/"+o.en.year}InitialFormLoad(){this.masterService.getCurrentDate().subscribe(e=>{this.contractpriceObj.STARTDATE=e.Date.substring(0,10),this.contractpriceObj.ENDDATE=e.Date.substring(0,10),this.contractpriceObj.STARTBSDATE=this.getBsDate(this.contractpriceObj.STARTDATE),this.contractpriceObj.ENDBSDATE=this.getBsDate(this.contractpriceObj.ENDDATE)},e=>{this.masterService.resolveError(e,"voucher-date - getCurrentDate")})}addRow(){if(""==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].MRP||null==this.contractpriceObj.CList[this.activerowIndex].MRP)return void this.alertService.warning("Please Select the Item Name.");if("FLAT"==this.contractpriceObj.CList[this.activerowIndex].DiscountType)if(this.contractpriceObj.CList[this.activerowIndex].PRATE>this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE||null==this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE){let i=this.checkForUserRigths("AllowContractPriceBelowPRate");if(i&&0==i?.value)return void this.alertService.info("Contract Price cannot be less than "+this.contractpriceObj.CList[this.activerowIndex].PRATE)}else{if(this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE<0)return void this.alertService.info("Contract Price Cannot be negative");if(this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE<0)return void this.alertService.info("Contract Price Cannot be negative")}if("DISCOUNT"==this.contractpriceObj.CList[this.activerowIndex].DiscountType){if(this.contractpriceObj.CList[this.activerowIndex].DISCOUNT>=100)return void this.alertService.info("The discount cannot be more than 100");if(this.contractpriceObj.CList[this.activerowIndex].DISCOUNT<0)return void this.alertService.info("The discount cannot be in negative")}null==this.contractpriceObj.CList&&(this.contractpriceObj.CList=[]);try{var e={};e.DiscountType=2==this.contractpriceObj.PRICEMODE?"DISCOUNT":"FLAT",this.contractpriceObj.CList.push(e)}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n).focus()},50),this.contractpriceObj.CList.forEach(i=>{i.ISACTIVE=1})}checkForUserRigths(e){if(e)return this.masterService.userProfile.userRights.find(n=>n.right==e)}nextRow(){null==this.contractpriceObj.CList&&(this.contractpriceObj.CList=[]);try{var e={};e.DiscountType=2==this.contractpriceObj.PRICEMODE?"DISCOUNT":"FLAT",this.contractpriceObj.CList.push(e)}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n).focus()},50),this.contractpriceObj.CList.forEach(i=>{i.ISACTIVE=1})}changeEntryDate(e,n){"AD"==n?this.contractpriceObj.STARTBSDATE=this.masterService.toBSDate(e):"BS"==n&&(this.contractpriceObj.STARTDATE=this.masterService.toADDate(e))}changeEndDate(e,n){"AD"==n?this.contractpriceObj.ENDBSDATE=this.masterService.toBSDate(e):"BS"==n&&(this.contractpriceObj.ENDDATE=this.masterService.toADDate(e))}ProductList(e){this.activerowIndex=e,this.getProductList(),this.genericGridProduct.show()}getProductList(){this.gridPopupSettingsForproduct={title:1==this.contractpriceObj.PRICEMODE?"PRODUCTS":"GROUPS",apiEndpoints:1==this.contractpriceObj.PRICEMODE?`/getMenuitemWithStockPagedList/${this.showStockedQuantityOnly}/A/all/NO/${this._trnMainService.userProfile.userWarehouse}`:"/getItemGroupListExceptService",defaultFilterIndex:1,useDefinefilterValue:"",columns:[{key:"MENUCODE",title:1==this.contractpriceObj.PRICEMODE?"PRODUCT CODE":"GROUP CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"DESCRIPTION",hidden:!1,noSearch:!1},{key:"BASEUNIT",title:"UNIT",hidden:1!=this.contractpriceObj.PRICEMODE,noSearch:!0},{key:"MRP",title:"MRP",hidden:!1,noSearch:!0,alignment:"right",pipe:!0}]},this.genericGridProduct.show()}onProductSelected(e){if(this.finds=this.contractpriceObj.CList.find(i=>i.MCODE==e.MCODE),void 0!==this.finds)return void this.alertService.info("The Items cannot be selected twice");this.contractpriceObj.CList[this.activerowIndex].MCODE=e.MCODE,this.contractpriceObj.CList[this.activerowIndex].ITEMCODE=e.MENUCODE,this.contractpriceObj.CList[this.activerowIndex].MCODE=e.MCODE,this.contractpriceObj.CList[this.activerowIndex].ITEMNAME=e.DESCA,this.contractpriceObj.CList[this.activerowIndex].UNIT=e.BASEUNIT,this.contractpriceObj.CList[this.activerowIndex].MRP=e.MRP,this.contractpriceObj.CList[this.activerowIndex].ISVAT=e.ISVAT,this.contractpriceObj.CList[this.activerowIndex].PRATE=e.PRATE,this.contractpriceObj.CList[this.activerowIndex].RATE=e.RATE,this.contractpriceObj.CList[this.activerowIndex].CUSTID=this.contractpriceObj.CustID,2==this.contractpriceObj.PRICEMODE&&(this.contractpriceObj.CList[this.activerowIndex].DiscountType="DISCOUNT",this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE=0);let n=this.activerowIndex;setTimeout(()=>{document.getElementById("discountType"+n).focus()},100)}CalculateDiscount(){let e=this.contractpriceObj.CList[this.activerowIndex];1==e.ISVAT&&(console.log("VATMRP",e.MRP),e.CONTRACT_SPRICE=Number((e.MRP/1.13-e.MRP/1.13*e.DISCOUNT/100).toFixed(5))),e.DISCOUNT<=0&&(e.CONTRACT_SPRICE=0),0==e.ISVAT&&(console.log("NOVATMRP",e.MRP),e.CONTRACT_SPRICE=Number((e.MRP-e.MRP*e.DISCOUNT/100).toFixed(5))),console.log("item.CONTRACT_PSRCIE",e.CONTRACT_SPRICE)}onSave(){console.log(" TABLE SAVE VALUE",this.contractpriceObj);try{if(!this._trnMainService?.TrnMainObj?.contractPriceBulk&&(""==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME))return void this.alertService.warning("Please Select the Item Name.");if(this.removeInvalidRows(),this._trnMainService?.TrnMainObj?.contractPriceBulk)return this.masterService.saveButtonClicked(),void this.Reset();this.masterService.checkDublicateContractPriceName(this.contractpriceObj.PRICENAME,this.Mode,this.contractpriceObj.CMID).subscribe(e=>{if("ok"==e.status&&null!=e.result){if(!this.fileUpload)return void this.alertService.error(e.result);confirm(e.result+"Do You want to overwrite ? "+e.result2.PRICENAME)?(this.Mode="Edit",this.contractpriceObj.CMID=e.result2.CMID,this.contractpriceObj.PRICENAME=e.result2.PRICENAME,this.contractpriceObj.CONTRACTPRICETYPE=e.result2.CONTRACTPRICETYPE,this.contractpriceObj.STARTDATE=e.result2.STARTDATE.substring(0,10),this.contractpriceObj.ENDDATE=e.result2.ENDDATE.substring(0,10),this.contractpriceObj.STARTBSDATE=this.getBsDate(this.contractpriceObj.STARTDATE),this.contractpriceObj.ENDBSDATE=this.getBsDate(this.contractpriceObj.ENDDATE),this.contractpriceObj.PRICEMODE=e.result2.PRICEMODE,this.submitSave()):(this.Reset(),console.log("User canceled the action."))}else"ok"==e.status&&null==e.result&&this.submitSave()},e=>{console.log(e)})}catch(e){alert(e)}}submitSave(){this.loadingService.show("Saving Contract Price, Please Wait..."),this.masterService.saveContractPrice(this.Mode,this.contractpriceObj).subscribe(e=>{console.log("contract price save result",e),"ok"==e.status?(this.loadingService.hide(),this.alertService.success(e.result),this.Reset()):(this.loadingService.hide(),this.alertService.info(e.result.error))})}removeInvalidRows(){this.contractpriceObj.CList=this.contractpriceObj.CList.filter(e=>null!=e.MCODE&&""!=e.MCODE),this.contractpriceObj.CList=this.contractpriceObj.CList.filter(e=>null!=e.ITEMCODE&&""!=e.ITEMCODE)}onEditclicked(){this.Mode="EDIT",this.fileUpload=!1,this.getContractPriceList(),this.genericGridViewEdit.show(),this._trnMainService.disableNepaliDate=!1}onBulkEditclicked(){this.Mode="EDIT",this.fileUpload=!1,this.getContractPriceList(),this._trnMainService.TrnMainObj.contractPriceBulk=!0,this.genericGridViewEdit.show(),this._trnMainService.disableNepaliDate=!0}onViewclicked(){this.Mode="VIEW",this.getContractPriceList(),this.genericGridViewEdit.show(),this._trnMainService.disableNepaliDate=!0}getContractPriceList(){this.gridPopupSettingsForView={title:"Contract Pricing List",apiEndpoints:"/getContractPricePagedList/ptype=all",defaultFilterIndex:0,useDefinefilterValue:null,columns:[{key:"CMID",title:"Price ID",hidden:!1,noSearch:!1},{key:"PRICENAME",title:"Price Name",hidden:!1,noSearch:!1}]}}onContactPriceSelected(e){console.log("contract price selecet",e),this.contractpriceObj.PRICENAME=e.PRICENAME,this.contractpriceObj.STARTDATE=e.STARTDATE?e.STARTDATE.toString().substring(0,10):"",this.contractpriceObj.ENDDATE=e.ENDDATE?e.ENDDATE.toString().substring(0,10):"",this.contractpriceObj.CMID=e.CMID,this.contractpriceObj.CONTRACTPRICETYPE=e.CONTRACTPRICETYPE,this.contractpriceObj.PRICEMODE=e.PRICEMODE?e.PRICEMODE:1,this.changeEntryDate(this.contractpriceObj.STARTDATE,"AD"),this.changeEndDate(this.contractpriceObj.ENDDATE,"AD"),console.log("contracct price after loading",this.contractpriceObj),this.loadingService.show("Loading Contract Price Details. Please Wait"),this.masterService.loadContractPriceDetails(this.contractpriceObj.CMID).subscribe(n=>{if(console.log("result from contract price laoding",n),"ok"==n.status){this.contractpriceObj.CList=[];let i=n.result;i.length>0&&i.forEach(o=>{let c={};c.CMID=o.CMID,c.CUSTID=o.CUSTID,c.ITEMCODE=o.ITEMCODE,c.MCODE=o.ITEMCODE,c.ITEMNAME=o.ITEMNAME,c.UNIT=o.UNIT,c.MRP=o.MRP,c.ISACTIVE=o.ISACTIVE,c.ISVAT=o.VAT,c.DiscountType=o.DISCOUNTTYPE,c.DISCOUNT=o.DISCOUNT,c.CONTRACT_SPRICE=o.CONTRACT_SPRICE,c.RATE=o.RATE_A,this._trnMainService.TrnMainObj.contractPriceBulk?this.ContractPriceVisualization.show(this.contractpriceObj,n.result,"ContractBulkEdit",this.Mode):this.contractpriceObj.CList.push(c)}),this.loadingService.hide()}else this.loadingService.hide()})}onResetParent(){this.Reset()}Reset(){this.fileUpload=!1,this.ShowMore=!0,this._trnMainService.disableNepaliDate=!1,this.modeTitle="Contract Pricing: Customer Wise Entry",this.InitialFormLoad(),this.Mode="ADD",this.contractpriceObj={},this.contractpriceObj.CList=[],this.contractpriceObj.DiscountType="FLAT",this.contractpriceObj.CONTRACTPRICETYPE="CUSTOMER",this.contractpriceObj.PRICEMODE=1,null==this.contractpriceObj.CList&&(this.contractpriceObj.CList=[]);try{var e={};e.DiscountType=2==this.contractpriceObj.PRICEMODE?"DISCOUNT":"FLAT",this.contractpriceObj.CList.push(e)}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n)?.focus()},50),this.contractpriceObj.CList.forEach(i=>{i.ISACTIVE=1})}clearRow(){confirm("Are you sure you want to delete the Row? ")&&(this.contractpriceObj.CList.splice(this.activerowIndex,1),0===this.contractpriceObj.CList.length&&this.nextRow())}cancel(){console.log("@@returnUrl");try{this.router.navigate(["/pages/dashboard"])}catch(e){console.log(e),this.alertService.info(e)}}handleKeyDownboardEvent(e){"ControlLeft"==e.code||"ControlRight"==e.code?(e.preventDefault(),this.showSecondaryButtons=!0):"F2"==e.code?(e.preventDefault(),this.showFileUploadPopUp()):"F3"==e.code?(e.preventDefault(),this.Reset()):"F6"==e.code?(e.preventDefault(),this.onSave()):"F4"==e.code?(e.preventDefault(),this.onViewclicked()):"F7"==e.code&&(e.preventDefault(),this.onEditclicked())}handleKeyUpboardEvent(e){("ControlLeft"==e.code||"ControlRight"==e.code)&&(e.preventDefault(),this.showSecondaryButtons=!1)}onDeleteClick(){console.log("Reached inside"),confirm("Are you sure you want to delete? ")&&this.masterService.deleteContractPrice(this.contractpriceObj.CMID).subscribe(e=>{console.log("Delete Contract Price",e),"ok"==e.status?(this.alertService.success("Contract Deleted Succesfully"),this.Reset()):this.alertService.info("Couldn't delete contract")})}onChangeMode(){"FLAT"==this.contractpriceObj.CList[this.activerowIndex].DiscountType&&(this.contractpriceObj.CList[this.activerowIndex].DISCOUNT=0),"DISCOUNT"==this.contractpriceObj.CList[this.activerowIndex].DiscountType&&(this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE=0)}showFileUploadPopUp(){this.fileUploadPopup.show()}fileUploadSuccess(e){this.fileUpload=!0,this.contractpriceObj.CList=[];let n=e.result;n.length>0&&n.forEach(i=>{let o={};o.CMID=i.CMID,o.CUSTID=i.CUSTID,o.ITEMCODE=i.ITEMCODE,o.MCODE=i.MCODE,o.ITEMNAME=i.ITEMNAME,o.UNIT=i.UNIT,o.MRP=i.MRP,o.ISACTIVE=i.ISACTIVE,o.ISVAT=i.VAT,o.DiscountType=i.DiscountType,o.DISCOUNT=i.DISCOUNT,o.CONTRACT_SPRICE=i.CONTRACT_SPRICE,o.RATE=i.rate,this.contractpriceObj.CList.push(o)})}onSelectMode(){2==this.contractpriceObj.PRICEMODE&&(this.contractpriceObj.DiscountType="DISCOUNT",this.contractpriceObj.CList[this.activerowIndex].DiscountType="DISCOUNT",this.addRowForModeChange()),1==this.contractpriceObj.PRICEMODE&&(this.contractpriceObj.DiscountType="FLAT",this.contractpriceObj.CList[this.activerowIndex].DiscountType="FLAT",this.addRowForModeChange())}addRowForModeChange(){this.contractpriceObj.CList=[];try{var e={};e.DiscountType=2==this.contractpriceObj.PRICEMODE?"DISCOUNT":"FLAT",this.contractpriceObj.CList.push(e)}catch(n){console.log(n),alert(n)}this.contractpriceObj.CList.forEach(n=>{n.ISACTIVE=1})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(d.c),t.Y36(C.V),t.Y36(u.P),t.Y36(x.p),t.Y36(d.c),t.Y36(p.F0))},r.\u0275cmp=t.Xpm({type:r,selectors:[["contract-price"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Ct,5),t.Gf(_t,5),t.Gf(gt,5),t.Gf(Tt,5),t.Gf(mt,5),t.Gf(Et,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.genericGridCustomer=i.first),t.iGM(i=t.CRH())&&(n.genericGridProduct=i.first),t.iGM(i=t.CRH())&&(n.genericGridViewEdit=i.first),t.iGM(i=t.CRH())&&(n.genericGridSupplier=i.first),t.iGM(i=t.CRH())&&(n.fileUploadPopup=i.first),t.iGM(i=t.CRH())&&(n.ContractPriceVisualization=i.first)}},hostBindings:function(e,n){1&e&&t.NdJ("keydown",function(o){return n.handleKeyDownboardEvent(o)},!1,t.evT)("keyup",function(o){return n.handleKeyUpboardEvent(o)},!1,t.evT)},decls:55,vars:24,consts:[[1,"sticky-top","row",2,"width","100%"],[1,"col-md-4"],[1,"col-md-8"],[1,"row","pull-right"],["type","submit","class","btn btn-info btn-sm",3,"click",4,"ngIf"],["type","submit","class","btn btn-info btn-sm","appOldFYearDB","",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-info btn-sm","appOldFYearDB","",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-info btn-sm",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-info","btn-sm",3,"click"],["class","row plainBackGround","style","margin-top: 0.5rem;",4,"ngIf"],[1,"row"],[1,"col-md-3","pd0",2,"margin-top","5px"],[1,"form-group","row"],[1,"col-md-3","form-control-label"],[1,"col-md-8","row"],["type","search","placeholder","Search...","name","filters",1,"form-control",2,"height","1.5rem","font-size","13px","margin-top","7px",3,"ngModel","ngModelChange"],[2,"margin-top","-5px"],[2,"height","480px","overflow-y","scroll"],[2,"margin-bottom","5px","font-size","13px","width","99%","margin-left","10px"],[2,"border-bottom","2px solid #e6e6e6","border-top","2px solid #e6e6e6","height","30px","background","#9ccae4","color","black"],[2,"font-size","12px","text-align","center","width","4%"],["scope","col","style","text-align: center;  font-size: 12px; width:28%;",4,"ngIf"],["scope","col",2,"text-align","center","font-size","12px","width","10%"],["scope","col","style","text-align: center; font-size: 12px; width:8%;",4,"ngIf"],["scope","col","style","text-align: center; width: 9%; font-size: 12px;",4,"ngIf"],["scope","col",2,"text-align","center","font-size","12px","width","9%"],["scope","col","style","text-align: center; font-size: 12px; width: 9%;",4,"ngIf"],["scope","col",2,"text-align","center","font-size","12px","width","6%"],["style","border: 1px; max-height: 25px;",3,"click",4,"ngFor","ngForOf"],[3,"popupsettings","onItemDoubleClick"],["genericGridProduct",""],["genericGridViewEdit",""],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],[3,"resetParent"],["ContractPriceVisualization",""],["type","submit","appOldFYearDB","",1,"btn","btn-info","btn-sm",3,"disabled","click"],["isOldFYearDB","appOldFYearDB"],["type","button","appOldFYearDB","",1,"btn","btn-info","btn-sm",3,"disabled","click"],["type","button",1,"btn","btn-info","btn-sm",3,"click"],[1,"row","plainBackGround",2,"margin-top","0.5rem"],[1,"form-group-row"],[1,"form-control-label",2,"width","108px"],["type","text","id","pricename","autocomplete","off",2,"width","72%","height","24px",3,"ngModel","disabled","ngModelChange"],[2,"margin-top","5px"],[2,"width","72%","height","24px",3,"ngModel","disabled","ngModelChange"],["value","CUSTOMER"],["value","SUPPLIER"],[1,"col-md-4",2,"font-size","13px"],[1,"row",2,"margin-left","80px !important"],[2,"display","flex"],[1,"form-control-label",2,"width","70px"],["type","date",2,"width","40%","height","24px",3,"ngModel","disabled","ngModelChange","change"],[2,"margin-left","5px","width","33%","height","30px"],["name","nepaliDateFrom",3,"id","label","ngModel","disable","change","ngModelChange"],[2,"margin-top","5px","display","flex"],["name","nepaliDateto",3,"id","disable","label","ngModel","change","ngModelChange"],["type","radio","name","item",3,"ngModel","value","disabled","ngModelChange","change"],["scope","col",2,"text-align","center","font-size","12px","width","28%"],["scope","col",2,"text-align","center","font-size","12px","width","8%"],["scope","col",2,"text-align","center","width","9%","font-size","12px"],[2,"border","1px","max-height","25px",3,"click"],["id","sn",2,"line-height","21px","text-align","center","border","1px solid #e6e6e6"],[2,"line-height","21px","text-align","center","border","1px solid #e6e6e6"],["type","text","placeholder","Please Enter to Select","autocomplete","off","readonly","true",2,"height","25px","width","100% !important",3,"id","ngModel","disabled","keydown.enter","ngModelChange","keydown.Shift.Delete"],[2,"width","95%","height","25px",3,"id","ngModel","disabled","ngModelChange","change"],["value","FLAT",4,"ngIf"],["value","DISCOUNT"],["style","line-height: 21px; text-align: center;border: 1px solid #e6e6e6;",4,"ngIf"],["style","line-height: 21px; text-align: right;border: 1px solid #e6e6e6;",4,"ngIf"],[2,"line-height","21px","text-align","right","border","1px solid #e6e6e6"],["type","number","autocomplete","off",2,"height","25px","width","100% !important",3,"id","ngModel","disabled","ngModelChange","keydown.enter","keydown.tab"],["type","checkbox",2,"height","18px","width","19% !important",3,"id","ngModel","disabled","change","ngModelChange"],["value","FLAT"],["type","number","autocomplete","off",2,"height","25px","width","100% !important",3,"id","disabled","ngModel","ngModelChange","keydown.enter","keydown.tab"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5"),t._uU(3),t.qZA()(),t.TgZ(4,"div",2)(5,"div",3),t.YNc(6,ft,2,0,"button",4),t.YNc(7,It,3,1,"button",5),t.YNc(8,Mt,3,1,"button",5),t.YNc(9,Ot,2,0,"button",4),t.YNc(10,bt,2,0,"button",4),t.YNc(11,xt,3,1,"button",6),t.YNc(12,At,2,0,"button",7),t.TgZ(13,"button",8),t.NdJ("click",function(){return n.cancel()}),t._uU(14,"Back"),t.qZA()()()(),t.YNc(15,Dt,34,22,"div",9),t.TgZ(16,"div")(17,"div",10)(18,"div",11)(19,"div",12)(20,"label",13),t._uU(21,"Search:"),t.qZA(),t.TgZ(22,"div",14)(23,"input",15),t.NdJ("ngModelChange",function(o){return n.filter=o}),t.qZA()()()()()(),t.TgZ(24,"div")(25,"div",16)(26,"div",17)(27,"table",18)(28,"thead")(29,"tr",19)(30,"th",20),t._uU(31,"SNo."),t.qZA(),t.YNc(32,Pt,2,0,"th",21),t.YNc(33,St,2,0,"th",21),t.TgZ(34,"th",22),t._uU(35,"PRICING MODE"),t.qZA(),t.YNc(36,vt,2,0,"th",23),t.YNc(37,wt,4,0,"th",24),t.YNc(38,Rt,2,0,"th",24),t.TgZ(39,"th",25),t._uU(40,"DISCOUNT(%)"),t.qZA(),t.YNc(41,Nt,4,0,"th",26),t.TgZ(42,"th",27),t._uU(43,"IS-ACTIVE"),t.qZA()()(),t.TgZ(44,"tbody"),t.YNc(45,kt,18,18,"tr",28),t.ALo(46,"searchDatas"),t.qZA()()()()(),t.TgZ(47,"generic-popup-grid",29,30),t.NdJ("onItemDoubleClick",function(o){return n.onProductSelected(o)}),t.qZA(),t.TgZ(49,"generic-popup-grid",29,31),t.NdJ("onItemDoubleClick",function(o){return n.onContactPriceSelected(o)}),t.qZA(),t.TgZ(51,"file-uploader-popup",32,33),t.NdJ("onUploaded",function(o){return n.fileUploadSuccess(o)}),t.qZA(),t.TgZ(53,"app-contract-price-visualization",34,35),t.NdJ("resetParent",function(){return n.onResetParent()}),t.qZA()),2&e&&(t.xp6(3),t.AsE("",n.modeTitle," [",n.Mode,"]"),t.xp6(3),t.Q6J("ngIf",!n.showSecondaryButtons),t.xp6(1),t.Q6J("ngIf",!n.showSecondaryButtons),t.xp6(1),t.Q6J("ngIf",!n.showSecondaryButtons),t.xp6(1),t.Q6J("ngIf",!n.showSecondaryButtons),t.xp6(1),t.Q6J("ngIf",!n.showSecondaryButtons),t.xp6(1),t.Q6J("ngIf","VIEW"==n.Mode),t.xp6(1),t.Q6J("ngIf",n.showSecondaryButtons),t.xp6(3),t.Q6J("ngIf",n.ShowMore),t.xp6(8),t.Q6J("ngModel",n.filter),t.xp6(9),t.Q6J("ngIf",1==n.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",2==n.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf",1==n.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",1==n.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",1==n.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf",1==n.contractpriceObj.PRICEMODE),t.xp6(4),t.Q6J("ngForOf",t.xi3(46,21,n.contractpriceObj.CList,n.filter)),t.xp6(2),t.Q6J("popupsettings",n.gridPopupSettingsForproduct),t.xp6(2),t.Q6J("popupsettings",n.gridPopupSettingsForView),t.xp6(2),t.Q6J("popupsettings",n.fileUploadPopupSettings))},dependencies:[h.sg,h.O5,l.YN,l.Kr,l.Fj,l.wV,l.Wl,l.EJ,l._,l.JJ,l.On,D.Zl,w.H,R.v,f.U,ut,ht],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{border:1px solid #cbcbcb;border-radius:3px;height:30px;color:#000}label[_ngcontent-%COMP%]{width:62px;height:25px;font-size:13px}.form-control[_ngcontent-%COMP%]{font-size:13px}td[_ngcontent-%COMP%]{border:1px solid #e6e6e6}input[_ngcontent-%COMP%]{padding:8px}"]}),r})()},{path:"item-wise-entry",component:(()=>{class r{constructor(e,n,i,o,c,E){this.alertService=e,this.loadingService=n,this.masterService=i,this._trnMainService=o,this._alertService=c,this.router=E,this.ShowMore=!1,this.showStockedQuantityOnly=0,this.activerowIndex=0,this.contractpriceObj={},this.itemWiseObj={},this.disableOnSave=!0,this.gridPopupSettingsForCustomer=new A.sG,this.gridPopupSettingsForproduct=new A.sG}ngOnInit(){this.Reset(),this.contractpriceObj.CList[this.activerowIndex].ISACTIVE=1,this.contractpriceObj.CONTRACTPRICETYPE="Customer Contract Pricing",this.itemWiseObj.CONTRACTPRICETYPE="Cus"}showMore(){this.ShowMore=!this.ShowMore}CusWiseEntry(){console.log("Reached inside");try{this.router.navigate(["/pages/masters/Contract-price"])}catch{}}itemWiseEntry(){console.log("Reached inside");try{this.router.navigate(["./pages/masters/Contract-price/item-wise-entry",{mode:"add",returnUrl:this.router.url}])}catch{}}rowClick(e){this.activerowIndex=e}addRow(){if(""==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].MRP||null==this.contractpriceObj.CList[this.activerowIndex].MRP)return void this.alertService.warning("Please Select the Item Name.");if(null==this.contractpriceObj.CList[this.activerowIndex].DISCOUNT||null==this.contractpriceObj.CList[this.activerowIndex].DISCOUNT)return void this.alertService.warning("Please Enter the Discount rate.");null==this.contractpriceObj.CList&&(this.contractpriceObj.CList=[]);try{this.contractpriceObj.CList.push({})}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n).focus()},50),this.contractpriceObj.CList.forEach(i=>{i.ISACTIVE=1})}nextRow(){null==this.contractpriceObj.CList&&(this.contractpriceObj.CList=[]);try{this.contractpriceObj.CList.push({})}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n).focus()},50),this.contractpriceObj.CList.forEach(i=>{i.ISACTIVE=1})}itemEnterCommand(){this.getProductList(),this.genericGridProduct.show()}onCustomerSelected(e){this.contractpriceObj.CustID=e.ACID,this.contractpriceObj.CustName=e.ACNAME,this.contractpriceObj.ADDRESS=e.ADDRESS,this.contractpriceObj.VAT=e.VATNO,this.masterService.focusAnyControl("itemname"+this.activerowIndex)}getCustomersList(){this.gridPopupSettingsForCustomer={title:"Customers",apiEndpoints:"/getAccountPagedListByPType/PA/C/0",defaultFilterIndex:0,useDefinefilterValue:this._trnMainService.TrnMainObj.BILLTO,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"VATNO",title:"VAT No.",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"PHONE",title:"Mobile No.",hidden:!1,noSearch:!1}]}}ProductList(e){this.activerowIndex=e,""==this.contractpriceObj.CustName||null==this.contractpriceObj.CustName||null==this.contractpriceObj.CustName?(this.alertService.warning("Please Select the Customer"),setTimeout(()=>{document.getElementById("custname").focus()},1e3),this.genericGridProduct.hide()):(this.getProductList(),this.genericGridProduct.show())}getProductList(){this.gridPopupSettingsForproduct={title:"PRODUCTS",apiEndpoints:`/getMenuitemWithStockPagedList/${this.showStockedQuantityOnly}/A/all/NO/${this._trnMainService.userProfile.userWarehouse}`,defaultFilterIndex:1,useDefinefilterValue:"",columns:[{key:"MENUCODE",title:"PRODUCT CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"DESCRIPTION",hidden:!1,noSearch:!1},{key:"BASEUNIT",title:"UNIT",hidden:!1,noSearch:!0},{key:"MRP",title:"MRP",hidden:!1,noSearch:!0,alignment:"right",pipe:!0}]},this.genericGridProduct.show()}onProductSelected(e){console.log("on prodcut select",e.MCODE,e.MENUCODE,this.itemWiseObj.CONTRACTPRICETYPE),this.itemWiseObj.ITEMNAME=e.DESCA,this.itemWiseObj.MCODE=e.MCODE,this.itemWiseObj.ISVAT=e.ISVAT,this.itemWiseObj.MRP=e.MRP,this.loadingService.show("Getting contracts assigned to this item..."),this.masterService.masterGetmethod(`/getItemWiseContract/${e.MCODE}/${this.itemWiseObj.CONTRACTPRICETYPE}`).subscribe(n=>{console.log("on item seleceted",n),"ok"==n.status?(this.loadingService.hide(),console.log("RESSS",n.result),this.itemWiseObj.contractList=n.result,this.itemWiseObj.contractList.forEach(i=>{i.ISACTIVE=1})):"error2"==n.status&&(this.loadingService.hide(),this.alertService.info(n.result.error.result))},n=>{this.loadingService.hide()})}onSave(){this.Mode="NEW",console.log(" TABLE SAVE VALUE",this.itemWiseObj);try{this.submitSave()}catch(e){alert(e)}}submitSave(){this.masterService.updateItemWiseContract(this.Mode,this.itemWiseObj).subscribe(e=>{console.log("item wise entry result",e),"ok"==e.status?(this.loadingService.hide(),this.alertService.success("ITEM WISE Saved Successfully !"),this.Reset()):(this.loadingService.hide(),this.alertService.info(e.result.error))})}removeInvalidRows(){this.contractpriceObj.CList=this.contractpriceObj.CList.filter(e=>null!=e.ITEMCODE&&""!=e.ITEMCODE)}onEditclicked(){this.Mode="EDIT"}Reset(){this.ShowMore=!0,this.modeTitle="Contract Pricing:Item Wise Entry",this.Mode="ADD",this.itemWiseObj={},this.itemWiseObj.contractList=[],this.itemWiseObj.ITEMNAME="",this.itemWiseObj.CONTRACTPRICETYPE="CUSTOMER",null==this.itemWiseObj.contractList&&(this.itemWiseObj.contractList=[]);try{this.itemWiseObj.contractList.push({})}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n)?.focus()},50),this.itemWiseObj.contractList.forEach(i=>{i.ISACTIVE=1})}clearRow(){confirm("Are you sure you want to delete the Row? ")&&(this.contractpriceObj.CList.splice(this.activerowIndex,1),0===this.contractpriceObj.CList.length&&this.nextRow())}cancel(){console.log("@@returnUrl");try{this.router.navigate(["/pages/dashboard"])}catch(e){console.log(e),this.alertService.info(e)}}onNewSRateEntry(e){console.log("New_SRate changed",e),0!=e?(this.New_Srate=!0,document.getElementById("NewDisrate"+this.activerowIndex).setAttribute("disabled","disabled"),this.itemWiseObj.contractList[this.activerowIndex].NEW_DRATE=0,this.itemWiseObj.contractList[this.activerowIndex].DISCOUNTTYPE="FLAT"):0==e?(console.log("@@New_SRate",e),document.getElementById("NewDisrate"+this.activerowIndex).removeAttribute("disabled"),this.itemWiseObj.contractList[this.activerowIndex].DISCOUNTTYPE=""):(this.New_Srate=!1,document.getElementById("NewSrate"+this.activerowIndex).removeAttribute("disabled"))}onNewDisRateEntry(e){console.log("New_DisRate changed",e),0!=e?(this.New_disrate=!0,document.getElementById("NewSrate"+this.activerowIndex).setAttribute("disabled","disabled"),this.itemWiseObj.contractList[this.activerowIndex].NEW_SRATE=0,this.itemWiseObj.contractList[this.activerowIndex].DISCOUNTTYPE="DISCOUNT"):0==e?(document.getElementById("NewSrate"+this.activerowIndex).removeAttribute("disabled"),this.itemWiseObj.contractList[this.activerowIndex].DISCOUNTTYPE=""):(this.New_disrate=!1,document.getElementById("NewDisrate"+this.activerowIndex).removeAttribute("disabled"))}handleKeyUpboardEvent(e){("ControlLeft"==e.code||"ControlRight"==e.code)&&(e.preventDefault(),this.showSecondaryButtons=!1)}handleKeyDownboardEvent(e){("ControlLeft"==e.code||"ControlRight"==e.code)&&(e.preventDefault(),this.showSecondaryButtons=!0)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(d.c),t.Y36(C.V),t.Y36(u.P),t.Y36(x.p),t.Y36(d.c),t.Y36(p.F0))},r.\u0275cmp=t.Xpm({type:r,selectors:[["ItemWise-Contractprice"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Vt,5),t.Gf(Ft,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.genericGridCustomer=i.first),t.iGM(i=t.CRH())&&(n.genericGridProduct=i.first)}},hostBindings:function(e,n){1&e&&t.NdJ("keyup",function(o){return n.handleKeyUpboardEvent(o)},!1,t.evT)("keydown",function(o){return n.handleKeyDownboardEvent(o)},!1,t.evT)},decls:59,vars:8,consts:[[1,"sticky-top","row"],[1,"col-md-3"],[2,"display","flex"],[1,"btn","btn-info",3,"click"],[2,"margin-left","-105px"],[1,"col-md-6"],[1,"row","pull-right"],["type","submit",1,"btn","btn-info","btn-sm",3,"click"],["type","button",1,"btn","btn-info","btn-sm"],["type","button","class","btn btn-info btn-sm",4,"ngIf"],["class","row plainBackGround","style","margin-top: 0.5rem;",4,"ngIf"],[2,"margin-top","10px"],[2,"height","480px","overflow-y","scroll"],[2,"margin-bottom","5px","font-size","13px","width","99%","margin-left","10px"],[2,"border-bottom","2px solid #e6e6e6","border-top","2px solid #e6e6e6","height","30px","background","#9ccae4","color","black"],[2,"font-size","12px","text-align","center"],["scope","col",2,"text-align","center","font-size","12px","width","21%"],["scope","col",2,"text-align","center","font-size","12px","width","13%"],["scope","col",2,"text-align","center","font-size","12px"],["scope","col",2,"text-align","center","width","9%","font-size","12px"],["scope","col",2,"text-align","center","font-size","12px","width","9%"],["style","border: 1px; max-height: 25px;",3,"click",4,"ngFor","ngForOf"],[3,"popupsettings","onItemDoubleClick"],["genericGridCustomer",""],["genericGridProduct",""],[1,"row","plainBackGround",2,"margin-top","0.5rem"],[1,"col-md-4"],[1,"form-group-row"],[1,"form-control-label"],["type","text","id","custname","placeholder","Press Enter to Select","autocomplete","off",2,"width","65%","height","24px",3,"ngModel","ngModelChange","keydown.enter"],[1,"row",2,"margin-left","60px !important"],[2,"width","137px"],[2,"width","200px","height","25px",3,"ngModel","ngModelChange"],["value","CUSTOMER"],["value","SUPPLIER"],[2,"margin-left","146px"],[1,"legend-class"],[2,"margin-left","44px","margin-top","-17px"],[2,"border","1px","max-height","25px",3,"click"],["id","sn",2,"line-height","21px","text-align","center","border","1px solid #e6e6e6"],[2,"line-height","21px","text-align","left","border","1px solid #e6e6e6"],[2,"line-height","21px","text-align","right","border","1px solid #e6e6e6"],[2,"line-height","21px","text-align","center","border","1px solid #e6e6e6"],["type","number",2,"height","25px","text-align","right",3,"id","ngModel","ngModelChange"],["type","checkbox",2,"height","25px",3,"id","ngModel","disabled","change","ngModelChange"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),t.NdJ("click",function(){return n.itemWiseEntry()}),t.TgZ(4,"span"),t._uU(5,"Item Wise Entry"),t.qZA()(),t.TgZ(6,"button",3),t.NdJ("click",function(){return n.CusWiseEntry()}),t.TgZ(7,"span"),t._uU(8,"Customer Wise Entry"),t.qZA()()()(),t.TgZ(9,"div",1)(10,"h5",4),t._uU(11),t.qZA()(),t.TgZ(12,"div",5)(13,"div",6)(14,"button",7),t.NdJ("click",function(){return n.Reset()}),t._uU(15,"Reset"),t.qZA(),t.TgZ(16,"button",7),t.NdJ("click",function(){return n.onSave()}),t._uU(17,"Save"),t.qZA(),t.TgZ(18,"button",8),t._uU(19,"Delete"),t.qZA(),t.YNc(20,Jt,2,0,"button",9),t.YNc(21,Gt,2,0,"button",9),t.TgZ(22,"button",7),t.NdJ("click",function(){return n.cancel()}),t._uU(23,"Back"),t.qZA()()()(),t.YNc(24,Wt,23,3,"div",10),t.TgZ(25,"div")(26,"div",11)(27,"div",12)(28,"table",13)(29,"thead")(30,"tr",14)(31,"th",15),t._uU(32,"SNo."),t.qZA(),t.TgZ(33,"th",16),t._uU(34,"CUSTOMER NAME"),t.qZA(),t.TgZ(35,"th",17),t._uU(36,"ADDRESS"),t.qZA(),t.TgZ(37,"th",18),t._uU(38,"VAT NO"),t.qZA(),t.TgZ(39,"th",19),t._uU(40,"MRP"),t.qZA(),t.TgZ(41,"th",20),t._uU(42,"Discount Type"),t.qZA(),t.TgZ(43,"th",20),t._uU(44,"CURRENT S-RATE"),t.qZA(),t.TgZ(45,"th",20),t._uU(46,"CURRENT Dis RATE"),t.qZA(),t.TgZ(47,"th",20),t._uU(48,"NEW S-RATE"),t.qZA(),t.TgZ(49,"th",20),t._uU(50,"NEW DIS RATE"),t.qZA(),t.TgZ(51,"th",18),t._uU(52,"IS-ACTIVE"),t.qZA()()(),t.TgZ(53,"tbody"),t.YNc(54,zt,23,15,"tr",21),t.qZA()()()()(),t.TgZ(55,"generic-popup-grid",22,23),t.NdJ("onItemDoubleClick",function(o){return n.onCustomerSelected(o)}),t.qZA(),t.TgZ(57,"generic-popup-grid",22,24),t.NdJ("onItemDoubleClick",function(o){return n.onProductSelected(o)}),t.qZA()),2&e&&(t.xp6(11),t.AsE("",n.modeTitle," [",n.Mode,"]"),t.xp6(9),t.Q6J("ngIf",n.showSecondaryButtons),t.xp6(1),t.Q6J("ngIf",n.showSecondaryButtons),t.xp6(3),t.Q6J("ngIf",n.ShowMore),t.xp6(30),t.Q6J("ngForOf",n.itemWiseObj.contractList),t.xp6(1),t.Q6J("popupsettings",n.gridPopupSettingsForCustomer),t.xp6(2),t.Q6J("popupsettings",n.gridPopupSettingsForproduct))},dependencies:[h.sg,h.O5,l.YN,l.Kr,l.Fj,l.wV,l.Wl,l.EJ,l.JJ,l.On,D.Zl],styles:["legend[_ngcontent-%COMP%]{font-size:12px;color:#222;width:auto}fieldset[_ngcontent-%COMP%]{margin-bottom:1%;border:2px solid #dbd7d7;width:179px;height:40px;margin-left:250px}"]}),r})()}];let Qt=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[p.Bz.forChild(Yt),p.Bz]}),r})();var Kt=a(71459),Ht=a(55618),qt=a(71800),$t=a(63321);let Xt=(()=>{class r{static forRoot(){return{ngModule:r}}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({providers:[N.i],imports:[h.ez,qt.zk.forRoot(),$t._.forRoot(),b.JX,v.Cl,l.u5]}),r})(),te=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[h.ez,Qt,_.m,b.JX,g.Xd,O.Is,m.b.forRoot(),P.Z,Kt.J,Ht.c.forRoot(),Xt.forRoot()]}),r})()}}]);