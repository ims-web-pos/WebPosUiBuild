(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[8977],{49457:function(M,w){var I;void 0!==(I=function(){"use strict";function u(o,a,g){var r=new XMLHttpRequest;r.open("GET",o),r.responseType="blob",r.onload=function(){f(r.response,a,g)},r.onerror=function(){console.error("could not download file")},r.send()}function x(o){var a=new XMLHttpRequest;a.open("HEAD",o,!1);try{a.send()}catch{}return 200<=a.status&&299>=a.status}function h(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(a)}}var p="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,b=p.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),f=p.saveAs||("object"!=typeof window||window!==p?function(){}:"download"in HTMLAnchorElement.prototype&&!b?function(o,a,g){var r=p.URL||p.webkitURL,d=document.createElement("a");d.download=a=a||o.name||"download",d.rel="noopener","string"==typeof o?(d.href=o,d.origin===location.origin?h(d):x(d.href)?u(o,a,g):h(d,d.target="_blank")):(d.href=r.createObjectURL(o),setTimeout(function(){r.revokeObjectURL(d.href)},4e4),setTimeout(function(){h(d)},0))}:"msSaveOrOpenBlob"in navigator?function(o,a,g){if(a=a||o.name||"download","string"!=typeof o)navigator.msSaveOrOpenBlob(function C(o,a){return typeof a>"u"?a={autoBom:!1}:"object"!=typeof a&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\ufeff",o],{type:o.type}):o}(o,g),a);else if(x(o))u(o,a,g);else{var r=document.createElement("a");r.href=o,r.target="_blank",setTimeout(function(){h(r)})}}:function(o,a,g,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof o)return u(o,a,g);var d="application/octet-stream"===o.type,O=/constructor/i.test(p.HTMLElement)||p.safari,D=/CriOS\/[\d]+/.test(navigator.userAgent);if((D||d&&O||b)&&typeof FileReader<"u"){var l=new FileReader;l.onloadend=function(){var i=l.result;i=D?i:i.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=i:location=i,r=null},l.readAsDataURL(o)}else{var _=p.URL||p.webkitURL,t=_.createObjectURL(o);r?r.location=t:location.href=t,r=null,setTimeout(function(){_.revokeObjectURL(t)},4e4)}});p.saveAs=f.saveAs=f,M.exports=f}.apply(w,[]))&&(M.exports=I)},23707:(M,w,c)=>{"use strict";c.d(w,{O:()=>D});var e=c(66274),I=c(53074),C=c(69389),u=c(67311),x=c(14970),h=c(71180),p=c(92752),b=c(7587),f=c(4721);const o=["fileSelect"];function a(l,_){if(1&l){const t=e.EpF();e.TgZ(0,"tr")(1,"td",34)(2,"input",35),e.NdJ("change",function(){const s=e.CHM(t).index,m=e.oxw(3);return e.KtG(m.onChangeDefault(s))}),e.qZA()(),e.TgZ(3,"td",36),e._UZ(4,"i",37),e.qZA(),e.TgZ(5,"td",38),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"button",39),e.NdJ("click",function(){const s=e.CHM(t).index,m=e.oxw(3);return e.KtG(m.onPreviewImage(s))}),e._UZ(9,"i",40),e.qZA(),e.TgZ(10,"button",41),e.NdJ("click",function(){const n=e.CHM(t),s=n.index,m=n.$implicit,v=e.oxw(3);return e.KtG(v.onDeleteImage(s,m.RowMode))}),e._UZ(11,"i",42),e.qZA()()()}if(2&l){const t=_.$implicit;e.xp6(2),e.Q6J("checked",!0===t.IsDefault),e.xp6(4),e.Oqu(t.ImageName)}}function g(l,_){if(1&l&&(e.TgZ(0,"div",30)(1,"table",31)(2,"thead")(3,"tr")(4,"th",32),e._uU(5," IsDefault "),e.qZA()()(),e.TgZ(6,"tbody"),e.YNc(7,a,12,2,"tr",33),e.qZA()()()),2&l){const t=e.oxw(2);e.xp6(7),e.Q6J("ngForOf",t.ImageFiles.ImageList)}}function r(l,_){if(1&l){const t=e.EpF();e.TgZ(0,"div",43)(1,"div")(2,"button",44),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.closeFullscreen())}),e.TgZ(3,"span",45),e._uU(4,"\xd7"),e.qZA()(),e.TgZ(5,"span",46),e._uU(6),e.qZA()(),e.TgZ(7,"div",47),e.NdJ("mousedown",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.startDrag(n))})("mousemove",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.drag(n))})("mouseup",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.endDrag())})("touchstart",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.startDrag(n))})("touchmove",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.drag(n))})("touchend",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.endDrag())}),e.TgZ(8,"img",48,49),e.NdJ("wheel",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.handleZoom(n))}),e.qZA()()()}if(2&l){const t=e.oxw(2);e.xp6(6),e.Oqu(t.previewedImgName),e.xp6(2),e.Udp("transform","scale("+t.zoomLevel+") translate("+t.dragOffset.x+"px, "+t.dragOffset.y+"px)"),e.s9C("src",t.imgURL,e.LSH)}}function d(l,_){if(1&l){const t=e.EpF();e.TgZ(0,"div")(1,"div",12)(2,"div",13)(3,"div",14)(4,"div",15),e.NdJ("dragover",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.onDragOver(n))})("drop",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.onDrop(n))})("click",function(){e.CHM(t);const n=e.MAs(16);return e.KtG(n.click())}),e.TgZ(5,"b"),e._uU(6,"Choose a File"),e.qZA(),e._uU(7," or Drag it Here. "),e.qZA()(),e.TgZ(8,"div",16)(9,"div",17)(10,"span",18)(11,"div",19),e._UZ(12,"span",20),e.TgZ(13,"span",21),e._uU(14,"Browse"),e.qZA(),e.TgZ(15,"input",22,23),e.NdJ("change",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.onFileChange(n))}),e.qZA()(),e.TgZ(17,"button",24),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.UploadImages())}),e.TgZ(18,"span",25),e._UZ(19,"i",26),e.qZA(),e._uU(20,"Upload "),e.qZA()()()()(),e.TgZ(21,"div",13)(22,"div",27),e.YNc(23,g,8,1,"div",28),e.qZA(),e.YNc(24,r,10,4,"div",29),e.qZA()(),e._UZ(25,"br"),e.qZA()}if(2&l){const t=e.oxw();e.xp6(4),e.ekj("file-dropover-continue",t.dragging),e.xp6(13),e.Q6J("disabled",!t.selectedFile&&t.uploadDisable),e.xp6(6),e.Q6J("ngIf",t.ImageFiles.ImageList&&t.ImageFiles.ImageList.length>0),e.xp6(1),e.Q6J("ngIf",t.isFullscreen)}}function O(l,_){if(1&l){const t=e.EpF();e.TgZ(0,"div",50)(1,"angular-editor",51),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.htmlContent=n)}),e.qZA(),e.TgZ(2,"div")(3,"button",52),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onSaveDescription())}),e.TgZ(4,"span",25),e._UZ(5,"i",26),e.qZA(),e._uU(6,"Save "),e.qZA()()()}if(2&l){const t=e.oxw();e.xp6(1),e.Q6J("placeholder","Enter text here...")("ngModel",t.htmlContent)("config",t.editorConfig)}}let D=(()=>{class l{constructor(t,i,n,s,m){this.masterService=t,this.setting=i,this.alertService=n,this.spinner=s,this.state=m,this.dragging=!1,this.fileList=null,this.ImageFiles={},this.DescriptionObj={},this.mode="add",this.imgURL=null,this.isPopUpActive=!1,this.isUploadActive=!1,this.isDescriptionActive=!1,this.uploadDisable=!0,this.editorConfig={editable:!0,spellcheck:!0,height:"40vh",minHeight:"0",maxHeight:"auto",width:"auto",minWidth:"0",defaultParagraphSeparator:"p"},this.isFullscreen=!1,this.zoomLevel=1,this.maxZoomLevel=3,this.minZoomLevel=.5,this.isDragging=!1,this.dragOffset={x:0,y:0},this.lastX=0,this.lastY=0,this.DescriptionObj={Description:"",Id:null,Itemcode:null};const v=this.state.getGlobalSetting("apiUrl");if(v&&v.length>0){const T=v.slice(0,v.lastIndexOf("/")+1);this.apiUrl=T}}ngOnInit(){}show(t,i){this.isPopUpActive=!0,this.isUploadActive=!0,this.uploadDisable=!0,this.ImageFiles.ImageList=[],this.ImageFiles.TableName=t,this.ImageFiles.ImageCode=this.DescriptionObj.Itemcode=i,this.getUploadedImages(),this.mode="add",this.getItemDescription()}closeDialog(){this.isPopUpActive=!1,this.isUploadActive=!1,this.isDescriptionActive=!1,this.ImageFiles={},this.DescriptionObj={}}setActiveTab(t){"upload"===t?(this.isPopUpActive=!0,this.isUploadActive=!0,this.isDescriptionActive=!1):"description"===t&&(this.isPopUpActive=!0,this.isUploadActive=!1,this.isDescriptionActive=!0)}onDragOver(t){this.dragging=!0,t.preventDefault()}onDrop(t){this.dragging=!1,t.preventDefault(),t.stopPropagation(),this.selectedFile=t.dataTransfer.files[0],this.setSelectedFileNames()}getUploadedImages(){this.masterService.getImages(this.ImageFiles.ImageCode).subscribe(t=>{t&&t.forEach(i=>{let n={};n.IsDefault=i.ISDEFAULT,n.Image=i.IMAGEPATH,n.Id=i.ID,n.RowMode="EDIT",n.ImageName=i.IMAGENAME,this.ImageFiles.ImageList.push(n)})})}setSelectedFileNames(){if(null==this.ImageFiles.ImageList&&(this.ImageFiles.ImageList=[]),null==this.selectedFile)return;let t={};t.IsDefault=0==this.ImageFiles.ImageList.length,t.Image=this.selectedFile,t.ImageName=this.selectedFile.name,t.Id="",t.RowMode="NEW",this.ImageFiles.ImageList.push(t)}onFileChange(t){this.selectedFile=t.target.files[0],this.setSelectedFileNames()}onPreviewImage(t){if(this.isFullscreen=!0,"EDIT"==this.ImageFiles.ImageList[t].RowMode)this.imgURL=this.apiUrl+this.ImageFiles.ImageList[t].Image,this.previewedImgName=this.ImageFiles.ImageList[t].ImageName;else{const i=this.ImageFiles.ImageList[t].Image;if(this.previewedImgName=this.ImageFiles.ImageList[t].Image.name,i){const n=new FileReader;n.onload=s=>{this.imgURL=s.target.result},n.readAsDataURL(i)}}}onChangeDefault(t){this.uploadDisable=!1,this.ImageFiles.ImageList.forEach((i,n)=>{i.IsDefault=n==t})}onDeleteImage(t,i){"EDIT"==i&&this.masterService.deleteImage(this.ImageFiles.ImageList[t].Id).subscribe(n=>{n&&(this.alertService.info("Image Deleted Successfully!"),this.ImageFiles.ImageList.splice(t,1))})}UploadImages(){const t=new FormData;t.append("TableName",this.ImageFiles.TableName),t.append("ImageCode",this.ImageFiles.ImageCode),this.ImageFiles.ImageList.forEach((i,n)=>{"NEW"==i.RowMode&&t.append(`ImageList[${n}].Image`,i.Image),t.append(`ImageList[${n}].IsDefault`,i.IsDefault.toString()),t.append(`ImageList[${n}].Id`,i.Id)}),this.spinner.show("Uploading Image, Please wait.."),this.masterService.UploadImages(t).subscribe(i=>{"ok"==i.status?(this.spinner.hide(),this.alertService.success("Your Images have been uploaded successfully."),this.closeDialog()):(this.spinner.hide(),this.alertService.error("Image failed to upload."))},i=>{this.spinner.hide(),this.alertService.error(i)})}onSaveDescription(){this.DescriptionObj.Description=this.htmlContent;const t=new FormData;t.append("mode",this.mode),t.append("data.Itemcode",this.DescriptionObj.Itemcode),t.append("data.Description",this.DescriptionObj.Description),this.masterService.SaveItemDescription(t).subscribe(i=>{"Saved successfully"==i||"Update successfully"==i?(this.spinner.hide(),this.alertService.success("Description Saved Sucessfully!"),this.closeDialog()):(this.spinner.hide(),this.alertService.error("Failed to Save!"))},i=>{this.spinner.hide(),this.alertService.error(i)})}getItemDescription(){!this.DescriptionObj.Itemcode||null==this.DescriptionObj.Itemcode||""==this.DescriptionObj.Itemcode||this.masterService.getItemDescription(this.DescriptionObj.Itemcode).subscribe(t=>{t&&(this.htmlContent=this.DescriptionObj.Description=t.DESCRIPTION,this.DescriptionObj.Itemcode=t.ITEMCODE,this.mode="edit")})}openFullscreen(){this.isFullscreen=!0,this.zoomLevel=1}closeFullscreen(){this.isFullscreen=!1}handleZoom(t){t.preventDefault(),t.deltaY<0&&this.zoomLevel<this.maxZoomLevel?this.zoomLevel+=.1:t.deltaY>0&&this.zoomLevel>this.minZoomLevel&&(this.zoomLevel-=.1)}startDrag(t){this.isDragging=!0;const i=t instanceof MouseEvent?t.clientX:t.touches[0].clientX,n=t instanceof MouseEvent?t.clientY:t.touches[0].clientY;this.lastX=i,this.lastY=n,t.preventDefault()}drag(t){if(!this.isDragging)return;const i=t instanceof MouseEvent?t.clientX:t.touches[0].clientX,n=t instanceof MouseEvent?t.clientY:t.touches[0].clientY,m=n-this.lastY;this.dragOffset.x+=i-this.lastX,this.dragOffset.y+=m,this.lastX=i,this.lastY=n,t.preventDefault()}endDrag(){this.isDragging=!1}}return l.\u0275fac=function(t){return new(t||l)(e.Y36(I.P),e.Y36(C.R),e.Y36(u.c),e.Y36(x.V),e.Y36(h.q))},l.\u0275cmp=e.Xpm({type:l,selectors:[["generic-img-upload"]],viewQuery:function(t,i){if(1&t&&e.Gf(o,5),2&t){let n;e.iGM(n=e.CRH())&&(i.fileSelect=n.first)}},decls:18,vars:8,consts:[[1,"modal-sticky"],[1,"modal-content","modal-content-main-area"],[1,"modal-header",2,"padding","0px","margin-top","10px"],[1,"modal-title",2,"text-align","center","margin","0px 0px 5px 30px"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true",2,"margin-right","10px"],[1,"nav","nav-tabs"],[1,"nav-item"],["type","button",1,"nav-link",3,"click"],[1,"upload-area","container"],[4,"ngIf"],["class","col-md-12 modal-content modal-content-main-area description-area",4,"ngIf"],[1,"file-upload-area"],[1,"row"],[1,"col-md-10"],["id","drop-zone",1,"upload-drop-zone",3,"dragover","drop","click"],[1,"col-md-2","pl-0"],[1,"input-group","image-preview"],[1,"input-group-btn"],[1,"btn","btn-info","image-preview-input",2,"margin-right","5px","width","70px"],[1,"glyphicon","glyphicon-folder-open"],[1,"image-preview-input-title"],["title","browse","placeholder","browser","type","file","accept",".png, .jpg","name","input-file-preview",3,"change"],["fileSelect",""],["type","button",1,"btn","btn-labeled","btn-info",2,"width","70px",3,"disabled","click"],[1,"btn-label"],[1,"glyphicon","glyphicon-upload"],[1,"col-md-12"],["class","table-div",4,"ngIf"],["class","fullscreen-overlay",4,"ngIf"],[1,"table-div"],[1,"img-table"],[2,"width","8%","font-weight","bold","font-size","x-small"],[4,"ngFor","ngForOf"],[2,"text-align","center"],["type","radio","name","radioGroup",3,"checked","change"],[2,"width","6%"],[1,"fa-solid","fa-image"],[2,"width","70%"],["type","button",1,"view-button",3,"click"],[1,"fa-regular","fa-eye"],["type","button",1,"delete-button",3,"click"],[1,"fa-solid","fa-trash"],[1,"fullscreen-overlay"],["aria-label","Close",1,"close","fullscreen-close",3,"click"],["aria-hidden","true"],[2,"padding","3px"],[1,"draggable-container",3,"mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],["alt","Uploaded Image",1,"fullscreen-img",3,"src","wheel"],["zoomableImage",""],[1,"col-md-12","modal-content","modal-content-main-area","description-area"],[1,"editor-fullscreen",3,"placeholder","ngModel","config","ngModelChange"],["type","button",1,"btn","btn-labeled","btn-info","pull-right",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h6",3),e._uU(4," Image Upload "),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return i.closeDialog()}),e.TgZ(6,"span",5),e._uU(7,"\xd7"),e.qZA()()(),e.TgZ(8,"ul",6)(9,"li",7)(10,"a",8),e.NdJ("click",function(){return i.setActiveTab("upload")}),e._uU(11,"Upload"),e.qZA()(),e.TgZ(12,"li",7)(13,"a",8),e.NdJ("click",function(){return i.setActiveTab("description")}),e._uU(14,"Description"),e.qZA()()(),e.TgZ(15,"div",9),e.YNc(16,d,26,5,"div",10),e.YNc(17,O,7,3,"div",11),e.qZA()()()),2&t&&(e.ekj("modal-sticky-hide",!i.isPopUpActive),e.xp6(10),e.ekj("active",i.isUploadActive),e.xp6(3),e.ekj("active",i.isDescriptionActive),e.xp6(3),e.Q6J("ngIf",i.isUploadActive),e.xp6(1),e.Q6J("ngIf",i.isDescriptionActive))},dependencies:[p.sg,p.O5,b.JJ,b.On,f.s6],styles:[".modal-sticky[_ngcontent-%COMP%]{position:fixed;inset:0;width:auto;height:auto;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-sticky-hide[_ngcontent-%COMP%]{display:none}.modal-content[_ngcontent-%COMP%]{padding:1px;margin:0;float:right;border:0px;width:45%}.container[_ngcontent-%COMP%]{padding-top:5px}.upload-drop-zone[_ngcontent-%COMP%]{height:80px;border-width:2px;margin-bottom:0}.upload-drop-zone[_ngcontent-%COMP%]{color:#c7dadf;border-style:dashed;border-color:#c7dadf;border-radius:2px;line-height:75px;text-align:center;cursor:pointer;height:6rem}.sample-download-area[_ngcontent-%COMP%]{color:#ccc;border-style:dashed;border-color:#ccc;line-height:60px;text-align:center;cursor:pointer}.upload-drop-zone.drop[_ngcontent-%COMP%]{color:#222;border-color:#222}.image-preview-input[_ngcontent-%COMP%]{position:relative;overflow:hidden;margin:0;color:#fff;background-color:#7cbd45;border-color:#7cbd45}.image-preview-input[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:0;right:0;margin:0;padding:0;font-size:20px;cursor:pointer;opacity:0;filter:alpha(opacity=0)}.image-preview-input-title[_ngcontent-%COMP%]{margin-left:2px}.form-control[_ngcontent-%COMP%]{height:35px}.file-dropover-continue[_ngcontent-%COMP%]{color:#1b6ed6;border-style:dashed;border-color:#1b6ed6;background:#ded4d4}.img-table[_ngcontent-%COMP%]{width:100%;height:auto;padding:5px;margin-top:20px}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{color:#000;position:sticky;top:0}.table-div[_ngcontent-%COMP%]{height:35vh;overflow-y:scroll}.table-div[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.table-div[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}.table-div[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.table-div[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#fff #fff}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px}.view-button[_ngcontent-%COMP%]{border:none;color:green;background-color:#fff}.delete-button[_ngcontent-%COMP%]{margin-left:6px;border:none;color:red;background-color:#fff}.fullscreen-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.8);display:flex;justify-content:center;align-items:center;z-index:1000;flex-direction:column}.fullscreen-close[_ngcontent-%COMP%]{position:absolute;top:70px;right:10px;background:none;border:none;color:#fff;font-size:30px;cursor:pointer}.fullscreen-previewedImgName[_ngcontent-%COMP%]{padding:3px;position:absolute;top:70px;left:10px;color:#fff}.fullscreen-img[_ngcontent-%COMP%]{display:block;max-width:90%;max-height:100vh;transition:transform .3s;object-fit:contain;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.nav-tabs[_ngcontent-%COMP%]{background-color:#fff;border-bottom-width:1px;border-bottom-color:#e5e5e5;margin-left:30px}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:gray}.nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background-color:#2dacd1;color:#fff}.nav-tabs[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{margin-bottom:-1px}.nav-link[_ngcontent-%COMP%]{height:30px;padding-top:6px}.description-area[_ngcontent-%COMP%]{flex-grow:1;display:contents;flex-direction:column}"]}),l})()}}]);