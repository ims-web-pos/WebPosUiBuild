"use strict";(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[6234],{11192:(z,Z,M)=>{M.d(Z,{C:()=>p});var t=M(42326),e=M(66274),s=M(67311),h=M(94534),V=M(53074);let p=(()=>{class F{constructor(L,I,m){this.alertService=L,this.genericProductService=I,this.masterService=m,this.rateValidationDisplayMessage="",this._trnMainService=I._trnMainService,this.userSetting=I.userSetting}mrpEnterEvent(L,I,m,S,g=new Function,R=new Function,u=new Function){"Tab"==S?.key&&S?.preventDefault(),(null==g()||"default"==g())&&(console.log("log 1"),this.mrpEnterEvent_CheckSellingRate(I)),this._trnMainService.TrnMainObj.VoucherType!=t.Km.ManualstockEntry&&this.mrpEnterEvent_validateRate(L,I,m.focusTo||"default"),console.log("clicktab");var a=R();1==a.preCheck?this.mrpEnterEvent_preCheckValidation(I,a.useDefault,m.focusTo||"default"):(console.log("rateissue"),this.mrpEnterEvent_checkValidation(I,a.useDefault,m.focusTo)),0==(null==u()||u())&&this.mrpEnterEvent_CalcuteBillDefault(I),this.genericProductService.navigationUsingFocusService(I,"ALTRATE","productEntrySetting.tableId")}mrpEnterEvent_new(L,I,m){return m.checkSellingRate&&(console.log("log 2"),this.mrpEnterEvent_CheckSellingRate(I)),this.mrpEnterEvent_validateRate(L,I,m.validateRateReturn.focusToId),console.log("clicktab"),1==m.checkValidationReturn.preCheckValidation?this.mrpEnterEvent_preCheckValidation(I,!0,"ITEMDESC"):this.mrpEnterEvent_checkValidation(I,!0,"ITEMDESC"),m.calculateBillReturn.useDefault&&this.mrpEnterEvent_CalcuteBillDefault(I),!1}mrpEnterEvent_CheckSellingRate(L){this.genericProductService.activerowIndex=L,this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&"IMPORT_PURCHASE"!=this._trnMainService.TrnMainObj.AdditionalObj.tag&&1!=this._trnMainService.TrnMainObj.ProdList[L].PTYPE&&this._trnMainService.TrnMainObj.ProdList&&this._trnMainService.TrnMainObj.ProdList.length&&0==this._trnMainService.TrnMainObj.ProdList[L].ALTUNITObj.RATE_A&&0==this._trnMainService.TrnMainObj.ProdList[L].MRP&&(this.rateValidationDisplayMessage="This Product has 0 selling rate. Please enter selling price. ",this.alertService.warning(this.rateValidationDisplayMessage),this.alertService.emitShowHideSubject.subscribe(m=>{setTimeout(()=>{null!==document.getElementById("newSellingPrice0")&&document.getElementById("newSellingPrice0").focus()},100)}),this._trnMainService.showPriceChangeDetail=!0,this._trnMainService.getAllSelingPriceOfItem(L),setTimeout(()=>{document.getElementById("newSellingPrice0").focus()},500))}mrpEnterEvent_validateRate(L,I,m){if(L.ALTRATE<1||null==L.ALTRATE||null==L.ALTRATE)return confirm(" Zero  Rate Entry Detected For Item '"+L.ITEMDESC+"'. Do You Want To Proceed Anyway ? ")?(console.log("reachq"),!1):(document.getElementById("ALTRATE"+I).focus(),console.log("reachq"),!0);this.genericProductService.focusByElementId(m)}mrpEnterEvent_preCheckValidation(L,I,m){if(this._trnMainService.TrnMainObj.VoucherType===t.Km.OpeningStockBalance)null!=document.getElementById("MRP"+L)?document.getElementById("MRP"+L).focus():0==this._trnMainService.TrnMainObj.ProdList[L].REQEXPDATE?this.mrpEnterEvent_checkValidation(L,I,m):document.getElementById("MFGDATE"+L).focus();else if(this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryChalan||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn)this.mrpEnterEvent_checkValidation(L,I,m="ITEMDESC");else if(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice&&"self-billing"==this.genericProductService.activeurlpath)this.mrpEnterEvent_checkValidation(L,I,m);else if(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice)"Non-Discountable"===this._trnMainService.TrnMainObj.ProdList[L].DISMODE?this.mrpEnterEvent_checkValidation(L,I,m):null!=document.getElementById("INDDISCOUNTRATE"+L)?document.getElementById("INDDISCOUNTRATE"+L).focus():document.getElementById("MFGDATE"+L).focus();else if(this._trnMainService.TrnMainObj.VoucherType===t.Km.RequisitionEntry)null!=document.getElementById("OrderComment"+L)&&document.getElementById("OrderComment"+L).focus();else if(this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry){if(console.log("raktab"),1==this._trnMainService.userSetting.EnableOnetoOneProduction)return!1;this.mrpEnterEvent_checkValidation(L,I,m)}else this._trnMainService.TrnMainObj.VoucherType===t.Km.PurchaseOrder&&"IMPORT_PURCHASE_ORDER"==this._trnMainService.TrnMainObj.AdditionalObj.tag||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockSettlement||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferIn||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===t.Km.Repack?this.mrpEnterEvent_checkValidation(L,I,m):this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue?(console.log("stock issue when batch selected"),this.mrpEnterEvent_checkValidation(L,I,m)):null!=document.getElementById("INDDISCOUNTRATE"+L)?document.getElementById("INDDISCOUNTRATE"+L).focus():null!=document.getElementById("remarks"+L)?document.getElementById("REMARKS"+L).focus():(console.log("foucsmfg"),document.getElementById("MFGDATE"+L)?.focus())}mrpEnterEvent_checkValidation(L,I,m){console.log("reached cehck validation");var S=this._trnMainService.TrnMainObj.ProdList[L];if(null!=S&&null==S.MCODE)return this.alertService.warning("Please select a Product"),!1;if(1==I&&0==this.mrpEnterEvent_CheckValidation_Default(L))return;let R=L;R=L+1,this.mrpEnterEvent_AddNewRow(),"default"!=m.toLocaleLowerCase()?this.genericProductService.focusByElementId(m+R):this.mrpEnterEvent_focusNextDefault(L)}mrpEnterEvent_AddNewRow(){if(this._trnMainService.TrnMainObj.VoucherType==t.Km.RequisitionApproval?this._trnMainService.CalculateApprovalBill():this._trnMainService.ReCalculateBillWithNormal(),!this._trnMainService.TrnMainObj.ProdList.some(L=>null==L.MCODE))return this._trnMainService.addRow()}mrpEnterEvent_focusNextDefault(L){let I=L+1;1==this._trnMainService.userSetting.GblBarcodeWiseBilling?(console.log("GBLbarcodewisebilling = 1 "),this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===t.Km.OpeningStockBalance?setTimeout(()=>{null!=document.getElementById("barcode"+I)?(console.log("rn1"),document.getElementById("barcode"+I).focus()):document.getElementById("itemDesc"+I).focus()},50):setTimeout(()=>{null!=document.getElementById("itemDesc"+I)&&document.getElementById("itemDesc"+I).focus()},50)):(console.log("GBLbarcodewisebilling = 0 "),setTimeout(()=>{null!=document.getElementById("itemDesc"+I)&&document.getElementById("itemDesc"+I).focus()},50))}mrpEnterEvent_CheckValidation_Default(L){var I=this._trnMainService.TrnMainObj.ProdList[L];if(I){if(this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice&&0==I.ALTERNATEQUANTIY)return this.alertService.warning(`Qty Is Not Specified For The Item ${I.ITEMDESC} (${I.MENUCODE}) Please Check Your Entry.`),!1;if(this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice&&"self-billing"!=this.genericProductService.activeurlpath&&0==this.userSetting.ENABLESINGLEBATCHMODE){var m=this.genericProductService.masterService.groupBy(this._trnMainService.TrnMainObj.ProdList,function(S){return[S.MCODE,S.RATE,S.BC,S.BATCH]});for(const S of m)if(S.length>1)return this.alertService.warning("Cannot enter same Item with same rate "),!1}if(this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry){let S=this._trnMainService.TrnMainObj.ProdList.filter(g=>1==g.REQEXPDATE&&0==this._trnMainService.nullToZeroConverter(g.EXPDATE))[0];if(null!=S&&1!=this._trnMainService.userSetting.ENABLESINGLEBATCHMODE)return this.alertService.info(`EXP date is required for item:${S.ITEMDESC}`),!1}return"superdistributor"===this._trnMainService.userProfile.CompanyInfo.ORG_TYPE&&this._trnMainService.TrnMainObj.VoucherType===t.Km.PurchaseOrder&&"IMPORT_PURCHASE_ORDER"!=this._trnMainService.TrnMainObj.AdditionalObj.tag&&null!=this._trnMainService.TrnMainObj.ProdList[L].SELECTEDITEM&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[L].Quantity)+this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[L].STOCK)>this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[L].SELECTEDITEM.MAXLEVEL)?(this.alertService.info("You can not Order more than maximum stock assign to you..."),document.getElementById("quantity"+L).focus(),!1):!((this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice)&&0==this._trnMainService.userSetting.ENABLESINGLEBATCHMODE&&this._trnMainService.TrnMainObj.ProdList[L].Quantity>this._trnMainService.TrnMainObj.ProdList[L].STOCK&&"EDIT"!==this._trnMainService.TrnMainObj.ProdList[L].rowMode?.toUpperCase()&&this._trnMainService.TrnMainObj.ProdList[L].STOCK>0&&9!=this._trnMainService.TrnMainObj.ProdList[L].PTYPE&&this._trnMainService.TrnMainObj.ProdList[L].PTYPE<10&&(this.alertService.info("Quantity Exceed the available Stock."),document.getElementById("basequantity"+L).focus(),1))}}mrpEnterEvent_CalcuteBillDefault(L){(this._trnMainService.TrnMainObj.VoucherType===t.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.Repack||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry)&&(this._trnMainService.calculateNetRATE(L),this._trnMainService.checkDeuplicateCodeAndRate(L)),this._trnMainService.ReCalculateBillWithNormal()}mrpEnterAssetPI(L,I,m){L.ALTUNIT==L.UNIT&&(L.Rate=L.ALTRATE),L.ALTRATE<this._trnMainService.TrnMainObj.MinDepValue&&(this.alertService.warning("Rate cannot be less than Minimun Depreciation Value!"),L.ALTRATE=this._trnMainService.TrnMainObj.MinDepValue),this._trnMainService.ReCalculateBillForAsset(this._trnMainService.TrnMainObj)}MRPChangeEvent(L,I,m,S){this.genericProductService.activerowIndex=m;let g=this._trnMainService.TrnMainObj.ProdList[m].PTYPE;if("goods-received-note"==this.genericProductService.activeurlpath&&"NEW"==this._trnMainService.TrnMainObj.Mode){let R=this.masterService.userProfile.roleRights.find(u=>"ALLOWRATECHANGEINPI"==u.right);0==this._trnMainService.disableRateOnGRNload&&0!=this.userSetting.PODELIVERYMODE&&1==this.userSetting.RATECHANGE_IN_POBASEPI&&1==R.value&&(this._trnMainService.TrnMainObj.ProdList[m].TEMP_ALTRATE==this._trnMainService.TrnMainObj.ProdList[m].ALTRATE||confirm("PRATE DOEN'T MATCHED WITH PURCHASE ORDER RATE. DO YOU WANT TO PROCEED ANYWAY ?")||(this._trnMainService.TrnMainObj.ProdList[m].ALTRATE=this._trnMainService.TrnMainObj.ProdList[m].TEMP_ALTRATE))}this.validateRate(S,m),this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&"IMPORT_PURCHASE"!=this._trnMainService.TrnMainObj.AdditionalObj.tag&&1===this.userSetting.HALTSPRICECHAGEDASKED&&1!=g&&S.MCODE&&((this._trnMainService.TrnMainObj.ProdList[m].showPriceChangePopup&&2==this.userSetting.EnableBatch||1==this.userSetting.EnableBatch)&&(this._trnMainService.showPriceChangeDetail=!0),console.log(this._trnMainService.priceChangeList),this._trnMainService.showPriceChangeDetailINDisc=!0,this._trnMainService.getAllSelingPriceOfItem(m),setTimeout(()=>{document.getElementById("newSellingPrice0").focus()},800)),this._trnMainService.TrnMainObj.VoucherType===t.Km.OpeningStockBalance&&this.validateCostPrice(),this._trnMainService.TrnMainObj.ProdList[m].UNIT==this._trnMainService.TrnMainObj.ProdList[m].BASEUNIT?this._trnMainService.TrnMainObj.ProdList[m].RATE=this._trnMainService.TrnMainObj.ProdList[m].ALTRATE:0!=this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[m].ALTRATE)&&(this._trnMainService.TrnMainObj.ProdList[m].RATE=this._trnMainService.TrnMainObj.ProdList[m].ALTRATE/this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[m].ALTCONFACTOR)),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote&&1==this.userSetting.ENABLEMANUALSALESRETURN&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].SELLRATEBEFORETAX=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].RATE,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MRP=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].RATE*this._trnMainService.nullToZeroConverter(this.userSetting.VatConRate)),this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder&&this._trnMainService.TrnMainObj.REFORDBILL&&this.checkRateisChangedinSoFromQT()}validateRate(L,I){if(L.ALTRATE<1||null==L.ALTRATE||null==L.ALTRATE)return!confirm(" Zero  Rate Entry Detected For Item '"+L.ITEMDESC+"'. Do You Want To Proceed Anyway ? ")&&(document.getElementById("ALTRATE"+I).focus(),!0);if(this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder){let m=this.getSellingRate();this.validateSellingPriceBelowLandingCost(m,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].PRATE,this.genericProductService.activerowIndex)}}getSellingRate(){let L=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].RATE;return 1==this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ISVAT&&this._trnMainService.TrnMainObj.VoucherType==t.Km.SalesOrder&&(L=1==this.userSetting.ENABLE_VTEXCLUDINGRATE_INSORDER?this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ALTRATE:this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ALTRATE/this.userSetting.VatConRate),L}validateSellingPriceBelowLandingCost(L,I,m){if(L<I)return this.alertService.warning("Entered rate is less than purchase rate !"),this.alertService.emitShowHideSubject.subscribe(S=>{setTimeout(()=>{null!==document.getElementById("INDDISCOUNTRATE"+m)?document.getElementById("INDDISCOUNTRATE"+m).focus():document.getElementById("REMARKS"+m).focus()},0)}),!1}validateCostPrice(){this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ALTRATE>this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].SELLRATEBEFORETAX&&this.alertService.info("Cost Price is grater than selling price")}checkRateisChangedinSoFromQT(){this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ALTRATE!==this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].PORATE&&(confirm("Rate is change Do you want to proceed .")||(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ALTRATE=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].PORATE))}calculateFCRATEChangeEvent(L){this._trnMainService.TrnMainObj.ProdList[L]&&(this._trnMainService.TrnMainObj.ProdList[L].ALTRATE=this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[L].INVRATE)*this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.EXRATE),this._trnMainService.TrnMainObj.ProdList[L].REALRATE=this._trnMainService.TrnMainObj.ProdList[L].ALTRATE/this._trnMainService.TrnMainObj.ProdList[L].ALTCONFACTOR,this._trnMainService.TrnMainObj.ProdList[L].RATE=this._trnMainService.TrnMainObj.ProdList[L].ALTRATE/this._trnMainService.TrnMainObj.ProdList[L].ALTCONFACTOR,this._trnMainService.ReCalculateBillWithNormal())}AlternateUnitEnterEventClick(L,I,m,S){console.log("event",L,m,I,S),S.preventDefault(),null!=this._trnMainService.TrnMainObj.ProdList[I].ALTUNIT&&""!=this._trnMainService.TrnMainObj.ProdList[I].ALTUNIT&&void 0!==this._trnMainService.TrnMainObj.ProdList[I].ALTUNIT&&(console.log("focusnext"),document.getElementById("ALTERNATEQUANTIY"+I).focus(),this._trnMainService.TrnMainObj.VoucherType==t.Km.RequisitionApproval&&document.getElementById("approvedQty"+I).focus(),this._trnMainService.TrnMainObj.VoucherType==t.Km.Stockadjustment&&document.getElementById("physicalStock"+I).focus()),this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice&&1==this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].NATURETYPE&&1===this.userSetting.GblBarcodeWiseBilling&&null!=this._trnMainService.TrnMainObj.ProdList[I].BC&&""!=this._trnMainService.TrnMainObj.ProdList[I].BC&&void 0!==this._trnMainService.TrnMainObj.ProdList[I].BC&&document.getElementById("RATE"+I).focus(),74==this._trnMainService.TrnMainObj.VoucherType&&null!=this._trnMainService.TrnMainObj.ProdList[I].ALTUNIT&&""!=this._trnMainService.TrnMainObj.ProdList[I].ALTUNIT&&null!=this._trnMainService.TrnMainObj.ProdList[I].ALTUNIT&&document.getElementById("ALTERNATEQUANTIY"+I).focus(),this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.REFORDBILL&&document.getElementById("ALTERNATEQUANTIY"+I).focus()}RemarksEnterCommand(L,I,m,S){if(S.preventDefault(),"asset-purchase-invoice"!=this._trnMainService.activeurlpath){if(this.genericProductService.showBatchWiseDetail=!1,this.genericProductService.checkValidation(I)||this.masterService.focusAnyControl("REMARKS"+I),this._trnMainService.TrnMainObj.VoucherType==t.Km.RequisitionApproval){let g=I+1;setTimeout(()=>{null!=document.getElementById("ALTUNIT"+g)&&document.getElementById("ALTUNIT"+g).focus()},50)}return!1}setTimeout(()=>{null!=document.getElementById("ACNAME"+this.genericProductService.activerowIndex)&&document.getElementById("ACNAME"+this.genericProductService.activerowIndex).focus()})}}return F.\u0275fac=function(L){return new(L||F)(e.LFG(s.c),e.LFG(h.w),e.LFG(V.P))},F.\u0275prov=e.Yz7({token:F,factory:F.\u0275fac}),F})()},56209:(z,Z,M)=>{M.d(Z,{u:()=>x});var t=M(92752),e=M(7587),s=M(71800),h=M(39773),V=M(31644),p=M(37469),F=M(48760),Q=M(63321),L=M(29546),I=M(65063),m=M(59629),S=M(89953),g=M(11192),R=M(94534),u=M(68328),a=M(92849),E=M(97784),y=M(33612),P=M(66274);let x=(()=>{class O{static forRoot(){return{ngModule:O,providers:[]}}}return O.\u0275fac=function(D){return new(D||O)},O.\u0275mod=P.oAB({type:O}),O.\u0275inj=P.cJS({providers:[R.w,g.C,u.X,y.i],imports:[a.S,Q._,p.X,V.v,I.f,L.l,F.L,E.m,t.ez,e.u5,e.UX,S.m,m.Z,h.X.forRoot(),s.zk.forRoot()]}),O})()},60716:(z,Z,M)=>{M.d(Z,{Vn:()=>e});var t=M(42326);class e{constructor(L){this.barcodeDisplay=!1,this.checkRefOrderBill=!1,this.gridPopUpApiForReturn="",this.multiCurrency=!1,this.showSubHeading=!1,this._trnMainService=L,this.userSetting=L.userSetting,this.itemPopupUrlSetting=new p}setItemPopupUrlDefaults(){this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder&&(this.itemPopupUrlSetting.showStock=!0),this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssueReturn&&(this.itemPopupUrlSetting.showStockIssueQty=!1),this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&1==this.userSetting.REFBILLCOMPULSORINDNOTE&&(this.itemPopupUrlSetting.showPQty=!1,this.itemPopupUrlSetting.showNetRate=!1),(this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesReturn||this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote)&&(this.itemPopupUrlSetting.showRate=!1,this.itemPopupUrlSetting.stockTitle="SALES QTY",this.itemPopupUrlSetting.showInCreditNote=!1),this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&(0!=this.userSetting.PODELIVERYMODE||0!=this.userSetting.IMPORTPOBILLMODE)&&(this.itemPopupUrlSetting.showPOStock=!1,this.itemPopupUrlSetting.grpName=!0),this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived&&0!=this.userSetting.PODELIVERYMODE&&(this.itemPopupUrlSetting.showPOStock=!1),this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder&&this._trnMainService.TrnMainObj.REFORDBILL&&(this.itemPopupUrlSetting.showQTStock=!1),(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice)&&(this._trnMainService.TrnMainObj.REFORDBILL?(this.itemPopupUrlSetting.showMRP=!0,this.itemPopupUrlSetting.showSOStock=!1,this.itemPopupUrlSetting.grpName=!0):(this.itemPopupUrlSetting.showMRP=!1,this.itemPopupUrlSetting.showSOStock=!0,this.itemPopupUrlSetting.grpName=!0)),this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut&&this._trnMainService.TrnMainObj.REFORDBILL&&(this.itemPopupUrlSetting.showRequesitionQty=!1)}}class p{constructor(){this.showStockIssueQty=!0,this.showNetRate=!0,this.showRate=!0,this.stockTitle="STOCK",this.showPOStock=!0,this.showQTStock=!0,this.showSOStock=!0,this.grpName=!1,this.showInCreditNote=!0,this.showRequesitionQty=!0,this.showMRP=!0,this.showStock=!1,this.showPQty=!0}}},68328:(z,Z,M)=>{M.d(Z,{K:()=>m,X:()=>I});var t=M(42326),e=M(27009),s=M(66274),h=M(94534),V=M(48083),p=M(53181),F=M(60694),Q=M(67311),L=M(53074);let I=(()=>{class S{constructor(R,u,a,E,y,P){this.genericProductEntryService=R,this.arouter=u,this.dialog=a,this.responseMsgService=E,this.alertService=y,this.masterService=P,this._trnMainService=R._trnMainService,this.masterService=R.masterService,this.userSetting=this._trnMainService.userSetting,this.activeurlpath=u.snapshot.url[0]?.path}ItemkeyEvent(R,u,a=new Function,E=new Function,y=new Function,P=new Function,x=new Function){if(u.preventDefault(),this._trnMainService=this.genericProductEntryService._trnMainService,this.genericProductEntryService.activerowIndex=R,this.checkCustomerSelected()){if(a()==m.default&&this.get_showStockedQuantityOnly(),E(this.genericProductEntryService.showStockedQuantityOnly)==m.default&&this.setItemPopupUrl(),"VIEW"==this._trnMainService?.TrnMainObj?.Mode?.toUpperCase())return void this.displayProductDetailInViewMode(u);var O=y();if(O==m.default){if(1==this.checkSelfBilling())return}else if(O==m.returnFunction)return;this._trnMainService.currentIndexProductDetails=[];var j=P();if(j!=m.returnFunction&&(j!=m.default||1!=this.itemKeyEvent_CheckFlatDiscount())){var D=x();if(console.log("call back check",D),D!=m.default&&null!=D||this.itemKeyEvent_CheckRefBill())return this._trnMainService.itemselectevent=!0,this.showGenericGrid(),!1}}}checkCustomerSelected(){return"performa-invoice"!=this.genericProductEntryService.activeurlpath&&"delivery-chalan"!=this.genericProductEntryService.activeurlpath||null!=this._trnMainService.TrnMainObj.BILLTO||(this.alertService.warning("Please select customer first"),this.alertService.emitShowHideSubject.subscribe(R=>{this.masterService.ShowMore=!0,setTimeout(()=>{document.getElementById("customerselectid").focus()},100)}),!1)}setItemPopupUrl(){console.log("set item popup urlrp",this.userSetting.DefaultFilterIndex);let R=!0,u=!0,a=!0,E=!0,y="STOCK",P=!0,x=!0,O=!0,j=!1,D=!0,U=!0,W=!0,$=!1,N=!1,k=!1,b=!0,w=!0,c=!1,_=!0;"requisition-log"==this._trnMainService.activeurlpath&&(c=!0),1===this.userSetting.OneToOneBarcodeMode&&[t.Km.GoodsReceived,t.Km.Purchase,t.Km.DebitNote,t.Km.OpeningStockBalance,t.Km.PurchaseOrder,t.Km.SalesOrder,t.Km.Quotation,t.Km.CreditNote,t.Km.StockSettlement,t.Km.Sales,t.Km.PerformaSalesInvoice,t.Km.TaxInvoice,t.Km.StockIssue,t.Km.RequisitionEntry,t.Km.BranchTransferOut].indexOf(this._trnMainService.TrnMainObj.VoucherType)>=0&&(b=!1,w=!1),this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssueReturn&&(u=!1),this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&1==this.userSetting.REFBILLCOMPULSORINDNOTE&&(R=!1,a=!1),(this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesReturn||this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote)&&(E=!1,y="SALES QTY",D=!1),this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn&&(y="ISSUED QTY",j=!0),this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&(0!=this.userSetting.PODELIVERYMODE||0!=this.userSetting.IMPORTPOBILLMODE)&&(P=!1,j=!0),this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived&&(0!=this.userSetting.PODELIVERYMODE||0!=this.userSetting.IMPORTPOBILLMODE)&&(P=!1),this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder&&this._trnMainService.TrnMainObj.REFORDBILL&&(x=!1),(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice)&&(this._trnMainService.TrnMainObj.REFORDBILL?(W=!0,O=!1,j=!0):(W=!1,O=!0,j=!0)),this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived&&(W=!1),this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&2==this.userSetting.EnableBatch&&(_=!1),this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut&&this._trnMainService.TrnMainObj.REFORDBILL&&(U=!1),(this._trnMainService.TrnMainObj.VoucherType===t.Km.PurchaseOrder||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&0===this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE)&&(N=!0),this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&(k=!1),this._trnMainService.TrnMainObj.VoucherType===t.Km.RequisitionEntry&&($=!0),this.genericProductEntryService.gridPopupSettings={title:"PRODUCTS",apiEndpoints:`/getMenuitemWithStockPagedList/${this.genericProductEntryService.showStockedQuantityOnly}/all/NO/${this._trnMainService.userProfile.userWarehouse}`,defaultFilterIndex:this.userSetting.DefaultFilterIndex?this.userSetting.DefaultFilterIndex:0,filterSupplierWise:N,showLoadAllProductsOption:k,multiSelect:c,columns:[{key:"MENUCODE",title:"ITEM CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"DESCRIPTION",hidden:!1,noSearch:!1},{key:"GroupName",title:"GROUP NAME",hidden:j,noSearch:!0},{key:"BATCH",title:"BATCH",hidden:_,noSearch:!0},{key:"PSTOCK",title:"P-QTY",hidden:R,noSearch:!0},{key:"ISSUEQTY",title:"ISSUE QTY",hidden:u,noSearch:!0},{key:"CRATE",title:"NETRATE",hidden:a,noSearch:!0},{key:"RATE",title:"S-RATE",hidden:E,noSearch:!0},{key:this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn?"ALTUNIT":"BASEUNIT",title:"UNIT",hidden:this._trnMainService.TrnMainObj.VoucherType!==t.Km.DeliveryReturn&&W,noSearch:!0},{key:this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn?"ALTSTOCK":"STOCK",title:y,hidden:$,noSearch:!0,alignment:"right"},{key:"REALQTY_IN",title:"Req.Order Qty",hidden:U,noSearch:!0},{key:"REALQTY",title:"Sales-Qty",hidden:D,noSearch:!0},{key:"POSTOCK",title:"PO QTY",hidden:P,noSearch:!0,alignment:"right"},{key:"POSTOCK",title:"QT QTY",hidden:x,noSearch:!0,alignment:"right"},{key:"OPSTOCK",title:"SO QTY",hidden:O,noSearch:!0,alignment:"right"},{key:"RATE",title:"PORATE",hidden:P,noSearch:!0,alignment:"right",pipe:!0},{key:"RATE",title:"SO RATE",hidden:O,noSearch:!0,alignment:"right",pipe:!0},{key:"BCODE",title:"BARCODE",hidden:b,noSearch:w},{key:"MRP",title:"MRP",hidden:W,noSearch:!0,alignment:"right",pipe:!0}]}}itemKeyEvent_CheckFlatDiscount(){if(this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&(this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT)>0||this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.DCRATE)>0))return this.alertService.info("Flat Discount is already given could not add new product"),!0}displayProductDetailInViewMode(R){console.log("eventlog",R),"VIEW"==this._trnMainService.TrnMainObj.Mode.toUpperCase()&&"F9"==R.code&&this.dialougeOpen()}get_showStockedQuantityOnly(){return this.genericProductEntryService.showStockedQuantityOnly=0,this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder||this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===t.Km.Repack||this._trnMainService.TrnMainObj.VoucherType===t.Km.Quotation?(this.genericProductEntryService.showStockedQuantityOnly=1,this.genericProductEntryService.loadBarCodeWiseProduct=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BARCODE??""):this.genericProductEntryService.showStockedQuantityOnly=0,this.genericProductEntryService.showStockedQuantityOnly}itemKeyEvent_CheckRefBill(){if(console.log("khai ?????"),this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder||this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===t.Km.Repack||this._trnMainService.TrnMainObj.VoucherType===t.Km.Quotation?(this.genericProductEntryService.showStockedQuantityOnly=1,this.genericProductEntryService.loadBarCodeWiseProduct=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BARCODE??""):this.genericProductEntryService.showStockedQuantityOnly=0,console.log("eter clicked",this._trnMainService.TrnMainObj.VoucherType,this.userSetting.PODELIVERYMODE,this.genericProductEntryService.activeurlpath,this.userSetting.DisablePOReferenceRequired),this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote&&1!==this._trnMainService.TrnMainObj.DONONSALEABLERETURN&&0==this.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&1===this.userSetting.REFBILLCOMPULSORINDNOTE||this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&0!==this.userSetting.PODELIVERYMODE&&"purchase-import"!==this.genericProductEntryService.activeurlpath&&0==this.userSetting.DisablePOReferenceRequired||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived&&0!==this.userSetting.PODELIVERYMODE&&0==this.userSetting.DisablePOReferenceRequired||this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder&&this._trnMainService.TrnMainObj.REFORDBILL&&0!==this.userSetting.ENABLE_QUOTATTION_INSO||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice&&0!==this.userSetting.ENABLE_SOINTI&&1==this.userSetting.SOREFERENCE_REQUIRED||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut&&1===this._trnMainService.TrnMainObj.ISLOADFROMORDER||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue&&1===this._trnMainService.TrnMainObj.ISLOADFROMORDER||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn&&0===this._trnMainService.TrnMainObj.DOFULLRETURN){if(console.log("eta ?"),this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder&&0!=this.userSetting.ENABLE_QUOTATTION_INSO||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice&&0!=this.userSetting.ENABLE_SOINTI||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut&&1===this._trnMainService.TrnMainObj.ISLOADFROMORDER||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue&&1===this._trnMainService.TrnMainObj.ISLOADFROMORDER){if(!this._trnMainService.TrnMainObj.REFORDBILL){let R=this.responseMsgService.getProperMessageForRefBill(this._trnMainService.TrnMainObj);return this.alertService.info(R),!1}}else if(null==this._trnMainService.TrnMainObj.REFBILL||""==this._trnMainService.TrnMainObj.REFBILL)return this.alertService.info("Please Load the ref bill for return"),!1;this.genericProductEntryService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList"}else if(this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssueReturn){if(!this._trnMainService.TrnMainObj.REFORDBILL)return this.alertService.info(this.responseMsgService.getProperMessageForRefBill(this._trnMainService.TrnMainObj)),!1;this.genericProductEntryService.gridPopupSettings.apiEndpoints=`/getMenuitemFromProdForIssueReturnPagedList/${this._trnMainService.TrnMainObj.BILLTO}`}else if(this._trnMainService.TrnMainObj.VoucherType==t.Km.Purchase&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag&&0!=this.userSetting.IMPORTPOBILLMODE){if(!this._trnMainService.TrnMainObj.REFORDBILL)return this.alertService.warning("Please Load the Import PO Ref bill for return"),!1;this.genericProductEntryService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList"}else if(this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&0!==this.userSetting.PODELIVERYMODE&&"IMPORT_PURCHASE"!==this._trnMainService.TrnMainObj.AdditionalObj.tag&&1==this.userSetting.DisablePOReferenceRequired&&null!=this._trnMainService.TrnMainObj.REFORDBILL)this.genericProductEntryService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList";else if(this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived&&0!==this.userSetting.PODELIVERYMODE&&0!=this.userSetting.ENABLE_GRN_IN_PI&&1==this.userSetting.DisablePOReferenceRequired&&null!=this._trnMainService.TrnMainObj.REFORDBILL)this.genericProductEntryService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList";else if(this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived&&0!=this.userSetting.ENABLE_GRN_IN_IMPORTPI&&null!=this._trnMainService.TrnMainObj.REFORDBILL)this.genericProductEntryService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList";else if(0!==this.userSetting.ENABLE_SOINTI&&null!=this._trnMainService.TrnMainObj.REFORDBILL&&(0==this.userSetting.SOREFERENCE_REQUIRED&&this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||0!==this.userSetting.ENABLE_SOINABB&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales||0!==this.userSetting.ENABLE_SOINDCHALAN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryChalan||0!==this.userSetting.PERFOMASOBILLMODE&&this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice))this.genericProductEntryService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList";else{let u,R="";"self-billing"===this.genericProductEntryService.activeurlpath?R="SB":null!=this._trnMainService.TrnMainObj.VoucherPrefix&&(R=this._trnMainService.TrnMainObj.VoucherPrefix);let a="";if(a=this._trnMainService.TrnMainObj.MWAREHOUSE?this._trnMainService.TrnMainObj.MWAREHOUSE:this._trnMainService.userProfile.userWarehouse,this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue&&(a=this._trnMainService.TrnMainObj.BILLTO,null==this._trnMainService.TrnMainObj.BILLTO))return void this.alertService.info("Please select From Warehouse before selecting an item ");if(this._trnMainService.TrnMainObj.VoucherType===t.Km.RequisitionEntry&&(null==this._trnMainService.TrnMainObj.MWAREHOUSE||""==this._trnMainService.TrnMainObj.MWAREHOUSE))return void this.alertService.info("Please select Warehouse before selecting item");if(u=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BC,(0==this.userSetting.GblBarcodeWiseBilling||null==u||void 0===u||""==u)&&(u="A"),this._trnMainService.TrnMainObj.VoucherType==t.Km.ProductionEntry){if(!this._trnMainService.TrnMainObj.BILLTO)return void this.alertService.info("Please select Production warehouse");a=this._trnMainService.TrnMainObj.BILLTO}this.genericProductEntryService.gridPopupSettings.apiEndpoints=`/getMenuitemWithStockPagedList/${this.genericProductEntryService.showStockedQuantityOnly}/${u}/all/${R}/${a}`,"EDIT"==this._trnMainService.TrnMainObj.Mode?.toUpperCase()&&this._trnMainService.TrnMainObj.VoucherType==t.Km.ProductionEntry&&(this.genericProductEntryService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList")}if(this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote&&"NewBill"===this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE){let R="";null!=this._trnMainService.TrnMainObj.VoucherPrefix&&(R=this._trnMainService.TrnMainObj.VoucherPrefix),this.genericProductEntryService.gridPopupSettings.apiEndpoints=`/getMenuitemWithStockPagedList/${this.genericProductEntryService.showStockedQuantityOnly}/all/PI/${this._trnMainService.userProfile.userWarehouse}`}if("add-membership-sales-invoice"==this.genericProductEntryService.activeurlpath&&(this.genericProductEntryService.gridPopupSettings.apiEndpoints="/getMenuItemListForMembershipSales"),this._trnMainService.TrnMainObj.VoucherType==t.Km.Purchase&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag||this._trnMainService.TrnMainObj.VoucherType==t.Km.PurchaseOrder&&"IMPORT_PURCHASE_ORDER"==this._trnMainService.TrnMainObj.AdditionalObj.tag||this._trnMainService.TrnMainObj.VoucherType==t.Km.GoodsReceived&&"GOODS_RECEIVED_NOTE_IMPORT"==this._trnMainService.TrnMainObj.AdditionalObj.tag){if(null==this._trnMainService.TrnMainObj.BILLTO||void 0===this._trnMainService.TrnMainObj.BILLTO||""==this._trnMainService.TrnMainObj.BILLTO)return void this.alertService.info("Please Choose Supplier to Proceed...");if(!this._trnMainService.TrnMainObj.EXRATE)return void this.alertService.info("Please choose exchange rate to proceed or exchange rate cannot be zero...")}return this.genericProductEntryService.genericGrid.show(this._trnMainService.TrnMainObj.VoucherType==t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==t.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType==t.Km.StockIssueReturn||this._trnMainService.TrnMainObj.VoucherType==t.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==t.Km.SalesOrder||"FROMPO"==this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE||"FROMSO"==this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE||"FROMIMPORTPO"==this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE?this._trnMainService.TrnMainObj.REFORDBILL:this._trnMainService.TrnMainObj.REFBILL),!1}dialougeOpen(){console.log("dialouge open ProductDetails",this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ProductDetails),this._trnMainService.currentIndexProductDetails=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ProductDetails,this.dialog.open(e.H,{hasBackdrop:!0,autoFocus:!1,data:{type:this._trnMainService.TrnMainObj.VoucherPrefix,mode:this._trnMainService.TrnMainObj.Mode,warehouse:this._trnMainService.TrnMainObj.MWAREHOUSE,message:this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex],curretnIndexPrevDetials:this._trnMainService.currentIndexProductDetails,productList:this._trnMainService.TrnMainObj.ProdList}}).afterClosed().subscribe(a=>{this.productLists=this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote?a?.data:a&&a.data&&a.data.productColorList?a.data.productColorList:[],this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ProductDetails=this.productLists,this._trnMainService.currentIndexProductDetails=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ProductDetails,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=this.productLists?this.productLists.length:0,(this._trnMainService.TrnMainObj.VoucherType==t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived)&&this._trnMainService.calculateNetRATE(this.genericProductEntryService.activerowIndex),setTimeout(()=>{if(0==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY){if(this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice)return void this.alertService.warning(`Zero Quantity Detected for Item ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].MENUCODE}). Please Check Your Entry.`)}else document.getElementById("RATE"+this.genericProductEntryService.activerowIndex).focus()},20)})}showGenericGrid(){"requisition-log"==this._trnMainService.activeurlpath&&(this.genericProductEntryService.gridPopupSettings.multiSelect=!0),this.genericProductEntryService.genericGrid.show(this._trnMainService.TrnMainObj.VoucherType==t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==t.Km.StockIssueReturn||this._trnMainService.TrnMainObj.VoucherType==t.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==t.Km.SalesOrder||"FROMPO"==this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE||"FROMSO"==this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE||"FROMIMPORTPO"==this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE?this._trnMainService.TrnMainObj.REFORDBILL:this._trnMainService.TrnMainObj.REFBILL)}checkSelfBilling(){if("self-billing"===this.genericProductEntryService.activeurlpath){if(""==this._trnMainService.TrnMainObj.MWAREHOUSE)return this.alertService.warning("Please select an unsalable warehouse!"),this.alertService.emitShowHideSubject.subscribe(R=>{this.masterService.ShowMore=!0,setTimeout(()=>{document.getElementById("warehouseId").focus()},100)}),!0;if(""==this._trnMainService.TrnMainObj.TRNACName||null==this._trnMainService.TrnMainObj.TRNACName)return this.alertService.warning("Please select an Account Name!"),!0;if(""==this._trnMainService.TrnMainObj.TRNACName||null==this._trnMainService.TrnMainObj.TRNACName)return this.alertService.warning("Please select an Account Before self billing!"),!0;if(""==this._trnMainService.TrnMainObj.REMARKS||null==this._trnMainService.TrnMainObj.REMARKS)return this.alertService.warning("Remarks is mandatory!"),this.alertService.emitShowHideSubject.subscribe(R=>{this.masterService.ShowMore=!0,setTimeout(()=>{document.getElementById("remarksid").focus()},100)}),!0;console.log("Check Tna",this._trnMainService.TrnMainObj.TRNACName,this._trnMainService.TrnMainObj.REMARKS),this.genericProductEntryService.showStockedQuantityOnly=0}return!1}ItemKeyEventForAsset(R,u=new Function){u(),this.genericProductEntryService.activerowIndex=R,this.genericProductEntryService.genericGrid.show()}ItemkeyEventForConsumptionEntry(R,u,a=new Function,E=new Function,y=new Function,P=new Function,x=new Function,O){if(u.preventDefault(),this._trnMainService=O,this.genericProductEntryService.activerowIndex=R,this.checkCustomerSelected()){if(a()==m.default&&this.get_showStockedQuantityOnly(),E(this.genericProductEntryService.showStockedQuantityOnly)==m.default&&this.setItemPopupUrl(),"VIEW"==this._trnMainService?.TrnMainObj?.Mode?.toUpperCase())return void this.displayProductDetailInViewMode(u);var j=y();if(j==m.default){if(1==this.checkSelfBilling())return}else if(j==m.returnFunction)return;this._trnMainService.currentIndexProductDetails=[];var D=P();if(D!=m.returnFunction&&(D!=m.default||1!=this.itemKeyEvent_CheckFlatDiscount())){var U=x();if(U!=m.default&&null!=U||this.itemKeyEvent_CheckRefBill())return this._trnMainService.itemselectevent=!0,this.showGenericGrid(),!1}}}}return S.\u0275fac=function(R){return new(R||S)(s.LFG(h.w),s.LFG(V.gz),s.LFG(p.uw),s.LFG(F.T),s.LFG(Q.c),s.LFG(L.P))},S.\u0275prov=s.Yz7({token:S,factory:S.\u0275fac}),S})();var m=(()=>{return(S=m||(m={}))[S.default=0]="default",S[S.done=1]="done",S[S.returnFunction=2]="returnFunction",m;var S})()},91772:(z,Z,M)=>{M.d(Z,{s:()=>g});var t=M(42326),e=M(71732),h=M(27009),V=M(23815),F=M(66274),Q=M(94534),L=M(67311),I=M(53181),m=M(48083),S=M(33612);let g=(()=>{class R{constructor(a,E,y,P,x){this.genericProductEntryService=a,this.alertService=E,this.dialog=y,this.arouter=P,this.focusService=x,this._trnMainService=a._trnMainService,this.masterService=a.masterService,this.userSetting=this.genericProductEntryService.userSetting,this.activerowIndex=a.activerowIndex,this.activeurlpath=this.genericProductEntryService.activeurlpath}QuantityChangeEvent(a){let E=this._trnMainService.TrnMainObj.VoucherType;if("asset-purchase-invoice"===this._trnMainService.activeurlpath||"assets-openingstockentry"===this._trnMainService.activeurlpath)return void this._trnMainService.ReCalculateBillForAsset(this._trnMainService.TrnMainObj);if(this.checkBCForMatrxiItem(),this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry){let O=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK;if((1==this.userSetting.EnableBomBaseConsumption||2==this.userSetting.EnableBomBaseConsumption)&&(O=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].TOTALSTOCK),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY>O)return this.alertService.warning("Entered quantity is greater than stock quantity!!"),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0,void(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].AMOUNT=0)}if(this._trnMainService.TrnMainObj.VoucherType==t.Km.BatchAdjustment&&this._trnMainService.calculateBatchAdjustmentVariance(),"EDIT"===this._trnMainService.TrnMainObj.Mode?.toUpperCase()){if(!this._trnMainService.allowMinusStockInEditMode(this.genericProductEntryService.activerowIndex)){let O=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];if(E in t.SL){if(console.log("loghere"),(y=this.ValidateQuantityinEDITMode())&&!y.status)return this._trnMainService.quantityExceedCheck="QuantityExceed",this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=y.userEnterQty,void this.alertService.info(y.message);this._trnMainService.quantityExceedCheck=""}if(E in t.fr&&1==this.userSetting.EnableBatchWisePrice&&2!=this.userSetting.EnableBatch){if("EDIT"===this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].rowMode?.toUpperCase())if(!0!==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PriceSelected)this.checkBatchWiseRateinEditMode();else{var y;if((y=this.ValidateQtyEDITModeForOUt())&&!y.status)return this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=y.userEnterQty,void this.alertService.info(y.message)}else if((y=this.ValidateQtyEDITModeForOUt())&&!y.status)return this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=y.userEnterQty,void this.alertService.info(y.message);let j=this.checkItemStockINEditModeForOutQty();if(j&&!j.status)return void this.alertService.info(j.message)}if(this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry){if(console.log("active",O),!this.checkBatchWiseEnterStock())return void this.alertService.warning("Entered quantity is greater than stock quantity!!");if("EDIT"===O?.RowMode?.toUpperCase()&&O&&!this.ValidateQtyINEditModeFroProduction(O))return}}if((this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue)&&2==this.userSetting.EnableBatch){let O=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].EDITABLEQTY,j=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY,D=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BILLEDQTY,U=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT;0==O?j>D&&(this.alertService.info(`Item: '${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC}' entered quantity: ${j} ${U} is more than editable quantity: ${D} ${U}`),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0):j>D+O&&(this.alertService.info(`Item: '${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC}' entered quantity: ${j} ${U} is more than editable quantity: ${D+O} ${U}`),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0)}}if((this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&0==this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue)&&!this.checkBatchSelectionInMultiplePrice())return this.alertService.info(`Item ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} has multiple batch price. Please select batch price first to proceed.`),void(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0);if((this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase)&&0!==this.userSetting.PODELIVERYMODE&&0==this.userSetting.AllowQtyExceedInPo&&("FROMPO"==this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE||this._trnMainService.TrnMainObj.REFORDBILL&&this._trnMainService.TrnMainObj.REFORDBILL.startsWith("PO"))&&this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY>this._trnMainService.TrnMainObj.ProdList[a].POSTOCK)return this.alertService.info(`Item ${this._trnMainService.TrnMainObj.ProdList[a].ITEMDESC} cannot have quantity more than PO Quantity.`),void(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=this._trnMainService.TrnMainObj.ProdList[a].POSTOCK);if(this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales&&"add-membership-sales-invoice"===this.genericProductEntryService.activeurlpath&&this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY>1&&(this.alertService.info(`Item ${this._trnMainService.TrnMainObj.ProdList[a].ITEMDESC} cannot have quantity more than one for membership sales invoice`),this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY=1,this.alertService.emitShowHideSubject.subscribe(O=>{setTimeout(()=>{null!==document.getElementById("rate"+a)&&document.getElementById("rate"+a).focus()},100)})),this._trnMainService.calculateNetRATE(a),this._trnMainService.ReCalculateBillWithNormal(),"EDIT"===this._trnMainService.TrnMainObj.Mode?.toUpperCase()&&this._trnMainService.TrnMainObj.VoucherType==t.Km.ProductionEntry&&this.genericProductEntryService.onChangeProductionItem.emit(),(this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived&&"goods-received-note-import"==this._trnMainService.activeurlpath&&1==this.userSetting.ENABLE_GRN_IN_IMPORTPI||this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&"purchase-import"==this._trnMainService.activeurlpath)&&2==this.userSetting.IMPORTPOBILLMODE&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&(!this._trnMainService.validatePOQtyInImportGRN(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].POSTOCK,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].Quantity,this.genericProductEntryService.activerowIndex,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC)||!this._trnMainService.validatedDuplicateInImportGRN(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].MCODE,this.genericProductEntryService.activerowIndex))||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&1==this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE&&!this._trnMainService.validatePurchaseQtyInDebitNote(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PSTOCK,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].Quantity,this.genericProductEntryService.activerowIndex,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC))return;if(this._trnMainService.TrnMainObj.VoucherType==t.Km.StockIssueReturn){let O=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];if(!this._trnMainService.validateIssueQtyInStockIssueReturn(O.PSTOCK,O.ALTERNATEQUANTIY,this.genericProductEntryService.activerowIndex))return this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0,void(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].Quantity=0)}if(console.log("activerowinsert",this.genericProductEntryService.activerowIndex),this._trnMainService.allowNegativeBilling(this.genericProductEntryService.activerowIndex)?console.log("check user irghrs here"):this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PTYPE<10&&(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryChalan||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===t.Km.BatchAdjustment||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssueReturn||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue&&"NEW"===this._trnMainService.TrnMainObj?.Mode?.toUpperCase()||this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice&&1===this._trnMainService.userSetting.INVBASEPROFORMA||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut&&7!=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].NATURETYPE&&9!==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PTYPE)&&(console.log("check entered product stock"),this.checkEnteredProductStock()),(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryChalan||(this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssueReturn)&&0==this._trnMainService.TrnMainObj.DOFULLRETURN)&&this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PTYPE<10&&0==this._trnMainService.userSetting.ENABLESINGLEBATCHMODE&&this.checkDuplicateproductEnterQuantity(),this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder&&1==this._trnMainService.userSetting.CheckSaleableQtyInSO&&0!=this.userSetting.EnableStockCheckInSO&&this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PTYPE<10&&7!=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].NATURETYPE&&(console.log("selabel soprodlist",this._trnMainService.TrnMainObj.ProdList),this.checkSaleableQuantityInSalesOrder()),this._trnMainService.TrnMainObj.REFORDBILL&&this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder&&(this.checkQuantityInSOLoadFromQT(),this.checkQuantityInSOLoadFromQTin()),this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn&&"EDIT"===this._trnMainService.TrnMainObj.Mode&&this._trnMainService.TrnMainObj.REFBILL&&this.checkStockInDREdit(a),((this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived)&&(0!==this._trnMainService.userSetting.PODELIVERYMODE||0!==this._trnMainService.userSetting.IMPORTPOBILLMODE)||0!==this.userSetting.ENABLE_SOINTI&&(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||0!==this.userSetting.ENABLE_SOINABB&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales||0!==this.userSetting.ENABLE_SOINDCHALAN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryChalan||0!==this.userSetting.PERFOMASOBILLMODE&&this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice))&&this._trnMainService.TrnMainObj.ProdList[a].Quantity<this._trnMainService.TrnMainObj.ProdList[a].POSTOCK){let O="Quantity is less than PO Stock!! Are you sure you want to proceed further";if((this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived)&&1===this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL&&1===this._trnMainService.userSetting.AllowQtyExceedInPo&&(O="Quantity is less than PO Stock!!! PO Stock placed as Quantity.",this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY=this._trnMainService.TrnMainObj.ProdList[a].POSTOCK),(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice)&&(O="Quantity is less than SO Stock!! Are you sure you want to proceed further"),!confirm(O))return this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY=0,document.getElementById("alternateqty"+a).focus(),void this._trnMainService.ReCalculateBillWithNormal()}this._trnMainService.TrnMainObj.VoucherType===t.Km.Repack&&(this._trnMainService.allowNegativeBilling(this.genericProductEntryService.activerowIndex)||(this.checkRepackStock(),this.checkChildproductEnterQuantity(),this.checkSameproductEnterQuantity())),this._trnMainService.TrnMainObj.VoucherType===t.Km.OpeningStockBalance&&"EDIT"===this._trnMainService.TrnMainObj.Mode?.toUpperCase()&&this.checkQuantityInEditMode(),this._trnMainService.allowNegativeBilling(this.genericProductEntryService.activerowIndex)||(this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssueReturn)&&9!==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PTYPE&&this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PTYPE<10&&this.checkBatchWiseStockOut(),this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice&&this._trnMainService.getItemRelatedDiscount(this.genericProductEntryService.activerowIndex,{MCODE:this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].MCODE,QUANTITY:this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].Quantity,RATE:this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].RATE,AMOUNT:this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].AMOUNT,UNIT:this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].UNIT,CUSTID:this._trnMainService.TrnMainObj.TRNAC,PRICEMODE:this._trnMainService.TrnMainObj.PRICEMODE}),(0!==this.userSetting.ENABLE_SOINABB&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales||0!==this.userSetting.ENABLE_SOINDCHALAN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryChalan||0!==this.userSetting.PERFOMASOBILLMODE&&this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice)&&this._trnMainService.TrnMainObj.REFORDBILL&&this.checkQuantityInPOdeliveryMode(),(this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&"IMPORT_PURCHASE"!==this._trnMainService.TrnMainObj.AdditionalObj.tag&&(1===this._trnMainService.userSetting.PODELIVERYMODE||2===this._trnMainService.userSetting.PODELIVERYMODE)&&null!=this._trnMainService.TrnMainObj.REFORDBILL&&""!=this._trnMainService.TrnMainObj.REFORDBILL||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice&&0!==this._trnMainService.userSetting.ENABLE_SOINTI||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived&&(1==this._trnMainService.userSetting.PODELIVERYMODE||2==this._trnMainService.userSetting.PODELIVERYMODE)&&this._trnMainService.TrnMainObj.REFORDBILL||this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&"IMPORT_PURCHASE"===this._trnMainService.TrnMainObj.AdditionalObj.tag&&0!=this._trnMainService.userSetting.IMPORTPOBILLMODE)&&this.checkQuantityInPOdeliveryMode();let P=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];E in t.po&&(!this._trnMainService.allowNegativeBilling(this.genericProductEntryService.activerowIndex)&&"self-billing"!=this.genericProductEntryService.activeurlpath&&this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PTYPE<10&&this.checkItemTotalQtyWithStock(P.MCODE,P.BC,P.HASVARIANT,P.RATE,this.genericProductEntryService.activerowIndex,P.BATCH),"self-billing"!=this.genericProductEntryService.activeurlpath&&this.valiadateDuplicateRateItem(P.HASVARIANT,P.MCODE,P.RATE,P.BATCH,this.genericProductEntryService.activerowIndex)),(this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&0==this._trnMainService.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&"NEW"==this._trnMainService.TrnMainObj.Mode)&&(console.log("JJJJJ"),this.checkBatchWiseEnterStock()||this.alertService.info(`Inserted Quantity Is Greater Than Its Available Stock \n        Qty=${this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK)} \n        ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].UNIT}, Item : ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} \n        @Qty = ${this.totalQuantity} ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT} `));const x=document.getElementById("ITEMDESC"+a);if(this._trnMainService.TrnMainObj.VoucherType==t.Km.DebitNote&&x&&""!==x.value?.trim()){let O=a+1;const j=document.getElementById("ITEMDESC"+O);let D={isFocusAchieved:!1};this.focusService.autoFocus(a,document.getElementById("ALTERNATEQUANTIY"+a),D,"productEntrySetting.tableId"),D.isFocusAchieved||(this.genericProductEntryService.checkValidation(a),j&&""!==j.value?.trim()&&this.focusService.autoFocus(O,document.getElementById("ITEMDESC"+O),{},"productEntrySetting.tableId"))}}checkStockInDREdit(a){let E=this._trnMainService.TrnMainObj.ProdList[a].POSTOCK/this._trnMainService.TrnMainObj.ProdList[a].ALTCONFACTOR;this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY>E&&(this.alertService.info(`Enter quantity is greater than main quantity: ${E}!`),this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY=0)}AlternateQuantityEventClick(a){if(console.log("rkone"),this.QuantityChangeEvent(a),this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry&&(this._trnMainService.TrnMainObj.ProdList[a+1]||this._trnMainService.addRow(),setTimeout(()=>{this.genericProductEntryService.focusNext(a)},10)),"asset-purchase-invoice"!=this.activeurlpath&&"assets-openingstockentry"!=this.activeurlpath||"NEW"!=this._trnMainService.TrnMainObj.Mode){if(5==this._trnMainService.TrnMainObj.CNDN_MODE&&"EDIT"==this._trnMainService.TrnMainObj.Mode){let P=this._trnMainService.TrnMainObj.VCHRNO,x=this._trnMainService.TrnMainObj.AssetsProdList[a].MCODE,O=this._trnMainService.TrnMainObj.AssetsProdList[a].BATCH;"new"!==this._trnMainService.TrnMainObj.AssetsProdList[a].rowMode&&this.masterService.getAssetEditableQty(P,x,O).subscribe(j=>{if("ok"==j.status){let D=this._trnMainService.TrnMainObj.AssetsProdList[a].ALTQTY_IN;if(j.result>0&&D>j.result)return void this.alertService.info(`Entered Qty${D} exceed the assets assign qty${j.result} `)}})}var E;if(this._trnMainService.TrnMainObj.VoucherType===t.Km.OpeningStockBalance&&"EDIT"===this._trnMainService.TrnMainObj.Mode&&setTimeout(()=>{document.getElementById("RATE"+a)?.focus()},20),(this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesReturn)&&0==this.userSetting.ENABLEMANUALSALESRETURN&&0==this._trnMainService.TrnMainObj.DONONSALEABLERETURN)if(E=this._trnMainService.ReturnStockReconcile(this._trnMainService.TrnMainObj.ProdList[a].MCODE),this._trnMainService.TrnMainObj.ProdList[a].STOCK<E)return void this.alertService.warning("Quantity cannot exceed the actual Sales Quantity");if((this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferIn)&&this._trnMainService.TrnMainObj.ProdList[a].MINLEVEL>0){const P=this._trnMainService.TrnMainObj.ProdList[a].TOTSTOCK-this._trnMainService.ReturnStockReconcile(this._trnMainService.TrnMainObj.ProdList[a].MCODE);if(P<this._trnMainService.TrnMainObj.ProdList[a].MINLEVEL)return this.alertService.warning(`Stock Qty Goes Below Minimum Stock Level. (Min Stock : ${this._trnMainService.TrnMainObj.ProdList[a].MINLEVEL} | Stock Qty : ${P})`),void(1==this._trnMainService.TrnMainObj.ProdList[a]?.MINWARN&&(this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY=0))}if(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex]?.BC||1===this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex]?.HASVARIANT&&(this._trnMainService.TrnMainObj.VoucherType==t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType==t.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType==t.Km.ProductionEntry||this._trnMainService.TrnMainObj.VoucherType==t.Km.RequisitionEntry||this._trnMainService.TrnMainObj.VoucherType==t.Km.Quotation||this._trnMainService.TrnMainObj.VoucherType==t.Km.PurchaseOrder||this._trnMainService.TrnMainObj.VoucherType==t.Km.SalesOrder)&&(this.alertService.info("Please select variants first!"),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0,this.masterService.masterGetmethod(`/getItemWiseVariantAttributes?mcat=${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].Mcat}&mcode=${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].MCODE}`).subscribe(P=>{"ok"==P.status&&P.result&&P.result.length&&this.alertService.emitShowHideSubject.subscribe(x=>{setTimeout(()=>{this.genericProductEntryService.matrixItemAtrribute=P.result,this.genericProductEntryService.matrixitemgrid.show()})})})),1===this.userSetting.EnableTelcomDevices&&1===this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex]?.NATURETYPE&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].visible=!0,!this._trnMainService.currentIndexProductDetails?.length&&"NEW"===this._trnMainService.TrnMainObj.Mode?.toUpperCase()&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ProductDetails=[]),(this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice&&(0,e.isNullOrUndefined)(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BARCODE)||this._trnMainService.TrnMainObj.VoucherType===t.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived)&&(1!==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].NATURETYPE||this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote||null==this._trnMainService.TrnMainObj.ProdList[a].BC||""==this._trnMainService.TrnMainObj.ProdList[a].BC||null==this._trnMainService.TrnMainObj.ProdList[a].BC||this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY)&&this.dialougeOpen()),(this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived)&&this.checkMaxStockLevel(a),this._trnMainService.TrnMainObj.ProdList[a]?.PTYPE<10&&(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==t.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut)&&this.checkReorderStocklevel(a),this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut&&9!=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PTYPE&&(this._trnMainService.allowNegativeBilling(this.genericProductEntryService.activerowIndex)||this.checkEnteredProductStock()),this._trnMainService.TrnMainObj.VoucherType==t.Km.CreditNote&&0==this.userSetting.ENABLEMANUALSALESRETURN&&this.genericProductEntryService.checkValidation(a),"self-billing"===this.activeurlpath&&this.genericProductEntryService.checkValidation(a),"variant-adjustment"==this.activeurlpath&&(1==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].HASVARIANT?setTimeout(()=>{document.getElementById("adjustbc"+this.genericProductEntryService.activerowIndex).focus()},20):setTimeout(()=>{document.getElementById("adjustbatch"+this.genericProductEntryService.activerowIndex).focus()},20)),this._trnMainService.TrnMainObj.VoucherType==t.Km.DebitNote&&1==this._trnMainService.TrnMainObj.ProdList[a].HASVARIANT){let P=0;P=this._trnMainService.ReturnStockReconcileForVariantItem(this._trnMainService.TrnMainObj.ProdList[a].MCODE,this._trnMainService.TrnMainObj.ProdList[a].BC);let j=this._trnMainService.TrnMainObj.ProdList[a].STOCK;if(j<P)return void this.alertService.info(`Entered Quantity exceed the stock Quantity ${j} `)}if(this._trnMainService.TrnMainObj.VoucherType==t.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType==t.Km.StockSettlement||this._trnMainService.TrnMainObj.VoucherType==t.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType==t.Km.DeliveryChalan||this._trnMainService.TrnMainObj.VoucherType==t.Km.DeliveryReturn){let P={isFocusAchieved:!1};this.focusService.autoFocus(a,document.getElementById("ALTERNATEQUANTIY"+a),P,"productEntrySetting.tableId"),P.isFocusAchieved||this.genericProductEntryService.checkValidation(a)}}}checkMaxStockLevel(a){0!==this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[a].MAXLEVEL)&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[a].STOCK)+this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY)>this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[a].MAXLEVEL)&&this.alertService.warning("Maximum stock level "+this._trnMainService.TrnMainObj.ProdList[a].MAXLEVEL+" exceeded !")}checkReorderStocklevel(a){var E=this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[a].STOCK)-this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY);if(E<this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[a].ROLEVEL)){if(0==this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[a].MINLEVEL))return;if(E<this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[a].MINLEVEL))this.alertService.warning("Stock for this item has receded the minimun stock level "+this._trnMainService.TrnMainObj.ProdList[a].MINLEVEL),1===this._trnMainService.TrnMainObj.ProdList[a].MINWARN&&(this._trnMainService.TrnMainObj.ProdList[a].ALTERNATEQUANTIY=0);else{if(0==this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[a].ROLEVEL))return;1===this._trnMainService.TrnMainObj.ProdList[a].ROWARN&&this.alertService.warning("Re-Order level "+this._trnMainService.TrnMainObj.ProdList[a].ROLEVEL+" has been reached !")}}}dialougeOpen(){console.log("dialouge open ProductDetails",this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ProductDetails),this._trnMainService.currentIndexProductDetails=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ProductDetails,this.dialog.open(h.H,{hasBackdrop:!0,autoFocus:!1,data:{type:this._trnMainService.TrnMainObj.VoucherPrefix,mode:this._trnMainService.TrnMainObj.Mode,warehouse:this._trnMainService.TrnMainObj.MWAREHOUSE,message:this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex],curretnIndexPrevDetials:this._trnMainService.currentIndexProductDetails,productList:this._trnMainService.TrnMainObj.ProdList}}).afterClosed().subscribe(y=>{this.productLists=this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote?y?.data:y&&y.data&&y.data.productColorList?y.data.productColorList:[],this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ProductDetails=this.productLists,this._trnMainService.currentIndexProductDetails=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ProductDetails,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=this.productLists?this.productLists.length:0,(this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote)&&this.calculateRateForStockOut(y?.data),(this._trnMainService.TrnMainObj.VoucherType==t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived)&&this._trnMainService.calculateNetRATE(this.genericProductEntryService.activerowIndex),setTimeout(()=>{if(0==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY){if(this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice)return void this.alertService.warning(`Zero Quantity Detected for Item ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].MENUCODE}). Please Check Your Entry.`)}else this._trnMainService.ReCalculateBillWithNormal(),document.getElementById("ALTRATE"+this.genericProductEntryService.activerowIndex).focus()},20)})}calculateRateForStockOut(a){this.productLists=a,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTRATE=this.productLists[0].Costprice,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].RATE=this.productLists[0].Costprice,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=1,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BC=this.productLists[0].IEMI1,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].AMOUNT=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY*this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTRATE;for(let E=1;E<this.productLists?.length;E++){let y=(0,V.cloneDeep)(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex]);y.ALTRATE=this.productLists[E].Costprice,y.RATE=this.productLists[E].Costprice,y.ALTERNATEQUANTIY=1,y.BC=this.productLists[E].IEMI1,y.AMOUNT=y.ALTERNATEQUANTIY*y.ALTRATE,this._trnMainService.TrnMainObj.ProdList.push(y)}}checkBCForMatrxiItem(){this._trnMainService.TrnMainObj.VoucherType===t.Km.BatchAdjustment&&1==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].HASVARIANT&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BC||this.alertService.warning(`Variant Details is not selected for Item :${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} `))}ValidateQuantityinEDITMode(){let a={},E=this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].EDITABLEQTY),y=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY,P=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BILLEDQTY,x=0;if(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT?x=y:(x=y,P/=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR),0==E&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].TOTALOUTWARDSTOCK)>0){if(x<P)return a.status=!1,a.userEnterQty=P,a.message=`Item (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC}) entered qty (${x}) is more than minimum editable qty is (0) `,a;if(x<this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BILLEDQTY-this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BSTOCK)return a.status=!1,a.userEnterQty=P,a.message=`Item(${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC}) entered qty (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY})\n            ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT} (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY} x ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR} = ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR*this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY} ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT}) \n            ,Exceed the transaction qty (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].TOTALOUTWARDSTOCK}  ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT}  ) ) `,a}if(E>0&&x<this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].TOTALOUTWARDSTOCK)return a.status=!1,a.userEnterQty=P,a.message=`Item(${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC}) entered qty (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY})\n            ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT} (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY} x ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR} = ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR*this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY} ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT} \n            ,Exceed the transaction qty (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].TOTALOUTWARDSTOCK}  ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT}   ) ) `,a}checkBatchWiseRateinEditMode(){this.genericProductEntryService.batchlist=[];let E="";E=this._trnMainService.TrnMainObj.MWAREHOUSE?this._trnMainService.TrnMainObj.MWAREHOUSE:this._trnMainService.userProfile.userWarehouse,this.masterService.masterGetmethod(`/getPrductMultiplePriceInEdit?mcode=${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].MCODE}&VCHRNO=${this._trnMainService.TrnMainObj.VCHRNO}&warehouse=${E}`).subscribe(y=>{if("ok"===y.status&&(this.genericProductEntryService.batchlist=y.result,1===this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].REQEXPDATE&&!this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BARCODE&&(this.masterService.PlistTitle="Batch Selection"),"replacerate"===y.message&&(this.changeBatchWiseRate(y.result[0].RATE),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK=y.result[0].STOCK,this.assignBarcodeWiseMFGEXPDATE(y.result),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PRATE=y.result[0].costprice),"SHOWPRICEPOPUP"===y.message&&!(this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&1==this.userSetting.REFBILLCOMPULSORINDNOTE)&&(this.masterService.PlistTitle="Batch Price Selection",this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].HasMulitplePrice=1,this._trnMainService.TrnMainObj.VoucherType===t.Km.Repack&&this.changeBatchWiseRate(y.result[0].RATE)),0===this.genericProductEntryService.batchlist.length&&"NewBill"!=this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE&&alert("Rate not Detected!")),"EDIT"===this._trnMainService.TrnMainObj.Mode?.toUpperCase()){var P=this.ValidateQtyEDITModeForOUt();if(P&&!P.status)return this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=P.userEnterQty,void this.alertService.info(P.message)}})}ValidateQtyEDITModeForOUt(){let a={},y=(this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].EDITABLEQTY),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY),P=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BILLEDQTY,x=0;if(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT?x=y:(x=y*this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR,P/=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR),console.log("stock",x,this._trnMainService.TrnMainObj.ProdList),x>this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK)return a.status=!1,a.userEnterQty=P,a.message=`Item(${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC}) entered qty (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY})\n        ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT} (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY} x ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR} = ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR*this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY} ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT}) \n        ,Exceed the Stock qty (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK}  ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT}  ) ) `,a}checkItemStockINEditModeForOutQty(){let a={},E=0,y=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY;if(E=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT?y:y*this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR,"EDIT"!==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].rowMode?.toUpperCase()&&E>this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK)return a.status=!1,a.message="Enter Qty exceed the batch wise transaction qty",a;if("EDIT"===this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].rowMode?.toUpperCase()){let P=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BatchWiseEditList?.map(x=>x.INVOICEQTY).reduce((x,O)=>x+O,0);if(E-P>this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK)return a.status=!1,a.message="Enter Qty exceed the batch wise transaction qty",a}}ValidateQtyINEditModeFroProduction(a){let E=0;return E=a.BASEUNIT===a.ALTUNIT?a.ALTERNATEQUANTIY:a.ALTERNATEQUANTIY*a.ALTERNATEQUANTIY,!(E<a.OUTQTY&&(this.alertService.info(`Item : ${a.ITEMDESC} entered Qty:${E} ${a.BASEUNIT} is less than transaction Qty:${a.OUTQTY}`),1))}checkBatchSelectionInMultiplePrice(){return 1!=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex]?.HasMulitplePrice||!!this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PriceSelected}checkDuplicateproductEnterQuantity(){let a=0,E={};if(E=2==this.userSetting.EnableBatch?this._trnMainService.TrnMainObj.ProdList.filter(P=>P.MCODE==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].MCODE&&P.BATCH==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BATCH&&P.BC==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BC&&P.ALTUNIT==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT&&P.PRATE==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PRATE&&P.CRATE==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].CRATE).forEach(P=>{a+=P.Quantity}):this._trnMainService.TrnMainObj.ProdList.filter(P=>P.MCODE==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].MCODE&&P.BATCH==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BATCH&&P.BC==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BC).forEach(P=>{a+=P.Quantity}),a>(this._trnMainService.TrnMainObj.VoucherType==t.Km.DebitNote&&0==this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE?this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK:this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].TOTSTOCK)&&9!=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PTYPE)return this.alertService.info(`Inserted Item ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} Quantity :\n  ${a}  \n  Is Greater Than Its Available Stock =${this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK)} \n  ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT}`),this._trnMainService.quantityExceedCheck="QuantityExceed",this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].AMOUNT=0,!1;this._trnMainService.quantityExceedCheck=""}checkEnteredProductStock(){let a=this._trnMainService.TrnMainObj.ProdList.filter(E=>E.Quantity>E.STOCK&&7!=E.NATURETYPE&&E.PTYPE<10)[0];if(console.log("prod stock obj",a),null!=a)return this.alertService.info(a.BASEUNIT!=a.ALTUNIT?`Inserted Quantity Is Greater Than Its Available Stock Qty=${this._trnMainService.nullToZeroConverter(a.STOCK)} ${a.BASEUNIT}, Item : ${a.ITEMDESC} @Qty1 = ${a.Quantity} ${a.BASEUNIT} (${a.ALTERNATEQUANTIY} x ${a.ALTCONFACTOR} = ${a.Quantity} ${a.BASEUNIT}) `:`Inserted Quantity Is Greater Than Its Available Stock Qty=${this._trnMainService.nullToZeroConverter(a.STOCK)} ${a.BASEUNIT}, Item : ${a.ITEMDESC} @Qty2 = ${a.Quantity} ${a.BASEUNIT} `),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0,this.alertService.emitShowHideSubject.subscribe(E=>{setTimeout(()=>{document.getElementById("alternateqty"+this.genericProductEntryService.activerowIndex).focus()},0)}),this._trnMainService.ReCalculateBillWithNormal(),!1}checkSaleableQuantityInSalesOrder(){let a=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex],E=a.ALTUNIT==a.BASEUNIT?a.ALTERNATEQUANTIY:a.ALTERNATEQUANTIY*a.ALTCONFACTOR;this.masterService.getSaleableQTY(a.MCODE,this._trnMainService.TrnMainObj.DIVISION,this._trnMainService.TrnMainObj.PhiscalID,this._trnMainService.TrnMainObj.TRNDATE,this._trnMainService.TrnMainObj.MWAREHOUSE,this._trnMainService.TrnMainObj.VCHRNO).subscribe(y=>{if("ok"==y.status){let P=y.result[0].SALEABLE_SQTY;E>P&&(a.ALTERNATEQUANTIY=0,this._trnMainService.ReCalculateBillWithNormal(),this.alertService.info("Entered qty is greater than its saleable qty:"+P),this.alertService.emitShowHideSubject.subscribe(x=>{setTimeout(()=>{document.getElementById("alternateqty"+this.genericProductEntryService.activerowIndex).focus()},0)}))}},y=>{this.alertService.info(y)})}checkQuantityInSOLoadFromQT(){null!=this._trnMainService.TrnMainObj.ProdList.filter(E=>E.Quantity>E.POSTOCK)[0]&&(this.alertService.info(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT?`Item ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} Quantity ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY}\n        ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT}\nexceed the item wise QT Quantity  ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].POSTOCK}\n${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT}\n`:`Item ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} Quantity ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY}\n        ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT} (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY} x ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR} = ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR*this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY} ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT} )\n        exceed the item wise PO Quantity  ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].POSTOCK}\n        ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT}\n        `),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0,this.alertService.emitShowHideSubject.subscribe(E=>{setTimeout(()=>{document.getElementById("alternateqty"+this.genericProductEntryService.activerowIndex).focus()})}))}checkQuantityInSOLoadFromQTin(){if(null!=this._trnMainService.TrnMainObj.ProdList.filter(E=>E.Quantity<E.POSTOCK)[0]&&!confirm("Quantity is less than QT stock !Are you sure you want to proceed ? "))return this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0,void document.getElementById("alternateqty"+this.genericProductEntryService.activerowIndex).focus()}checkRepackStock(){let a=this._trnMainService.TrnMainObj.ProdList.filter(E=>E.BATCH===this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BATCH&&E.ROUTQTY>E.STOCK)[0];if(null!=a&&null!=a)return this.alertService.info(`Inserted Quantity Is Greater Than Its Available Stock Qty=${this._trnMainService.nullToZeroConverter(a.STOCK)} ${a.PUNIT}, Item : ${a.ITEMDESC} @Qty3 = ${a.Quantity} ${a.ALTUNIT} `),console.log("repor1"),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0,this.alertService.emitShowHideSubject.subscribe(E=>{setTimeout(()=>{document.getElementById("alternateqty"+this.genericProductEntryService.activerowIndex).focus()},0)}),this._trnMainService.ReCalculateBillWithNormal(),!1}checkChildproductEnterQuantity(){console.log("check child product enter quantitiy");let a=0;if(this._trnMainService.TrnMainObj.ProdList.filter(y=>y.PMCODE==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PMCODE&&y.BATCH==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BATCH).forEach(y=>{a+=y.ROUTQTY}),console.log("total Enter qty",a,"stokc",this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK),a>this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK)return this.alertService.info(`Inserted Quantity Is Greater Than Its Available Stock \n      Qty=${this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK)} \n      ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PUNIT},\n      (-${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex-1].ROUTQTY}   ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PUNIT} ) \n      Item : ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} \n      @Qty = ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].Quantity} ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT} `),this._trnMainService.quantityExceedCheck="QuantityExceed",void(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0);this._trnMainService.quantityExceedCheck=""}checkSameproductEnterQuantity(){console.log("r2");let a=0;if(this._trnMainService.TrnMainObj.ProdList.filter(y=>y.MCODE==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].MCODE&&y.BATCH==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BATCH).forEach(y=>{a+=y.ROUTQTY}),a>this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK)return this.alertService.info(`Inserted Quantity Is Greater Than Its Available Stock \n    Qty=${this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK)} \n    ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PUNIT},\n    (-${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex-1].ROUTQTY}   ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PUNIT} ) \n    Item : ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} \n    @Qty = ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].Quantity} ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT} `),this._trnMainService.quantityExceedCheck="QuantityExceed",void(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0);this._trnMainService.quantityExceedCheck=""}checkQuantityInEditMode(){let a=this._trnMainService.TrnMainObj.ProdList.filter(E=>E.Quantity<E.OUTQTY)[0];null!=a?(this._trnMainService.quantityExceedCheck="QuantityExceed",this.alertService.warning(`Item ${a.ITEMDESC} Quantity exceed the batch wise transaction stock`)):this._trnMainService.quantityExceedCheck=""}checkBatchWiseStockOut(){this.checkBatchWiseEnterStock()||this.alertService.info(`Inserted Quantity Is Greater Than Its Available Stock \n      Qty=${this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK)} \n      ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT}, Item : ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} \n      @Qty = ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].Quantity} ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT} `)}checkQuantityInPOdeliveryMode(){console.log("reachdownpodelivery"),(7!=this._trnMainService.TrnMainObj.ProdList[this.activerowIndex]?.NATURETYPE||1!=this.userSetting.AllowQtyExceedInPo)&&null!=this._trnMainService.TrnMainObj.ProdList.filter(E=>E.Quantity>E.POSTOCK)[0]&&(this.alertService.info(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT?`Item ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} Quantity ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY}\n        ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT} exceed the item wise PO Quantity  ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].POSTOCK}\n        ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT}\n        `:`Item ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ITEMDESC} Quantity ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY}\n        ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT} (${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY} x ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR} = ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTCONFACTOR*this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY} ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT} )\n        exceed the item wise PO Quantity  ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].POSTOCK}\n        ${this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BASEUNIT}\n        `),(this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived)&&1===this._trnMainService.userSetting.AllowQtyExceedInPo&&1===this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL||(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0),this.alertService.emitShowHideSubject.subscribe(E=>{setTimeout(()=>{document.getElementById("alternateqty"+this.genericProductEntryService.activerowIndex).focus()})}))}checkItemTotalQtyWithStock(a,E,y,P,x,O=""){let j=0;if(j=1==y?this._trnMainService.TrnMainObj.ProdList.filter(D=>D.MCODE==a&&D.BC==E&&D.RATE==P).map(D=>D.Quantity).reduce((D,U)=>D+U,0):this._trnMainService.TrnMainObj.ProdList.filter(D=>D.MCODE==a&&D.RATE==P&&D.BATCH==O).map(D=>D.Quantity).reduce((D,U)=>D+U,0),j>0)return j>this._trnMainService.TrnMainObj.ProdList[x].STOCK&&9!=this._trnMainService.TrnMainObj.ProdList[x].PTYPE?(console.log("entered info"),this.alertService.info(`Item ${this._trnMainService.TrnMainObj.ProdList[x].ITEMDESC} Entered  Quantity: ${j}  exceed the available stock ${this._trnMainService.TrnMainObj.ProdList[x].STOCK} `),this._trnMainService.quantityExceedCheck="QuantityExceed",void(this._trnMainService.TrnMainObj.ProdList[x].ALTERNATEQUANTIY=0)):void(this._trnMainService.quantityExceedCheck="")}valiadateDuplicateRateItem(a,E,y,P,x){if(0==a){let O=this._trnMainService.TrnMainObj.ProdList.filter(j=>j.MCODE==E&&j.RATE==y&&j.BATCH==P);if(O&&O?.length>1)return this.alertService.info(`Item:${O[0].ITEMDESC} duplicate rate:${O[0].RATE} is detected.`),void(this._trnMainService.TrnMainObj.ProdList[x].ALTERNATEQUANTIY=0)}}checkBatchWiseEnterStock(){let a=0;return this._trnMainService.TrnMainObj.ProdList.filter(E=>E.MCODE==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].MCODE&&E.BATCH==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BATCH&&E.ALTUNIT==this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTUNIT).forEach(E=>a+=E.Quantity),this.totalQuantity=a,a>this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].STOCK?(this._trnMainService.quantityExceedCheck="QuantityExceed",this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTERNATEQUANTIY=0,!1):(this._trnMainService.quantityExceedCheck="",!0)}quantityKeyPress(a,E,y,P){("Tab"==a.key||"Enter"==a.key)&&(a.preventDefault(),this.AlternateQuantityEventClick(y))}changeBatchWiseRate(a){(this._trnMainService.TrnMainObj.VoucherType==t.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===t.Km.Repack||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote||"consumption"===this._trnMainService.TrnMainObj.AdditionalObj.RETURNTYPE)&&this._trnMainService.nullToZeroConverter(a)>0&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].RATE=a,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].REPACKRATE=a,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].PRATE=a,this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].ALTRATE=this._trnMainService.TrnMainObj.VoucherType==t.Km.Repack?this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].RATE*this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].CONFACTOR):a,this.setDefaultUnitwisRate(this.genericProductEntryService.activerowIndex))}assignBarcodeWiseMFGEXPDATE(a){1===this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].REQEXPDATE&&this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BC&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].MFGDATE=null==a[0].MFGDATE?"":a[0].MFGDATE.toString().substring(0,7),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].EXPDATE=null==a[0].EXPDATE?"":a[0].EXPDATE.toString().substring(0,7),this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BATCH=a[0].BATCH)}setDefaultUnitwisRate(a){null!=this._trnMainService.TrnMainObj.ProdList[a].Product.AlternateUnits.filter(y=>1==y.ISDEFAULTPUNIT)[0]&&(this._trnMainService.TrnMainObj.ProdList[a].ALTRATE=this._trnMainService.TrnMainObj.ProdList[a].RATE*this._trnMainService.TrnMainObj.ProdList[a].ALTCONFACTOR)}}return R.\u0275fac=function(a){return new(a||R)(F.LFG(Q.w),F.LFG(L.c),F.LFG(I.uw),F.LFG(m.gz),F.LFG(S.i))},R.\u0275prov=F.Yz7({token:R,factory:R.\u0275fac}),R})()},94534:(z,Z,M)=>{M.d(Z,{w:()=>S});var t=M(66274),e=M(42326),s=M(28698),h=M(60716),V=M(87584),p=M(53074),F=M(67311),Q=M(60694),L=M(48083),I=M(48063),m=M(33612);let S=(()=>{class g{constructor(u,a,E,y,P,x,O){this._trnMainService=u,this.masterService=a,this.alertService=E,this.responseMsgService=y,this.arouter=P,this.productHelperService=x,this.focusService=O,this.gridPopupSettings=new s.im,this.onChangeProductionItem=new t.vpe,this.loadFromBarcode=!1,this.activeurlpath="",this.batchlist=[],this.barcodeDisplay=!1,this.showBarCodeDetail=!1,this.showStockedQuantityOnly=0,this.stringValue="",this.hoverId=null,this.codeHoverId=null,this.rateHoverId=null,this.showBatchWiseDetail=!1,this.showBatchPopup=!1,this.subHeader=[],this.subHeader2=[],this.headerAfterSubHeader=[],this.headerAfterSubHeader2=[],this.gridPopupSettingsForSupplier=new s.im,this.userSetting=u.userSetting,this.userProfile=u.userProfile,this.genericProductEntrySetting=new h.Vn(u),this._trnMainService.activeurlpath=P.snapshot?.url[0]?.path}checkBatchWiseRateSettingZero(){console.log("check batch wise rate for setting"),this.batchlist=[];let a="",E="";a=this._trnMainService.TrnMainObj.VoucherType==e.Km.Repack?this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].PMCODE:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MCODE,E=this._trnMainService.TrnMainObj.MWAREHOUSE?this._trnMainService.TrnMainObj.MWAREHOUSE:this._trnMainService.userProfile.userWarehouse,this.masterService.masterGetmethod(`/getVariantItemDetails?mcode=${a}&voucherPrefix=${this._trnMainService.TrnMainObj.VoucherPrefix}&warehouse=${E}&barcode=`).subscribe(y=>{"ok"===y.status&&(this.batchlist=y.result,"SHOWPRICEPOPUP"===y.message&&(this.masterService.PlistTitle="Item Variant Selection"))})}getContractPriceandOtherDiscount(){this._trnMainService.getItemRelatedDiscount(this.activerowIndex,{MCODE:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MCODE,QUANTITY:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].Quantity,RATE:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].RATE,AMOUNT:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].AMOUNT,UNIT:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].UNIT,CUSTID:this._trnMainService.TrnMainObj.TRNAC,PRICEMODE:this._trnMainService.TrnMainObj.PRICEMODE})}assignValueForReturnModeInProd(u){console.log("ineditmode"),this._trnMainService.TrnMainObj.VoucherType===e.Km.DebitNote?(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].CRATE=u.CRATE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].PRATE=u.RATE):this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].PRATE=u.PRATE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].REALRATE=this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTRATE=this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].RATE=u.RATE,console.log("prodRAte",u.RATE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTRATE),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].SPRICE=u.SPRICE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BATCH=u.BATCH,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MFGDATE=null==u.MFGDATE?"":u.MFGDATE.toString().substring(0,7),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].EXPDATE=null==u.EXPDATE?"":u.EXPDATE.toString().substring(0,7),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].UNIT=u.UNIT,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].STOCK=u.STOCK,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].Quantity=u.STOCK,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].WAREHOUSE=u.WAREHOUSE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNTRATE=u.INDDISCOUNTRATE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNT=u.INDDISCOUNT,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNTRATE=u.INDDISCOUNTRATE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].PrimaryDiscount=u.PrimaryDiscount,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].SecondaryDiscount=u.SecondaryDiscount,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].LiquiditionDiscount=u.LiquiditionDiscount,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BASEUNIT=u.BASEUNIT,null==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].Product&&(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].Product={}),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].Product.MCODE=u.MCODE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].CONFACTOR=1,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTUNIT=u.UNIT,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].UNIT=u.UNIT,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BASEQUANTITY=u.Quantity,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ProductDetails=[],this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTERNATEUNIT=this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTUNIT,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTCONFACTOR=u.ALTCONFACTOR,console.log("RATE",this._trnMainService.TrnMainObj.ProdList,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MFGDATE),this._trnMainService.ReCalculateBillWithNormal()}assignRateandQtyLoadFromSO(u){this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].RATE=u.PRATE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTRATE=u.PRATE,this._trnMainService.TrnMainObj.VoucherType==e.Km.TaxInvoice&&0==this.userSetting.ENABLE_VTEXCLUDINGRATE_INSORDER&&(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].RATE=u.PRATE/this.userSetting.VatConRate,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTRATE=u.PRATE/this.userSetting.VatConRate),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].RECRATE=u.RECRATE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].PORATE=u.PRATE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].POSTOCK=this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice&&0!=this.userSetting.ENABLE_SOINTI||0!==this.userSetting.ENABLE_SOINABB&&this._trnMainService.TrnMainObj.VoucherType===e.Km.Sales||0!==this.userSetting.ENABLE_SOINDCHALAN&&this._trnMainService.TrnMainObj.VoucherType===e.Km.DeliveryChalan||0!==this.userSetting.PERFOMASOBILLMODE&&this._trnMainService.TrnMainObj.VoucherType===e.Km.PerformaSalesInvoice?u.OPSTOCK:u.POSTOCK}assignOrderedDiscount(u){if(console.log("assign ordered discount",u),u?.DISCOUNT){let a=u.DISCOUNT?100*u.DISCOUNT/u.AMOUNT:0;console.log("totaldisc loaded",a),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNTRATE=a}else this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNT=u.INDDISCOUNT,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNTRATE=u.INDDISCOUNTRATE}ValidateDuplicateItemEntry(u){if(this._trnMainService.TrnMainObj.VoucherType in e.NA){let E;return E=this._trnMainService.TrnMainObj.ProdList.filter(y=>y.MENUCODE==u.MENUCODE),!(E.length>0&&1==this.userSetting.DisableDuplicateItemEntry)}}getProductColorMcodeWise(){this.colorLists=[],this.masterService.getProductColorByMCode(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MCODE).subscribe(u=>{this.colorLists=u&&u.result?u.result:[]})}setPrefix(){let u="";return"self-billing"===this._trnMainService.activeurlpath?u="SB":null!=this._trnMainService.TrnMainObj.VoucherPrefix&&(u=this._trnMainService.TrnMainObj.VoucherPrefix),u}setItemPopupUrl(){console.log("set item popup url1",this.userSetting.DefaultFilterIndex),this.gridPopupSettings={title:"PRODUCTS",apiEndpoints:`/getMenuitemWithStockPagedList/${this.showStockedQuantityOnly}/all/NO/${this._trnMainService.userProfile.userWarehouse}`,defaultFilterIndex:this.userSetting.DefaultFilterIndex?this.userSetting.DefaultFilterIndex:0,columns:[{key:"MENUCODE",title:"ITEM CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"DESCRIPTION",hidden:!1,noSearch:!1},{key:"GroupName",title:"GROUP NAME",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.grpName,noSearch:!0},{key:"PSTOCK",title:"P-QTY",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showPQty,noSearch:!0},{key:"ISSUEQTY",title:"ISSUE QTY",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showStockIssueQty,noSearch:!0},{key:"CRATE",title:"NETRATE",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showNetRate,noSearch:!0},{key:"RATE",title:"S-RATE",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showRate,noSearch:!0},{key:"BASEUNIT",title:"UNIT",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showMRP,noSearch:!0},{key:"STOCK",title:this.genericProductEntrySetting.itemPopupUrlSetting.stockTitle,hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showStock,noSearch:!0,alignment:"right"},{key:"REALQTY_IN",title:"Req.Order Qty",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showRequesitionQty,noSearch:!0},{key:"REALQTY",title:"Sales-Qty",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showInCreditNote,noSearch:!0},{key:"POSTOCK",title:"PO QTY",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showPOStock,noSearch:!0,alignment:"right"},{key:"POSTOCK",title:"QT QTY",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showQTStock,noSearch:!0,alignment:"right"},{key:"OPSTOCK",title:"SO QTY",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showSOStock,noSearch:!0,alignment:"right"},{key:"RATE",title:"PORATE",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showPOStock,noSearch:!0,alignment:"right",pipe:!0},{key:"RATE",title:"SO RATE",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showSOStock,noSearch:!0,alignment:"right",pipe:!0},{key:"BARCODE",title:"BARCODE",hidden:!0,noSearch:!0},{key:"MRP",title:"MRP",hidden:this.genericProductEntrySetting.itemPopupUrlSetting.showMRP,noSearch:!0,alignment:"right",pipe:!0}]},this.gridPopupSettingsForSupplier={title:"Supplier",apiEndpoints:"/getAccountPagedListByPType/PA/V/0",defaultFilterIndex:0,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ERPPLANTCODE",title:"CODE",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"EMAIL",title:"EMAIL",hidden:!1,noSearch:!1}]}}setItemPopupUrl_old(){console.log("set item popup urlold",this.userSetting.DefaultFilterIndex);let u=!0,a=!0,E=!0,y=!0,P="STOCK",x=!0,O=!0,j=!0,D=!1,U=!0,W=!0,$=!0;this._trnMainService.TrnMainObj.VoucherType===e.Km.StockIssueReturn&&(a=!1),this._trnMainService.TrnMainObj.VoucherType===e.Km.DebitNote&&1==this.userSetting.REFBILLCOMPULSORINDNOTE&&(u=!1,E=!1),(this._trnMainService.TrnMainObj.VoucherType===e.Km.SalesReturn||this._trnMainService.TrnMainObj.VoucherType===e.Km.CreditNote)&&(y=!1,P="SALES QTY",U=!1),this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase&&(0!=this.userSetting.PODELIVERYMODE||0!=this.userSetting.IMPORTPOBILLMODE)&&(x=!1,D=!0),this._trnMainService.TrnMainObj.VoucherType===e.Km.GoodsReceived&&0!=this.userSetting.PODELIVERYMODE&&(x=!1),this._trnMainService.TrnMainObj.VoucherType===e.Km.SalesOrder&&this._trnMainService.TrnMainObj.REFORDBILL&&(O=!1),(this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.PerformaSalesInvoice)&&(this._trnMainService.TrnMainObj.REFORDBILL?($=!0,j=!1,D=!0):($=!1,j=!0,D=!0)),this._trnMainService.TrnMainObj.VoucherType===e.Km.BranchTransferOut&&this._trnMainService.TrnMainObj.REFORDBILL&&(W=!1),this.gridPopupSettings={title:"PRODUCTS",apiEndpoints:`/getMenuitemWithStockPagedList/${this.showStockedQuantityOnly}/all/NO/${this._trnMainService.userProfile.userWarehouse}`,defaultFilterIndex:this.userSetting.DefaultFilterIndex?this.userSetting.DefaultFilterIndex:0,columns:[{key:"MENUCODE",title:"ITEM CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"DESCRIPTION",hidden:!1,noSearch:!1},{key:"GroupName",title:"GROUP NAME",hidden:D,noSearch:!0},{key:"PSTOCK",title:"P-QTY",hidden:u,noSearch:!0},{key:"ISSUEQTY",title:"ISSUE QTY",hidden:a,noSearch:!0},{key:"CRATE",title:"NETRATE",hidden:E,noSearch:!0},{key:"RATE",title:"S-RATE",hidden:y,noSearch:!0},{key:"BASEUNIT",title:"UNIT",hidden:$,noSearch:!0},{key:"STOCK",title:P,hidden:!1,noSearch:!0,alignment:"right"},{key:"REALQTY_IN",title:"Req.Order Qty",hidden:W,noSearch:!0},{key:"REALQTY",title:"Sales-Qty",hidden:U,noSearch:!0},{key:"POSTOCK",title:"PO QTY",hidden:x,noSearch:!0,alignment:"right"},{key:"POSTOCK",title:"QT QTY",hidden:O,noSearch:!0,alignment:"right"},{key:"OPSTOCK",title:"SO QTY",hidden:j,noSearch:!0,alignment:"right"},{key:"RATE",title:"PORATE",hidden:x,noSearch:!0,alignment:"right",pipe:!0},{key:"RATE",title:"SO RATE",hidden:j,noSearch:!0,alignment:"right",pipe:!0},{key:"BARCODE",title:"BARCODE",hidden:!0,noSearch:!0},{key:"MRP",title:"MRP",hidden:$,noSearch:!0,alignment:"right",pipe:!0}]},this.gridPopupSettingsForSupplier={title:"Supplier",apiEndpoints:"/getAccountPagedListByPType/PA/V/0",defaultFilterIndex:0,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ERPPLANTCODE",title:"CODE",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"EMAIL",title:"EMAIL",hidden:!1,noSearch:!1}]}}displayProductDetailInViewMode(u){console.log("eventlog",u);var a=!1;return"VIEW"==this._trnMainService.TrnMainObj.Mode?.toUpperCase()&&"F9"==u.code&&(a=!0),a}checkFlatDiscountEntered(){return this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase&&(this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT)>0||this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.DCRATE)>0)}setShowStockQuatityAndLoadBarcodewiseProduct(){this._trnMainService.TrnMainObj.VoucherType===e.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.SalesOrder||this._trnMainService.TrnMainObj.VoucherType===e.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===e.Km.Repack||this._trnMainService.TrnMainObj.VoucherType===e.Km.Quotation?(this.showStockedQuantityOnly=1,this.loadBarCodeWiseProduct=this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BARCODE??""):this.showStockedQuantityOnly=0}checkSelfBilling(u){return!("self-billing"!==this._trnMainService.activeurlpath||(""==this._trnMainService.TrnMainObj.MWAREHOUSE?(this.alertService.warning("Please select an unsalable warehouse!"),this.alertService.emitShowHideSubject.subscribe(a=>{this.masterService.ShowMore=!0,u("warehouseId")}),0):""==this._trnMainService.TrnMainObj.TRNACName||null==this._trnMainService.TrnMainObj.TRNACName?(this.alertService.warning("Please select an Account Name!"),0):""==this._trnMainService.TrnMainObj.REMARKS||null==this._trnMainService.TrnMainObj.REMARKS?(this.alertService.warning("Remarks is mandatory!"),this.alertService.emitShowHideSubject.subscribe(a=>{this.masterService.ShowMore=!0,u("remarksid")}),0):(this.showStockedQuantityOnly=0,0)))}checkREFBILL(){if((this._trnMainService.TrnMainObj.VoucherType===e.Km.CreditNote&&1!==this._trnMainService.TrnMainObj.DONONSALEABLERETURN&&0==this.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType===e.Km.DebitNote&&1===this.userSetting.REFBILLCOMPULSORINDNOTE||this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase&&0!==this.userSetting.PODELIVERYMODE&&"purchase-import"!==this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType===e.Km.GoodsReceived&&0!==this.userSetting.IMPORTPOBILLMODE||this._trnMainService.TrnMainObj.VoucherType===e.Km.GoodsReceived&&0!==this.userSetting.PODELIVERYMODE||this._trnMainService.TrnMainObj.VoucherType===e.Km.SalesOrder&&this._trnMainService.TrnMainObj.REFORDBILL&&0!==this.userSetting.ENABLE_QUOTATTION_INSO||this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice&&0!==this.userSetting.ENABLE_SOINTI&&1==this.userSetting.SOREFERENCE_REQUIRED||this._trnMainService.TrnMainObj.VoucherType===e.Km.BranchTransferOut&&1===this._trnMainService.TrnMainObj.ISLOADFROMORDER||this._trnMainService.TrnMainObj.VoucherType===e.Km.StockIssue&&1===this._trnMainService.TrnMainObj.ISLOADFROMORDER)&&!this._trnMainService.TrnMainObj.REFORDBILL){let u=this.responseMsgService.getProperMessageForRefBill(this._trnMainService.TrnMainObj);return this.alertService.info(u),!1}return null==this._trnMainService.TrnMainObj.REFBILL||""==this._trnMainService.TrnMainObj.REFBILL?(this.alertService.info("Please Load the ref bill for return"),!1):(this.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList",this._trnMainService.TrnMainObj.VoucherType!=e.Km.Purchase||"IMPORT_PURCHASE"!=this._trnMainService.TrnMainObj.AdditionalObj.tag||0==this.userSetting.IMPORTPOBILLMODE||this._trnMainService.TrnMainObj.REFORDBILL?void 0:(this.alertService.warning("Please Load the Import PO Ref bill for return"),!1))}showPOQtyRate(u){this._trnMainService.TrnMainObj.REFORDBILL&&(this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase&&0!=this.userSetting.PODELIVERYMODE&&"IMPORT_PURCHASE"!=this._trnMainService.TrnMainObj.AdditionalObj.tag||this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase&&0!=this.userSetting.IMPORTPOBILLMODE&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag||this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice&&0!=this.userSetting.ENABLE_SOINTI||0!==this.userSetting.ENABLE_SOINABB&&this._trnMainService.TrnMainObj.VoucherType===e.Km.Sales||0!==this.userSetting.ENABLE_SOINDCHALAN&&this._trnMainService.TrnMainObj.VoucherType===e.Km.DeliveryChalan||0!==this.userSetting.PERFOMASOBILLMODE&&this._trnMainService.TrnMainObj.VoucherType===e.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.SalesOrder||this._trnMainService.TrnMainObj.VoucherType===e.Km.GoodsReceived&&0!=this.userSetting.PODELIVERYMODE)&&(this._trnMainService.purchaseOrderQty=this._trnMainService.TrnMainObj.ProdList[u].POSTOCK,this._trnMainService.purchaseOrderRate=this._trnMainService.TrnMainObj.ProdList[u].ALTRATE,this._trnMainService.produstWiseOrderUnit=this._trnMainService.TrnMainObj.ProdList[u].BASEUNIT)}checkBatchWiseRate(){if(null==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MCODE)return this.alertService.warning("Please select a Product"),!1;this.batchlist=[];let u=this._trnMainService.TrnMainObj.VoucherPrefix;"self-billing"===this._trnMainService.activeurlpath&&(u="SF");let a="";a=this._trnMainService.TrnMainObj.VoucherType==e.Km.Repack?this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].PMCODE:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MCODE;let E="";E=this._trnMainService.TrnMainObj.MWAREHOUSE?this._trnMainService.TrnMainObj.MWAREHOUSE:this.userProfile.userWarehouse,this._trnMainService.TrnMainObj.VoucherType==e.Km.ProductionEntry&&this.userSetting.LinkProductionwithconsumption&&(E=this._trnMainService.TrnMainObj.BILLTO);let y=encodeURIComponent(E);this.masterService.masterGetmethod(`/getProuductMultiplePriceBatchWise?mcode=${a}&voucherPrefix=${u}&warehouse=${y}&barcode=`).subscribe(P=>{"ok"===P.status&&(this.batchlist=P.result,this._trnMainService.checkBatchWiseApiResponses=!0,console.log("batchlist",this.batchlist),1===this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].REQEXPDATE&&!this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BARCODE&&this._trnMainService.TrnMainObj.VoucherType!==e.Km.ProductionEntry&&(this.masterService.PlistTitle="Batch Selection"),"replacerate"===P.message&&this._trnMainService.TrnMainObj.VoucherType===e.Km.Repack&&(this.batchWiseStockTax(P.result),this.changeBatchWiseRate(P.result[0].RATE)),"replacerate"===P.message&&(this.changeBatchWiseRate(P.result[0].RATE),this.assignBarcodeWiseMFGEXPDATE(P.result),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].PRATE=P.result[0].costprice),"SHOWPRICEPOPUP"===P.message&&(this.masterService.PlistTitle=this._trnMainService.TrnMainObj.VoucherType===e.Km.ProductionEntry?"Consumption Batch Selection":"Batch Price Selection",this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].HasMulitplePrice=1,this._trnMainService.TrnMainObj.VoucherType===e.Km.Repack&&this.changeBatchWiseRate(P.result[0].RATE)),0===this.batchlist.length&&"NewBill"!=this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE&&alert("Rate not Detected!")),"error"==P.status&&this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase&&(this.masterService.PlistTitle="Batch Selection")})}batchWiseStockTax(u){this._trnMainService.TrnMainObj.VoucherType===e.Km.Repack&&(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].STOCK=u.map(a=>a.STOCK).reduce((a,E)=>a+E,0))}changeBatchWiseRate(u){(this._trnMainService.TrnMainObj.VoucherType==e.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===e.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===e.Km.Repack||this._trnMainService.TrnMainObj.VoucherType===e.Km.StockSettlement||this._trnMainService.TrnMainObj.VoucherType===e.Km.DebitNote||"consumption"===this._trnMainService.TrnMainObj.AdditionalObj.RETURNTYPE)&&this._trnMainService.nullToZeroConverter(u)>0&&(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].RATE=u,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].REPACKRATE=u,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].PRATE=u,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTRATE=this._trnMainService.TrnMainObj.VoucherType==e.Km.Repack?this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].RATE*this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].CONFACTOR):u,this.setDefaultUnitwisRate(this.activerowIndex))}assignBarcodeWiseMFGEXPDATE(u){1===this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].REQEXPDATE&&this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BC&&(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MFGDATE=null==u[0].MFGDATE?"":u[0].MFGDATE.toString().substring(0,7),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].EXPDATE=null==u[0].EXPDATE?"":u[0].EXPDATE.toString().substring(0,7),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BATCH=u[0].BATCH)}setDefaultUnitwisRate(u){null!=this._trnMainService.TrnMainObj.ProdList[u].Product.AlternateUnits.filter(E=>1==E.ISDEFAULTPUNIT)[0]&&(this._trnMainService.TrnMainObj.ProdList[u].ALTRATE=this._trnMainService.TrnMainObj.ProdList[u].RATE*this._trnMainService.TrnMainObj.ProdList[u].ALTCONFACTOR)}itemFromBC(u){return 1==u&&1==this.loadFromBarcode}focusByElementId(u){setTimeout(()=>{const a=document.getElementById(u);!a||(a.focus(),a.click())},20)}discRateEnterClicked(u,a,E){if(this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.Sales){let y=this.masterService.userProfile.roleRights.find(P=>"DISLIMIT"==P.right);console.log("disLimt on discount rate",y),y&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNTRATE)>y?.value&&(this.alertService.warning("Discount limit of :"+y.value+"% exceeded"),this.alertService.emitShowHideSubject.subscribe(P=>{setTimeout(()=>{null!==document.getElementById("discountAmt"+a)&&document.getElementById("discountAmt"+a).focus()},0)}))}if(this._trnMainService.TrnMainObj.VoucherType===e.Km.SalesOrder){let y=this.masterService.userProfile.userRights.find(P=>"SODiscountLimit"==P.right);y&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNTRATE)>y?.value&&(this.alertService.warning("Discount limit for sales order ("+y.value+") exceeded"),this.alertService.emitShowHideSubject.subscribe(P=>{setTimeout(()=>{null!==document.getElementById("discountAmt"+a)?document.getElementById("discountAmt"+a).focus():document.getElementById("remarks"+a).focus()},0)}))}return(this._trnMainService.TrnMainObj.VoucherType===e.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType===e.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===e.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===e.Km.Quotation||this._trnMainService.TrnMainObj.VoucherType===e.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===e.Km.PurchaseOrder||this._trnMainService.TrnMainObj.VoucherType===e.Km.SalesOrder||this._trnMainService.TrnMainObj.VoucherType===e.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.DeliveryChalan)&&(this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNTRATE)>0&&0==this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].REQEXPDATE)||2==this._trnMainService.userSetting.EnableBatch?this._trnMainService.TrnMainObj.VoucherType==e.Km.PurchaseOrder&&"add-purchase-order"==this.activeurlpath||this._trnMainService.TrnMainObj.VoucherType==e.Km.SalesOrder?document.getElementById("REMARKS"+a)&&document.getElementById("REMARKS"+a).focus():this.checkValidation(a):0==this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNTRATE)?this._trnMainService.TrnMainObj.VoucherType==e.Km.Purchase&&"purchase-import"==this.activeurlpath?document.getElementById("INDDISCOUNT"+a).focus():null!=document.getElementById("INDDISCOUNT"+a)&&(this._trnMainService.TrnMainObj.VoucherType===e.Km.DebitNote?this.navigationUsingFocusService(a,"INDDISCOUNTRATE","productEntrySetting.tableId"):document.getElementById("INDDISCOUNT"+a).focus()):this._trnMainService.TrnMainObj.VoucherType==e.Km.PurchaseOrder&&"add-purchase-order"==this.activeurlpath?document.getElementById("INDDISCOUNT"+a).focus():document.getElementById("MFGDATE"+a).focus()),!1}disRateChange(u,a,E){u.DISCOUNT=0,u.DISRATE<0?u.DISRATE=0:u.DISRATE>100&&(u.DISRATE=100),this._trnMainService.ReCalculateBillForAsset(this._trnMainService.TrnMainObj)}disRateEnter(u,a,E){setTimeout(()=>{u.DISRATE?(this._trnMainService.initializeAssetProdlist(),setTimeout(()=>{document.getElementById("ITEMDESC"+(this.activerowIndex+1))&&document.getElementById("ITEMDESC"+(this.activerowIndex+1)).focus()})):document.getElementById("DISCOUNT"+this.activerowIndex).focus()})}IndDiscountRateChangeEvent(u,a,E){this._trnMainService.calculateNetRATE(E),this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNTRATE<0?this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNTRATE=0:this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNTRATE>100&&(this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNTRATE=100),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.calculateTradingNontradingTotalinDebitNote()}IndDiscountModelRateChange(u,a,E){return u>100?(this.alertService.info("Discount rate cannot be greater than 100%"),void(this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNTRATE=0)):u<0?(this.alertService.info("Discount rate cannot be less than 0%"),void(this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNTRATE=0)):void 0}focusNext(u){let a=u+1;1==this._trnMainService.userSetting.GblBarcodeWiseBilling?(console.log("GBLbarcodewisebilling = 1 "),this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType===e.Km.ProductionEntry||this._trnMainService.TrnMainObj.VoucherType===e.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===e.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===e.Km.OpeningStockBalance?setTimeout(()=>{null!=document.getElementById("BC"+a)?(console.log("rn1"),document.getElementById("BC"+a).focus()):document.getElementById("ITEMDESC"+a).focus()},50):setTimeout(()=>{null!=document.getElementById("ITEMDESC"+a)&&document.getElementById("ITEMDESC"+a).focus()},50)):(console.log("GBLbarcodewisebilling = 0 "),setTimeout(()=>{null!=document.getElementById("ITEMDESC"+a)&&document.getElementById("ITEMDESC"+a).focus()},50))}disAmountChange(u,a,E){u.DISRATE=0,u.DISCOUNT<0?u.DISCOUNT=0:u.DISCOUNT>u.AMOUNT&&(u.DISCOUNT=u.AMOUNT),this._trnMainService.initializeAssetProdlist(),setTimeout(()=>{document.getElementById("ITEMDESC"+(this.activerowIndex+1))&&document.getElementById("ITEMDESC"+(this.activerowIndex+1)).focus()}),this._trnMainService.ReCalculateBillForAsset(this._trnMainService.TrnMainObj)}checkDiscountAmountGreaterThanGrossAmount(u){return this._trnMainService.TrnMainObj.ProdList[u].INDDISCOUNT>this._trnMainService.TrnMainObj.ProdList[u].GROSSAMNT&&(this.alertService.warning("Discount amount cannot be greater than gross amount"),!0)}IndDiscountAmountChangeEvent(u,a,E,y){if(null!=this._trnMainService.TrnMainObj.ProdList[E].MCODE){if(!this.checkDiscountAmountGreaterThanGrossAmount(E)){if(this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.Sales){let P=100*this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNT/this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTERNATEQUANTIY*this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTRATE),x=this.masterService.userProfile.roleRights.find(O=>"DISLIMIT"==O.right);console.log("dis rate",P,"dislimit",x),x&&P>x?.value&&(this.alertService.warning("Discount limit of :"+x.value+"% exceeded, with given discount amount : "+this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNT),this.alertService.emitShowHideSubject.subscribe(O=>{setTimeout(()=>{null!==document.getElementById("INDDISCOUNT"+E)&&document.getElementById("INDDISCOUNT"+E).focus()},0)}))}if((this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===e.Km.GoodsReceived)&&(this._trnMainService.TrnMainObj.ProdList[E].UNIT==this._trnMainService.TrnMainObj.ProdList[E].BASEUNIT?(this._trnMainService.TrnMainObj.ProdList[E].NETRATE=this._trnMainService.TrnMainObj.ProdList[E].RATE+this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[E].ECSAMOUNT)/this._trnMainService.TrnMainObj.ProdList[E].Quantity-this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNT),this._trnMainService.TrnMainObj.ProdList[E].CRATE=this._trnMainService.TrnMainObj.ProdList[E].NETRATE):(this._trnMainService.TrnMainObj.ProdList[E].NETRATE=this._trnMainService.TrnMainObj.ProdList[E].RATE+this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[E].ECSAMOUNT)/this._trnMainService.TrnMainObj.ProdList[E].Quantity-this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNT/this._trnMainService.TrnMainObj.ProdList[E].Quantity),this._trnMainService.TrnMainObj.ProdList[E].CRATE=this._trnMainService.TrnMainObj.ProdList[E].NETRATE)),this._trnMainService.TrnMainObj.VoucherType===e.Km.SalesOrder){let P=100*this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].INDDISCOUNT/this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTERNATEQUANTIY*this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTRATE),x=this.masterService.userProfile.userRights.find(O=>"SODiscountLimit"==O.right);console.log(" so dis rate",P,"dislimit",x),x&&P>x?.value&&(this.alertService.warning("Discount limit of :"+x.value+"% exceeded, with given discount amount : "+this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNT),this.alertService.emitShowHideSubject.subscribe(O=>{setTimeout(()=>{null!==document.getElementById("INDDISCOUNT"+E)&&document.getElementById("INDDISCOUNT"+E).focus()},0)}))}this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNTRATE=0,this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNT<0&&(this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNT=0),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.calculateTradingNontradingTotalinDebitNote()}}else this._trnMainService.TrnMainObj.ProdList[E].INDDISCOUNT=0}discEnterClicked(u,a,E,y){if(this._trnMainService.TrnMainObj.VoucherType===e.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===e.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===e.Km.CreditNote&&1==this.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType===e.Km.CreditNote&&0==this.userSetting.ENABLEMANUALSALESRETURN&&0==this._trnMainService.TrnMainObj.DOFULLRETURN){if(this._trnMainService.TrnMainObj.ProdList[a].INDDISCOUNTRATE>0&&(this._trnMainService.TrnMainObj.ProdList[a].INDDISCOUNTRATE=0),this.checkDiscountAmountGreaterThanGrossAmount(a))return;0==this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].REQEXPDATE)?(console.log("reach1"),this.checkValidation(a)):document.getElementById("MFGDATE"+a).focus()}else this._trnMainService.TrnMainObj.VoucherType===e.Km.DebitNote?("Tab"==y.key&&y.preventDefault(),this.checkValidation(a),this.navigationUsingFocusService(a,"INDDISCOUNT","productEntrySetting.tableId")):this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice?1===this.userSetting.ENABLE_NETAMOUNT_EDIT?null!=document.getElementById("netamounteditable"+this.activerowIndex)&&document.getElementById("netamounteditable"+this.activerowIndex).focus():this.checkValidation(a):this._trnMainService.TrnMainObj.VoucherType===e.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===e.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.DeliveryChalan?this.checkValidation(a):this._trnMainService.TrnMainObj.VoucherType===e.Km.Quotation||this._trnMainService.TrnMainObj.VoucherType===e.Km.PurchaseOrder&&"IMPORT_PURCHASE_ORDER"!=this._trnMainService.TrnMainObj.AdditionalObj.tag||this._trnMainService.TrnMainObj.VoucherType===e.Km.SalesOrder?document.getElementById("REMARKS"+a).focus():this._trnMainService.TrnMainObj.VoucherType===e.Km.PurchaseOrder&&"IMPORT_PURCHASE_ORDER"==this._trnMainService.TrnMainObj.AdditionalObj.tag?this.checkValidation(a):document.getElementById("MFGDATE"+a).focus();return!1}QuantityEnterClicked(u,a,E){("Tab"==u.key||"Enter"==u.key)&&(u.preventDefault(),(this._trnMainService.TrnMainObj.VoucherType===e.Km.DeliveryReturn||this._trnMainService.TrnMainObj.VoucherType==e.Km.ProductionEntry)&&this.checkValidation(a))}checkValidation(u){console.log("hello validations");var a=this._trnMainService.TrnMainObj.ProdList[u];if(null!=a){if(null==a.MCODE)return this._trnMainService.TrnMainObj.ProdList.splice(u,0),this.alertService.warning("Please select a Product"),!1;if(this._trnMainService.TrnMainObj.VoucherType==e.Km.TaxInvoice&&0==a.ALTERNATEQUANTIY)return this.alertService.warning(`Qty Is Not Specified For The Item ${a.ITEMDESC} (${a.MENUCODE}) Please Check Your Entry.`),!1;if("Non-Discountable"==this._trnMainService.TrnMainObj.ProdList[u].DISMODE&&this._trnMainService.TrnMainObj.VoucherType in e.Sl)return this.alertService.warning("Selected Item is not discountable."),this._trnMainService.TrnMainObj.ProdList[u].INDDISCOUNTRATE=0,this._trnMainService.TrnMainObj.ProdList[u].INDDISCOUNT=0,!1}if(this._trnMainService.TrnMainObj.VoucherType===e.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===e.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===e.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType==e.Km.TaxInvoice&&"self-billing"!=this.activeurlpath){if(2==this.userSetting.EnableBatch)var E=this.masterService.groupBy(this._trnMainService.TrnMainObj.ProdList,function(x){return[x.MCODE,x.RATE,x.BC,x.BATCH,x.CRATE]});else E=this.masterService.groupBy(this._trnMainService.TrnMainObj.ProdList,function(O){return[O.MCODE,O.RATE,O.BC,O.BATCH]});for(const x of E)if(x.length>1)return this.alertService.warning("Cannot enter same Item with same rate "),!1}if(this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===e.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType===e.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===e.Km.ProductionEntry){let x=this._trnMainService.TrnMainObj.ProdList.filter(O=>1==O.REQEXPDATE&&0==this._trnMainService.nullToZeroConverter(O.EXPDATE))[0];if(null!=x&&1!=this.userSetting.ENABLESINGLEBATCHMODE)return this.alertService.info(`EXP date is required for item:${x.ITEMDESC}`),!1}if("superdistributor"===this._trnMainService.userProfile.CompanyInfo.ORG_TYPE&&this._trnMainService.TrnMainObj.VoucherType===e.Km.PurchaseOrder&&"IMPORT_PURCHASE_ORDER"!=this._trnMainService.TrnMainObj.AdditionalObj.tag&&null!=this._trnMainService.TrnMainObj.ProdList[u].SELECTEDITEM&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[u].Quantity)+this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[u].STOCK)>this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[u].SELECTEDITEM.MAXLEVEL))return this.alertService.info("You can not Order more than maximum stock assign to you..."),document.getElementById("quantity"+u).focus(),!1;if((this._trnMainService.TrnMainObj.VoucherType===e.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===e.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice)&&0==this.userSetting.ENABLESINGLEBATCHMODE&&this._trnMainService.TrnMainObj.ProdList[u].Quantity>this._trnMainService.TrnMainObj.ProdList[u].STOCK&&"EDIT"!==this._trnMainService.TrnMainObj.ProdList[u].rowMode?.toUpperCase()&&this._trnMainService.TrnMainObj.ProdList[u].STOCK>0&&9!=this._trnMainService.TrnMainObj.ProdList[u].PTYPE&&this._trnMainService.TrnMainObj.ProdList[u].PTYPE<10)return this.alertService.error("Quantity Exceed the available Stock."),void document.getElementById("basequantity"+this.activerowIndex).focus();this._trnMainService.TrnMainObj.VoucherType==e.Km.RequisitionApproval?this._trnMainService.CalculateApprovalBill():(this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.calculateTradingNontradingTotalinDebitNote());let y=u+1;const P=document.getElementById("ITEMDESC"+y);!this._trnMainService.TrnMainObj.ProdList.some(x=>null==x.MCODE)&&(!P||""===P.value.trim())&&(console.log("reachsales order"),!1===this._trnMainService.addRow())||(1==this.userSetting.GblBarcodeWiseBilling?(console.log("GBLbarcodewisebilling = 1 "),this._trnMainService.TrnMainObj.VoucherType===e.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===e.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType===e.Km.ProductionEntry||this._trnMainService.TrnMainObj.VoucherType===e.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===e.Km.OpeningStockBalance?setTimeout(()=>{null!=document.getElementById("BC"+y)?(console.log("rn1"),document.getElementById("BC"+y).focus()):document.getElementById("ITEMDESC"+y).focus()},50):setTimeout(()=>{null!=document.getElementById("ITEMDESC"+y)&&document.getElementById("ITEMDESC"+y).focus()},50)):(console.log("GBLbarcodewisebilling = 0 "),setTimeout(()=>{null!=document.getElementById("ITEMDESC"+y)&&document.getElementById("ITEMDESC"+y).focus()},50)))}onHoverRate(u){this.rateHoverId=u,this.stringValue=this.productHelperService.hoverRate(u,this._trnMainService.TrnMainObj.ProdList[u])}onHover(u){this.hoverId=u,this._trnMainService.TrnMainObj.ProdList[u].TotalDiscountDescription=this.productHelperService.hoverDiscount(u,this._trnMainService.TrnMainObj.ProdList[u]),this.stringValue=this.productHelperService.hoverDiscount(u,this._trnMainService.TrnMainObj.ProdList[u])}onHoverCode(u){this.codeHoverId=u;let a=this._trnMainService.TrnMainObj.ProdList[u];console.log("prodlist ma k aaucha",this._trnMainService.TrnMainObj.ProdList[u]),a.TotalDiscountDescription=this.productHelperService.hoverCode(u,this._trnMainService.TrnMainObj.ProdList[u]),this.stringValue=this.productHelperService.hoverCode(u,this._trnMainService.TrnMainObj.ProdList[u])}getPreviousBatchList(){this.checkBatchWiseRate()}BatchEnter(u,a,E,y){let P=this._trnMainService.TrnMainObj.VoucherType;if(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].VRATE=u.LANDINGCOST,2==this.userSetting.EnableBatch&&0==this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].EnableAutoBatch)&&P in e.Bv&&this._trnMainService.checkBatchInSystem(this.activerowIndex),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BC||this.checkBatchWiseRate(),null!=document.getElementById("alternateunit"+this.activerowIndex)&&"variant-adjustment"!==this.activeurlpath&&setTimeout(()=>{document.getElementById("alternateunit"+this.activerowIndex).focus()},20),this._trnMainService.TrnMainObj.VoucherType==e.Km.BatchAdjustment||"variant-adjustment"==this.activeurlpath){this.batchlist=[];let O=this._trnMainService.TrnMainObj.ProdList[E].MCODE,j=this.masterService.userProfile.userWarehouse;O&&this.masterService.getItemWiseBatch(O,j).subscribe(D=>{"ok"==D.status&&(this.batchlist=D.result.filter(U=>U.STOCK>0),this.batchlist?(setTimeout(()=>{document.getElementById("sourcebatch"+this.activerowIndex).blur(),document.getElementById("sourcebc"+this.activerowIndex).blur()},200),this.showBatchPopup=!0,setTimeout(()=>{this.masterService.focusAnyControl("filter")},200)):this.alertService.info("There are no batch assigned for this item"))})}this.showBatchWiseDetail=!0;let x={isFocusAchieved:!1};return this.focusService.autoFocus(E,document.getElementById("BATCH"+E),x,"productEntrySetting.tableId"),x.isFocusAchieved||this.checkValidation(E),!1}onKeyDownBatch(u,a){this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===e.Km.OpeningStockBalance||"NewBill"===this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE||this._trnMainService.TrnMainObj.VoucherType===e.Km.GoodsReceived||"Enter"===u.key||"Tab"===u.key||u.preventDefault()}expDateEnterEvent(u,a,E){return this._trnMainService.TrnMainObj.VoucherType==e.Km.ProductionEntry&&1==this.userSetting.EnableOnetoOneProduction||this.checkValidation(a)||this.masterService.focusAnyControl("REMARKS"+a),!1}CommentEnterEvent(u){this._trnMainService.TrnMainObj.VoucherType===e.Km.RequisitionEntry&&this.checkValidation(u)}MFGDateEnterEvent(u,a,E){return document.getElementById("expdate"+this.activerowIndex).focus(),!1}RecalculateMRP(){this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].SPRICE=1==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ISVAT?this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MRP/1.13:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MRP}onTabMRP(u,a){u.preventDefault(),this.RecalculateMRP(),document.getElementById("SPRICE"+a).focus()}RecalculateSPRICE(){this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MRP=1==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ISVAT?1.13*this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].SPRICE:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].SPRICE}onTabSPRICE(u,a){u.preventDefault(),null!=document.getElementById("VSRATE"+this.activerowIndex)?document.getElementById("VSRATE"+this.activerowIndex).focus():0==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].REQEXPDATE?this.checkValidation(a):document.getElementById("mfgdate"+a).focus()}RecalculateVSRATE(){this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].VPRATE=(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ISVAT=1)?this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].VSRATE/1.13:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].VSRATE}onTabVSRATE(u){u.preventDefault(),this.RecalculateSPRICE(),document.getElementById("VPRATE"+this.activerowIndex).focus()}RecalculateVPRATE(){this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].VSRATE=1.13*this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].VPRATE}onTabVPRATE(u,a){u.preventDefault(),this.RecalculateSPRICE(),0==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].REQEXPDATE?this.checkValidation(a):document.getElementById("mfgdate"+a).focus()}isReadOnly(u,a){return this._trnMainService.TrnMainObj.VoucherType!==e.Km.TaxInvoice&&this._trnMainService.TrnMainObj.VoucherType!==e.Km.Sales&&57!=this._trnMainService.TrnMainObj.VoucherType&&this._trnMainService.TrnMainObj.VoucherType!=e.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!==e.Km.DeliveryChalan?(this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===e.Km.GoodsReceived)&&(this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.FLATDCAMNT)>0||this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.DCRATE)>0)&&(this._trnMainService.disableProd=!1,!0):"Non-Discountable"===a?.DISMODE||void 0}NonProductPopupSelectEvent(u=new Function){u(),this.genericGrid.show()}useFulLifeEnter(u,a,E){this._trnMainService.initializeAssetProdlist(),setTimeout(()=>{document.getElementById("ITEMDESC"+(this.activerowIndex+1))&&document.getElementById("ITEMDESC"+(this.activerowIndex+1)).focus()})}isVatableInRow(u,a,E,y){this._trnMainService.TrnMainObj.ProdList[E].ISVAT=u.target.checked?1:0,this._trnMainService.ReCalculateBillWithNormal()}CommentEnterEventBranchIn(u){if(this._trnMainService.TrnMainObj.VoucherType===e.Km.BranchTransferIn){this.checkValidation(u);let a=u+1;setTimeout(()=>{null!=document.getElementById("OPQTY"+a)&&document.getElementById("OPQTY"+a).focus()},50)}}getDuplicates(){let u=new Set,a=[];for(let E of this._trnMainService.TrnMainObj.ProdList){let y=E.ITEMDESC;u.has(y)?a.push(E):u.add(y)}return a}EXPDATEEnterClicked(u,a,E){let y=a+1;console.log("grn navigation gets here.....",y,this._trnMainService.TrnMainObj.DOFULLRETURN,document.getElementById("BC"+y)),(1!=this._trnMainService.TrnMainObj.DOFULLRETURN||!this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("PO"))&&null==document.getElementById("BC"+y)&&this._trnMainService.addRow(),setTimeout(()=>{this.focusNext(a)},10)}navigationUsingFocusService(u,a,E){let y=u+1;document.getElementById("ITEMDESC"+y);let x={isFocusAchieved:!1};this.focusService.autoFocus(u,document.getElementById(a+u),x,E),x.isFocusAchieved||this.focusService.autoFocus(y,document.getElementById("BC"+y),{},E)}}return g.\u0275fac=function(u){return new(u||g)(t.LFG(V.p),t.LFG(p.P),t.LFG(F.c),t.LFG(Q.T),t.LFG(L.gz),t.LFG(I.h),t.LFG(m.i))},g.\u0275prov=t.Yz7({token:g,factory:g.\u0275fac}),g})()},33159:(z,Z,M)=>{M.d(Z,{Z:()=>ai});var t=M(92752),e=M(66274),s=M(42326),h=M(32711),V=M(64752),p=M(27009);let F=(()=>{class d{constructor(i){this.template=i}}return d.\u0275fac=function(i){return new(i||d)(e.Y36(e.Rgc))},d.\u0275dir=e.lG2({type:d,selectors:[["","appCtrlTemplate",""]],inputs:{name:["appCtrlTemplate","name"]}}),d})();var Q=M(53074),L=M(87584),I=M(48083),m=M(53181),S=M(14970),g=M(67297),R=M(7782),u=M(74263),a=M(67311),E=M(94534),y=M(11192),P=M(60694),x=M(48063),O=M(33612),j=M(8630),D=M(28698),U=M(94619),W=M(87454),$=M(88762),N=M(7587),k=M(37051),b=M(64657),w=M(71800),c=M(77398);let _=(()=>{class d{constructor(i,n,r,o,C,B){this.alertService=i,this.masterService=n,this.productEntryService=r,this.arouter=o,this._trnMainService=C,this.genericProductService=B,this.ItemkeyEvent=new e.vpe,this.dblClickPopupItem=new e.vpe,this.activerowIndex=0,this.showBarCodeDetail=!1,this.loadFromBarcode=!1,this.showStockedQuantityOnly=0,this.userSetting=this._trnMainService.userSetting,this.userProfile=this._trnMainService.userProfile,this.activeurlpath=o.snapshot.url[0].path,this._trnMainService=r._trnMainService,this._trnMainService.activeurlpath=this.genericProductService.activeurlpath}disablePipe(i,n){let r="";return i.disablePipe&&(r=i.disablePipe(i,n)),r}ItemBarCodeClick(i,n){if(this.eventparam=n,this.activerowIndex=i,this._trnMainService.TrnMainObj.VoucherType!=s.Km.ProductionEntry||this._trnMainService.TrnMainObj.BILLTO){if(!this._trnMainService.TrnMainObj.ProdList[i].BC&&(this._trnMainService.TrnMainObj.VoucherType===s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===s.Km.GoodsReceived)&&"NEW"!==this._trnMainService.TrnMainObj.Mode.toUpperCase())return this.showBarCodeDetail=!0,this.productWiseBarCode=this._trnMainService.TrnMainObj.ProdList[i].ProductDetails,this._trnMainService.TrnMainObj.ProdList[i].visible=!0,this.productEntryService.getProductColorMcodeWise(),!1;if(this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote&&"PI"===this._trnMainService.TrnMainObj.REFBILL.substring(0,2).toUpperCase())return this.showBarCodeDetail=!0,this.productWiseBarCode=this._trnMainService.TrnMainObj.ProdList[i].ProductDetails,this._trnMainService.TrnMainObj.ProdList[i].visible=!0,this.productEntryService.getProductColorMcodeWise(),!1;if(("VIEW"===this._trnMainService.TrnMainObj.Mode||"EDIT"===this._trnMainService.TrnMainObj.Mode)&&6===this._trnMainService.TrnMainObj.ProdList[i].Ptype&&(this.productEntryService.getProductColorMcodeWise(),this.showBarCodeDetail=!0),void 0===this._trnMainService.TrnMainObj.ProdList[i].BC||null==this._trnMainService.TrnMainObj.ProdList[i].BC||""==this._trnMainService.TrnMainObj.ProdList[i].BC)1==this._trnMainService.TrnMainObj.ProdList[i].isBarcodeOfPtypeSix&&(this._trnMainService.TrnMainObj.ProdList[i].isBarcodeOfPtypeSix=!1,setTimeout(()=>{console.log("k1"),this._trnMainService.TrnMainObj.ProdList[i]={}},0)),null!=document.getElementById("itemDesc"+i)&&setTimeout(()=>{document.getElementById("itemDesc"+i).focus()},50);else{if(this._trnMainService.hideProductDescriptionPopUp=!0,this._trnMainService.TrnMainObj.VoucherType!==s.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!==s.Km.SalesReturn){let r=this._trnMainService.TrnMainObj.ProdList.filter(C=>C.BC==this._trnMainService.TrnMainObj.ProdList[i].BC);if(null!=r&&r?.length>1)return this.alertService.info(`Duplicate barcode:${this._trnMainService.TrnMainObj.ProdList[i].BC} is detected.`),void this.alertService.emitShowHideSubject.subscribe(C=>{setTimeout(()=>{document.getElementById("barcode"+i).focus()},0)});this._trnMainService.TrnMainObj.ProdList.filter(C=>6==C.PTYPE).forEach(C=>C.ProductDetails?.forEach(B=>{if(B.IEMI1==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BC)return this.alertService.info(`Duplicte IMEI1 :${B.IEMI1} is found on Bulk Entry Grid`),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BC=null,!1}))}this._trnMainService.TrnMainObj.ProdList[i].BC&&(this._trnMainService.CheckIfSalesReturn()?this._trnMainService.checkBarcodeForSalesReturn(this._trnMainService.TrnMainObj.ProdList[i].BC,this._trnMainService.TrnMainObj.REFBILL).subscribe(r=>{"ok"==r.status?(this._trnMainService.ReturnStockObj=r.result,this.loadBarcodeWiseProductList(r.result.TotalStock)):(this.alertService.info(r.result),this.alertService.emitShowHideSubject.subscribe(o=>{setTimeout(()=>{document.getElementById("barcode"+i).focus()},0)}))},r=>{this.alertService.info(r.result)}):this._trnMainService.checkBarcode(this._trnMainService.TrnMainObj.ProdList[i].BC,this._trnMainService.TrnMainObj.MWAREHOUSE).subscribe(r=>{"ok"==r.status?this.loadBarcodeWiseProductList():this.alertService.info(r.result)},r=>{this.alertService.info(r.result)}))}}else this.alertService.info("Please select Production warehouse")}loadBarcodeWiseProductList(i=0){this.loadFromBarcode=!1;let r=[];this.masterService.masterGetmethod(`/getMenuitemBarCodeWise?showstockqty=${this.showStockedQuantityOnly}&prefix=${this._trnMainService.TrnMainObj.VoucherPrefix}&barcode=${this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BC}&warehouse=${this._trnMainService.userProfile.userWarehouse}`).subscribe(C=>{if("ok"===C.status)if(r=C.result.data,0===r.length)this.alertService.info("Product is out of Stock ");else if(1===r.length){this.loadFromBarcode=!0;var B=r[0];if(this._trnMainService.CheckIfSalesReturn()){B.STOCK=i;var Y=0;for(let oe of this._trnMainService.TrnMainObj.ProdList)oe.BC==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BC&&(Y+=oe.ALTERNATEQUANTIY);if(B.STOCK<Y)return void this.alertService.warning("Quantity exceed the actual Barcode stock!")}if(this.dblClickPopupItem.emit(B),this.loadFromBarcode=!1,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].VARIANTDESCA="",B.barcodeDetails){var H=JSON.parse(B.barcodeDetails);for(var te in console.log("varDetail",H),H)this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].VARIANTDESCA+=`<b>${te}</b>:${H[te]} &nbsp;`}}else this.ItemkeyEvent.emit(this.eventparam);else this.alertService.info(C.result.error)})}ItemBarCodeFoucusOut(i,n){this.productEntryService.barcodeDisplay=!1}ItemBarCodeClickFocusIn(i,n){this.productEntryService.barcodeDisplay=!0}}return d.\u0275fac=function(i){return new(i||d)(e.Y36(a.c),e.Y36(Q.P),e.Y36(E.w),e.Y36(I.gz),e.Y36(L.p),e.Y36(E.w))},d.\u0275cmp=e.Xpm({type:d,selectors:[["barcodeBox"]],inputs:{i:["index","i"],col:"col",trnprod:"trnprod"},outputs:{ItemkeyEvent:"ItemkeyEvent",dblClickPopupItem:"dblClickPopupItem"},decls:2,vars:8,consts:[["type","text",2,"width","100%",3,"id","ngModel","disabled","ngModelChange","keydown.Tab","change","keydown.enter","focusout","focus"]],template:function(i,n){1&i&&(e.TgZ(0,"input",0),e.NdJ("ngModelChange",function(o){return n.trnprod[n.col.field]=o})("keydown.Tab",function(o){return n.ItemBarCodeClick(n.i,o)})("change",function(o){return n.ItemBarCodeClick(n.i,o)})("keydown.enter",function(o){return n.ItemBarCodeClick(n.i,o)})("focusout",function(o){return n.ItemBarCodeFoucusOut(n.i,o)})("focus",function(o){return n.ItemBarCodeClickFocusIn(n.i,o)}),e.ALo(1,"disable"),e.qZA()),2&i&&(e.Q6J("id",n.col.field+n.i)("ngModel",n.trnprod[n.col.field])("disabled",e.Dn7(1,4,n.disablePipe(n.col,n.i),n.i,n._trnMainService.callPipe)),e.uIk("disabled",!0))},dependencies:[N.Fj,N.JJ,N.On,c.e],encapsulation:2}),d})();function l(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"input",3),e.NdJ("change",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o.onChangeAllocation(r))}),e.qZA()}}let v=(()=>{class d{constructor(i,n,r,o,C,B){this.alertService=i,this.genericProductService=n,this.responseMsgService=r,this.arouter=o,this.dialog=C,this.productHelper=B,this.showGenericGrid=new e.vpe,this.dialogueOpen=new e.vpe,this._trnMainService=n._trnMainService,this.prodlist=this._trnMainService.TrnMainObj.ProdList,this._trnMainService.activeurlpath=this.genericProductService.activeurlpath}onClicked(){this._trnMainService.inputCode=!0}ngOnInit(){this.showAllocationCheckBox$=this.productHelper.forceAllocation$}disablePipe(i,n){var r="";return i.disablePipe&&(r=i.disablePipe(i,n)),r}checkDiscount(){if(this._trnMainService.TrnMainObj.VoucherType===s.Km.Purchase&&(this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT)>0||this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.DCRATE)>0))return this.alertService.info("Flat Discount is already given could not add new product"),!0}checkSelfBilling(){return!("self-billing"!==this._trnMainService.activeurlpath||(""==this._trnMainService.TrnMainObj.MWAREHOUSE?(this.alertService.warning("Please select an unsalable warehouse!"),this.alertService.emitShowHideSubject.subscribe(i=>{this.genericProductService.masterService.ShowMore=!0,setTimeout(()=>{document.getElementById("warehouseId").focus()},100)}),0):""==this._trnMainService.TrnMainObj.TRNACName||null==this._trnMainService.TrnMainObj.TRNACName?(this.alertService.warning("Please select an Account Name!"),0):""==this._trnMainService.TrnMainObj.TRNACName||null==this._trnMainService.TrnMainObj.TRNACName?(this.alertService.warning("Please select an Account Before self billing!"),0):""==this._trnMainService.TrnMainObj.REMARKS||null==this._trnMainService.TrnMainObj.REMARKS?(this.alertService.warning("Remarks is mandatory!"),this.alertService.emitShowHideSubject.subscribe(i=>{this.genericProductService.masterService.ShowMore=!0,setTimeout(()=>{document.getElementById("remarksid").focus()},100)}),0):(console.log("Check Tna",this._trnMainService.TrnMainObj.TRNACName,this._trnMainService.TrnMainObj.REMARKS),this.genericProductService.showStockedQuantityOnly=0,0)))}onChangeAllocation(i){const n={showOrHideAllocationPopup:!1,index:this.i};i.target.checked?(console.log("Hello"),n.showOrHideAllocationPopup=!0,this.productHelper.showOrHideAllocationPopup(n)):this.productHelper.showOrHideAllocationPopup(n)}checkBarcodeSetting(){this._trnMainService.TrnMainObj.VoucherType===s.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.SalesOrder||this._trnMainService.TrnMainObj.VoucherType===s.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===s.Km.Repack||this._trnMainService.TrnMainObj.VoucherType===s.Km.Quotation?(this.genericProductService.showStockedQuantityOnly=1,this.genericProductService.loadBarCodeWiseProduct=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].BARCODE??""):this.genericProductService.showStockedQuantityOnly=0}checkRefOrderBill(){if(1==this.genericProductService.genericProductEntrySetting.checkRefOrderBill){let i=this.responseMsgService.getProperMessageForRefBill(this._trnMainService.TrnMainObj);return this.alertService.info(i),!1}if(this._trnMainService.TrnMainObj.VoucherType===s.Km.CreditNote&&1!==this._trnMainService.TrnMainObj.DONONSALEABLERETURN&&0==this.genericProductService.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote&&1===this.genericProductService.userSetting.REFBILLCOMPULSORINDNOTE||this._trnMainService.TrnMainObj.VoucherType===s.Km.Purchase&&0!==this.genericProductService.userSetting.PODELIVERYMODE&&"purchase-import"!==this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType===s.Km.GoodsReceived&&0!==this.genericProductService.userSetting.PODELIVERYMODE||this._trnMainService.TrnMainObj.VoucherType===s.Km.SalesOrder&&this._trnMainService.TrnMainObj.REFORDBILL&&0!==this.genericProductService.userSetting.ENABLE_QUOTATTION_INSO||this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice&&0!==this.genericProductService.userSetting.ENABLE_SOINTI&&1==this.genericProductService.userSetting.SOREFERENCE_REQUIRED||this._trnMainService.TrnMainObj.VoucherType===s.Km.BranchTransferOut&&1===this._trnMainService.TrnMainObj.ISLOADFROMORDER||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue&&1===this._trnMainService.TrnMainObj.ISLOADFROMORDER){if(!this._trnMainService.TrnMainObj.REFORDBILL){let i=this.responseMsgService.getProperMessageForRefBill(this._trnMainService.TrnMainObj);return this.alertService.info(i),!1}if(null==this._trnMainService.TrnMainObj.REFBILL||""==this._trnMainService.TrnMainObj.REFBILL)return!1}}setGridPopupApi(){var i=this.setPrefix(),n=this.setBarcode(),r=this.setWarehouse();switch(this.genericProductService.gridPopupSettings.apiEndpoints=`/getMenuitemWithStockPagedList/${this.genericProductService.showStockedQuantityOnly}/${n}/all/${i}/${r}`,this._trnMainService.TrnMainObj.VoucherType){case s.Km.CreditNote:if(1!==this._trnMainService.TrnMainObj.DONONSALEABLERETURN&&0==this.genericProductService.userSetting.ENABLEMANUALSALESRETURN){this.genericProductService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList";break}"NewBill"===this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE&&(i=this.setPrefix(),n=this.setBarcode(),r=this.setWarehouse(),this.genericProductService.gridPopupSettings.apiEndpoints=`/getMenuitemWithStockPagedList/${this.genericProductService.showStockedQuantityOnly}/all/PI/${r}`);break;case s.Km.DebitNote:1===this.genericProductService.userSetting.REFBILLCOMPULSORINDNOTE&&(this.genericProductService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList");break;case s.Km.Purchase:if(0!==this.genericProductService.userSetting.PODELIVERYMODE&&"purchase-import"!==this._trnMainService.activeurlpath){this.genericProductService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList";break}"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag&&0!=this.genericProductService.userSetting.IMPORTPOBILLMODE&&(this.genericProductService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList");break;case s.Km.GoodsReceived:0!==this.genericProductService.userSetting.PODELIVERYMODE&&(this.genericProductService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList");break;case s.Km.SalesOrder:this._trnMainService.TrnMainObj.REFORDBILL&&0!==this.genericProductService.userSetting.ENABLE_QUOTATTION_INSO&&(this.genericProductService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList");break;case s.Km.TaxInvoice:0!==this.genericProductService.userSetting.ENABLE_SOINTI&&1==this.genericProductService.userSetting.SOREFERENCE_REQUIRED&&(this.genericProductService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList");break;case s.Km.BranchTransferIn:1===this._trnMainService.TrnMainObj.ISLOADFROMORDER&&(this.genericProductService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList");break;case s.Km.StockIssue:1===this._trnMainService.TrnMainObj.ISLOADFROMORDER&&(this.genericProductService.gridPopupSettings.apiEndpoints="/getMenuitemFromProdForReturnPagedList");case s.Km.StockIssueReturn:this.genericProductService.gridPopupSettings.apiEndpoints=`/getMenuitemFromProdForIssueReturnPagedList/${this._trnMainService.TrnMainObj.BILLTO}`;case s.Km.ProductionEntry:if("EDIT"==this._trnMainService.TrnMainObj.Mode)break;default:if("add-membership-sales-invoice"==this._trnMainService.activeurlpath){this.genericProductService.gridPopupSettings.apiEndpoints="/getMenuItemListForMembershipSales";break}i=this.setPrefix(),n=this.setBarcode(),r=this.setWarehouse(),this.genericProductService.gridPopupSettings.apiEndpoints=`/getMenuitemWithStockPagedList/${this.genericProductService.showStockedQuantityOnly}/${n}/all/${i}/${r}`}}dialougeOpen(){console.log("dialouge open ProductDetails",this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ProductDetails),this._trnMainService.currentIndexProductDetails=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ProductDetails,this.dialog.open(p.H,{hasBackdrop:!0,autoFocus:!1,data:{type:this._trnMainService.TrnMainObj.VoucherPrefix,mode:this._trnMainService.TrnMainObj.Mode,warehouse:this._trnMainService.TrnMainObj.MWAREHOUSE,message:this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex],curretnIndexPrevDetials:this._trnMainService.currentIndexProductDetails,productList:this._trnMainService.TrnMainObj.ProdList}}).afterClosed().subscribe(r=>{this.productLists=this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote?r?.data:r&&r.data&&r.data.productColorList?r.data.productColorList:[],this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ProductDetails=this.productLists,this._trnMainService.currentIndexProductDetails=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ProductDetails,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ALTERNATEQUANTIY=this.productLists?this.productLists.length:0,(this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===s.Km.GoodsReceived)&&this._trnMainService.calculateNetRATE(this.genericProductService.activerowIndex),setTimeout(()=>{if(0==this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ALTERNATEQUANTIY){if(this._trnMainService.TrnMainObj.VoucherType==s.Km.TaxInvoice)return void this.alertService.warning(`Zero Quantity Detected for Item ${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ITEMDESC} (${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MENUCODE}). Please Check Your Entry.`)}else document.getElementById("rate"+this.genericProductService.activerowIndex).focus()},20)})}displayProductDetailInViewMode(i){console.log("eventlog",i),"VIEW"==this._trnMainService.TrnMainObj.Mode.toUpperCase()&&"F9"==i.code&&this.dialougeOpen()}setPrefix(){let i="";return"self-billing"===this._trnMainService.activeurlpath?i="SB":null!=this._trnMainService.TrnMainObj.VoucherPrefix&&(i=this._trnMainService.TrnMainObj.VoucherPrefix),i}setWarehouse(){let i="";if(i=this._trnMainService.TrnMainObj.MWAREHOUSE?this._trnMainService.TrnMainObj.MWAREHOUSE:this._trnMainService.userProfile.userWarehouse,this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue&&(i=this._trnMainService.TrnMainObj.BILLTO,null==this._trnMainService.TrnMainObj.BILLTO))return this.alertService.info("Please select From Warehouse before selecting an item "),"";if(this._trnMainService.TrnMainObj.VoucherType===s.Km.RequisitionEntry&&(null==this._trnMainService.TrnMainObj.MWAREHOUSE||""==this._trnMainService.TrnMainObj.MWAREHOUSE))return this.alertService.info("Please select Warehouse before selecting item"),"";if(this._trnMainService.TrnMainObj.VoucherType==s.Km.ProductionEntry){if(!this._trnMainService.TrnMainObj.BILLTO)return this.alertService.info("Please select Production warehouse"),"";i=this._trnMainService.TrnMainObj.BILLTO}return i}checkExchangeRate(){if(1==this.genericProductService.genericProductEntrySetting.multiCurrency||this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag||this._trnMainService.TrnMainObj.VoucherType==s.Km.PurchaseOrder&&"IMPORT_PURCHASE_ORDER"==this._trnMainService.TrnMainObj.AdditionalObj.tag||this._trnMainService.TrnMainObj.VoucherType==s.Km.GoodsReceived&&"GOODS_RECEIVED_NOTE_IMPORT"==this._trnMainService.TrnMainObj.AdditionalObj.tag){if(null==this._trnMainService.TrnMainObj.BILLTO||void 0===this._trnMainService.TrnMainObj.BILLTO||""==this._trnMainService.TrnMainObj.BILLTO)return this.alertService.info("Please Choose Supplier to Proceed..."),!1;if(!this._trnMainService.TrnMainObj.EXRATE)return this.alertService.info("Please choose exchange rate to proceed or exchange rate cannot be zero..."),!1}return!0}setBarcode(){console.log({prodlist:this._trnMainService.TrnMainObj.ProdList,activeRowIndex:this.genericProductService.activerowIndex});let i=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex]?.BC;return(0==this.genericProductService.userSetting.GblBarcodeWiseBilling||null==i||void 0===i||""==i)&&(i="A"),i}ItemkeyEvent(i,n){n.preventDefault(),this.showGenericGrid.emit({event:n,index:i,genericGrid:null})}ItemkeyEvent_old(i,n){if(n.preventDefault(),this.genericProductService.setItemPopupUrl(),this._trnMainService.currentIndexProductDetails=[],1!=this.checkDiscount()){if("VIEW"==this._trnMainService.TrnMainObj.Mode.toUpperCase())return this.displayProductDetailInViewMode(n),void console.log({view:!0});if(1!=this.checkSelfBilling())if(this.checkBarcodeSetting(),0!=this.checkRefOrderBill()){if(this.setGridPopupApi(),0!=this.checkExchangeRate())return this._trnMainService.itemselectevent=!0,this.showGenericGrid.emit(this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==s.Km.StockIssueReturn||this._trnMainService.TrnMainObj.VoucherType==s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType==s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==s.Km.SalesOrder||"FROMPO"==this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE||"FROMSO"==this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE||"FROMIMPORTPO"==this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE?this._trnMainService.TrnMainObj.REFORDBILL:this._trnMainService.TrnMainObj.REFBILL),!1;console.log({checkExchangeRate:!1})}else console.log({checkRefOrderBill:!1});else console.log({chekcSelfBilling:!0})}else console.log({checkDiscount:!0})}}return d.\u0275fac=function(i){return new(i||d)(e.Y36(a.c),e.Y36(E.w),e.Y36(P.T),e.Y36(I.gz),e.Y36(m.uw),e.Y36(x.h))},d.\u0275cmp=e.Xpm({type:d,selectors:[["itemDescInputBox"]],inputs:{trnprod:"trnprod",col:"col",i:["index","i"]},outputs:{showGenericGrid:"showGenericGrid",dialogueOpen:"dialogueOpen"},decls:6,vars:11,consts:[["type","text","autocomplete","off","placeholder","Press ENTER to Select",2,"width","100%",3,"id","readonly","ngModel","disabled","ngModelChange","keydown.enter","click"],["contenteditable","false",1,"CellComment"],["type","checkbox","class","allocation-for-new",3,"change",4,"ngIf"],["type","checkbox",1,"allocation-for-new",3,"change"]],template:function(i,n){1&i&&(e.TgZ(0,"input",0),e.NdJ("ngModelChange",function(o){return n.trnprod[n.col.field]=o})("keydown.enter",function(o){return n.ItemkeyEvent(n.i,o),n.genericProductService.displayProductDetailInViewMode(o)})("click",function(){return n.onClicked()}),e.ALo(1,"disable"),e.qZA(),e.TgZ(2,"span",1),e._uU(3,"Press ENTER to Select Item"),e.qZA(),e.YNc(4,l,1,0,"input",2),e.ALo(5,"async")),2&i&&(e.Q6J("id",n.col.field+n.i)("readonly",!0)("ngModel",n.trnprod[n.col.field])("disabled",e.Dn7(1,5,n.disablePipe(n.col,n.i),n.i,n._trnMainService.callPipe)),e.xp6(4),e.Q6J("ngIf",e.lcZ(5,9,n.showAllocationCheckBox$)))},dependencies:[t.O5,N.Fj,N.JJ,N.On,t.Ov,c.e],styles:[".allocation-for-new[_ngcontent-%COMP%]{position:absolute;border:1px solid #cbcbcb!important;height:23px!important;border-radius:3px;width:auto!important;right:1rem}"]}),d})();function T(d,f){if(1&d&&(e.ynx(0),e.TgZ(1,"option",2),e._uU(2),e.qZA(),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.s9C("value",i.ALTUNIT),e.xp6(1),e.Oqu(i.ALTUNIT)}}let A=(()=>{class d{constructor(i,n,r,o,C){this.alertService=i,this.genericProductService=n,this.responseMsgService=r,this.arouter=o,this.dialog=C,this.showGenericGrid=new e.vpe,this.dialogueOpen=new e.vpe,this._trnMainService=n._trnMainService,this.prodlist=this._trnMainService.TrnMainObj.ProdList,this.prod=this.prodlist[this.i],this._trnMainService.activeurlpath=this.genericProductService.activeurlpath}onFocus(){}disablePipe(i,n){var r="";return i.disablePipe&&(r=i.disablePipe(i,n)),r}SelectUnit(i){this._trnMainService.TrnMainObj.ProdList[i].DiscountOnAltUnit=!1,this._trnMainService.TrnMainObj.ProdList[i].ALTERNATEQUANTIY=0,this._trnMainService.TrnMainObj.ProdList[i].CRATE=0;let n=this._trnMainService.TrnMainObj.ProdList[i].Product.AlternateUnits.find(r=>r.ALTUNIT==this._trnMainService.TrnMainObj.ProdList[i].ALTUNIT);this._trnMainService.TrnMainObj.ProdList[i].StopDecimal=n.StopDecimal,this._trnMainService.TrnMainObj.ProdList[i].ALTUNIT==this._trnMainService.TrnMainObj.ProdList[i].BASEUNIT?(this._trnMainService.TrnMainObj.ProdList[i].ALTRATE=this._trnMainService.TrnMainObj.ProdList[i].RATE,this._trnMainService.TrnMainObj.ProdList[i].ALTCONFACTOR=1,this._trnMainService.TrnMainObj.ProdList[i].INDDISCOUNTRATE=0):(this._trnMainService.TrnMainObj.ProdList[i].ALTCONFACTOR=n.CONFACTOR,this._trnMainService.TrnMainObj.ProdList[i].ALTRATE=this._trnMainService.TrnMainObj.ProdList[i].RATE*this._trnMainService.TrnMainObj.ProdList[i].ALTCONFACTOR,this._trnMainService.ReCalculateBillWithNormal()),this._trnMainService.TrnMainObj.VoucherType==s.Km.DeliveryChalan&&this.applyDiscountOnUnitChangeOnSales(n,i),this._trnMainService.ReCalculateBillWithNormal()}applyDiscountOnUnitChangeOnSales(i,n){1==this.genericProductService.userSetting.EnableAltUnitDiscOnRate?(console.log("unit4"),this._trnMainService.TrnMainObj.ProdList[n].ALTRATE=this._trnMainService.TrnMainObj.ProdList[n].ALTRATE-this._trnMainService.TrnMainObj.ProdList[n].ALTRATE*(i.SRATE_DISCOUNT/100),this._trnMainService.TrnMainObj.ProdList[n].RATE=this._trnMainService.TrnMainObj.ProdList[n].ALTRATE):this._trnMainService.TrnMainObj.ProdList[n].INDDISCOUNTRATE=1==this.genericProductService.userSetting.EnableDiscountInAltUnit?i.WSRATE_DISCOUNT:i.SRATE_DISCOUNT}onKeyDown(i,n,r,o){if(console.log({trnprod:o,col:n,i:r,event:i}),"Enter"===i.key)console.log({tofocus:n.focusTo+r}),this.genericProductService.focusByElementId(n.focusTo+r),n.onEnter&&n.onEnter(o,r,n,i);else if("Tab"==i.key){if(1==i.shiftKey)return;this.genericProductService.focusByElementId(n.focusTo+r)}}}return d.\u0275fac=function(i){return new(i||d)(e.Y36(a.c),e.Y36(E.w),e.Y36(P.T),e.Y36(I.gz),e.Y36(m.uw))},d.\u0275cmp=e.Xpm({type:d,selectors:[["unitSelectionInputBox"]],inputs:{trnprod:"trnprod",col:"col",i:["index","i"]},outputs:{showGenericGrid:"showGenericGrid",dialogueOpen:"dialogueOpen"},decls:3,vars:8,consts:[["type","text",2,"width","100%",3,"id","ngModel","disabled","ngModelChange","change","keydown.enter","keydown.tab"],[4,"ngFor","ngForOf"],[3,"value"]],template:function(i,n){1&i&&(e.TgZ(0,"select",0),e.NdJ("ngModelChange",function(o){return n.trnprod[n.col.field]=o})("change",function(){return n.SelectUnit(n.i)})("keydown.enter",function(o){return n.onKeyDown(o,n.col,n.i,n.trnprod)})("keydown.tab",function(o){return n.onKeyDown(o,n.col,n.i,n.trnprod)}),e.ALo(1,"disable"),e.YNc(2,T,3,2,"ng-container",1),e.qZA()),2&i&&(e.Q6J("id",n.col.field+n.i)("ngModel",n.trnprod[n.col.field])("disabled",e.Dn7(1,4,n.disablePipe(n.col,n.i),n.i,n._trnMainService.callPipe)),e.xp6(2),e.Q6J("ngForOf",null==n.trnprod.Product?null:n.trnprod.Product.AlternateUnits))},dependencies:[t.sg,N.YN,N.Kr,N.EJ,N.JJ,N.On,c.e],styles:["select[_ngcontent-%COMP%]:disabled{opacity:1}"]}),d})();var K=M(91772),q=M(90994),G=M(89952);const J=function(d,f,i,n){return{green:d,red:f,yellow:i,brown:n}};let ie=(()=>{class d{constructor(i,n,r){this.genericProductService=i,this.quantityChangeService=n,this.masterService=r,this._trnMainService=this.genericProductService._trnMainService,this._userSetting=this.genericProductService.userSetting,this._trnMainService.activeurlpath=this.genericProductService.activeurlpath,this.userSetting=this.genericProductService.userSetting}disablePipe(i,n){let r="";return i.disablePipe&&(r=i.disablePipe(i,n)),r}class(i,n,r){if(i.class)return i.class(i,n,r)}onKeyDown(i,n,r,o){"Enter"!==i.key&&"Tab"!=i.key||(i.preventDefault(),console.log({tofocus:n.focusTo+r}),this.genericProductService.focusByElementId(n.focusTo+r),!n.onKeyPress||this.addNextRow(r))}okKeyPress(i,n,r,o){n.onKeyPress&&n.onKeyPress(i,n,r,o)}onChange(i,n,r,o){n.onChange&&n.onChange(i,n,r,o)}onFocusOut(i,n,r,o){n.onFocusOut&&n.onFocusOut(i,n,r,o)}addNextRow(i){if(this.quantityChangeService.AlternateQuantityEventClick(i),this._trnMainService.TrnMainObj.VoucherType==s.Km.ProductionEntry)return!0;const n=this.masterService.userProfile.userRights.find(r=>"AllowRateChangeInSO"==r.right);return this._trnMainService.TrnMainObj.VoucherType==s.Km.DeliveryReturn||0==n?.value||1==this.masterService.userSetting.EnableBatchWisePrice||1===this._trnMainService.TrnMainObj.ProdList[i].HASBATCH}}return d.\u0275fac=function(i){return new(i||d)(e.Y36(E.w),e.Y36(K.s),e.Y36(Q.P))},d.\u0275cmp=e.Xpm({type:d,selectors:[["quantityInputBox"]],inputs:{trnprod:"trnprod",col:"col",i:["index","i"]},decls:3,vars:19,consts:[["type","number","autocomplete","off",3,"id","ngStyle","ngModel","disabled","placeholder","OnlyWholeNumber","decimalPlacesRestriction","ngClass","ngModelChange","keydown.enter","keydown.tab","keypress","keydown.arrowup","keydown.arrowdown","change","focusout"]],template:function(i,n){1&i&&(e.TgZ(0,"input",0),e.NdJ("ngModelChange",function(o){return n.trnprod[n.col.field]=o})("keydown.enter",function(o){return n.onKeyDown(o,n.col,n.i,n.trnprod)})("keydown.tab",function(o){return n.onKeyDown(o,n.col,n.i,n.trnprod)})("keypress",function(o){return n.okKeyPress(o,n.col,n.i,n.trnprod)})("keydown.arrowup",function(){return 1!==(null==n.trnprod?null:n.trnprod.NATURETYPE)})("keydown.arrowdown",function(){return 1!==(null==n.trnprod?null:n.trnprod.NATURETYPE)})("change",function(o){return n.onChange(o,n.col,n.i,n.trnprod)})("focusout",function(o){return n.onFocusOut(o,n.col,n.i,n.trnprod)}),e.ALo(1,"twoDigitNumber"),e.ALo(2,"disable"),e.qZA()),2&i&&e.Q6J("id",n.col.field+n.i)("ngStyle",n.col.columnNgStyle)("ngModel",n.col.applyTwoDigitPipe?e.lcZ(1,8,n.trnprod[n.col.field]):n.trnprod[n.col.field])("disabled",e.Dn7(2,10,n.disablePipe(n.col,n.i),n.i,n._trnMainService.callPipe))("placeholder",n.col.placeholder||"")("OnlyWholeNumber",1==n.trnprod.StopDecimal)("decimalPlacesRestriction",n.col.decimalPlacesRestriction?n.col.decimalPlacesRestriction:null)("ngClass",e.l5B(14,J,"green"==n.class(n.col,n.i,n.trnprod),"red"==n.class(n.col,n.i,n.trnprod),"yellow"==n.class(n.col,n.i,n.trnprod),"brown"==n.class(n.col,n.i,n.trnprod)))},dependencies:[t.mk,t.PC,N.Fj,N.wV,N.JJ,N.On,q.r,b.F,G.g,c.e],styles:[".dynamicStyle[_ngcontent-%COMP%]{background-color:#cef8ff}.green[_ngcontent-%COMP%]{background-color:#26ef01}.red[_ngcontent-%COMP%]{background-color:#ff4141}.yellow[_ngcontent-%COMP%]{background-color:#ff0}.brown[_ngcontent-%COMP%]{background-color:#9602c7;color:#fff}"]}),d})();function _e(d,f){if(1&d&&(e.ynx(0),e.TgZ(1,"option",2),e._uU(2),e.qZA(),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.s9C("value",i.LocID),e.xp6(1),e.Oqu(i.Name)}}let Me=(()=>{class d{constructor(i,n,r,o,C){this.alertService=i,this.genericProductService=n,this.responseMsgService=r,this.arouter=o,this.dialog=C,this.showGenericGrid=new e.vpe,this.dialogueOpen=new e.vpe,this._trnMainService=n._trnMainService,this.prodlist=this._trnMainService.TrnMainObj.ProdList,this.prod=this.prodlist[this.i],this._trnMainService.activeurlpath=this.genericProductService.activeurlpath}onFocus(){}disablePipe(i,n){var r="";return i.disablePipe&&(r=i.disablePipe(i,n)),r}onKeyDown(i,n,r,o){if("Enter"===i.key)this.genericProductService.focusByElementId(n.focusTo+r),n.onEnter&&n.onEnter(o,r,n,i);else if("Tab"==i.key){if(1==i.shiftKey)return;this.genericProductService.focusByElementId(n.focusTo+r)}}}return d.\u0275fac=function(i){return new(i||d)(e.Y36(a.c),e.Y36(E.w),e.Y36(P.T),e.Y36(I.gz),e.Y36(m.uw))},d.\u0275cmp=e.Xpm({type:d,selectors:[["locationSelectionInputBox"]],inputs:{trnprod:"trnprod",col:"col",i:["index","i"]},outputs:{showGenericGrid:"showGenericGrid",dialogueOpen:"dialogueOpen"},decls:4,vars:8,consts:[["type","text",2,"width","100%",3,"id","ngModel","disabled","ngModelChange","keydown.enter"],[4,"ngFor","ngForOf"],[3,"value"]],template:function(i,n){1&i&&(e.TgZ(0,"select",0),e.NdJ("ngModelChange",function(o){return n.trnprod[n.col.field]=o})("keydown.enter",function(o){return n.onKeyDown(o,n.col,n.i,n.trnprod)}),e.ALo(1,"disable"),e._UZ(2,"option"),e.YNc(3,_e,3,2,"ng-container",1),e.qZA()),2&i&&(e.Q6J("id",n.col.field+n.i)("ngModel",n.trnprod[n.col.field])("disabled",e.Dn7(1,4,n.disablePipe(n.col,n.i),n.i,n._trnMainService.callPipe)),e.xp6(3),e.Q6J("ngForOf",n._trnMainService.TrnMainObj.LOCATIONLIST))},dependencies:[t.sg,N.YN,N.Kr,N.EJ,N.JJ,N.On,c.e],encapsulation:2}),d})();var Te=M(84260),Se=M(63688);let ve=(()=>{class d{transform(i,n){return"red"==i?{backgroundColor:"#FF4141 !important",color:"white !important"}:"green"==i?{backgroundColor:"#26EF01 !important",color:"white !important"}:"yellow"==i?{backgroundColor:"#ECEC10 !important",color:"white !important"}:"purple"==i?{backgroundColor:"#9602C7 !important",color:"white !important"}:void 0}}return d.\u0275fac=function(i){return new(i||d)},d.\u0275pipe=e.Yjl({name:"color",type:d,pure:!0}),d})(),pe=(()=>{class d{transform(i,n){return this.getTemplate(i,n)}getTemplate(i,n){if(!n)return;let r=n.toArray().find(o=>o.name.toLowerCase()==i?.toLowerCase())?.template;return r||(r=n.toArray().find(o=>"default"==o.name.toLowerCase()).template),r}}return d.\u0275fac=function(i){return new(i||d)},d.\u0275pipe=e.Yjl({name:"inputColumnType",type:d,pure:!0}),d})();const Ee=["table1"],Oe=["table2"],ge=["genericGrid"],me=["rateValidatoin"],Pe=["genericGridPopupComponent"],fe=["barCodeGridPopup"],be=["genericGridMulitplePricePopup"],Ie=["matrixitemgrid"],ye=["authenticationPopup"],Ce=["itemDesc"];function Ae(d,f){if(1&d&&(e.TgZ(0,"th",52),e._uU(1),e.qZA()),2&d){const i=e.oxw().$implicit;e.Q6J("ngStyle",i.headerNgStyle),e.uIk("colspan",i.colspan)("rowspan",i.rowspan),e.xp6(1),e.hij(" ",i.header," ")}}function Le(d,f){if(1&d&&(e.ynx(0),e.YNc(1,Ae,2,4,"th",51),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",!i.hidden)}}function Re(d,f){if(1&d&&(e.TgZ(0,"th",52),e._uU(1),e.qZA()),2&d){const i=e.oxw().$implicit;e.Q6J("ngStyle",i.headerNgStyle),e.uIk("colspan",i.colspan)("rowspan",i.rowspan),e.xp6(1),e.hij(" ",i.header," ")}}function De(d,f){if(1&d&&(e.ynx(0),e.YNc(1,Re,2,4,"th",51),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",!i.hidden)}}function je(d,f){if(1&d&&(e.ynx(0),e.TgZ(1,"th",54),e._uU(2),e.qZA(),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngStyle",i.headerNgStyle),e.xp6(1),e.Oqu(i.header)}}function xe(d,f){if(1&d&&(e.ynx(0),e.YNc(1,je,3,2,"ng-container",5),e.BQk()),2&d){const i=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",i.subHeader)}}function Ne(d,f){if(1&d&&(e.ynx(0),e.YNc(1,xe,2,1,"ng-container",9),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",i.showSubHeading)}}function we(d,f){if(1&d&&(e.TgZ(0,"tr",53),e.YNc(1,Ne,2,1,"ng-container",5),e.qZA()),2&d){const i=e.oxw();e.xp6(1),e.Q6J("ngForOf",i.genericProductEntrySetting.columns)}}const ne=function(d,f,i){return{index:d,col:f,trnprod:i}};function Be(d,f){if(1&d&&(e.TgZ(0,"td",57),e.GkF(1,58),e.ALo(2,"inputColumnType"),e.qZA()),2&d){const i=e.oxw().$implicit,n=e.oxw(),r=n.index,o=n.$implicit,C=e.oxw();e.xp6(1),e.Q6J("ngTemplateOutlet",e.xi3(2,2,i.inputType,C.templateRefs))("ngTemplateOutletContext",e.kEZ(5,ne,r,i,o))}}function Ue(d,f){if(1&d&&(e.ynx(0),e.YNc(1,Be,3,9,"td",56),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",!i.hidden&&!i.showSubHeading)}}const se=function(){return{"background-color":"#cef8ff"}};function Ke(d,f){if(1&d&&(e.ynx(0),e.TgZ(1,"td",59),e.GkF(2,58),e.ALo(3,"inputColumnType"),e.qZA(),e.BQk()),2&d){const i=e.oxw().$implicit,n=e.oxw().$implicit,r=e.oxw().index,o=e.oxw();e.xp6(1),e.Q6J("ngStyle",n.Request>0&&"VIEW"!=o._trnMainService.TrnMainObj.Mode?e.DdM(6,se):null),e.xp6(1),e.Q6J("ngTemplateOutlet",e.xi3(3,3,i.inputType,o.templateRefs))("ngTemplateOutletContext",e.kEZ(7,ne,r,i,n))}}function Ve(d,f){if(1&d&&(e.ynx(0),e.YNc(1,Ke,4,11,"ng-container",9),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",i.showSubHeading)}}function ke(d,f){if(1&d&&(e.ynx(0),e.YNc(1,Ve,2,1,"ng-container",5),e.BQk()),2&d){const i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",null==i.genericProductService.subHeader[0]?null:i.genericProductService.subHeader[0].subHeader)}}function Fe(d,f){if(1&d&&(e.TgZ(0,"td",57),e.GkF(1,58),e.ALo(2,"inputColumnType"),e.qZA()),2&d){const i=e.oxw().$implicit,n=e.oxw(),r=n.index,o=n.$implicit,C=e.oxw();e.xp6(1),e.Q6J("ngTemplateOutlet",e.xi3(2,2,i.inputType,C.templateRefs))("ngTemplateOutletContext",e.kEZ(5,ne,r,i,o))}}function Qe(d,f){if(1&d&&(e.ynx(0),e.YNc(1,Fe,3,9,"td",60),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",!i.hidden&&!i.showSubHeading)}}function Ge(d,f){if(1&d){const i=e.EpF();e.ynx(0),e.TgZ(1,"tr",55),e.NdJ("click",function(){const o=e.CHM(i).index,C=e.oxw();return e.KtG(C.RowClick(o))})("keydown.Shift.delete",function(){const o=e.CHM(i).index,C=e.oxw();return e.KtG(C.deleteRow(o))}),e.YNc(2,Ue,2,1,"ng-container",5),e.YNc(3,ke,2,1,"ng-container",5),e.YNc(4,Qe,2,1,"ng-container",5),e.qZA(),e.BQk()}if(2&d){const i=f.$implicit,n=f.index,r=e.oxw();e.xp6(1),e.ekj("selected",r.isTableRowSelected(n))("highlighted",n+1==r.highlightBarCodeWiseRow())("bgforlessstockitem",r.highlightLessStockItem(n))("less-quantity",null==i?null:i.showRed),e.MGl("id","productEntrySetting.tableId_",n,""),e.xp6(1),e.Q6J("ngForOf",r.genericProductEntrySetting.columns),e.xp6(1),e.Q6J("ngForOf",i.BranchWiseDistributionList1),e.xp6(1),e.Q6J("ngForOf",null==r.genericProductService?null:r.genericProductService.headerAfterSubHeader)}}function We(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"span",61),e.NdJ("click",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.addRowInsert())}),e.TgZ(1,"p"),e._uU(2,"+"),e.qZA()()}}function Ze(d,f){if(1&d&&(e.TgZ(0,"th",52),e._uU(1),e.qZA()),2&d){const i=e.oxw().$implicit;e.Q6J("ngStyle",i.headerNgStyle),e.uIk("colspan",i.colspan)("rowspan",i.rowspan),e.xp6(1),e.hij(" ",i.header," ")}}function Ye(d,f){if(1&d&&(e.ynx(0),e.YNc(1,Ze,2,4,"th",51),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",!i.hidden)}}function He(d,f){if(1&d&&(e.TgZ(0,"th",52),e._uU(1),e.qZA()),2&d){const i=e.oxw().$implicit;e.Q6J("ngStyle",i.headerNgStyle),e.uIk("colspan",i.colspan)("rowspan",i.rowspan),e.xp6(1),e.hij(" ",i.header," ")}}function Je(d,f){if(1&d&&(e.ynx(0),e.YNc(1,He,2,4,"th",51),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",!i.hidden)}}function $e(d,f){if(1&d&&(e.ynx(0),e.TgZ(1,"th",54),e._uU(2),e.qZA(),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngStyle",i.headerNgStyle),e.xp6(1),e.Oqu(i.header)}}function qe(d,f){if(1&d&&(e.ynx(0),e.YNc(1,$e,3,2,"ng-container",5),e.BQk()),2&d){const i=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",i.subHeader)}}function Xe(d,f){if(1&d&&(e.ynx(0),e.YNc(1,qe,2,1,"ng-container",9),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",i.showSubHeading)}}function ze(d,f){if(1&d&&(e.TgZ(0,"tr",53),e.YNc(1,Xe,2,1,"ng-container",5),e.qZA()),2&d){const i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",null==i.genericProductEntrySetting2?null:i.genericProductEntrySetting2.columns)}}function et(d,f){if(1&d&&(e.TgZ(0,"td",57),e.GkF(1,58),e.ALo(2,"inputColumnType"),e.qZA()),2&d){const i=e.oxw().$implicit,n=e.oxw(),r=n.index,o=n.$implicit,C=e.oxw(2);e.xp6(1),e.Q6J("ngTemplateOutlet",e.xi3(2,2,i.inputType,C.templateRefs))("ngTemplateOutletContext",e.kEZ(5,ne,r,i,o))}}function tt(d,f){if(1&d&&(e.ynx(0),e.YNc(1,et,3,9,"td",56),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",!i.hidden&&!i.showSubHeading)}}function it(d,f){if(1&d&&(e.ynx(0),e.TgZ(1,"td",59),e.GkF(2,58),e.ALo(3,"inputColumnType"),e.qZA(),e.BQk()),2&d){const i=e.oxw().$implicit,n=e.oxw().$implicit,r=e.oxw().index,o=e.oxw(2);e.xp6(1),e.Q6J("ngStyle",n.Request>0&&"VIEW"!=o._trnMainService.TrnMainObj.Mode?e.DdM(6,se):null),e.xp6(1),e.Q6J("ngTemplateOutlet",e.xi3(3,3,i.inputType,o.templateRefs))("ngTemplateOutletContext",e.kEZ(7,ne,r,i,n))}}function nt(d,f){if(1&d&&(e.ynx(0),e.YNc(1,it,4,11,"ng-container",9),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",i.showSubHeading)}}function rt(d,f){if(1&d&&(e.ynx(0),e.YNc(1,nt,2,1,"ng-container",5),e.BQk()),2&d){const i=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",null==i.genericProductService.subHeader2[0]?null:i.genericProductService.subHeader2[0].subHeader)}}function ot(d,f){if(1&d&&(e.TgZ(0,"td",57),e.GkF(1,58),e.ALo(2,"inputColumnType"),e.qZA()),2&d){const i=e.oxw().$implicit,n=e.oxw(),r=n.index,o=n.$implicit,C=e.oxw(2);e.xp6(1),e.Q6J("ngTemplateOutlet",e.xi3(2,2,i.inputType,C.templateRefs))("ngTemplateOutletContext",e.kEZ(5,ne,r,i,o))}}function ct(d,f){if(1&d&&(e.ynx(0),e.YNc(1,ot,3,9,"td",60),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.Q6J("ngIf",!i.hidden&&!i.showSubHeading)}}function at(d,f){if(1&d){const i=e.EpF();e.ynx(0),e.TgZ(1,"tr",55),e.NdJ("click",function(){const o=e.CHM(i).index,C=e.oxw(2);return e.KtG(C.RowClick(o))})("keydown.Shift.delete",function(){const o=e.CHM(i).index,C=e.oxw(2);return e.KtG(C.deleteRow(o))}),e.YNc(2,tt,2,1,"ng-container",5),e.YNc(3,rt,2,1,"ng-container",5),e.YNc(4,ct,2,1,"ng-container",5),e.qZA(),e.BQk()}if(2&d){const i=f.$implicit,n=f.index,r=e.oxw(2);e.xp6(1),e.ekj("selected",r.isTableRowSelected(n))("highlighted",n+1==r.highlightBarCodeWiseRow())("bgforlessstockitem",r.highlightLessStockItem(n)),e.MGl("id","productEntrySetting.tableId_",n,""),e.xp6(1),e.Q6J("ngForOf",null==r.genericProductEntrySetting2?null:r.genericProductEntrySetting2.columns),e.xp6(1),e.Q6J("ngForOf",i.BranchWiseDistributionList2),e.xp6(1),e.Q6J("ngForOf",null==r.genericProductService?null:r.genericProductService.headerAfterSubHeader2)}}function st(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"span",61),e.NdJ("click",function(){e.CHM(i);const r=e.oxw(2);return e.KtG(r.addRowInsert())}),e.TgZ(1,"p"),e._uU(2,"+"),e.qZA()()}}const le=function(d){return{scrollable:d}};function lt(d,f){if(1&d){const i=e.EpF();e.ynx(0),e.TgZ(1,"div",62,63),e.NdJ("scroll",function(r){e.CHM(i),e.oxw();const o=e.MAs(2);return e.KtG(o.nativeElement.scrollTop=r.target.scrollTop)}),e.TgZ(3,"table",3)(4,"tr",4),e.YNc(5,Ye,2,1,"ng-container",5),e.YNc(6,Je,2,1,"ng-container",5),e.qZA(),e.YNc(7,ze,2,1,"tr",64),e.TgZ(8,"tbody",7),e.YNc(9,at,5,10,"ng-container",5),e.qZA()(),e.YNc(10,st,3,0,"span",8),e.ALo(11,"hide"),e.qZA(),e.BQk()}if(2&d){const i=e.oxw();e.xp6(1),e.Udp("height",null==i.genericProductEntrySetting2?null:i.genericProductEntrySetting2.height),e.xp6(2),e.Q6J("ngClass",e.VKq(11,le,i.scrollable())),e.xp6(2),e.Q6J("ngForOf",null==i.genericProductEntrySetting2?null:i.genericProductEntrySetting2.columns),e.xp6(1),e.Q6J("ngForOf",null==i.genericProductService?null:i.genericProductService.headerAfterSubHeader2),e.xp6(1),e.Q6J("ngIf",null==i.genericProductEntrySetting2?null:i.genericProductEntrySetting2.showSubHeading),e.xp6(2),e.Q6J("ngForOf",null==i._trnMainService||null==i._trnMainService.TrnMainObj?null:i._trnMainService.TrnMainObj.ProdList),e.xp6(1),e.Q6J("ngIf",e.xi3(11,8,"hideAddButton",i._trnMainService.callPipe)&&"VIEW"!=i._trnMainService.TrnMainObj.Mode&&(null==i.genericProductEntrySetting2?null:i.genericProductEntrySetting2.columns))}}function ht(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"barcodeBox",65),e.NdJ("ItemKeyEvent",function(r){const C=e.CHM(i).index,B=e.oxw();return e.KtG(B.ItemKeyEvent(C,r))})("dblClickPopupItem",function(r){const C=e.CHM(i).index,B=e.oxw();return e.KtG(B.dblClickPopupItem(C,r))}),e.qZA()}if(2&d){const i=f.index,n=f.trnprod,r=f.col;e.Q6J("i",r.field+i)("index",i)("col",r)("trnprod",n)}}function ut(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"barcodeInputBox",66),e.NdJ("ItemKeyEvent",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o.ItemKeyEvent(o.i,r))})("dblClickPopupItem",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o.dblClickPopupItem(o.i,r))}),e.qZA(),e.TgZ(1,"input",67),e.NdJ("keydown.Tab",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o.ItemBarCodeClick(o.i,r))})("change",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o.ItemBarCodeClick(o.i,r))})("keydown.enter",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o.ItemBarCodeClick(o.i,r))})("focusout",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o.ItemBarCodeFoucusOut(o.i,r))}),e.ALo(2,"disable"),e.qZA()}if(2&d){const i=e.oxw();e.Q6J("i",i.col.field+i.i),e.xp6(1),e.Q6J("i",i.col.field+i.i)("disabled",e.Dn7(2,3,i.disablePipe(i.col,i.i),i.i,i._trnMainService.callPipe))}}function dt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"input",72),e.NdJ("ngModelChange",function(r){e.CHM(i);const o=e.oxw(2);return e.KtG(o.trnprod[o.col.checkboxField]=r)})("change",function(r){e.CHM(i);const o=e.oxw(2),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onCheckBoxChange(r,C,B,Y))}),e.qZA()}if(2&d){const i=e.oxw(2),n=i.trnprod,r=i.col,o=e.oxw();e.Q6J("ngModel",n[r.checkboxField])("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)}}const _t=function(d){return{"position-static":d}};function Mt(d,f){if(1&d&&(e.ynx(0,46),e.TgZ(1,"span",69),e._uU(2),e.qZA(),e.TgZ(3,"span",70),e.YNc(4,dt,1,2,"input",71),e.qZA(),e.BQk()),2&d){const i=e.oxw(),n=i.index,r=i.col,o=e.oxw();e.xp6(1),e.Q6J("ngClass",e.VKq(3,_t,!o.userSetting.IsBBSM)),e.xp6(1),e.Oqu(n+1),e.xp6(2),e.Q6J("ngIf",r.checkbox)}}const he=function(d){return{tooltipChild:d}};function Tt(d,f){if(1&d&&(e.ynx(0),e._UZ(1,"span",74),e.BQk()),2&d){const i=e.oxw(2).index,n=e.oxw();e.xp6(1),e.Q6J("ngClass",e.VKq(2,he,n.genericProductService.hoverId==i))("innerHTML",n.genericProductService.stringValue,e.oJD)}}function St(d,f){if(1&d&&(e.ynx(0),e._UZ(1,"span",74),e.BQk()),2&d){const i=e.oxw(2).index,n=e.oxw();e.xp6(1),e.Q6J("ngClass",e.VKq(2,he,n.genericProductService.codeHoverId==i))("innerHTML",n.genericProductService.stringValue,e.oJD)}}function vt(d,f){if(1&d){const i=e.EpF();e.ynx(0),e.TgZ(1,"div",73),e.NdJ("mouseover",function(r){e.CHM(i);const o=e.oxw(),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.hoverDiscount(r,C,B,Y)||H.hoverDescription(r,C,B,Y))})("mouseleave",function(){e.CHM(i);const r=e.oxw(2);return e.KtG(r.hoverLeaveDiscount()||r.hoverLeaveDescription())}),e._uU(2),e.ALo(3,"twoDigitNumber"),e.YNc(4,Tt,2,4,"ng-container",9),e.YNc(5,St,2,4,"ng-container",9),e.qZA(),e.BQk()}if(2&d){const i=e.oxw(),n=i.col,r=i.index,o=i.trnprod;e.xp6(1),e.Q6J("ngStyle",n.columnNgStyle)("id",n.field+r),e.xp6(1),e.hij(" ",n.applyTwoDigitPipe?e.lcZ(3,5,o[n.field]):o[n.field]," "),e.xp6(2),e.Q6J("ngIf",o[n.field]>0&&n.displayOnHover),e.xp6(1),e.Q6J("ngIf",o[n.field]>0&&n.displayOnHoverCode)}}function pt(d,f){if(1&d){const i=e.EpF();e.ynx(0),e.TgZ(1,"button",77),e.NdJ("click",function(){e.CHM(i);const r=e.oxw(2).index,o=e.oxw();return e.KtG(o.deleteRow(r))}),e.ALo(2,"disable"),e._UZ(3,"img",78),e.qZA(),e.BQk()}if(2&d){const i=e.oxw(2),n=i.col,r=i.index,o=e.oxw();e.xp6(1),e.Q6J("disabled",e.Dn7(2,1,o.disablePipe(n,r),r,o._trnMainService.callPipe)||"VIEW"==o._trnMainService.TrnMainObj.Mode&&("asset-purchase-invoice"!==o._trnMainService.activeurlpath||"assets-openingstockentry"!==o._trnMainService.activeurlpath)||21==o._trnMainService.TrnMainObj.VoucherType&&1==o._trnMainService.TrnMainObj.DOFULLRETURN||null!=o._trnMainService.TrnMainObj.FLATDCAMNT&&0!=o._trnMainService.TrnMainObj.FLATDCAMNT||null!=o._trnMainService.TrnMainObj.DCRATE&&0!=o._trnMainService.TrnMainObj.DCRATE)}}function Et(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"button",79),e.NdJ("click",function(){e.CHM(i);const r=e.oxw(2).trnprod,o=e.oxw();return e.KtG(o.onViewClick(r))}),e._UZ(1,"i",80),e.qZA()}}function Ot(d,f){if(1&d&&(e.ynx(0),e.TgZ(1,"div",54),e.YNc(2,pt,4,5,"ng-container",75),e.YNc(3,Et,2,0,"ng-template",null,76,e.W1O),e.qZA(),e.BQk()),2&d){const i=e.MAs(4),n=e.oxw().col,r=e.oxw();e.xp6(1),e.Q6J("ngStyle",n.columnNgStyle),e.xp6(1),e.Q6J("ngIf",r.showDeleteButton())("ngIfElse",i)}}function gt(d,f){if(1&d&&(e.YNc(0,Mt,5,5,"ng-container",68),e.YNc(1,vt,6,7,"ng-container",9),e.YNc(2,Ot,5,3,"ng-container",9)),2&d){const i=f.col;e.Q6J("ngIf",i.isSno),e.xp6(1),e.Q6J("ngIf",!i.isSno),e.xp6(1),e.Q6J("ngIf",i.removeButton)}}function mt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"itemDescInputBox",81),e.NdJ("showGenericGrid",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o.showGenericGrid(r))}),e.qZA(),e.ynx(1),e._UZ(2,"br")(3,"span",82),e.BQk()}if(2&d){const i=f.index,n=f.col,r=f.trnprod;e.Q6J("trnprod",r)("index",i)("col",n),e.xp6(3),e.Q6J("innerHtml",r.VARIANTDESCA,e.oJD)}}function Pt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"input",83),e.NdJ("ngModelChange",function(r){const o=e.CHM(i);return e.KtG(o.trnprod[o.col.field]=r)})("keydown.enter",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onEnter(r,C,B,Y))})("keydown.Tab",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onEnter(r,C,B,Y))}),e.ALo(1,"disable"),e.qZA()}if(2&d){const i=f.index,n=f.col,r=f.trnprod,o=e.oxw();e.Q6J("id",n.field+i)("ngModel",r[n.field])("disabled",e.Dn7(1,4,o.disablePipe(n,i),i,o._trnMainService.callPipe))("readonly",!0)}}function ft(d,f){if(1&d&&e._UZ(0,"unitSelectionInputBox",84),2&d){const i=f.index,n=f.col,r=f.trnprod;e.Q6J("i",n.field+i)("index",i)("col",n)("trnprod",r)}}function bt(d,f){if(1&d&&e._UZ(0,"locationSelectionInputBox",84),2&d){const i=f.index,n=f.col,r=f.trnprod;e.Q6J("i",n.field+i)("index",i)("col",n)("trnprod",r)}}function It(d,f){if(1&d&&e._UZ(0,"defaultSelectionInputBox",84),2&d){const i=f.index,n=f.col,r=f.trnprod;e.Q6J("i",n.field+i)("index",i)("col",n)("trnprod",r)}}function yt(d,f){if(1&d&&e._UZ(0,"quantityInputBox",84),2&d){const i=f.index,n=f.col,r=f.trnprod;e.Q6J("i",n.field+i)("index",i)("col",n)("trnprod",r)}}function Ct(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"input",85),e.NdJ("ngModelChange",function(r){const o=e.CHM(i);return e.KtG(o.trnprod[o.col.field]=r)})("click",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.onClicked())})("keydown.enter",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onKeyDown(r,C,B,Y))})("keydown.tab",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onKeyDown(r,C,B,Y))})("change",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=e.oxw();return e.KtG(Y.onChange(r,C,B))}),e.ALo(1,"twoDigitNumber"),e.ALo(2,"disable"),e.qZA()}if(2&d){const i=f.index,n=f.col,r=f.trnprod,o=e.oxw();e.Q6J("id",n.field+i)("ngStyle",n.columnNgStyle)("ngModel",n.applyTwoDigitPipe?e.lcZ(1,5,r[n.field]):r[n.field])("placeholder",n.placeholder||"")("disabled",e.Dn7(2,7,o.disablePipe(n,i),i,o._trnMainService.callPipe)||"VIEW"==r.rowMode)}}function At(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"input",86),e.NdJ("keydown.enter",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onItemSelection(r,C,B,Y))}),e.ALo(1,"disable"),e.qZA()}if(2&d){const i=f.index,n=f.col,r=f.trnprod,o=e.oxw();e.Q6J("id",n.field+i)("ngModel",r[n.field])("placeholder",n.placeholder||"")("disabled",e.Dn7(1,4,o.disablePipe(n,i),i,o._trnMainService.callPipe)||"VIEW"==r.rowMode)}}function Lt(d,f){if(1&d&&(e.ynx(0),e.TgZ(1,"option",88),e._uU(2),e.qZA(),e.BQk()),2&d){const i=f.$implicit;e.xp6(1),e.s9C("value",i.name),e.xp6(1),e.hij(" ",i.name,"")}}function Rt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"select",87),e.NdJ("ngModelChange",function(r){const o=e.CHM(i);return e.KtG(o.trnprod[o.col.field]=r)})("change",function(){const o=e.CHM(i).index,C=e.oxw();return e.KtG(C.SelectUnit(o))})("keydown.enter",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onKeyDown(r,C,B,Y))})("keydown.tab",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onKeyDown(r,C,B,Y))}),e.ALo(1,"disable"),e.YNc(2,Lt,3,2,"ng-container",5),e.qZA()}if(2&d){const i=f.index,n=f.col,r=f.trnprod,o=e.oxw();e.Q6J("id",n.field+i)("ngModel",r[n.field])("disabled",e.Dn7(1,4,o.disablePipe(n,i),i,o._trnMainService.callPipe)),e.xp6(2),e.Q6J("ngForOf",o.selectComments)}}const Dt=function(d){return{tooltipChildRate:d}};function jt(d,f){if(1&d&&(e.ynx(0),e._UZ(1,"span",74),e.BQk()),2&d){const i=e.oxw().index,n=e.oxw();e.xp6(1),e.Q6J("ngClass",e.VKq(2,Dt,n.genericProductService.rateHoverId==i))("innerHTML",n.genericProductService.stringValue,e.oJD)}}function xt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"input",89),e.NdJ("change",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onChange(r,C,B,Y))})("keydown.enter",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onKeyDown(r,C,B,Y))})("keydown.tab",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onKeyDown(r,C,B,Y))})("ngModelChange",function(r){const o=e.CHM(i),C=o.trnprod,B=o.col,Y=o.index,H=e.oxw();return C[B.field]=r,e.KtG(H.onModelChange(r,B,Y,C))})("keyup",function(r){const C=e.CHM(i).col,B=e.oxw();return e.KtG(B.rateChange(r,C))})("focusout",function(r){const C=e.CHM(i).col,B=e.oxw();return e.KtG(B.rateFocusOut(r,C))})("mouseover",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.hoverRate(r,C,B,Y))})("mouseleave",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.hoverLeaveRate())}),e.ALo(1,"color"),e.ALo(2,"color"),e.ALo(3,"threeDigitNumber"),e.ALo(4,"twoDigitNumber"),e.ALo(5,"disable"),e.qZA(),e.YNc(6,jt,2,4,"ng-container",9)}if(2&d){const i=f.index,n=f.col,r=f.trnprod,o=e.oxw();let C,B;e.Udp("background-color",null==(C=e.lcZ(1,11,o.colorPipe(n,r,i)))?null:C.backgroundColor)("color",null==(B=e.lcZ(2,13,o.colorPipe(n,r,i)))?null:B.color),e.Q6J("id",n.field+i)("ngStyle",n.columnNgStyle)("ngModel",n.applyTwoDigitPipe||n.applyThreeDigitPipe?n.applyThreeDigitPipe?e.lcZ(3,15,r[n.field]):e.lcZ(4,17,r[n.field]):r[n.field])("disabled",e.Dn7(5,19,o.disablePipe(n,i),i,o._trnMainService.callPipe))("decimalPlacesRestriction",n.decimalPlacesRestriction?n.decimalPlacesRestriction:null)("readonly",o.isReadOnly(n,i,r)),e.xp6(6),e.Q6J("ngIf",r[n.field]>0&&n.displayOnHoverRate)}}function Nt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"input",90),e.NdJ("ngModelChange",function(r){const o=e.CHM(i);return e.KtG(o.trnprod[o.col.field]=r)})("ngModelChange",function(r){const o=e.CHM(i),C=o.trnprod,B=o.col,Y=o.index,H=e.oxw();return C[B.field]=r,e.KtG(H.onModelChange(r,B,Y,C))})("keydown.enter",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onKeyDown(r,C,B,Y))})("keydown.tab",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onKeyDown(r,C,B,Y))}),e.ALo(1,"disable"),e.qZA()}if(2&d){const i=f.index,n=f.col,r=f.trnprod,o=e.oxw();e.s9C("type",o.mfgExpDateType),e.Q6J("id",n.field+i)("ngStyle",n.columnNgStyle)("ngModel",r[n.field])("disabled",e.Dn7(1,6,o.disablePipe(n,i),i,o._trnMainService.callPipe))("min","EXPDATE"==n.field?o.currDate:null)}}function wt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"input",91),e.NdJ("ngModelChange",function(r){const o=e.CHM(i);return e.KtG(o.trnprod[o.col.field]=r)})("click",function(r){const o=e.CHM(i),C=o.col,B=o.index,Y=o.trnprod,H=e.oxw();return e.KtG(H.onClicked(r,C,B,Y))})("change",function(r){const o=e.CHM(i);return e.KtG(o.trnprod[o.col.field]=r.target.checked?1:0)}),e.ALo(1,"twoDigitNumber"),e.ALo(2,"disable"),e.qZA()}if(2&d){const i=f.index,n=f.col,r=f.trnprod,o=e.oxw();e.Q6J("id",n.field+i)("ngStyle",n.columnNgStyle)("ngModel",n.applyTwoDigitPipe?e.lcZ(1,4,r[n.field]):r[n.field])("disabled",e.Dn7(2,6,o.disablePipe(n,i),i,o._trnMainService.callPipe)||"VIEW"==r.rowMode)}}function Bt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"create-manual-batch-popup",92),e.NdJ("closeBatchPopupEvent",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.toggleCreateBatch())})("emitCreatedBatchEvent",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o.emittedBatch(r))}),e.qZA()}if(2&d){const i=e.oxw();e.Q6J("activeIndex",i.activerowIndex)}}function Ut(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"div",93)(1,"PBatchList",94),e.NdJ("dbClickEvent",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o.dblClickPopupBatch(r))})("BatchClosedClick",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.model1Closed())})("returnBatchValue",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o.returnBatch(r))})("showCreateBatchEvent",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.showCreateBatchFromPopup())}),e.qZA()()}if(2&d){const i=e.oxw();e.xp6(1),e.Q6J("AlternateUnits",i.genericProductService.AlternateUnits)("activerowIndex",i.genericProductService.activerowIndex)("title",i.masterService.PlistTitle)("BList",i.genericProductService.batchlist)("voucherType",i._trnMainService.TrnMainObj.VoucherType)("activeurlpath",i.genericProductService.activeurlpath)}}function Kt(d,f){1&d&&(e.TgZ(0,"th",119),e._uU(1," CURRENT WS-PRICE "),e.qZA())}function Vt(d,f){1&d&&(e.TgZ(0,"th",120),e._uU(1,"NEW S-PRICE INCLUDING VAT"),e.qZA())}function kt(d,f){1&d&&(e.TgZ(0,"th",120),e._uU(1,"NEW S-PRICE EXCLUDING VAT"),e.qZA())}function Ft(d,f){1&d&&(e.TgZ(0,"th",120),e._uU(1," NEW WS-PRICE EXCLUDING VAT "),e.qZA())}function Qt(d,f){1&d&&(e.TgZ(0,"th",120),e._uU(1," NEW WS-PRICE INCLUDING VAT "),e.qZA())}function Gt(d,f){if(1&d&&(e.TgZ(0,"td",57),e._uU(1),e.ALo(2,"twoDigitNumber"),e.qZA()),2&d){const i=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,i.WSRATE_A)," ")}}function Wt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"td",57)(1,"input",123),e.NdJ("change",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))})("ngModelChange",function(r){e.CHM(i);const o=e.oxw().$implicit;return e.KtG(o.NRATE_A=r)})("keyup",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.actualMarginCalculation(o,r))})("keydown.enter",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))})("keydown.Tab",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))}),e.qZA()()}if(2&d){const i=e.oxw(),n=i.index,r=i.$implicit,o=e.oxw(3);e.xp6(1),e.MGl("id","newSellingPrice",n,""),e.Q6J("ngModel",r.NRATE_A)("disabled","VIEW"==r.rowMode||r.isPurchaseOrderItem||o._trnMainService.TrnMainObj.ProdList[o.genericProductService.activerowIndex].BASEUNIT!=r.UNIT)}}function Zt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"td",57)(1,"input",123),e.NdJ("change",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))})("ngModelChange",function(r){e.CHM(i);const o=e.oxw().$implicit;return e.KtG(o.EX_NRATE_A=r)})("keyup",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.actualMarginCalculation(o,r))})("keydown.enter",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))})("keydown.Tab",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))}),e.qZA()()}if(2&d){const i=e.oxw(),n=i.index,r=i.$implicit,o=e.oxw(3);e.xp6(1),e.MGl("id","newSellingPrice",n,""),e.Q6J("ngModel",r.EX_NRATE_A)("disabled","VIEW"==r.rowMode||r.isPurchaseOrderItem||o._trnMainService.TrnMainObj.ProdList[o.genericProductService.activerowIndex].BASEUNIT!=r.UNIT)}}function Yt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"td",57)(1,"input",123),e.NdJ("change",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))})("ngModelChange",function(r){e.CHM(i);const o=e.oxw().$implicit;return e.KtG(o.WNRATE_A=r)})("keyup",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.actualMarginCalculation(o,r))})("keydown.enter",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))})("keydown.Tab",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))}),e.qZA()()}if(2&d){const i=e.oxw(),n=i.index,r=i.$implicit,o=e.oxw(3);e.xp6(1),e.MGl("id","newWholeSellingPrice",n,""),e.Q6J("ngModel",r.WNRATE_A)("disabled","VIEW"==r.rowMode||r.isPurchaseOrderItem||o._trnMainService.TrnMainObj.ProdList[o.genericProductService.activerowIndex].BASEUNIT!=r.UNIT)}}function Ht(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"td",124)(1,"input",123),e.NdJ("change",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))})("ngModelChange",function(r){e.CHM(i);const o=e.oxw().$implicit;return e.KtG(o.EX_WNRATE_A=r)})("keyup",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.actualMarginCalculation(o,r))})("keydown.enter",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))})("keydown.Tab",function(r){e.CHM(i);const o=e.oxw().index,C=e.oxw(3);return e.KtG(C.onChangePurchasePrice(o,r))}),e.qZA()()}if(2&d){const i=e.oxw(),n=i.index,r=i.$implicit,o=e.oxw(3);e.xp6(1),e.MGl("id","newWholeSellingPrice",n,""),e.Q6J("ngModel",r.EX_WNRATE_A)("disabled","VIEW"==r.rowMode||r.isPurchaseOrderItem||o._trnMainService.TrnMainObj.ProdList[o.genericProductService.activerowIndex].BASEUNIT!=r.UNIT)}}function Jt(d,f){if(1&d&&(e.TgZ(0,"tbody")(1,"tr",121)(2,"td",57),e._uU(3),e.qZA(),e.TgZ(4,"td",57),e._uU(5),e.ALo(6,"twoDigitNumber"),e.qZA(),e.YNc(7,Gt,3,3,"td",60),e.YNc(8,Wt,2,3,"td",60),e.YNc(9,Zt,2,3,"td",60),e.YNc(10,Yt,2,3,"td",60),e.YNc(11,Ht,2,3,"td",122),e.qZA()()),2&d){const i=f.$implicit,n=e.oxw(3);e.xp6(3),e.Oqu(i.UNIT),e.xp6(2),e.hij(" ",e.lcZ(6,7,i.CRATE_A)," "),e.xp6(2),e.Q6J("ngIf",1==n.userSetting.ENABLEWSALESRATEBILLING),e.xp6(1),e.Q6J("ngIf",0===(null==n.userSetting?null:n.userSetting.VatExcludingRate)),e.xp6(1),e.Q6J("ngIf",1===(null==n.userSetting?null:n.userSetting.VatExcludingRate)),e.xp6(1),e.Q6J("ngIf",1==n.userSetting.ENABLEWSALESRATEBILLING&&0==(null==n.userSetting?null:n.userSetting.VatExcludingRate)),e.xp6(1),e.Q6J("ngIf",1==n.userSetting.ENABLEWSALESRATEBILLING&&1==(null==n.userSetting?null:n.userSetting.VatExcludingRate))}}function $t(d,f){if(1&d&&(e.TgZ(0,"h6",125),e._uU(1),e.ALo(2,"twoDigitNumber"),e.qZA()),2&d){const i=e.oxw(3);e.xp6(1),e.hij(" Actual Margin (RETAIL): ",e.lcZ(2,1,i._trnMainService.TrnMainObj.ProdList[i.genericProductService.activerowIndex].ActualmarginRetial),"% ")}}function qt(d,f){if(1&d&&(e.TgZ(0,"div",126)(1,"h6"),e._uU(2),e.ALo(3,"twoDigitNumber"),e.qZA(),e.TgZ(4,"h6"),e._uU(5),e.ALo(6,"twoDigitNumber"),e.qZA()()),2&d){const i=e.oxw(3);e.xp6(2),e.hij("Actual Margin (RETAIL): ",e.lcZ(3,2,i._trnMainService.TrnMainObj.ProdList[i.genericProductService.activerowIndex].ActualmarginRetial),"%"),e.xp6(3),e.hij("Actual Margin (Wholesale): ",e.lcZ(6,4,i._trnMainService.TrnMainObj.ProdList[i.genericProductService.activerowIndex].ActualmarginWholeSale),"%")}}function Xt(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"div",97)(1,"div",98)(2,"div",99)(3,"h4",100),e._uU(4," Selling Price Setting "),e.qZA()(),e.TgZ(5,"div",101)(6,"div")(7,"h5",100),e._uU(8," Cost Price has been changed.Please reset you new Selling Price "),e.qZA(),e._UZ(9,"hr",102),e.qZA(),e.TgZ(10,"div",46)(11,"label"),e._uU(12,"Label MRP:"),e.qZA(),e.TgZ(13,"input",103),e.NdJ("ngModelChange",function(r){e.CHM(i);const o=e.oxw(2);return e.KtG(o._trnMainService.TrnMainObj.ProdList[o.genericProductService.activerowIndex].LABELMRP=r)}),e.qZA()(),e.TgZ(14,"fieldset")(15,"legend",104),e._uU(16," New Selling Price Setting "),e.qZA(),e.TgZ(17,"table",105)(18,"thead")(19,"tr",106)(20,"th",107),e._uU(21,"UOM"),e.qZA(),e.TgZ(22,"th",108),e._uU(23,"CURRENT S-PRICE"),e.qZA(),e.YNc(24,Kt,2,0,"th",109),e.YNc(25,Vt,2,0,"th",110),e.YNc(26,kt,2,0,"th",110),e.YNc(27,Ft,2,0,"th",111),e.YNc(28,Qt,2,0,"th",111),e.qZA()(),e.YNc(29,Jt,12,9,"tbody",5),e.qZA(),e.TgZ(30,"div",46)(31,"div",112)(32,"div",113)(33,"h6"),e._uU(34),e.qZA()(),e.TgZ(35,"div",114),e.YNc(36,$t,3,3,"h6",115),e.YNc(37,qt,7,6,"div",116),e.qZA()()()(),e.TgZ(38,"button",117),e.NdJ("click",function(){e.CHM(i);const r=e.oxw(2);return e.KtG(r.onApplyClickNewPrice())})("keydown.enter",function(){e.CHM(i);const r=e.oxw(2);return e.KtG(r.onApplyClickNewPrice())}),e._uU(39," APPLY "),e.qZA(),e.TgZ(40,"button",118),e.NdJ("click",function(){e.CHM(i);const r=e.oxw(2);return e.KtG(r.onApplyOldPriceClick())})("keydown.enter",function(){e.CHM(i);const r=e.oxw(2);return e.KtG(r.onApplyOldPriceClick())}),e._uU(41," APPLY OLD S-PRICE "),e.qZA()()()()}if(2&d){const i=e.oxw(2);e.xp6(13),e.Q6J("ngModel",i._trnMainService.TrnMainObj.ProdList[i.genericProductService.activerowIndex].LABELMRP),e.xp6(11),e.Q6J("ngIf",1==i.userSetting.ENABLEWSALESRATEBILLING),e.xp6(1),e.Q6J("ngIf",0==(null==i.userSetting?null:i.userSetting.VatExcludingRate)),e.xp6(1),e.Q6J("ngIf",1==(null==i.userSetting?null:i.userSetting.VatExcludingRate)),e.xp6(1),e.Q6J("ngIf",1==i.userSetting.ENABLEWSALESRATEBILLING&&1==(null==i.userSetting?null:i.userSetting.VatExcludingRate)),e.xp6(1),e.Q6J("ngIf",1==i.userSetting.ENABLEWSALESRATEBILLING&&0==(null==i.userSetting?null:i.userSetting.VatExcludingRate)),e.xp6(1),e.Q6J("ngForOf",i._trnMainService.priceChangeList),e.xp6(5),e.hij(" Recommended Margin: ",i._trnMainService.selectedProdcutRecMargin,"% "),e.xp6(2),e.Q6J("ngIf",!i.userSetting.ENABLEWSALESRATEBILLING),e.xp6(1),e.Q6J("ngIf",1==i.userSetting.ENABLEWSALESRATEBILLING)}}function zt(d,f){if(1&d&&(e.TgZ(0,"div",95),e.YNc(1,Xt,42,10,"div",96),e.qZA()),2&d){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",(null==i._trnMainService.TrnMainObj.ProdList[i.genericProductService.activerowIndex]?null:i._trnMainService.TrnMainObj.ProdList[i.genericProductService.activerowIndex].showPriceChangePopup)&&2==i.userSetting.EnableBatch||1==i.userSetting.EnableBatch)}}function ei(d,f){if(1&d){const i=e.EpF();e.TgZ(0,"div")(1,"div",127)(2,"div",128)(3,"div",129)(4,"h6",130),e._uU(5," Authorization for Negative Stock Entry "),e.qZA(),e.TgZ(6,"button",43),e.NdJ("click",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.closeModal())}),e.TgZ(7,"span",44),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",45)(10,"div",131)(11,"label",132),e._uU(12,"User Name:"),e.qZA(),e.TgZ(13,"div",133)(14,"input",134),e.NdJ("ngModelChange",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o._trnMainService.disAuthObj.username=r)}),e.qZA()()(),e.TgZ(15,"div",131)(16,"label",132),e._uU(17,"Password:"),e.qZA(),e.TgZ(18,"div",133)(19,"input",135),e.NdJ("ngModelChange",function(r){e.CHM(i);const o=e.oxw();return e.KtG(o._trnMainService.disAuthObj.password=r)}),e.qZA()()()(),e.TgZ(20,"div",136)(21,"button",137),e.NdJ("click",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.confirmAuthorization())}),e._uU(22," Confirm "),e.qZA(),e.TgZ(23,"button",138),e.NdJ("click",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.closeModal())}),e._uU(24," Cancel "),e.qZA()()()()()}if(2&d){const i=e.oxw();e.xp6(14),e.Q6J("ngModel",i._trnMainService.disAuthObj.username),e.xp6(5),e.Q6J("ngModel",i._trnMainService.disAuthObj.password)}}function ti(d,f){if(1&d&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA()()),2&d){const i=f.$implicit;e.xp6(2),e.Oqu(i.AssetID)}}function ii(d,f){if(1&d){const i=e.EpF();e.ynx(0),e.TgZ(1,"div",127)(2,"div",128)(3,"div",129)(4,"h6",130),e._uU(5),e.qZA(),e.TgZ(6,"button",43),e.NdJ("click",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.closeAssetId())}),e.TgZ(7,"span",44),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",45)(10,"div",131)(11,"table")(12,"thead")(13,"th"),e._uU(14,"Asset ID"),e.qZA()(),e.TgZ(15,"tbody"),e.YNc(16,ti,3,1,"tr",5),e.qZA()()()()()(),e.BQk()}if(2&d){const i=e.oxw();e.xp6(5),e.hij(" ITEM NAME: ",i.showAssetProductDetail.ITEMNAME," "),e.xp6(11),e.Q6J("ngForOf",i.showAssetProductDetail.LIST)}}const ni=function(d){return{fixedHeight:d}},ri=function(d){return{overflow:d}},oi=function(d){return{height:d}},ci=function(){return{backdrop:"static"}};let ai=(()=>{class d{constructor(i,n,r,o,C,B,Y,H,te,oe,si,li,hi,ui){this.masterService=i,this._trnMainService=n,this.arouter=r,this.dialog=o,this.spinnerService=C,this.authservice=B,this.userRightAuthService=Y,this.validationService=H,this.alertService=te,this.genericProductService=oe,this.entryValidationService=si,this.responseMsgService=li,this.productHelperService=hi,this.focusService=ui,this.showNonItemGenericGrid=new e.vpe,this.GenericPopUpSettings=new h.im,this.gridPopupSettingsForMultiplePrice=new V.JP,this.ShowGenericGridEvent=new e.vpe,this.onChangeProductionItem=new e.vpe,this.activerowIndex=0,this.showDiscountAuth=!1,this.mfgExpDateType="month",this.showStockedQuantityOnly=0,this.barcodeDetailActiverowIndex=0,this.barCodeAdded=0,this.barcodeWiseProductIndex=0,this.stringValue="",this.hover=!1,this.applyTwoDigitPipe=!0,this.applyThreeDigitPipe=!0,this.currDate="",this.maxDate="",this.showAssetProductDetail={},this.showCreateBatch=!1,this.selectComments=[{name:"Nil"},{name:"Bulk Order"},{name:"Customer Order"}],this.batchList=[],this.setVariantData=_i=>{let X=Object.assign({},this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex]),ue=[];for(var ee of _i)if(X.VaraintDetailS=[],this.masterService.nullToZeroConverter(ee.QTY)>0){let ae="";X.VARIANTDESCA="";var de={};for(var re in ee)-1==["QTY","PRATE","MRP","SRATE","BARCODE"].indexOf(re)&&(ae+=ee[re].VARIANTBARCODE,X.VARIANTDESCA=X.VARIANTDESCA+`<b>${this._trnMainService.getVariantNameFromId(re)}</b>:${ee[re].NAME} &nbsp;`,de[ee[re].VARIANTNAME]=ee[re].NAME);X.VaraintDetailS.push(de),X.VARIANTLIST=ee,X.BC=ee.BARCODE?ee.BARCODE:X.MCODE+ae,X.Quantity=ee.QTY,X.MRP=ee.MRP,X.ALTMRP=ee.MRP,X.REALQTY_IN=ee.QTY,X.ALTERNATEQUANTIY=ee.QTY,X.AltQty=ee.QTY,X.PRATE=ee.PRATE,X.RATE=ee.PRATE,X.REALRATE=ee.PRATE,X.ALTRATE=ee.PRATE,"purchase-import"==this._trnMainService.activeurlpath&&(X.INVRATE=ee.PRATE,X.ALTRATE=X.INVRATE*this._trnMainService.TrnMainObj.EXRATE,X.RATE=X.ALTRATE),X.SPRICE=ee.SRATE,X.SellingPrice=ee.SRATE,X.ALTRATE2=ee.SRATE,this._trnMainService.TrnMainObj.VoucherType==s.Km.ProductionEntry&&(X.SELLRATEBEFORETAX=ee.SRATE),ue.push(Object.assign({},X))}let ce=this._trnMainService.TrnMainObj.ProdList.slice(0,this.genericProductService.activerowIndex),Ti=this._trnMainService.TrnMainObj.ProdList.slice(this.genericProductService.activerowIndex+1);for(var Si of(this._trnMainService.TrnMainObj.ProdList.splice(this.genericProductService.activerowIndex),ue))ce.push(Si);for(var vi of Ti)ce.push(vi);this._trnMainService.TrnMainObj.ProdList=ce,this.checkDeuplicateCodeAndRate(),this._trnMainService.ReCalculateBillWithNormal(),setTimeout(()=>{document.getElementById("ALTRATE"+this.genericProductService.activerowIndex).focus()},500)},this.Snos=0,console.log("checkkkk",this.selectComments),console.log({gridsetting:this.genericProductEntrySetting}),this.genericProductService.activeurlpath=r.snapshot.url[0]?.path,this.appType=this.masterService.appType,this.userSetting=this.authservice.getSetting(),this.userProfile=this.authservice.getUserProfile(),1==this.userSetting.enableDayWiseMfgEXPDate&&(this.mfgExpDateType="date");const di=new Date;this.currDate=(0,t.p6)(di,"yyyy-MM-dd","en-US"),this.maxDate="2999-12-31"}ngAfterViewInit(){this.genericProductService.genericGrid=this.genericGrid,this.genericProductService.matrixitemgrid=this.matrixitemgrid,this.genericProductService.onChangeProductionItem=this.onChangeProductionItem}ngOnInit(){this.hideUnhideColumn()}isTableRowSelected(){}highlightBarCodeWiseRow(){}highlightLessStockItem(i){}RowClick(i){this.genericProductService.activerowIndex=i,this.activerowIndex=i,this.masterService.ShowMore=!1,this.genericProductService.showPOQtyRate(i);const n=new Date;0==this.userSetting.EnablePreviousDateInExpiry&&(this.currDate=(0,t.p6)(n,"yyyy-MM-dd","en-US"),this.maxDate="2999-12-31",0==this.userSetting.enableDayWiseMfgEXPDate&&(this.currDate=(0,t.p6)(n,"yyyy-MM","en-US"),this.maxDate="2999-12"))}addRowInsert(){"asset-purchase-invoice"==this._trnMainService.activeurlpath||"assets-openingstockentry"==this._trnMainService.activeurlpath?this._trnMainService.initializeAssetProdlist():this._trnMainService.addRow()}deleteRow(i){if(!this._trnMainService.TrnMainObj.REFORDBILL||2!=this._trnMainService.userSetting.PODELIVERYMODE||1!=this._trnMainService.userSetting.ENABLE_GRN_IN_PI||this._trnMainService.TrnMainObj.VoucherType!==s.Km.Purchase||!("GR"==this._trnMainService.TrnMainObj.VoucherAbbName||this._trnMainService.TrnMainObj.CHALANNO&&this._trnMainService.TrnMainObj.CHALANNO.startsWith("GR"))){if(this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote&&1==this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE&&1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFBILL&&this._trnMainService.TrnMainObj.REFBILL?.startsWith("PI")||(this._trnMainService.TrnMainObj.VoucherType===s.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===s.Km.Purchase)&&1==this._trnMainService.userSetting.PODELIVERYMODE&&this._trnMainService.TrnMainObj.REFORDBILL&&this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("PO"))return!1;if("asset-purchase-invoice"===this._trnMainService.activeurlpath||"assets-openingstockentry"===this._trnMainService.activeurlpath)return void(confirm("Are you sure u you want to delete the Row?")&&(this.genericProductService.activerowIndex=this.rowIndex=i,this._trnMainService.TrnMainObj.AssetsProdList.splice(this.genericProductService.activerowIndex,null==this._trnMainService.TrnMainObj.AssetsProdList[this.genericProductService.activerowIndex]?.MCODE&&1==this._trnMainService.TrnMainObj.AssetsProdList.length?0:1),0===this._trnMainService.TrnMainObj.AssetsProdList.length&&this._trnMainService.initializeAssetProdlist(),this._trnMainService.ReCalculateBillForAsset(this._trnMainService.TrnMainObj)));if("EDIT"==this._trnMainService.TrnMainObj?.Mode?.toUpperCase()&&(this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==s.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType==s.Km.BranchTransferOut)){if(this.userRightAuthService.checkuserrightfordelete(this.genericProductService.activerowIndex,this._trnMainService.TrnMainObj.VoucherType))return;if((this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase&&2==this.userSetting.ALLOWMINUSTOCK_PURCHASE||this._trnMainService.TrnMainObj.VoucherType==s.Km.OpeningStockBalance&&2==this.userSetting.ALLOWMINUSTOCK_OPENING)&&"EDIT"===this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].rowMode?.toUpperCase()&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].TOTALOUTWARDSTOCK)>0&&this.alertService.info(`Edited Quantity Exceed the transaction stock  for the item::${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ITEMDESC}`),(this._trnMainService.TrnMainObj.VoucherType==s.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase)&&0==this.userSetting.ENABLESINGLEBATCHMODE&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[i].TOTALOUTWARDSTOCK)>0&&"EDIT"===this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].rowMode?.toUpperCase()&&10!=this._trnMainService.TrnMainObj.ProdList[i]?.PTYPE)return void this.alertService.info(`Transaction has been completed for this item::${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ITEMDESC}, cannot delete.`)}this._trnMainService.TrnMainObj.VoucherType!=s.Km.BranchTransferIn&&(3!=this._trnMainService.TrnMainObj.VoucherType||"IMPORT_PURCHASE"!=this._trnMainService.TrnMainObj.AdditionalObj.tag||1!=this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI)&&confirm("Are you sure u you want to delete the Row?")&&(this.genericProductService.activerowIndex=this.rowIndex=i,this._trnMainService.TrnMainObj.ProdList.splice(this.genericProductService.activerowIndex,null==this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex]?.MCODE&&1==this._trnMainService.TrnMainObj.ProdList.length?0:1),0===this._trnMainService.TrnMainObj.ProdList.length&&this._trnMainService.addRow(),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.quantityExceedCheck="")}}onGenericGridPopup(){}dblClickbarcodePopUP(i){}dblClickPricePopUP(i){}checkDeuplicateCodeAndRate(){let i=[],n=this._trnMainService.TrnMainObj.ProdList.filter(r=>r.MCODE==this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MCODE);if(null!=n&&n.length>1){let r=0;for(let o of this._trnMainService.TrnMainObj.ProdList)o.MCODE==this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MCODE&&i.push(r),r++}}setBatchWiseEditData(i){}onUserRightReceived(i){}onKeyDown(i,n,r,o){if("Enter"===i.key||"Tab"==i.key)i.stopImmediatePropagation(),this.genericProductService.focusByElementId(n.focusTo+r),n.onEnter&&n.onEnter(o,r,n,i);else if("Tab"==i.key){if(1==i.shiftKey)return;this.genericProductService.focusByElementId(n.focusTo+r)}}emittedBatch(i){i&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].BATCH=i.batchName,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MFGDATE=i.mfgDate,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].EXPDATE=i.expDate,setTimeout(()=>{this.masterService.focusAnyControl("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex)},301))}toggleCreateBatch(){this.showCreateBatch=!this.showCreateBatch,setTimeout(()=>{this.masterService.focusAnyControl("BATCH"+this.genericProductService.activerowIndex)},300)}showCreateBatchFromPopup(){this.showCreateBatch=!0,this.model1Closed()}onEnter(i,n,r,o){this.RowClick(r),2==this.userSetting.EnableBatch&&this._trnMainService.TrnMainObj.VoucherType==s.Km.DebitNote?document.getElementById("ALTUNIT"+this.genericProductService.activerowIndex).focus():this.genericProductService.getPreviousBatchList()}isReadOnly(i,n,r){if(i.isReadOnly&&i.isReadOnly(n,r))return!0}onChange(i,n,r,o){n.onChange&&n.onChange(i,n,r,o)}onModelChange(i,n,r,o){n.onModelChange&&n.onModelChange(i,n,r,o)}onKeyPress(i,n,r){n.onKeyPress&&n.onKeyPress(i,n)}disablePipe(i,n){var r="";return i.disablePipe&&(r=i.disablePipe(i,n)),r}colorPipe(i,n,r){if(i.colorPipe)return i.colorPipe(i,n,r)}onClicked(i,n,r,o){n.onClicked&&n.onClicked(i,n,r,o)}rateChange(i,n){n.applyTwoDigitPipe&&(n.applyTwoDigitPipe=!1),n.applyThreeDigitPipe&&(n.applyThreeDigitPipe=!1)}rateFocusOut(i,n){n.applyTwoDigitPipe=!0,n.applyThreeDigitPipe=!0}hoverDiscount(i,n,r,o){"mouseover"==i.type&&n.onHover&&(this.hover=!0,n.onHover(r))}hoverDescription(i,n,r,o){console.log("mouseover"==i.type),"mouseover"==i.type&&n.onHover&&(this.hover=!0,n.onHover(r))}hoverRate(i,n,r,o){"mouseover"==i.type&&n.onHover&&(this.hover=!0,n.onHover(r))}hoverLeaveDiscount(){this.hover=!1,this.genericProductService.hoverId=null}hoverLeaveDescription(){this.hover=!1,this.genericProductService.codeHoverId=null}hoverLeaveRate(){this.hover=!1,this.genericProductService.rateHoverId=null}showGenericGrid(i){console.log({keyevent:i}),this.ShowGenericGridEvent.emit({event:i.event,genericGrid:this.genericGrid,index:i.index})}hideUnhideColumn(){this.genericProductEntrySetting.columns.forEach(i=>{i.hidden=this.hideColumn(i)})}hideColumn(i){if(!i)return!1;if(1==i?.hidden)return!0;if(this.genericProductEntrySetting.hideColumn){if(1==this.genericProductEntrySetting.hideColumn(i))return!0}else{var r=this._trnMainService.checkRightForOptional(s.Km[this._trnMainService.TrnMainObj.VoucherType],"HideColumn",i.header);if(r&&("true"==r||"1"==r))return!0}return!1}getTemplate(i){if(console.log({templaterefs:this.templateRefs}),this.templateRefs){var n=this.templateRefs.toArray().find(r=>r.name.toLowerCase()==i?.toLowerCase())?.template;return n||(n=this.templateRefs.toArray().find(r=>"default"==r.name.toLowerCase()).template),console.log({gettemplate:n}),n}}updown(i){"F2"===i.code&&this.genericProductEntrySetting.barcodeDisplay&&this.getBarodePagedList(),"F7"==i.code&&(i.preventDefault(),this.genericProductEntrySetting.voucherType==s.Km.DebitNote&&(this.gridPopupSettingsForMultiplePrice=this.masterService.getGridSetttingForMultiplePrice("multiplePrice",this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MCODE,this._trnMainService.TrnMainObj.VoucherPrefix),this.genericGridMulitplePricePopup.show())),"F9"===i.code&&(i.preventDefault(),this._trnMainService.inputCode&&this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ProductDetails.length>0&&this.dialougeOpen()),"F11"==i.code&&i.ctrlKey&&(i.preventDefault(),this._trnMainService.barCodes.BC||null!=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MCODE&&this.genericProductService.checkBatchWiseRate()),"Escape"==i.code&&(i.preventDefault(),1==this._trnMainService.showNegativeBilling&&this.closeModal())}getBarodePagedList(){this.barcodeGridSettings=this.masterService.getGenericGridPopUpSettings("barcodeList"),this.barCodeGridPopup.show()}dialougeOpen(){console.log("dialouge open ProductDetails",this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ProductDetails),this._trnMainService.currentIndexProductDetails=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ProductDetails,this.dialog.open(p.H,{hasBackdrop:!0,autoFocus:!1,data:{type:this._trnMainService.TrnMainObj.VoucherPrefix,mode:this._trnMainService.TrnMainObj.Mode,warehouse:this._trnMainService.TrnMainObj.MWAREHOUSE,message:this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex],curretnIndexPrevDetials:this._trnMainService.currentIndexProductDetails,productList:this._trnMainService.TrnMainObj.ProdList}})}closeModal(){this.showDiscountAuth=!1,this._trnMainService.showNegativeBilling=!1,1==this.userSetting.ENABLESINGLEBATCHMODE&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ALTERNATEQUANTIY=0),this.userRightAuthService.showAuthPopup=!1}emitReferenceQuantity(){}dblClickForAssetPurchase(i){if(i.hasOwnProperty("ACID")&&i.hasOwnProperty("ACNAME")&&i.hasOwnProperty("HASSUBLEDGER"))return this._trnMainService.TrnMainObj.AssetsProdList[this.genericProductService.activerowIndex].ACID=i.ACID,this._trnMainService.TrnMainObj.AssetsProdList[this.genericProductService.activerowIndex].ACNAME=i.ACNAME,this._trnMainService.TrnMainObj.AssetsProdList[this.genericProductService.activerowIndex].HASSUBLEDGER=i.HASSUBLEDGER,this._trnMainService.callPipe=!this._trnMainService.callPipe,void setTimeout(()=>{document.getElementById("SL_ACNAME"+this.genericProductService.activerowIndex).disabled?document.getElementById("ALTQTY_IN"+this.genericProductService.activerowIndex).focus():document.getElementById("SL_ACNAME"+this.genericProductService.activerowIndex).focus()});if(i.hasOwnProperty("SL_ACID")&&i.hasOwnProperty("SL_ACNAME"))return this._trnMainService.TrnMainObj.AssetsProdList[this.genericProductService.activerowIndex].SL_ACID=i.SL_ACID,this._trnMainService.TrnMainObj.AssetsProdList[this.genericProductService.activerowIndex].SL_ACNAME=i.SL_ACNAME,this._trnMainService.callPipe=!this._trnMainService.callPipe,void setTimeout(()=>{document.getElementById("ALTQTY_IN"+this.genericProductService.activerowIndex)&&document.getElementById("ALTQTY_IN"+this.genericProductService.activerowIndex).focus()});let n=this._trnMainService.TrnMainObj.AssetsProdList[this.genericProductService.activerowIndex];n.ITEMDESC=i.DESCA,n.ALTRATE=i.PRATE,n.PRATE=i.PRATE,n.Rate=i.PRATE,n.ALTUNIT=i.BASEUNIT,n.UNIT=i.BASEUNIT,n.MCODE=i.MCODE,n.MENUCODE=i.MENUCODE,n.ISVAT=i.VAT,setTimeout(()=>{document.getElementById("REMARKS"+this.genericProductService.activerowIndex)?document.getElementById("REMARKS"+this.genericProductService.activerowIndex).focus():document.getElementById("ACNAME"+this.genericProductService.activerowIndex)&&document.getElementById("ACNAME"+this.genericProductService.activerowIndex).focus()})}dblClickPopupItem(i){if("asset-purchase-invoice"==this._trnMainService.activeurlpath||"assets-openingstockentry"==this._trnMainService.activeurlpath)return void this.dblClickForAssetPurchase(i);console.log("value",i);let n=this._trnMainService.TrnMainObj.VoucherType;if(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex]={},(this._trnMainService.TrnMainObj.VoucherType===s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.Sales)&&this.userSetting.CompulsoryHSCodeInput){if(i&&!i.HSNCode)return void this.alertService.warning("HS Code is not registered!");this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].HS_Code=i.HSNCode}if(!1===this.validationService.validateDuplicateItemEntry(this._trnMainService.TrnMainObj,i))return this.alertService.info("Cannot enter duplicate item with same batch and same net rate!"),void this.alertService.emitShowHideSubject.subscribe(B=>{setTimeout(()=>{document.getElementById("itemDesc"+this.genericProductService.activerowIndex).focus()},0)});!1!==this.genericProductService.ValidateDuplicateItemEntry(i)?(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].HASBATCH=i.HASBATCH,"add-sales-invoice-wholesale"===this.genericProductService.activeurlpath?(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].RATE=i.WRATE,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ALTRATE=i.WRATE):this._trnMainService.TrnMainObj.VoucherType!=s.Km.BranchTransferOut&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].RATE=i.RATE,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].BASERATE=i.RATE,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ALTRATE=i.RATE),"add-purchase-invoice"===this.genericProductService.activeurlpath&&1===this.userSetting.EnableServiceCharge&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ISVAT=i.ISVAT),this.genericProductEntrySetting.setRowItemFromSelectedItem(i),this._trnMainService.NeedToTakePriceFromMenuItem()&&(n in s.qK&&this._trnMainService.assignProductMasterRate(this.genericProductService.activerowIndex,i.RATE),"add-sales-invoice-wholesale"===this.genericProductService.activeurlpath&&this._trnMainService.assignProductMasterRate(this.genericProductService.activerowIndex,i.WRATE),n in s.N7&&this._trnMainService.assignProductMasterRate(this.genericProductService.activerowIndex,i.PRATE,i.CONFACTOR)),this._trnMainService.TrnMainObj.VoucherType===s.Km.SalesOrder&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ALTRATE2=i.ALTRATE2),this.genericProductService.focusByElementId(this.genericProductEntrySetting.getIdToSetFocus),this.masterService.PlistTitle="",this._trnMainService.TrnMainObj.VoucherType==s.Km.ManualstockEntry&&(this.focusAfterItemSelect(),1===i.HASVARIANT&&0===this.userSetting.EnableBatchWisePrice&&this.genericProductService.checkBatchWiseRateSettingZero()),null!=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex]&&(this.genericProductService.batchlist=[],this.genericProductEntrySetting.setAllUnitsOfItem(),this._trnMainService.TrnMainObj.VoucherType==s.Km.BatchAdjustment&&this.FocusForBatchAdjustment(i.HASVARIANT),this.genericProductEntrySetting.setRowItemRate(i,B=>this.CheckVariant(B))),6===i.PTYPE&&this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice&&(this.genericProductService.getProductColorMcodeWise(),!0===this._trnMainService.hideProductDescriptionPopUp&&(this.genericProductService.showBarCodeDetail=!0),0===this.genericProductService.activerowIndex?this.loadBarCodeRow(this.genericProductService.activerowIndex):6===this.userSetting.EnableTelcomDevices&&this.addNewBarCodeDetailRow(this.genericProductService.activerowIndex)),1===this.userSetting.EnableWSRateGroup&&this._trnMainService.TrnMainObj.VoucherType===s.Km.SalesOrder&&(this._trnMainService.nullToZeroConverter(this.userProfile.RateGroupId)>0||this._trnMainService.nullToZeroConverter(this.userProfile.WRateGroupId)>0)&&this._trnMainService.getItemGroupWiseRate(this.genericProductService.activerowIndex),1===this.userSetting.ENABLERATEGROUP&&("abbreviated-sales-invoice"===this.genericProductService.activeurlpath||"add-sales-invoice"===this.genericProductService.activeurlpath||"add-sales-invoice-wholesale"===this.genericProductService.activeurlpath)&&(this._trnMainService.nullToZeroConverter(this.userProfile.RateGroupId)>0||this._trnMainService.nullToZeroConverter(this.userProfile.WRateGroupId)>0)&&this._trnMainService.getItemGroupWiseRate(this.genericProductService.activerowIndex),this._trnMainService.NeedToTakePriceFromMenuItem()||(this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockSettlement||this._trnMainService.TrnMainObj.VoucherType===s.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===s.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.DeliveryChalan)&&1===this.userSetting.EnableItemWiseBatch&&1===i.HASBATCH&&this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].PTYPE<10&&this.genericProductService.checkBatchWiseRate(),(this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===s.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.DeliveryChalan)&&0===this.userSetting.EnableItemWiseBatch&&1===this.userSetting.EnableBatchWisePrice&&this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].PTYPE<10&&this.genericProductService.checkBatchWiseRate(),this._trnMainService.NeedToTakePriceFromMenuItem()||(this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssueReturn||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===s.Km.BranchTransferIn||this._trnMainService.TrnMainObj.VoucherType===s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===s.Km.ProductionEntry||"consumption"===this._trnMainService.TrnMainObj.AdditionalObj.RETURNTYPE||this._trnMainService.TrnMainObj.VoucherType===s.Km.Repack||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote&&0===this.userSetting.REFBILLCOMPULSORINDNOTE||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockSettlement&&"Excess"!=this._trnMainService.TrnMainObj.TRNMODE||"self-billing"===this.genericProductService.activeurlpath)&&(this._trnMainService.getAllUnitsOfItem(this.genericProductService.activerowIndex),(1===this.userSetting.EnableBatch||2===this.userSetting.EnableBatch)&&i.PTYPE<10&&9!==i.PTYPE&&(this._trnMainService.TrnMainObj.VoucherType===s.Km.PerformaSalesInvoice&&this._trnMainService.TrnMainObj.REFORDBILL||!1===this.genericProductService.itemFromBC(i.HASVARIANT)&&1!=i.NATURETYPE&&this.genericProductService.checkBatchWiseRate())),(this._trnMainService.TrnMainObj.VoucherType===s.Km.SalesOrder||this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote&&1===this.userSetting.ENABLESINGLEBATCHMODE&&0===this.userSetting.EnableBatchWisePrice)&&0===this.userSetting.EnableBatchWisePrice&&1===i.HASVARIANT&&this.genericProductService.checkBatchWiseRateSettingZero(),(this._trnMainService.TrnMainObj.VoucherType==s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==s.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType==s.Km.SalesOrder)&&1==this.userSetting.EnableContractPrice&&this.genericProductService.getContractPriceandOtherDiscount(),1!=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].NATURETYPE&&this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote&&0==this.userSetting.REFBILLCOMPULSORINDNOTE&&1==this.userSetting.EnableBatchWisePrice&&0==this._trnMainService.userSetting.ENABLESINGLEBATCHMODE&&this.genericProductService.checkBatchWiseRate(),(this._trnMainService.TrnMainObj.VoucherType===s.Km.CreditNote&&0==this.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote&&1==this.userSetting.REFBILLCOMPULSORINDNOTE)&&this.genericProductService.assignValueForReturnModeInProd(i),this._trnMainService.TrnMainObj.VoucherType===s.Km.SalesOrder&&this._trnMainService.TrnMainObj.REFORDBILL&&(this.genericProductService.assignRateandQtyLoadFromSO(i),this.genericProductService.assignOrderedDiscount(i)),this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].BC||1===this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].HASVARIANT&&(this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===s.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType==s.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType==s.Km.ProductionEntry||this._trnMainService.TrnMainObj.VoucherType==s.Km.RequisitionEntry||this._trnMainService.TrnMainObj.VoucherType==s.Km.Quotation||this._trnMainService.TrnMainObj.VoucherType==s.Km.PurchaseOrder||this._trnMainService.TrnMainObj.VoucherType==s.Km.SalesOrder)&&this.masterService.masterGetmethod(`/getItemWiseVariantAttributes?mcat=${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].Mcat}&mcode=${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MCODE}`).subscribe(B=>{"ok"==B.status&&B.result&&B.result.length&&(this.genericProductService.matrixItemAtrribute=B.result,this.matrixitemgrid.show())}),this.focusAfterItemSelect(),console.log("PRODDDLSIT",this._trnMainService.TrnMainObj.ProdList)):this.alertService.warning("Cannot enter duplicate item!")}CheckVariant(i){this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].BC||1===this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].HASVARIANT&&(this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===s.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType==s.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType==s.Km.ProductionEntry||this._trnMainService.TrnMainObj.VoucherType==s.Km.RequisitionEntry||this._trnMainService.TrnMainObj.VoucherType==s.Km.Quotation||this._trnMainService.TrnMainObj.VoucherType==s.Km.PurchaseOrder||this._trnMainService.TrnMainObj.VoucherType==s.Km.SalesOrder)&&this.masterService.masterGetmethod(`/getItemWiseVariantAttributes?mcat=${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].Mcat}&mcode=${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MCODE}`).subscribe(n=>{"ok"==n.status&&n.result&&n.result.length&&(this.genericProductService.matrixItemAtrribute=n.result,this.matrixitemgrid.show())})}GetParentStock(){this._trnMainService.getParentItemStock(this.genericProductService.activerowIndex)}loadBarCodeRow(i){let r={IEMI1:"",IEMI2:""};r.MCODE=0===this.genericProductService.activerowIndex?"":this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MCODE,r.Color="",0===this.genericProductService.activerowIndex?(this._trnMainService.TrnMainObj.ProdList[0].ProductDetails=[],this._trnMainService.TrnMainObj.ProdList[0].ProductDetails.push(r)):this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ProductDetails.push(r),setTimeout(()=>{null!=document.getElementById(`Color${this.barCodeAdded}${this.barcodeWiseProductIndex}`)&&document.getElementById(`Color${this.barCodeAdded}${this.barcodeWiseProductIndex}`).focus()},20)}addNewBarCodeDetailRow(i){let o={IEMI1:"",IEMI2:""};o.MCODE=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MCODE,o.Color="",this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ProductDetails.push(o),setTimeout(()=>{null!=document.getElementById(`Color${this.barCodeAdded}${this.barcodeWiseProductIndex}`)&&document.getElementById(`Color${this.barCodeAdded}${this.barcodeWiseProductIndex}`).focus()},20)}focusQuantityAfterDblClickOnManualStock(){this._trnMainService.TrnMainObj.VoucherType===s.Km.ManualstockEntry&&null!=document.getElementById("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex)&&setTimeout(()=>{document.getElementById("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex).focus()},20)}focusAfterItemSelect(){2==this.userSetting.EnableBatch?(this.focusQuantityAfterDblClickOnManualStock(),null!=document.getElementById("BATCH"+this.genericProductService.activerowIndex)&&setTimeout(()=>{this.focusService.autoFocus(this.genericProductService.activerowIndex,document.getElementById("ITEMDESC"+this.genericProductService.activerowIndex),{},"productEntrySetting.tableId")},20)):this._trnMainService.TrnMainObj.VoucherType==s.Km.BatchAdjustment?null!=document.getElementById("BATCH"+this.genericProductService.activerowIndex)&&setTimeout(()=>{document.getElementById("BATCH"+this.genericProductService.activerowIndex).focus()},20):(null!=document.getElementById("ALTERNATEUNIT"+this.genericProductService.activerowIndex)?(console.log("FOCUS HERE"),setTimeout(()=>{document.getElementById("ALTERNATEUNIT"+this.genericProductService.activerowIndex).focus()},20)):null!=document.getElementById("ALTUNIT"+this.genericProductService.activerowIndex)&&setTimeout(()=>{document.getElementById("ALTUNIT"+this.genericProductService.activerowIndex).focus()},20),83===this._trnMainService.TrnMainObj.VoucherType&&2==this.userSetting.EnablePartialSalesFromDeliveryChalan&&null!=document.getElementById("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex)&&setTimeout(()=>{document.getElementById("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex).focus()},20),74===this._trnMainService.TrnMainObj.VoucherType&&null!=document.getElementById("ALTERNATEUNIT"+this.genericProductService.activerowIndex)&&setTimeout(()=>{document.getElementById("ALTERNATEUNIT"+this.genericProductService.activerowIndex).focus()},20),this._trnMainService.TrnMainObj.VoucherType===s.Km.RequisitionEntry&&null!=document.getElementById("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex)&&setTimeout(()=>{document.getElementById("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex).focus()},20),this._trnMainService.TrnMainObj.VoucherType===s.Km.ProductionEntry&&setTimeout(()=>{document.getElementById("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex).focus()},20),this.focusQuantityAfterDblClickOnManualStock()),this.focusQuantityAfterDblClickOnDeliveryChalanReturn()}FocusForBatchAdjustment(i){1==i?setTimeout(()=>{document.getElementById("sourcebc"+this.genericProductService.activerowIndex).focus()},200):0==i&&setTimeout(()=>{document.getElementById("sourcebatch"+this.genericProductService.activerowIndex).focus()},200)}onFocus(){console.log("Focus Is gained for this Element")}model1Closed(){this.masterService.PlistTitle="",1==this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].REQEXPDATE?setTimeout(()=>{document.getElementById("BATCH"+this.genericProductService.activerowIndex).focus()},300):setTimeout(()=>{document.getElementById("ALTERNATEUNIT"+this.genericProductService.activerowIndex)?.focus()},300)}returnBatch(i){if("self-billing"==this.genericProductService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===s.Km.ProductionEntry)if(this._trnMainService.ReCalculateBillWithNormal(),i.BATCH||0!=this.userSetting.REFBILLCOMPULSORINDNOTE||1!=this.userSetting.EnableBatch||1!=this.userSetting.EnableBatchWisePrice){let r=[];if(r=this._trnMainService.TrnMainObj.ProdList.filter(2==this.userSetting.EnableBatch?o=>o.BATCH==i.BATCH&&o.MCODE==i.MCODE&&o.CRATE==i.RATE:o=>o.BATCH==i.BATCH&&o.MCODE==i.MCODE),r.length>0)return void this.alertService.warning("Cannot add same item with same batch")}else if(this._trnMainService.TrnMainObj.ProdList.filter(o=>o.CRATE==i.costprice&&o.MCODE==i.MCODE).length>0)return void this.alertService.warning("Cannot add same item with same rate");if(this._trnMainService.assignBatchToActiveProdRow(i,this.genericProductService.activerowIndex),this.masterService.PlistTitle="",this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].PriceSelected=!0,1===this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].HASVARIANT)for(var n in this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].VARIANTLIST=i.VARIANTDETAIL,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].VARIANTDESCA="",this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].BC=i.BCODE,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].VARIANTLIST)console.log("Var attribute",n,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].VARIANTLIST[n]),this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].VARIANTDESCA+=`<b>${n}</b>:${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].VARIANTLIST[n]} &nbsp;`;(this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===s.Km.ProductionEntry||this._trnMainService.TrnMainObj.VoucherType===s.Km.Repack||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockSettlement||this._trnMainService.TrnMainObj.VoucherType===s.Km.Purchase)&&this.masterService.focusAnyControl("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex),this._trnMainService.TrnMainObj.VoucherType===s.Km.ManualstockEntry&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].WAREHOUSE=this._trnMainService.TrnMainObj.MWAREHOUSE,this.masterService.focusAnyControl("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex))}dblClickPopupBatch(i){this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].showPriceChangePopup=!1,this._trnMainService.showPriceChangeDetail=!1,this.returnBatch(i)}onApplyClickNewPrice(){if(this.validateNewSellingRate(!1)){for(let i of this._trnMainService.priceChangeList){if(1!=this.masterService.is_PurchaseOrder){const n=this.userSetting.VatExcludingRate?"EX_NRATE_A":"NRATE_A";this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].Product.AltSellingPrices.find(r=>r.UNIT==i.UNIT)[n]=i[n]}setTimeout(()=>{this.masterService.focusAnyControl("barcodeField")},0)}this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ActualmarginRetial=0,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ActualmarginWholeSale=0,this._trnMainService.showPriceChangeDetail=!1}}validateNewSellingRate(i){const n=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex],r=this.getProductRate(n.NETRATE,n.RATE),o=this.calculatePurchaseRate(r,n.ISVAT);return i?this.validateOldPrice(o):this.validateNewPrice(o)}getProductRate(i,n){const r=this._trnMainService.nullToZeroConverter(i);return 0===r?n:r}calculatePurchaseRate(i,n){return 0===this.userSetting.VatExcludingRate&&1===n?i+i*this.userSetting.VATRate:i}validateOldPrice(i){const n=this._trnMainService.priceChangeList[0];if(1===this.userSetting.EnableBatchWisePrice){const r=this._trnMainService.priceChangeList.find(o=>0===this._trnMainService.nullToZeroConverter(o.CRATE_A));if(r)return this.alertService.warning(`Selling price for this item with UOM: ${r.UNIT} cannot be 0, Please enter valid selling rate`),!1}return!this.checkPriceAboveCost(i,n)&&(this.updatePriceConversionRates(n),this.markSellingPriceChangedIfNeeded(),!0)}checkPriceAboveCost(i,n){return i>n.CRATE_A?(this.alertService.warning("Cost price for this item cannot be more than Sales price"),!0):1===this.userSetting.ENABLEWSALESRATEBILLING&&i>n.WSRATE_A&&(this.alertService.warning("New Cost price for this item cannot be more than Old Wholesale Sales price"),!0)}updatePriceConversionRates(i){i.CRATE_A&&(i.NRATE_A=i.CRATE_A,i.EX_NRATE_A=this.convertToExclusiveRate(i.CRATE_A)),i.WSRATE_A&&(i.WNRATE_A=i.WSRATE_A,i.EX_WNRATE_A=this.convertToExclusiveRate(i.WSRATE_A))}convertToExclusiveRate(i){return 0==this.userSetting.VatExcludingRate&&1==this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ISVAT?this._trnMainService.nullToZeroConverter(i/(this.userSetting.VatConRate||1)):i}validateNewPrice(i){const n=this._trnMainService.priceChangeList[0],r=this.getExclusiveOrRegularRate(n.NRATE_A,n.EX_NRATE_A),o=this.getExclusiveOrRegularRate(n.WNRATE_A,n.EX_WNRATE_A);return!(this.checkNewSaleRateBelowCost(r,i,"NEW SELLING PRICE")||this.userSetting.ENABLEWSALESRATEBILLING&&this.checkNewSaleRateBelowCost(o,i,"NEW WHOLESALE PRICE")||!this.validateSellingRates(n)||(this.markSellingPriceChangedIfNeeded(),0))}getExclusiveOrRegularRate(i,n){return this._trnMainService.nullToZeroConverter(this.userSetting.VatExcludingRate?n:i)}checkNewSaleRateBelowCost(i,n,r){return i<=n&&(this.alertService.error(`${r} ${i} IS BELOW OR EQUAL TO NEW PURCHASE PRICE ${n}`),!0)}validateSellingRates(i){if(this.userSetting.VatExcludingRate){if(!i.EX_NRATE_A)return this.alertService.warning("Invalid selling rate"),!1;if(this.userSetting.ENABLEWSALESRATEBILLING&&!i.EX_WNRATE_A)return this.alertService.warning("Invalid Wholesale selling rate"),!1}else{const n=this.findInvalidUOM();if(n)return this.alertService.warning(`Invalid new selling price for this item with UOM: ${n.UNIT}, Please enter valid selling rate`),!1}return!0}findInvalidUOM(){return this._trnMainService.priceChangeList.find(1===this.userSetting.EnableBatchWisePrice?i=>0===this._trnMainService.nullToZeroConverter(i.NRATE_A):i=>!i.NRATE_A)}markSellingPriceChangedIfNeeded(){2===this.userSetting.PODELIVERYMODE&&0===this._trnMainService.TrnMainObj.DOFULLRETURN&&"add-purchase-invoice"===this._trnMainService.activeurlpath&&(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].HasSellingPriceChange=!0)}onApplyOldPriceClick(){!this.validateNewSellingRate(!0)||(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ActualmarginRetial=0,this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ActualmarginWholeSale=0,this._trnMainService.showPriceChangeDetail=!1)}onChangePurchasePrice(i,n){const r=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex],o=this._trnMainService.priceChangeList[i],C=0===this.userSetting.VatExcludingRate?o.NRATE_A:o.EX_NRATE_A,B=0===this.userSetting.VatExcludingRate?o.WNRATE_A:o.EX_WNRATE_A;if(!o)return;const te=this.calculateRecommendedMarginRate(r,r.NETRATE?r.NETRATE:r.RATE);C<=te&&(this.entryValidationService.rateValidationDisplayMessage="NEW SELLING PRICE IS BELOW RECOMMENDED MARGIN. PROCEED OR NOT",this.rateValidation.show()),this.userSetting.ENABLEWSALESRATEBILLING&&B<=te&&(console.log("margin1",o,te),this.entryValidationService.rateValidationDisplayMessage="NEW WHOLESALE SELLING PRICE IS BELOW RECOMMENDED MARGIN. PROCEED OR NOT",this.rateValidation.show()),this.focusOnNextInput(),this.updateSellingPrices(i),this.actualMarginCalculation(i),this.updateProdListWithUserInput(i,r,o),this.masterService.is_PurchaseOrder&&this.updatePODetailList(i)}calculateRecommendedMarginRate(i,n){let r=n*(i.RECRATE/100);return 0==this.userSetting.VatExcludingRate?r=(r+n)*this.userSetting.VatConRate:r+=n,i.RECRATE?r:n}applyVAT(i,n){return 0===this.userSetting.VatExcludingRate&&1===n.ISVAT?i*(1+this.userSetting.VATRate):i}focusOnNextInput(){setTimeout(()=>{(document.getElementById("newWholeSellingPrice0")||document.getElementById("apply"))?.focus()},0)}updateSellingPrices(i){this.changeSellingPrice(i),this.actualMarginCalculation(i)}updateProdListWithUserInput(i,n,r){const o=this.getUserInputRate(r),C=this.getUserInputRate(r,!0),B=this.userSetting.VatConRate||1;n.SELLRATEBEFORETAX=1==n.ISVAT&&0==this.userSetting.VatExcludingRate?o/B:o,n.W_SELLRATEBEFORETAX=1==n.ISVAT&&0==this.userSetting.VatExcludingRate?C/B:C,n.MRP=0===this.userSetting.VatExcludingRate?o:o*B,n.W_MRP=0===this.userSetting.VatExcludingRate?C:C*B}getUserInputRate(i,n=!1){return this.userSetting.VatExcludingRate?n?i.EX_WNRATE_A:i.EX_NRATE_A:n?i.WNRATE_A:i.NRATE_A}updatePODetailList(i){this._trnMainService.TrnMainObj.PODetailList[i].SELLRATEBEFORETAX=this._trnMainService.priceChangeList[i].NRATE_A,this._trnMainService.TrnMainObj.PODetailList[i].W_SELLRATEBEFORETAX=this._trnMainService.priceChangeList[i].WNRATE_A}actualMarginCalculation(i){const n=this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex],C=(0,this._trnMainService.nullToZeroConverter)(n.NETRATE)||n.RATE,B=this._trnMainService.priceChangeList[0],Y=this.getUserRate(B,"NRATE_A"),H=this.getUserRate(B,"WNRATE_A"),te=this.userSetting.VatConRate||1;n.ActualmarginRetial=this.calculateMargin(Y,C,te,n.ISVAT),this.userSetting.ENABLEWSALESRATEBILLING&&(n.ActualmarginWholeSale=this.calculateMargin(H,C,te,n.ISVAT)),n.ActualmarginRetial=this.isInvalidMargin(n.ActualmarginRetial,Y)?0:n.ActualmarginRetial,n.ActualmarginWholeSale=this.isInvalidMargin(n.ActualmarginWholeSale,H)?0:n.ActualmarginWholeSale}getUserRate(i,n){return this._trnMainService.nullToZeroConverter(i[this.userSetting.VatExcludingRate?`EX_${n}`:n])}calculateMargin(i,n,r,o){return 100*((this.userSetting.VatExcludingRate||0===o?i:i/r)-n)/n}isInvalidMargin(i,n){return-100===i||0===n}changeSellingPrice(i){const n=1===this.userSetting.VatExcludingRate?"EX_NRATE_A":"NRATE_A",r=1===this.userSetting.VatExcludingRate?"EX_WNRATE_A":"WNRATE_A";for(const o of this._trnMainService.priceChangeList)o.SNO>1&&(o[n]=o.CONFACTOR*this._trnMainService.priceChangeList[i][n],o[r]=o.CONFACTOR*this._trnMainService.priceChangeList[i][r])}onClickYes(){this.rateValidation.hide(),setTimeout(()=>{document.getElementById("newSellingPrice0").focus()},500)}onClickNo(){this.rateValidation.hide(),setTimeout(()=>{document.getElementById("newSellingPrice0").focus()},500)}onItemSelection(i,n,r,o){let C={event:i,col:n,i:r,trnprod:o};this.showNonItemGenericGrid.emit(C),("asset-purchase-invoice"===this._trnMainService.activeurlpath||"assets-openingstockentry"===this._trnMainService.activeurlpath)&&(C.trnprod.SL_ACNAME=null,C.trnprod.SL_ACID=null)}getFilteredList(){return"asset-purchase-invoice"===this._trnMainService.activeurlpath||"assets-openingstockentry"===this._trnMainService.activeurlpath?this._trnMainService.TrnMainObj.AssetsProdList:this._trnMainService.TrnMainObj.ProdList}confirmAuthorization(){1==this._trnMainService.showNegativeBilling&&this._trnMainService.NegativeBillAuthConfirm(this.genericProductService.activerowIndex),1==this.userRightAuthService.showAuthPopup&&this.DeleteAuthConfirm()}DeleteAuthConfirm(){this.spinnerService.show("Authorizing Please wait"),this.masterService.NegativeBillingAuth(this._trnMainService.disAuthObj).subscribe(i=>{this._trnMainService.disAuthObj={username:"",password:"",discount:0,discountType:"0",remarks:""},this.spinnerService.hide(),"ok"==i.status?"ALLOW"==i.result?(this.alertService.success("User Right Granted !"),this._trnMainService.showNegativeBilling=!1,this.userRightAuthService.showAuthPopup=!1,(this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==s.Km.OpeningStockBalance)&&"EDIT"===this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].rowMode?.toUpperCase()&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].TOTALOUTWARDSTOCK)>0&&this.alertService.info(`Edited Quantity Exceed the transaction stock  for the item:${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ITEMDESC}.`),confirm(`Are you sure u you want to delete item ${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].ITEMDESC} (${this._trnMainService.TrnMainObj.ProdList[this.genericProductService.activerowIndex].MENUCODE}) ?`)&&(this._trnMainService.TrnMainObj.ProdList.splice(this.genericProductService.activerowIndex,1),0===this._trnMainService.TrnMainObj.ProdList.length&&this._trnMainService.addRow(),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.quantityExceedCheck="")):(this.alertService.warning("this user has no rights to do delete in  negative stock billing !"),this._trnMainService.showNegativeBilling=!1,this.userRightAuthService.showAuthPopup=!1):(this.alertService.warning("Authorization Failed, cannot delete."),this._trnMainService.showNegativeBilling=!1,this.userRightAuthService.showAuthPopup=!1)},i=>{this.spinnerService.hide(),this.alertService.info(i)})}showDeleteButton(){return!!("asset-purchase-invoice"!=this._trnMainService.activeurlpath&&"assets-openingstockentry"!=this._trnMainService.activeurlpath||"VIEW"!=this._trnMainService.TrnMainObj.Mode&&"EDIT"!=this._trnMainService.TrnMainObj.Mode)}onViewClick(i){this.masterService.getAssetIDListByPurchaseVoucher(this._trnMainService.TrnMainObj.VCHRNO,i.MCODE,i.BATCH).subscribe(n=>{n?.length>0?(this.showAssetProductDetail.ITEMNAME=i.ITEMDESC,this.showAssetProductDetail.LIST=n):this.alertService.info("No data found!")})}closeAssetId(){this.showAssetProductDetail={}}scrollable(){return 82==this._trnMainService.TrnMainObj.VoucherType&&this._trnMainService.TrnMainObj.ProdList?.length>0&&this.genericProductService.headerAfterSubHeader?.length>0&&this._trnMainService.TrnMainObj.ProdList[0].BranchWiseDistributionList1.length>6}onCheckBoxChange(i,n,r,o){n.onCheckBoxChange&&n.onCheckBoxChange(i,r,n,o)}showSecondTable(){if(this._trnMainService.TrnMainObj.VoucherType==s.Km.RequisitionApproval&&this._trnMainService.TrnMainObj.ProdList.some(i=>i.BranchWiseDistributionList2?.length>0)||82==this._trnMainService.TrnMainObj.VoucherType)return!0}onMultiItemSelected(i){this._trnMainService.TrnMainObj.ProdList.length>1&&this.removeInvalidRowsFromprod(),i.forEach(n=>{this.checkDublicateonItemEnter(n)||this.addRow(n,0)})}removeInvalidRowsFromprod(){this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(i=>null!=i.MCODE&&""!=i.MCODE)}checkDublicateonItemEnter(i){return this._trnMainService.TrnMainObj.ProdList.filter(r=>r.ITEMDESC==i.DESCA)?.length>0&&(this._trnMainService.TrnMainObj.ProdList.forEach(r=>{r.ITEMDESC==i.DESCA&&(r.ALTERNATEQUANTIY+=1)}),this._trnMainService.ReCalculateBillWithNormal(),!0)}addRow(i,n,r=!1){this._trnMainService.barCodes.Quantity=1;let o={};o.Sn=this.Snos+=1,o.inputMode=!0,o.MENUCODE=i.MENUCODE,o.ITEMDESC=i.DESCA,o.ALTRATE=i.PRATE,o.RATE=i.PRATE,o.SELLRATEBEFORETAX=r?n?.SELLRATEBEFORETAX:i.RATE,o.MCODE=i.MCODE,o.ISVAT=i.ISVAT,o.UNIT=i.BASEUNIT,o.BASEUNIT=i.BASEUNIT,o.ALTUNIT=i.BASEUNIT,o.MRP=i.MRP,o.BATCH=r?n.BATCH:"",o.NCRATE=null,o.AMOUNT=null,o.INDDISCOUNTRATE=null,o.INDDISCOUNT=null,o.DISCOUNT=null,o.VAT=null,o.NETAMOUNT=null,o.ITEMTYPE=null,o.RECEIVEDTYPE=null,o.WAREHOUSE=null,o.BC=i.BARCODE,o.ALTERNATEQUANTIY=this._trnMainService.barCodes.Quantity,o.PRATE=r?n.costprice:i.costprice,o.STOCK=r?n.STOCK:i.STOCK,o.FulfillBatchQty=!1,o.HASVARIANT=i.HASVARIANT,o.HasMulitplePrice=r?1:0,o.REQEXPDATE=i.REQEXPDATE,o.PTYPE=i.PTYPE,o.NATURETYPE=i.NATURETYPE,o.IsAuthorizeForNegative=!1,o.DISMODE=i.DISMODE,o.ISUNKNOWN=i.ISUNKNOWN,o.SUPPNAME=i.SUPPNAME,1==this.userSetting.ENABLEBARCODEWISEBATCH&&i?.BATCH&&(o.BATCH=i.BATCH),r&&(o.PriceSelected=!0),this._trnMainService.TrnMainObj.ProdList[0].BC||this._trnMainService.TrnMainObj.ProdList[0].MCODE?this._trnMainService.TrnMainObj.ProdList.push(o):this._trnMainService.TrnMainObj.ProdList[0]=o;let C=0;C=this._trnMainService.TrnMainObj.ProdList.length-1,this._trnMainService.getAllUnitsOfItem(C),this._trnMainService.ReCalculateBillWithNormal(),console.log("prodlist",this._trnMainService.TrnMainObj.ProdList)}trackByFn(i){return i}focusQuantityAfterDblClickOnDeliveryChalanReturn(){this._trnMainService.TrnMainObj.VoucherType===s.Km.DeliveryReturn&&(document.getElementById("ALTUNIT"+this.genericProductService.activerowIndex).disabled?null!=document.getElementById("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex)&&setTimeout(()=>{document.getElementById("ALTERNATEQUANTIY"+this.genericProductService.activerowIndex).focus()},20):setTimeout(()=>{document.getElementById("ALTUNIT"+this.genericProductService.activerowIndex).focus()},20))}}return d.\u0275fac=function(i){return new(i||d)(e.Y36(Q.P),e.Y36(L.p),e.Y36(I.gz),e.Y36(m.uw),e.Y36(S.V),e.Y36(g.e),e.Y36(R.y),e.Y36(u.R),e.Y36(a.c),e.Y36(E.w),e.Y36(y.C),e.Y36(P.T),e.Y36(x.h),e.Y36(O.i))},d.\u0275cmp=e.Xpm({type:d,selectors:[["generic-product-entry"]],viewQuery:function(i,n){if(1&i&&(e.Gf(Ee,5),e.Gf(Oe,5),e.Gf(ge,5),e.Gf(me,5),e.Gf(Pe,5),e.Gf(fe,5),e.Gf(be,5),e.Gf(Ie,5),e.Gf(ye,5),e.Gf(F,5),e.Gf(Ce,5)),2&i){let r;e.iGM(r=e.CRH())&&(n.table1=r.first),e.iGM(r=e.CRH())&&(n.table2=r.first),e.iGM(r=e.CRH())&&(n.genericGrid=r.first),e.iGM(r=e.CRH())&&(n.rateValidation=r.first),e.iGM(r=e.CRH())&&(n.genericGridPopupComponent=r.first),e.iGM(r=e.CRH())&&(n.barCodeGridPopup=r.first),e.iGM(r=e.CRH())&&(n.genericGridMulitplePricePopup=r.first),e.iGM(r=e.CRH())&&(n.matrixitemgrid=r.first),e.iGM(r=e.CRH())&&(n.authenticationPopup=r.first),e.iGM(r=e.CRH())&&(n.templateRefs=r),e.iGM(r=e.CRH())&&(n.itemDesc=r)}},hostBindings:function(i,n){1&i&&e.NdJ("keydown",function(o){return n.updown(o)},!1,e.evT)},inputs:{genericProductEntrySetting:["GenericProductEntrySetting","genericProductEntrySetting"],genericProductEntrySetting2:["GenericProductEntrySetting2","genericProductEntrySetting2"]},outputs:{showNonItemGenericGrid:"showNonItemGenericGrid",ShowGenericGridEvent:"ShowGenericGridEvent",onChangeProductionItem:"onChangeProductionItem"},decls:79,vars:49,consts:[[2,"margin-right","15px",3,"ngClass"],[1,"wrapper","height-wrapper",3,"ngClass","ngStyle","scroll"],["table1",""],["id","productEntrySetting.tableId",3,"ngClass"],["id","prodlistTableheader",2,"background","silver","color","black","border-width","1px 1px 0 1px","border-color","#b4b4b4","border-style","solid"],[4,"ngFor","ngForOf"],["style","background: silver; color: black; border-width: 0px 1px 0 1px; border-color: #b4b4b4; border-style: solid; position: sticky; top: 36px; ",4,"ngIf"],[2,"border","1px"],["class","add",3,"click",4,"ngIf"],[4,"ngIf"],[3,"appCtrlTemplate"],["barcodeInputText",""],["barcodeInputText1",""],["default",""],["itemDesc",""],["batch",""],["unitsOption",""],["locationOption",""],["quantity",""],["inputText",""],["popup",""],["CommentsSelect",""],["number",""],["date",""],["checkBox",""],[3,"popupsettings","onItemDoubleClick","onItemsSelected"],["genericGrid",""],[3,"popupsettings","onItemDoubleClick"],["genericGridPopupComponent",""],["barCodeGridPopup",""],["genericGridMulitplePricePopup",""],[3,"activeIndex","closeBatchPopupEvent","emitCreatedBatchEvent",4,"ngIf"],["class","PList",4,"ngIf"],[3,"activerowIndex","matrixItemAtrribute","onApplyClicked"],["matrixitemgrid",""],[3,"onUserRightReceived"],["authenticationPopup",""],["class","modal-sticky","style","width:100%",4,"ngIf"],["bsModal","","tabindex","0","role","dialog","aria-labelledby","mySmallModalLabel","aria-hidden","true",1,"modal","fade",2,"height","460px","z-index","9999999",3,"config"],["rateValidatoin","bs-modal"],[1,"modal-dialog","modal-sm"],[1,"modal-content",2,"width","420px"],[1,"modal-header"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],[1,"col-md-12",2,"margin-top","-10px","margin-bottom","12px"],[1,"col-md-12"],[1,"btn","btn-danger",2,"margin-right","4px",3,"click"],["type","button ",1,"btn","btn-warning",3,"click"],["style","position: sticky; top: 0;",3,"ngStyle",4,"ngIf"],[2,"position","sticky","top","0",3,"ngStyle"],[2,"background","silver","color","black","border-width","0px 1px 0 1px","border-color","#b4b4b4","border-style","solid","position","sticky","top","36px"],[3,"ngStyle"],[2,"border","1px solid #b4b4b4","max-height","25px",3,"id","click","keydown.Shift.delete"],["style","border: 1px solid #b4b4b4;",4,"ngIf"],[2,"border","1px solid #b4b4b4"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[2,"border","1px solid #b4b4b4",3,"ngStyle"],["style","border: 1px solid #b4b4b4",4,"ngIf"],[1,"add",3,"click"],[1,"wrapper","height-wrapper","mt-4",3,"scroll"],["table2",""],["style","background: silver; color: black; border-width: 0px 1px 0 1px; border-color: #b4b4b4; border-style: solid; position: sticky; top: 36px;",4,"ngIf"],[3,"i","index","col","trnprod","ItemKeyEvent","dblClickPopupItem"],[3,"i","ItemKeyEvent","dblClickPopupItem"],["type","text",2,"width","100%",3,"i","disabled","keydown.Tab","change","keydown.enter","focusout"],["class","row",4,"ngIf"],[1,"col-md-6",2,"width","100%",3,"ngClass"],[1,"col-md-6",2,"float","right"],["type","checkbox","style","width: 21px;",3,"ngModel","disabled","ngModelChange","change",4,"ngIf"],["type","checkbox",2,"width","21px",3,"ngModel","disabled","ngModelChange","change"],[3,"ngStyle","id","mouseover","mouseleave"],[2,"display","none",3,"ngClass","innerHTML"],[4,"ngIf","ngIfElse"],["view",""],[1,"closeTooltip",3,"disabled","click"],["src","../../../assets/icons/close-icon.png","alt","",2,"width","20px","padding","2.5px"],[1,"closeTooltip",3,"click"],[1,"fa-solid","fa-eye"],[3,"trnprod","index","col","showGenericGrid"],[3,"innerHtml"],["type","text","placeholder","Press ENTER to Select",2,"width","100%",3,"id","ngModel","disabled","readonly","ngModelChange","keydown.enter","keydown.Tab"],[3,"i","index","col","trnprod"],["type","text","autocomplete","off",3,"id","ngStyle","ngModel","placeholder","disabled","ngModelChange","click","keydown.enter","keydown.tab","change"],["type","text","autocomplete","off","readonly","",2,"width","100%",3,"id","ngModel","placeholder","disabled","keydown.enter"],["type","text",2,"width","100%",3,"id","ngModel","disabled","ngModelChange","change","keydown.enter","keydown.tab"],[3,"value"],["type","number","step","0.001",3,"id","ngStyle","ngModel","disabled","decimalPlacesRestriction","readonly","change","keydown.enter","keydown.tab","ngModelChange","keyup","focusout","mouseover","mouseleave"],[3,"id","type","ngStyle","ngModel","disabled","min","ngModelChange","keydown.enter","keydown.tab"],["type","checkbox","autocomplete","off",3,"id","ngStyle","ngModel","disabled","ngModelChange","click","change"],[3,"activeIndex","closeBatchPopupEvent","emitCreatedBatchEvent"],[1,"PList"],[3,"AlternateUnits","activerowIndex","title","BList","voucherType","activeurlpath","dbClickEvent","BatchClosedClick","returnBatchValue","showCreateBatchEvent"],[1,"modal-sticky",2,"width","100%"],["class","extraDom","style","\n    display: block;\n    padding: 0px;\n    margin-bottom: 25px;\n    height: 390px;\n    position: absolute;\n    right: 25%;\n    top: 5px;\n    width: 51%;\n    z-index: 9999999;\n  ",4,"ngIf"],[1,"extraDom",2,"display","block","padding","0px","margin-bottom","25px","height","390px","position","absolute","right","25%","top","5px","width","51%","z-index","9999999"],[1,"modal-content","modal-content-main-area",2,"overflow","unset"],[1,"modal-header",2,"height","40px"],["id","myModalLabel",1,"modal-title",2,"font-size","15px"],[1,"col-md-12",2,"height","300px","margin-top","10px"],[2,"margin-top","4px","margin-bottom","2px"],["type","number",3,"ngModel","ngModelChange"],[2,"font-size","13px","width","32%"],[1,"table"],[2,"border-bottom","2px solid #b4b4b4","border-top","2px solid #b4b4b4","height","30px","background","silver","color","black"],["scope","col",2,"width","15%"],["scope","col",2,"width","17%"],["scope","col","style","width: 18%",4,"ngIf"],["scope","col","style","width: 23%;line-height: 1.2 !important",4,"ngIf"],["scope","col","style","width: 23%;line-height: 1.2 !important;",4,"ngIf"],[1,"col-md-12","row",2,"padding","0px"],[1,"col-md-4"],[1,"col-md-8","row","justify-content-end",2,"text-align","right"],["style","margin-right: 0;",4,"ngIf"],["class","d-flex justify-content-end","style","gap: 10px;",4,"ngIf"],["id","apply",1,"btn","btn-info","pull-right",2,"margin","0px 4px",3,"click","keydown.enter"],[1,"btn","btn-info","pull-right",2,"margin","0px 4px",3,"click","keydown.enter"],["scope","col",2,"width","18%"],["scope","col",2,"width","23%","line-height","1.2 !important"],[2,"border","1px solid #b4b4b4","max-height","25px"],["style","border: 1px solid #b4b4b4 ;width: 98%",4,"ngIf"],["appSalesRateDisableFromUserProfile","","type","number",2,"height","33px","width","98%","border","1px solid #b4b4b4",3,"id","ngModel","disabled","change","ngModelChange","keyup","keydown.enter","keydown.Tab"],[2,"border","1px solid #b4b4b4","width","98%"],[2,"margin-right","0"],[1,"d-flex","justify-content-end",2,"gap","10px"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","-4rem","margin-right","27rem","bottom","85px"],[1,"modal-content","modal-content-main-area",2,"width","70%","height","auto"],[1,"modal-header",2,"padding","0px","background","#c0c0c0"],[1,"modal-title",2,"padding-left","5px"],[1,"form-group","row",2,"margin","0.5rem"],[1,"col-sm-4","form-control-label",2,"font-size","13px"],[1,"col-sm-7",2,"padding","0px"],["type","text","id","AuthUserName","autocomplete","off",1,"form-control",2,"height","4vh","font-size","13px",3,"ngModel","ngModelChange"],["type","password","id","Parent","autocomplete","off",1,"form-control",2,"height","4vh","font-size","13px",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","submit",1,"btn","btn-sm","btn-info",2,"font-size","12px",3,"click"],["type","button",1,"btn","btn-sm","btn-info",2,"font-size","12px",3,"click"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1,2),e.NdJ("scroll",function(o){return(null==n.table2?null:n.table2.nativeElement).scrollTop=o.target.scrollTop}),e.TgZ(3,"table",3)(4,"tr",4),e.YNc(5,Le,2,1,"ng-container",5),e.YNc(6,De,2,1,"ng-container",5),e.qZA(),e.YNc(7,we,2,1,"tr",6),e.TgZ(8,"tbody",7),e.YNc(9,Ge,5,12,"ng-container",5),e.qZA()(),e.YNc(10,We,3,0,"span",8),e.ALo(11,"hide"),e.qZA(),e.YNc(12,lt,12,13,"ng-container",9),e.qZA(),e.YNc(13,ht,1,4,"ng-template",10,11,e.W1O),e.YNc(15,ut,3,7,"ng-template",null,12,e.W1O),e.YNc(17,gt,3,3,"ng-template",10,13,e.W1O),e.YNc(19,mt,4,4,"ng-template",10,14,e.W1O),e.YNc(21,Pt,2,8,"ng-template",10,15,e.W1O),e.YNc(23,ft,1,4,"ng-template",10,16,e.W1O),e.YNc(25,bt,1,4,"ng-template",10,17,e.W1O),e.YNc(27,It,1,4,"ng-template",10,16,e.W1O),e.YNc(29,yt,1,4,"ng-template",10,18,e.W1O),e.YNc(31,Ct,3,11,"ng-template",10,19,e.W1O),e.YNc(33,At,2,8,"ng-template",10,20,e.W1O),e.YNc(35,Rt,3,8,"ng-template",10,21,e.W1O),e.YNc(37,xt,7,23,"ng-template",10,22,e.W1O),e.YNc(39,Nt,2,10,"ng-template",10,23,e.W1O),e.YNc(41,wt,3,10,"ng-template",10,24,e.W1O),e.TgZ(43,"generic-popup-grid",25,26),e.NdJ("onItemDoubleClick",function(o){return n.dblClickPopupItem(o)})("onItemsSelected",function(o){return n.onMultiItemSelected(o)}),e._uU(45," >\n"),e.qZA(),e.TgZ(46,"generic-popup-grid",27,28),e.NdJ("onItemDoubleClick",function(o){return n.dblClickPopupItem(o)}),e.qZA(),e.TgZ(48,"barcode-popup-grid",27,29),e.NdJ("onItemDoubleClick",function(o){return n.dblClickbarcodePopUP(o)}),e.qZA(),e.TgZ(50,"multiple-price-popup-grid",27,30),e.NdJ("onItemDoubleClick",function(o){return n.dblClickPricePopUP(o)}),e.qZA(),e.YNc(52,Bt,1,1,"create-manual-batch-popup",31),e.YNc(53,Ut,2,6,"div",32),e.TgZ(54,"matrix-item-grid",33,34),e.NdJ("onApplyClicked",function(o){return n.setVariantData(o)}),e.qZA(),e.TgZ(56,"authentication-entry",35,36),e.NdJ("onUserRightReceived",function(o){return n.onUserRightReceived(o)}),e.qZA(),e.YNc(58,zt,2,1,"div",37),e.TgZ(59,"div")(60,"div",38,39)(62,"div",40)(63,"div",41)(64,"div",42)(65,"button",43),e.NdJ("click",function(){return n.onClickNo()}),e.TgZ(66,"span",44),e._uU(67,"\xd7"),e.qZA()()(),e.TgZ(68,"div",45)(69,"div",46)(70,"div",47),e._uU(71),e.qZA(),e.TgZ(72,"div",48)(73,"button",49),e.NdJ("click",function(){return n.onClickYes()}),e._uU(74," Yes "),e.qZA(),e.TgZ(75,"button",50),e.NdJ("click",function(){return n.onClickNo()}),e._uU(76," No "),e.qZA()()()()()()()(),e.YNc(77,ei,25,2,"div",9),e.YNc(78,ii,17,2,"ng-container",9)),2&i&&(e.Q6J("ngClass",e.VKq(40,ni,"inventory-allocation"==n.genericProductService.activeurlpath)),e.xp6(1),e.Q6J("ngClass",e.VKq(42,ri,n.userSetting.IsBBSM))("ngStyle",e.VKq(44,oi,n.userSetting.IsBBSM?"goods-received-note"===n.genericProductService.activeurlpath&&n.masterService.ShowMore?n.genericProductEntrySetting.height:"510px":"auto")),e.xp6(2),e.Q6J("ngClass",e.VKq(46,le,n.scrollable())),e.xp6(2),e.Q6J("ngForOf",n.genericProductEntrySetting.columns),e.xp6(1),e.Q6J("ngForOf",null==n.genericProductService?null:n.genericProductService.headerAfterSubHeader),e.xp6(1),e.Q6J("ngIf",n.genericProductEntrySetting.showSubHeading),e.xp6(2),e.Q6J("ngForOf",n.getFilteredList()),e.xp6(1),e.Q6J("ngIf",e.xi3(11,37,"hideAddButton",n._trnMainService.callPipe)&&"VIEW"!=n._trnMainService.TrnMainObj.Mode),e.xp6(2),e.Q6J("ngIf",n.showSecondTable()),e.xp6(1),e.Q6J("appCtrlTemplate","barcodeInputText"),e.xp6(4),e.Q6J("appCtrlTemplate","default"),e.xp6(2),e.Q6J("appCtrlTemplate","itemDesc"),e.xp6(2),e.Q6J("appCtrlTemplate","batch"),e.xp6(2),e.Q6J("appCtrlTemplate","unitsOption"),e.xp6(2),e.Q6J("appCtrlTemplate","locationOption"),e.xp6(2),e.Q6J("appCtrlTemplate","defaultOption"),e.xp6(2),e.Q6J("appCtrlTemplate","quantity"),e.xp6(2),e.Q6J("appCtrlTemplate","inputText"),e.xp6(2),e.Q6J("appCtrlTemplate","popup"),e.xp6(2),e.Q6J("appCtrlTemplate","CommentsSelect"),e.xp6(2),e.Q6J("appCtrlTemplate","number"),e.xp6(2),e.Q6J("appCtrlTemplate","date"),e.xp6(2),e.Q6J("appCtrlTemplate","checkBox"),e.xp6(2),e.Q6J("popupsettings",n.genericProductService.gridPopupSettings),e.xp6(3),e.Q6J("popupsettings",n.GenericPopUpSettings),e.xp6(2),e.Q6J("popupsettings",n.barcodeGridSettings),e.xp6(2),e.Q6J("popupsettings",n.gridPopupSettingsForMultiplePrice),e.xp6(2),e.Q6J("ngIf",n.showCreateBatch),e.xp6(1),e.Q6J("ngIf","Batch Price Selection"==n.masterService.PlistTitle||"Item Variant Selection"==n.masterService.PlistTitle||"Batch Selection"==n.masterService.PlistTitle||"Consumption Batch Selection"==n.masterService.PlistTitle),e.xp6(1),e.Q6J("activerowIndex",n.genericProductService.activerowIndex)("matrixItemAtrribute",n.genericProductService.matrixItemAtrribute),e.xp6(4),e.Q6J("ngIf",n._trnMainService.showPriceChangeDetail&&1==n.userSetting.ShowPriceChangePopup),e.xp6(2),e.Q6J("config",e.DdM(48,ci)),e.xp6(11),e.hij(" ",n.entryValidationService.rateValidationDisplayMessage," "),e.xp6(6),e.Q6J("ngIf",1==n._trnMainService.showNegativeBilling||1==n.userRightAuthService.showAuthPopup),e.xp6(1),e.Q6J("ngIf",(null==n.showAssetProductDetail.LIST?null:n.showAssetProductDetail.LIST.length)>0))},dependencies:[j.n,D.Zl,h.ed,U.m,V._v,W.t,$.B,t.mk,t.sg,t.O5,t.tP,t.PC,N.YN,N.Kr,N.Fj,N.wV,N.Wl,N.EJ,N.JJ,N.On,k.K,b.F,w.oB,F,_,v,A,ie,Me,G.g,c.e,Te.R,Se.v,ve,pe],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.position-static[_ngcontent-%COMP%]{position:static}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:8px}th[_ngcontent-%COMP%]{text-align:left;background:#eee}.wrapper[_ngcontent-%COMP%]{width:100%}.overflow[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:auto}.color[_ngcontent-%COMP%]{background:#ff4141}.col1[_ngcontent-%COMP%]{position:absolute;width:10em;left:0;top:auto}.col2[_ngcontent-%COMP%]{position:absolute;width:5em;left:10em;top:auto}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:10px;right:10px}.modal-backdrop[_ngcontent-%COMP%]{display:none}.tooltipChild[_ngcontent-%COMP%]{display:block!important;background:seagreen;position:absolute;border-radius:17px;text-align:center;color:#fff;width:13%}.tooltipChildRate[_ngcontent-%COMP%]{display:block!important;background:seagreen;position:absolute;border-radius:17px;text-align:center;color:#fff;width:13%;top:30px}.modal-content[_ngcontent-%COMP%]{padding:1px;margin:0;float:right;width:122%}tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover{background-color:#f3f5f4;cursor:pointer}tr[_ngcontent-%COMP%]{font-size:13px}.selected-row[_ngcontent-%COMP%]{background-color:#7ed0ff}tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{line-height:30px!important;padding:3px}thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{line-height:11px!important}tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child{text-align:left!important;padding:0 0 0 11px!important}.modal-content[_ngcontent-%COMP%]{box-shadow:-10px 0 10px 1px #aaa}.modal-content-main-area[_ngcontent-%COMP%]{max-height:100%;height:94%;overflow:auto;overflow-x:hidden}.modal-content-summary-area[_ngcontent-%COMP%]{max-height:20%;height:20%;overflow:auto;overflow-x:hidden}.ellipsis[_ngcontent-%COMP%]{white-space:nowrap}.close[_ngcontent-%COMP%]{margin:-9px 0}.highlighted[_ngcontent-%COMP%]{background-color:#7ed0ff}.bgforlessstockitem[_ngcontent-%COMP%]{background-color:#ffc107d2}.less-quantity[_ngcontent-%COMP%]{background-color:#ff4141}.add[_ngcontent-%COMP%]{color:#04aa6d;border:2px solid #04AA6D;margin-top:5px}span.add[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}span.add[_ngcontent-%COMP%]{display:inline-block;width:22px;height:22px;text-align:center;font-size:20px;font-family:Roboto;border-radius:50%;background:#FFF;position:relative;cursor:pointer}.closeTooltip[_ngcontent-%COMP%]{display:inline-block;transition:.3s ease;border:none;background:none}.closeTooltip[_ngcontent-%COMP%]:focus{outline:none}.tooltiptext[_ngcontent-%COMP%]{visibility:hidden;opacity:0;width:49px;background-color:#000;color:#fff;text-align:center;border-radius:3px;padding:0;position:absolute;right:0;font-size:10px;height:20px;top:-14px;align-items:center;line-height:2;z-index:99}.scrollable[_ngcontent-%COMP%]{width:max-content;overflow-x:auto;table-layout:fixed}.close-wrapper[_ngcontent-%COMP%]:hover   .tooltiptext[_ngcontent-%COMP%]{visibility:visible;opacity:1}@media screen and (max-width: 1366px){.fixedHeight[_ngcontent-%COMP%]{height:380px}}"]}),d})()},54471:(z,Z,M)=>{M.d(Z,{o:()=>k});var t=M(8239),e=M(92340),s=M(42326),h=M(28698),V=M(38011),p=M(66274),F=M(53074),Q=M(87584),L=M(67311),I=M(48083),m=M(67297),S=M(14970),g=M(48063),R=M(92752),u=M(7587),a=M(37051);const E=["multiselectGenericGrid"],y=["genericGrid"],P=["genericGridForSupplier"],x=["genericGridForBarcodeWiseProduct"];function O(b,w){if(1&b){const c=p.EpF();p.TgZ(0,"input",19),p.NdJ("ngModelChange",function(l){p.CHM(c);const v=p.oxw();return p.KtG(v._trnMainService.barCodes.DESCA=l)}),p.qZA()}if(2&b){const c=p.oxw();p.Q6J("disabled",c.disableBarcode())("ngModel",c._trnMainService.barCodes.DESCA)}}function j(b,w){if(1&b){const c=p.EpF();p.TgZ(0,"input",20),p.NdJ("ngModelChange",function(l){p.CHM(c);const v=p.oxw();return p.KtG(v._trnMainService.barCodes.DESCA=l)})("keydown.enter",function(){p.CHM(c);const l=p.oxw();return p.KtG(l.descEnter())})("keypress",function(l){p.CHM(c);const v=p.oxw();return p.KtG(v.keyPress(l))}),p.qZA()}if(2&b){const c=p.oxw();p.Q6J("ngModel",c._trnMainService.barCodes.DESCA)("disabled",c.disableBarcode())}}const D=function(){return{color:"green"}},U=function(){return{color:"red"}};function W(b,w){if(1&b&&(p.TgZ(0,"div",1)(1,"label",21),p._uU(2,"Stock: \xa0"),p.TgZ(3,"span",22),p._uU(4),p.qZA()()()),2&b){const c=p.oxw();p.xp6(3),p.Q6J("ngStyle",c.productHelperService.barcodeEnterStock>0?p.DdM(2,D):p.DdM(3,U)),p.xp6(1),p.Oqu(c.productHelperService.barcodeEnterStock)}}function $(b,w){if(1&b){const c=p.EpF();p.TgZ(0,"div",1)(1,"fieldset",23)(2,"legend",24)(3,"input",25),p.NdJ("ngModelChange",function(l){p.CHM(c);const v=p.oxw();return p.KtG(v.enableSupplierSelect=l)})("change",function(l){p.CHM(c);const v=p.oxw();return p.KtG(v.enableSupplierSelect=l.target.checked?1:0)})("ngModelChange",function(l){p.CHM(c);const v=p.oxw();return p.KtG(v.onChangeEvent(l))}),p.qZA(),p._uU(4,"Supplier Wise Filter"),p.qZA(),p.TgZ(5,"div",1)(6,"label",26),p._uU(7,"Supplier Name:"),p.qZA(),p.TgZ(8,"div",27)(9,"input",28),p.NdJ("keydown.Enter",function(){p.CHM(c);const l=p.oxw();return p.KtG(l.onSupplierEnter())})("keyup",function(){p.CHM(c);const l=p.oxw();return p.KtG(l.onSupplierEnter())})("keypress",function(l){p.CHM(c);const v=p.oxw();return p.KtG(v.keyPress(l))})("ngModelChange",function(l){p.CHM(c);const v=p.oxw();return p.KtG(v._trnMainService.TrnMainObj.BILLTO=l)}),p.qZA()()()()()}if(2&b){const c=p.oxw();p.xp6(3),p.Q6J("ngModel",c.enableSupplierSelect)("checked",1==c.enableSupplierSelect)("disabled","VIEW"==c.tranMode),p.xp6(6),p.Q6J("disabled","VIEW"==c.tranMode||0==c.enableSupplierSelect)("ngModel",c._trnMainService.TrnMainObj.BILLTO)}}function N(b,w){if(1&b){const c=p.EpF();p.TgZ(0,"div",29)(1,"PBatchList",30),p.NdJ("dbClickEvent",function(l){p.CHM(c);const v=p.oxw();return p.KtG(v.dblClickPopupBatch(l))})("BatchClosedClick",function(){p.CHM(c);const l=p.oxw();return p.KtG(l.model1Closed())})("returnBatchValue",function(l){p.CHM(c);const v=p.oxw();return p.KtG(v.returnBatch(l))}),p.qZA()()}if(2&b){const c=p.oxw();p.xp6(1),p.Q6J("AlternateUnits",c.AlternateUnits)("activerowIndex",c.activerowIndex)("title",c.PlistTitle)("BList",c.batchlist)("voucherType",c._trnMainService.TrnMainObj.VoucherType)("activeurlpath",c.activeurlpath)}}let k=(()=>{class b{constructor(c,_,l,v,T,A,K){this.masterService=c,this._trnMainService=_,this.alertService=l,this.arouter=v,this.authservice=T,this.spinnerService=A,this.productHelperService=K,this.activerowIndex=0,this.productWiseBarCode=[],this.loadFromBarcode=!1,this.showStockedQuantityOnly=0,this.barcodeDisplay=!1,this.TrnMainObj={},this.batchlist=[],this.PlistTitle="",this.loadDescriptionWiseProduct=!1,this.enableSupplierSelect=0,this.multiselectPopupSettings=new V.oe,this.gridPopupSettings=new h.im,this.genericGridForSupplierSetting=new h.im,this.genericGridForBarcodeWiseProductSetting=new h.im,this.Snos=0,this.userSetting=this.authservice.getSetting(),this.activeurlpath=v.snapshot.url[0]?.path,this.genericGridForBarcodeWiseProductSetting={title:"BARCODE WISE PRODUCTS",apiEndpoints:"",defaultFilterIndex:1,columns:[{key:"MENUCODE",title:"Item Code",hidden:!1,noSearch:!1},{key:"DESCA",title:"Item Name",hidden:!1,noSearch:!1},{key:"DESCB",title:"Description",hidden:!1,noSearch:!1},{key:"BARCODE",title:"Barcode",hidden:!1,noSearch:!0},{key:"MRP",title:"MRP",hidden:!1,noSearch:!0}]}}ngOnInit(){this._trnMainService.barCodes.BC="",this._trnMainService.barCodes.DESCA="",this.productHelperService.barcodeEnterStock=null}disableBarcode(){return!!("VIEW"==this._trnMainService.TrnMainObj.Mode||this._trnMainService.disableOnPerFormaSelect||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL&&"purchase-import"==this.activeurlpath||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL&&1==this.userSetting.ENABLE_GRN_IN_PI&&"goods-received-note"==this.activeurlpath||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&"add-debitnote-itembase"==this.activeurlpath&&"1"==this.userSetting.REFBILLCOMPULSORINDNOTE||this._trnMainService.TrnMainObj.VoucherType==s.Km.CreditNote&&0==this.userSetting.ENABLEMANUALSALESRETURN&&!this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.VoucherType==s.Km.DeliveryReturn&&(!this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.REFBILL&&1==this._trnMainService.TrnMainObj.DOFULLRETURN)||"add-purchase-invoice"==this.activeurlpath&&(1==this._trnMainService.TrnMainObj.DOFULLRETURN&&(0!=this.userSetting.PODELIVERYMODE||0!=this.userSetting.ENABLE_GRN_IN_PI)&&0==this.userSetting.DisablePOReferenceRequired||1==this.userSetting.ENABLE_GRN_IN_PI&&this._trnMainService.TrnMainObj.REFORDBILL||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&0!=this.userSetting.PODELIVERYMODE&&0==this.userSetting.ENABLE_GRN_IN_PI&&this._trnMainService.TrnMainObj.REFORDBILL)||(this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.Sales)&&this._trnMainService.TrnMainObj.REFORDBILL&&1==this._trnMainService.TrnMainObj.LOADFULLFROMQT||this._trnMainService.TrnMainObj.VoucherType===s.Km.SalesOrder&&this._trnMainService.TrnMainObj.REFORDBILL&&1==this._trnMainService.TrnMainObj.DOFULLRETURN||(this._trnMainService.TrnMainObj.VoucherType===s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue&&"FROMREQUESITION"==this._trnMainService.TrnMainObj.tag)&&this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice&&this._trnMainService.TrnMainObj.DELIVERYREF)||(null!=this._trnMainService.TrnMainObj.FLATDCAMNT&&0!=this._trnMainService.TrnMainObj.FLATDCAMNT||null!=this._trnMainService.TrnMainObj.DCRATE&&0!=this._trnMainService.TrnMainObj.DCRATE?!((0==this._trnMainService.TrnMainObj.DOFULLRETURN||0==this._trnMainService.TrnMainObj.LOADFULLFROMQT)&&(this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.REFORDBILL)):void 0)}barcodeQuantityClick(c){if(this.loadDescriptionWiseProduct){let _=this._trnMainService.TrnMainObj.ProdList.findIndex(l=>l.ITEMDESC==this._trnMainService.barCodes.DESCA);if(2==this.userSetting.OneToOneBarcodeMode&&(this._trnMainService.TrnMainObj.VoucherType==s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==s.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType==s.Km.BranchTransferOut)&&this._trnMainService.barCodes.Quantity>this._trnMainService.TrnMainObj.ProdList[_].TOTSTOCK)return void this.alertService.info("Quantity exceed the avilable stock");this._trnMainService.TrnMainObj.ProdList[_].ALTERNATEQUANTIY=this._trnMainService.barCodes.Quantity,this._trnMainService.ReCalculateBillWithNormal()}else{let _=this._trnMainService.TrnMainObj.ProdList.findIndex(l=>l.BC==this._trnMainService.barCodes.BC&&0==l.FulfillBatchQty);if(1==this._trnMainService.TrnMainObj.ProdList[_].NATURETYPE&&1!=this._trnMainService.barCodes.Quantity&&(this._trnMainService.TrnMainObj.VoucherType===s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote))return this.alertService.info("The entered item cannot have duplicate barcodes!"),void(this._trnMainService.barCodes.Quantity=1);if(1==this.userSetting.ENABLESINGLEBATCHMODE){let l=this.getTotalQty(this._trnMainService.TrnMainObj.ProdList.filter(T=>T.BC==this._trnMainService.barCodes.BC)[0].MCODE,!0),v=this._trnMainService.TrnMainObj.ProdList.findIndex(T=>T.BC==this._trnMainService.barCodes.BC);this._trnMainService.TrnMainObj.ProdList[v].IsAuthorizeForNegative||this._trnMainService.allowNegativeBilling(v,!1,!1,!0,l),this.addQuantityInExistingRow(_,this._trnMainService.barCodes.Quantity,!0)}else if(this.checkGridEnteredQty(this._trnMainService.barCodes.Quantity,this._trnMainService.barCodes.BC,!1,0,!0)){if(this._trnMainService.TrnMainObj.VoucherType!=s.Km.SalesOrder&&this._trnMainService.TrnMainObj.VoucherType!=s.Km.Purchase&&this._trnMainService.TrnMainObj.VoucherType!=s.Km.ManualstockEntry&&this._trnMainService.TrnMainObj.VoucherType!=s.Km.RequisitionEntry&&!this.checkMcodeWiseStock(this._trnMainService.TrnMainObj.ProdList.filter(l=>l.BC==this._trnMainService.barCodes.BC)[0].MCODE,!0))return console.log("reach202"),void this.alertService.info("Quantity exceed the avilable stock");this.addQuantityInExistingRow(_,this._trnMainService.barCodes.Quantity,!0)}}}myFunction(){}ItemBarCodeClick(c){if(2==this.userSetting.OneToOneBarcodeMode&&this._trnMainService.TrnMainObj.VoucherType==s.Km.DebitNote&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&!this._trnMainService.TrnMainObj.REFBILL&&1==this.userSetting.REFBILLCOMPULSORINDNOTE)return void this.alertService.info("Please Load the ref bill for return");if(0==this.userSetting.DisablePOReferenceRequired&&0!=this.userSetting.PODELIVERYMODE&&!this._trnMainService.TrnMainObj.REFORDBILL&&(this._trnMainService.TrnMainObj.VoucherType==s.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase))return void this.alertService.info("Please Load the ref bill for return");let _=this._trnMainService.TrnMainObj.ProdList?.findIndex(v=>v.BC==this._trnMainService.barCodes.BC&&!v.FulfillBatchQty);c.preventDefault(),document.getElementById("barcodeField").select(),this._trnMainService.TrnMainObj.ProdList.length>1&&this.removeInvalidRowsFromprod(),("self-billing"!=this.activeurlpath||this.validationInSelfBilling())&&this._trnMainService.checkBarcode(this._trnMainService.barCodes.BC,this._trnMainService.TrnMainObj.MWAREHOUSE).subscribe(v=>{if("ok"==v.status)if(this.checkItemInGrid()){if(1!=this._trnMainService.TrnMainObj.ProdList[_]?.NATURETYPE||this._trnMainService.TrnMainObj.VoucherType!==s.Km.BranchTransferOut&&this._trnMainService.TrnMainObj.VoucherType!==s.Km.TaxInvoice&&this._trnMainService.TrnMainObj.VoucherType!==s.Km.Sales&&this._trnMainService.TrnMainObj.VoucherType!==s.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==s.Km.SalesOrder){if((this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockSettlement||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote)&&!this.checkGridEnteredQty(1,this._trnMainService.barCodes.BC)||this._trnMainService.TrnMainObj.REFBILL&&(console.log("khai ?"),(this._trnMainService.TrnMainObj.VoucherType===s.Km.CreditNote&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&0==this.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType===s.Km.DeliveryReturn&&0==this._trnMainService.TrnMainObj.DOFULLRETURN)&&!this.checkGridEnteredQty(1,this._trnMainService.barCodes.BC)))return;if(0==this.userSetting.ENABLESINGLEBATCHMODE&&(this._trnMainService.TrnMainObj.VoucherType==s.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType==s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType==s.Km.Sales||this._trnMainService.TrnMainObj.VoucherType==s.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockSettlement)&&!this.checkMcodeWiseStock(this._trnMainService.TrnMainObj.ProdList.filter(T=>T.BC==this._trnMainService.barCodes.BC)[0].MCODE,!0))return void this.alertService.info("Quantity exceed the avilable stock");if(1==this.userSetting.ENABLESINGLEBATCHMODE){let T=this.getTotalQty(this._trnMainService.TrnMainObj.ProdList.filter(K=>K.BC==this._trnMainService.barCodes.BC)[0].MCODE,!0),A=this._trnMainService.TrnMainObj.ProdList.findIndex(K=>K.BC==this._trnMainService.barCodes.BC);this._trnMainService.TrnMainObj.ProdList[A].IsAuthorizeForNegative||this._trnMainService.allowNegativeBilling(A,!1,!1,!0,T)}console.log("reachhere",_),this.addQuantityInExistingRow(_,1)}else if(this._trnMainService.TrnMainObj.ProdList.find(A=>A.BC==this._trnMainService.barCodes.BC).ALTERNATEQUANTIY>0)return void this.alertService.error("Item has already been loaded!!")}else this.loadBarcodeWiseProductList();else this.alertService.info(v.result)})}getBarcodeScanEndPoint(){const c=encodeURIComponent("wholesale");let _="",l=this._trnMainService.TrnMainObj.MWAREHOUSE;l||(l=this._trnMainService.userProfile.userWarehouse),this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue&&(l=this._trnMainService.TrnMainObj.BILLTO);let v=encodeURIComponent(this._trnMainService.barCodes.BC);_=`/getMenuitemBarCodeWise?showstockqty=${this.showStockedQuantityOnly}&prefix=${this._trnMainService.TrnMainObj.VoucherPrefix}&barcode=${v}&warehouse=${l}`;var T=`&RefBill=${encodeURIComponent(this._trnMainService.TrnMainObj.REFBILL)}`,A=this._trnMainService.TrnMainObj;return"add-sales-invoice-wholesale"==this.activeurlpath&&(_=`${_}&tag=${c}`),A.VoucherType==s.Km.CreditNote&&0==A.DOFULLRETURN&&0==A.DOMANUALSALESRETURN?_+=`${T}`:A.VoucherType==s.Km.CreditNote&&1==A.DOMANUALSALESRETURN?_+=`${T}&DomanualSalesReturn=${A.DOMANUALSALESRETURN}`:A.VoucherType==s.Km.DeliveryReturn?_+=`${T}`:A.VoucherType==s.Km.DebitNote&&1==this.userSetting.REFBILLCOMPULSORINDNOTE&&A.REFBILL&&0==A.DOFULLRETURN?_+=`${T}&DomanualPurchaseReturn=1`:("add-sales-invoice"==this.activeurlpath&&A.REFORDBILL&&0==A.LOADFULLFROMQT&&0!=this.userSetting.ENABLE_SOINTI||A.VoucherType==s.Km.GoodsReceived&&A.REFORDBILL&&0==A.DOFULLRETURN&&0!=this.userSetting.PODELIVERYMODE||"add-purchase-invoice"==this.activeurlpath&&A.REFORDBILL&&0==A.DOFULLRETURN&&0!=this.userSetting.PODELIVERYMODE||A.VoucherType==s.Km.SalesOrder&&A.REFORDBILL&&0==A.DOFULLRETURN&&0!=this.userSetting.ENABLE_QUOTATTION_INSO)&&(_+=`&RefBill=${A.REFORDBILL}`),_}loadBarcodeWiseProductList(c=0){this.loadFromBarcode=!1;let _=[],l=this.getBarcodeScanEndPoint();this.masterService.masterGetmethod(l).subscribe(v=>{if(console.log("here here",l),"ok"===v.status){if(_=v.result.data,(this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==s.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType==s.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType==s.Km.BranchTransferOut)&&2==this.userSetting.OneToOneBarcodeMode&&_.length>1){let A=this._trnMainService.TrnMainObj.MWAREHOUSE;A||(A=this._trnMainService.userProfile.userWarehouse),this._trnMainService.TrnMainObj.VoucherType!=s.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!=s.Km.CreditNote||!this._trnMainService.TrnMainObj.REFBILL||encodeURIComponent(this._trnMainService.TrnMainObj.REFBILL);let q=this._trnMainService.TrnMainObj.VoucherPrefix;encodeURIComponent(this._trnMainService.barCodes.BC),l=`/getMenuitemBarCodeWise/${this.showStockedQuantityOnly}/${q}`,this.genericGridForBarcodeWiseProductSetting.apiEndpoints=l,this.genericGridForBarcodeWiseProduct.show()}if(1===_.length){this.loadFromBarcode=!0;var T=_[0];this.itemInfo=T,this.currentProdObj=_[0],this._trnMainService.barCodes.DESCA=T.DESCA,this.productHelperService.barcodeEnterStock=T.STOCK,T.existingBarcode=!1;const A=this._trnMainService.TrnMainObj.ProdList.filter(K=>0==K.PTYPE&&0==K.HASVARIANT)?.find(K=>K.MCODE==_[0].MCODE);if(A&&(A.BC=this._trnMainService.barCodes.BC,A.FulfillBatchQty=!1,T.existingBarcode=!0,this._trnMainService.TrnMainObj.VoucherType==s.Km.CreditNote&&0==this.userSetting.ENABLEMANUALSALESRETURN&&1!=this.userSetting.ENABLESINGLEBATCHMODE&&!this.checkGridEnteredQty(1,this._trnMainService.barCodes.BC)))return;if((this._trnMainService.TrnMainObj.VoucherType===s.Km.CreditNote&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&0==this.userSetting.ENABLEMANUALSALESRETURN&&this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.VoucherType===s.Km.DeliveryReturn&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFBILL)&&(this.productHelperService.barcodeEnterStock=T.Quantity),this._trnMainService.TrnMainObj.VoucherType===s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote&&0==this.userSetting.REFBILLCOMPULSORINDNOTE||this._trnMainService.TrnMainObj.VoucherType===s.Km.CreditNote&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&0==this.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockSettlement){if(2==this.userSetting.OneToOneBarcodeMode&&this._trnMainService.TrnMainObj.VoucherType===s.Km.CreditNote&&0==this._trnMainService.TrnMainObj.DOFULLRETURN)return void this.majorMethods(T);if(1==this.userSetting.ENABLEBARCODEWISEBATCH&&T?.BATCH)return void this.getItemDetails(T);0==this.userSetting.ENABLESINGLEBATCHMODE&&1!=T.NATURETYPE&&this.checkBatchWiseRate(T),(1==this.userSetting.ENABLESINGLEBATCHMODE||1==T.NATURETYPE)&&this.getItemDetails(T)}else if(this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===s.Km.PerformaSalesInvoice){if(1==this.userSetting.ENABLEBARCODEWISEBATCH&&T?.BATCH)return void this.getItemDetails(T);this.majorMethods(T)}else this.checkIfItemExistOrNot(T).then(q=>{q||(this.addNewRowInGrid(T),this._trnMainService.TrnMainObj.VoucherType===s.Km.SalesOrder&&this.getContractPriceandOtherDiscount())})}}})}majorMethods(c,_=!1){1===c.HASBATCH&&1===this.userSetting.EnableItemWiseBatch&&this.checkBatchWiseRate(c),(0===this.userSetting.EnableBatchWisePrice||1===this.userSetting.EnableItemWiseBatch&&0===c.HASBATCH)&&0===this.userSetting.ENABLESINGLEBATCHMODE&&this.getItemDetails(c,_),0==this.userSetting.ENABLESINGLEBATCHMODE&&1===this.userSetting.EnableBatchWisePrice&&0===this.userSetting.EnableItemWiseBatch&&this.checkBatchWiseRate(c,_),1==this.userSetting.ENABLESINGLEBATCHMODE&&this.getItemDetails(c)}checkItemInGrid(){return(this._trnMainService.TrnMainObj.VoucherType!=s.Km.Purchase&&this._trnMainService.TrnMainObj.VoucherType!=s.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!=s.Km.BranchTransferOut||2!=this.userSetting.OneToOneBarcodeMode||"EDIT"!=this._trnMainService.TrnMainObj.Mode||!this._trnMainService.TrnMainObj.ProdList.find(c=>c.BC==this._trnMainService.barCodes.BC&&null==c.hasSameBarcode))&&!!this._trnMainService.TrnMainObj.ProdList.find(c=>c.BC==this._trnMainService.barCodes.BC&&!c.hasSameBarcode)}checkIfItemExistOrNot(c){var _=this;return(0,t.Z)(function*(){if(_._trnMainService.TrnMainObj.ProdList.find(l=>l.BC==_._trnMainService.barCodes.BC)){if(_._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice){let l=_._trnMainService.TrnMainObj.ProdList.findIndex(T=>T.BC==_._trnMainService.barCodes.BC&&0==T.FulfillBatchQty);_._trnMainService.nullToZeroConverter(_._trnMainService.TrnMainObj.ProdList[l].ALTERNATEQUANTIY)+_._trnMainService.nullToZeroConverter(_._trnMainService.barCodes.Quantity)>_._trnMainService.TrnMainObj.ProdList[l].STOCK&&(console.log("reach down"),_._trnMainService.TrnMainObj.ProdList[l].FulfillBatchQty=!0,document.getElementById("barcodeField").blur(),0==c.HASVARIANT&&_.checkBatchWiseRate(c))}return!0}return!1})()}addQuantityInExistingRow(c,_,l=!1){if(c>=0){if(l)return this._trnMainService.TrnMainObj.ProdList[c].ALTERNATEQUANTIY=this._trnMainService.nullToZeroConverter(_),console.log(this._trnMainService.TrnMainObj.ProdList[c].ALTERNATEQUANTIY),this._trnMainService.barCodes.Quantity=this._trnMainService.TrnMainObj.ProdList[c].ALTERNATEQUANTIY,this.productHelperService.barcodeEnterStock=this._trnMainService.TrnMainObj.ProdList[c].STOCK,this._trnMainService.barCodes.DESCA=this._trnMainService.TrnMainObj.ProdList[c].ITEMDESC,void this._trnMainService.ReCalculateBillWithNormal();this._trnMainService.TrnMainObj.ProdList[c].ALTERNATEQUANTIY=this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[c].ALTERNATEQUANTIY)+this._trnMainService.nullToZeroConverter(_),this._trnMainService.barCodes.Quantity=this._trnMainService.TrnMainObj.ProdList[c].ALTERNATEQUANTIY,this.productHelperService.barcodeEnterStock=this._trnMainService.TrnMainObj.ProdList[c].STOCK,this._trnMainService.barCodes.DESCA=this._trnMainService.TrnMainObj.ProdList[c].ITEMDESC,this._trnMainService.ReCalculateBillWithNormal()}}addNewRowInGrid(c){document.getElementById("barcodeField").blur(),this.addRow(c,null)}ItemBarCodeTabEnter(){document.getElementById("quantityBarcode").focus()}ItemQuantityTabEnter(){document.getElementById("barcodeField").focus()}ItemBarcodeInsert(){document.getElementById("quantityBarcode").focus()}addRow(c,_,l=!1,v=!1){this._trnMainService.barCodes.Quantity=1;let T={};if(T.Sn=this.Snos+=1,T.inputMode=!0,T.MENUCODE=c.MENUCODE,T.ITEMDESC=c.DESCA,T.ALTRATE=l?_.RATE:this.getVoucherWiseRateForBarcode(c),T.BASERATE=l?_.RATE:this.getVoucherWiseRateForBarcode(c),T.RATE=l?_.RATE:this.getVoucherWiseRateForBarcode(c),T.SELLRATEBEFORETAX=l?_?.SELLRATEBEFORETAX:c.RATE,T.MCODE=c.MCODE,T.ISVAT=c.ISVAT,T.UNIT=c.BASEUNIT,T.BASEUNIT=c.BASEUNIT,T.ALTUNIT=c.BASEUNIT,T.MRP=c.MRP,T.SPRICE=c.MRP/this.userSetting.VatConRate,T.MFGDATE=l?_.MFGDATE?.toString().substring(0,10):c.MFGDATE?.toString().substring(0,10),T.EXPDATE=l?_.EXPDATE?.toString().substring(0,10):c.EXPDATE?.toString().substring(0,10),T.BATCH=l?_.BATCH:c?.BATCH,T.NCRATE=null,T.ECSRATE=c.ECSRATE,T.AMOUNT=null,T.INDDISCOUNTRATE=c?.INDDISCOUNTRATE,T.INDDISCOUNT=c?.INDDISCOUNT,T.CRATE=c?.CRATE,T.DISCOUNT=null,T.VAT=null,T.NETAMOUNT=null,T.ITEMTYPE=null,T.RECEIVEDTYPE=null,T.WAREHOUSE=null,T.BC=c.BARCODE,T.ALTERNATEQUANTIY=this._trnMainService.barCodes.Quantity,T.PRATE=l?_.costprice:c.costprice,T.STOCK=l?_.STOCK:c.STOCK,T.TOTSTOCK=this.salesreturnInLiteMode()?c.Quantity:c?.STOCK,T.FulfillBatchQty=!1,T.HASVARIANT=c.HASVARIANT,T.HASECSRATE=c.HASECSRATE,T.HASECSCHARGE=c.HASECSCHARGE,T.HasMulitplePrice=l?1:0,T.REQEXPDATE=c.REQEXPDATE,T.PTYPE=c.PTYPE,T.NATURETYPE=c.NATURETYPE,T.IsAuthorizeForNegative=!1,T.DISMODE=c.DISMODE,T.ISUNKNOWN=c.ISUNKNOWN,T.SUPPNAME=c.SUPPNAME,T.WARRANTY=c.WARRANTY,T.MINLEVEL=c.MINLEVEL,T.hasSameBarcode=v,this._trnMainService.TrnMainObj.VoucherType==s.Km.ManualstockEntry&&(T.WAREHOUSE=this._trnMainService.TrnMainObj.MWAREHOUSE),1==this.userSetting.ENABLEBARCODEWISEBATCH&&c?.BATCH&&(T.BATCH=c.BATCH),l&&(T.PriceSelected=!0),c.HASVARIANT&&1==c.HASVARIANT&&"requisition-log"!=this.activeurlpath){T.VARIANTDESCA="";var A=JSON.parse(c.barcodeDetails);for(var K in T.VARIANTLIST=A,A)T.VARIANTDESCA+=`<b>${K}</b>:${A[K]} &nbsp;`}if(this._trnMainService.TrnMainObj.ProdList[0].BC||this._trnMainService.TrnMainObj.ProdList[0].MCODE){if(this._trnMainService.TrnMainObj.ProdList.push(T),!this.checkMcodeWiseStock(T.MCODE))return console.log("reach"),void this.alertService.info("Quantity exceed the avilable stock")}else this._trnMainService.TrnMainObj.ProdList[0]=T;let q=0;q=this._trnMainService.TrnMainObj.ProdList.length-1,this.activerowIndex=q,this._trnMainService.getAllUnitsOfItem(q,c.ALTUNIT),this.getSchemeDiscountForItem(T),this.loadDescriptionWiseProduct?document.getElementById("barcodeDesc")?.focus():document.getElementById("barcodeField")?.focus(),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.allowNegativeBilling(q,!1,!1)}removeInvalidRowsFromprod(){this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(c=>null!=c.MCODE&&""!=c.MCODE)}getVoucherWiseRateForBarcode(c){return this._trnMainService.TrnMainObj.VoucherType===s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===s.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType===s.Km.PurchaseOrder||this._trnMainService.TrnMainObj.VoucherType===s.Km.RequisitionEntry||this._trnMainService.TrnMainObj.VoucherType===s.Km.GoodsReceived||"self-billing"===this.activeurlpath?c.PRATE:"add-sales-invoice-wholesale"==this.activeurlpath||this._trnMainService.TrnMainObj.VoucherType==s.Km.PerformaSalesInvoice&&1==this._trnMainService.TrnMainObj.AdditionalObj.LoadWholeSaleRate?c.RATE_B:this._trnMainService.TrnMainObj.VoucherType===s.Km.SalesOrder&&0===this.userSetting.ENABLE_VTEXCLUDINGRATE_INSORDER?c.IN_RATE:this._trnMainService.TrnMainObj.VoucherType===s.Km.SalesOrder&&1==this._trnMainService.TrnMainObj.AdditionalObj.LoadWholeSaleRate?c.RATE_B:c.RATE}checkBatchWiseRate(c,_=!1){this.batchlist=[];let l="";this.PlistTitle="";let v=this._trnMainService.TrnMainObj.VoucherPrefix;"self-billing"===this.activeurlpath&&(v="SF"),l=this._trnMainService.TrnMainObj.MWAREHOUSE?this._trnMainService.TrnMainObj.MWAREHOUSE:this._trnMainService.userProfile.userWarehouse;let A=this.debitNoteEndPointReturnMode(c,l,v,this._trnMainService.TrnMainObj.REFBILL);this.masterService.masterGetmethod(A).subscribe(K=>{if("ok"===K.status){if(this.batchlist=K.result,console.log("activerow1",this.activerowIndex),1===this._trnMainService.TrnMainObj.ProdList[this.activerowIndex]?.REQEXPDATE&&!this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BARCODE&&(this.PlistTitle="Batch Selection"),"replacerate"===K.message){if(this.getItemDetails(c,_),this._trnMainService.TrnMainObj.VoucherType===s.Km.Repack&&this.batchWiseStockTax(K.result[0].STOCK),this.assignBarcodeWiseMFGEXPDATE(K.result),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].PRATE=K.result[0].costprice,(this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote)&&!this.checkGridEnteredQty(0,this._trnMainService.barCodes.BC))return;this.changeBatchWiseRate(K.result[0].RATE)}"SHOWPRICEPOPUP"===K.message&&(this.PlistTitle="Batch Price Selection",document.getElementById("barcodeField").blur(),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].HasMulitplePrice=1,this._trnMainService.TrnMainObj.VoucherType===s.Km.Repack&&this.changeBatchWiseRate(K.result[0].RATE)),this._trnMainService.TrnMainObj.REFBILL&&(this._trnMainService.TrnMainObj.VoucherType===s.Km.CreditNote&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&0==this.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&1==this.userSetting.REFBILLCOMPULSORINDNOTE&&this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.VoucherType===s.Km.DeliveryReturn&&0==this._trnMainService.TrnMainObj.DOFULLRETURN)&&(this.assingBatchInReturnMode(K.result[0].BATCH),this.batchWiseStockTax(K.result[0].STOCK),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].TOTSTOCK=K.result[0].STOCK),this._trnMainService.vatFreeBill(),(this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===s.Km.BranchTransferOut)&&this.altrateChangeForReplaceRate(K,c),this._trnMainService.ReCalculateBillWithNormal(),0===this.batchlist.length&&"NewBill"!=this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE&&alert("Rate not Detected!")}else this.alertService.info(K.result)})}assingBatchInReturnMode(c){this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BATCH=c}debitNoteEndPointReturnMode(c,_,l,v){const T=encodeURIComponent("wholesale");let A=encodeURIComponent(this._trnMainService.barCodes.BC),G=`/getProuductMultiplePriceBatchWise?mcode=${encodeURIComponent(c.MCODE)}&voucherPrefix=${l}&warehouse=${encodeURIComponent(_)}&barcode=${A}`;return"add-sales-invoice-wholesale"==this.activeurlpath&&(G=`${G}&tag=${T}`),G}getItemDetails(c,_=!1){if(this.checkItemInGrid()){let l=this._trnMainService.TrnMainObj.ProdList.findIndex(v=>v.BC==this._trnMainService.barCodes.BC&&0==v.FulfillBatchQty);this.addQuantityInExistingRow(l,1)}else this.addRow(c,0,!1,_),(this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===s.Km.PerformaSalesInvoice)&&this.getContractPriceandOtherDiscount()}getContractPriceandOtherDiscount(){this._trnMainService.getItemRelatedDiscount(this.activerowIndex,{MCODE:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MCODE,QUANTITY:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].Quantity,RATE:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].RATE,AMOUNT:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].AMOUNT,UNIT:this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].UNIT,CUSTID:this._trnMainService.TrnMainObj.PARAC,PRICEMODE:this._trnMainService.TrnMainObj.PRICEMODE})}batchWiseStockTax(c){this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].STOCK=c}checkMcodeWiseStock(c,_=!1){let l=0,v=0;return l=1==this.userSetting.ENABLEBARCODEWISEBATCH?this._trnMainService.TrnMainObj.ProdList.filter(T=>T.MCODE==c&&T.BC==this._trnMainService.barCodes.BC).map(T=>T.RealQty).reduce((T,A)=>T+A,0):this._trnMainService.TrnMainObj.ProdList.filter(T=>T.MCODE==c).map(T=>T.RealQty).reduce((T,A)=>T+A,0),_&&(l+=1),v=1==this.userSetting.ENABLEBARCODEWISEBATCH?this._trnMainService.TrnMainObj.ProdList.filter(T=>T.MCODE==c&&T.BC==this._trnMainService.barCodes.BC)[0].TOTSTOCK:this._trnMainService.TrnMainObj.ProdList.filter(T=>T.MCODE==c)[0].TOTSTOCK,!(l>v)}getTotalQty(c,_=!1){let l=this._trnMainService.TrnMainObj.ProdList.filter(v=>v.MCODE==c).map(v=>v.RealQty).reduce((v,T)=>v+T,0);return _&&(l+=1),l}checkGridEnteredQty(c,_,l=!1,v=0,T=!1,A=""){if(this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==s.Km.ManualstockEntry||this._trnMainService.TrnMainObj.VoucherType==s.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType==s.Km.CreditNote&&1==this.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType==s.Km.SalesOrder||this._trnMainService.TrnMainObj.VoucherType==s.Km.Quotation||this._trnMainService.TrnMainObj.VoucherType==s.Km.RequisitionEntry)return!0;let K=0;if(K=2==this.userSetting.EnableBatch?this._trnMainService.TrnMainObj.ProdList.filter(G=>G.BC===_&&G.BATCH==A).map(G=>G.Quantity).reduce((G,J)=>G+J,0):this._trnMainService.TrnMainObj.ProdList.filter(G=>G.BC===_).map(G=>G.Quantity).reduce((G,J)=>G+J,0),(this._trnMainService.TrnMainObj.VoucherType==s.Km.CreditNote&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&0==this.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType==s.Km.DeliveryReturn&&0==this._trnMainService.TrnMainObj.DOFULLRETURN)&&K>0){if(c+K>this._trnMainService.TrnMainObj.ProdList.find(J=>J.BC===_).TOTSTOCK)return this.alertService.info("Quantity exceed the available stock"),!1;c=0}if(1==this.userSetting.ENABLESINGLEBATCHMODE&&"pro"===e.N.appMode)return!0;let q=0;if(q=l?2==this.userSetting.EnableBatch?this._trnMainService.TrnMainObj.ProdList.filter(G=>G.BC===_&&G.BATCH==A&&G.RATE===v&&0==G.FulfillBatchQty).map(G=>G.Quantity).reduce((G,J)=>G+J,0):this._trnMainService.TrnMainObj.ProdList.filter(G=>G.BC===_&&G.RATE===v&&0==G.FulfillBatchQty).map(G=>G.Quantity).reduce((G,J)=>G+J,0):2==this.userSetting.OneToOneBarcodeMode?this._trnMainService.TrnMainObj.ProdList.filter(G=>G.BC===_&&G.MCODE==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MCODE&&0==G.FulfillBatchQty).map(G=>G.Quantity).reduce((G,J)=>G+J,0):this._trnMainService.TrnMainObj.ProdList.filter(G=>G.BC===_&&0==G.FulfillBatchQty).map(G=>G.Quantity).reduce((G,J)=>G+J,0),!this.checkPurchaseVouchertype())if(2==this.userSetting.OneToOneBarcodeMode){if(K=this._trnMainService.TrnMainObj.ProdList.filter(G=>G.BC===_&&G.MCODE==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MCODE).map(G=>G.Quantity).reduce((G,J)=>G+J,0),K>0&&c+K>this._trnMainService.TrnMainObj.ProdList.find(J=>J.BC===_&&J.MCODE==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MCODE).TOTSTOCK)return this.alertService.info("Quantity exceed the available stock"),!1}else if(K>0&&c+K>this._trnMainService.TrnMainObj.ProdList.find(J=>J.BC===_).TOTSTOCK)return this.alertService.info("Quantity exceed the available stock"),!1;if(q>0){let G=c+q;if(T&&(G=c),G>this._trnMainService.TrnMainObj.ProdList.find(J=>J.BC===_&&0==J.FulfillBatchQty).STOCK&&!this.checkPurchaseVouchertype()){let J=this._trnMainService.TrnMainObj.ProdList.findIndex(ie=>ie.BC===_&&0==ie.FulfillBatchQty);return confirm("Batch Wise Stock is exceeded do you want to choose batch popup ")&&(this.PlistTitle="Batch Price Selection",document.getElementById("barcodeField").blur(),this._trnMainService.TrnMainObj.ProdList[J].FulfillBatchQty=!0),!1}}return!0}changeBatchWiseRate(c){let _=0;this.itemInfo&&(_=this._trnMainService.TrnMainObj.ProdList.findIndex(l=>l.MCODE==this.itemInfo.MCODE&&l.BC==this._trnMainService.barCodes.BC)),(this._trnMainService.TrnMainObj.VoucherType==s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===s.Km.Repack||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===s.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===s.Km.PerformaSalesInvoice||"consumption"===this._trnMainService.TrnMainObj.AdditionalObj.RETURNTYPE||this._trnMainService.TrnMainObj.VoucherType===s.Km.SalesOrder)&&this._trnMainService.nullToZeroConverter(c)>0&&(this._trnMainService.TrnMainObj.ProdList[_].RATE=c,this._trnMainService.TrnMainObj.ProdList[_].REPACKRATE=c,this._trnMainService.TrnMainObj.ProdList[_].PRATE=c,this._trnMainService.TrnMainObj.ProdList[_].ALTRATE=this._trnMainService.TrnMainObj.VoucherType==s.Km.Repack?this._trnMainService.TrnMainObj.ProdList[_].RATE*this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[_].CONFACTOR):c)}setDefaultUnitwisRate(c){console.log("setunit",c),null!=this._trnMainService.TrnMainObj.ProdList[c].Product.AlternateUnits.filter(l=>1==l.ISDEFAULTPUNIT)[0]&&(this._trnMainService.TrnMainObj.ProdList[c].ALTRATE=this._trnMainService.TrnMainObj.ProdList[c].RATE*this._trnMainService.TrnMainObj.ProdList[c].ALTCONFACTOR)}assignBarcodeWiseMFGEXPDATE(c){1===this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].REQEXPDATE&&this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BC&&(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MFGDATE=null==c[0].MFGDATE?"":c[0].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].EXPDATE=null==c[0].EXPDATE?"":c[0].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].BATCH=c[0].BATCH)}model1Closed(){this.PlistTitle="",1==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].REQEXPDATE?setTimeout(()=>{document.getElementById("batch"+this.activerowIndex).focus()},300):setTimeout(()=>{document.getElementById("alternateqty"+this.activerowIndex).focus()},300)}checkPurchaseVouchertype(){return this._trnMainService.TrnMainObj.VoucherType===s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===s.Km.PurchaseOrder||this._trnMainService.TrnMainObj.VoucherType===s.Km.GoodsReceived}returnBatch(c){let _=[];if("self-billing"==this.activeurlpath&&(_=this._trnMainService.TrnMainObj.ProdList.filter(l=>l.BATCH==c.BATCH&&l.MCODE==c.MCODE),_.length>0))this.alertService.warning("Cannot add same item with same batch in self-billing");else{if(this._trnMainService.TrnMainObj.VoucherType===s.Km.TaxInvoice&&"self-billing"!=this.activeurlpath||this._trnMainService.TrnMainObj.VoucherType===s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType===s.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType===s.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===s.Km.Sales){if(_=this._trnMainService.TrnMainObj.ProdList.filter(2==this.userSetting.EnableBatch||1==this.userSetting.EnableBatch&&1==this.userSetting.EnableBatchWisePrice?l=>l.BC==this._trnMainService.barCodes.BC&&l.BATCH==c.BATCH&&l.RATE==c.RATE:l=>l.BC==this._trnMainService.barCodes.BC&&l.RATE==c.RATE),_.length>0)return void this.alertService.info("Cannot select the batch with same rate");if(!this.checkGridEnteredQty(1,this._trnMainService.barCodes.BC,!0,c.RATE,c.BATCH))return}this.PlistTitle="",this.addRow(this.currentProdObj,c,!0,!0),this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].PriceSelected=!0}}dblClickPopupBatch(c){this.returnBatch(c)}hideDetails(){this.masterService.ShowMore=!1,this._trnMainService.barCodes.Quantity=1}validationInSelfBilling(){return""==this._trnMainService.TrnMainObj.MWAREHOUSE?(this.alertService.warning("Please select an unsaleable warehouse!"),this.alertService.emitShowHideSubject.subscribe(c=>{this.masterService.ShowMore=!0,setTimeout(()=>{document.getElementById("warehouseId").focus()},100)}),!1):""!=this._trnMainService.TrnMainObj.REMARKS&&null!=this._trnMainService.TrnMainObj.REMARKS||(this.alertService.warning("Remarks is mandatory!"),this.alertService.emitShowHideSubject.subscribe(c=>{this.masterService.ShowMore=!0,setTimeout(()=>{document.getElementById("remarksid").focus()},100)}),!1)}salesreturnInLiteMode(){return!("lite"!=this._trnMainService.AppMode||this._trnMainService.TrnMainObj.VoucherType!==s.Km.CreditNote||!this._trnMainService.TrnMainObj.REFBILL||0!=this._trnMainService.TrnMainObj.DOFULLRETURN||0!=this._trnMainService.userSetting.ENABLEMANUALSALESRETURN)}getSchemeDiscountForItem(c){console.log("get scheme discount for item",c),this._trnMainService.getSchemeDiscount(c.MCODE,this._trnMainService.TrnMainObj.DIVISION).subscribe(v=>{console.log("result fff",v),c.SchemeList="ok"==v.status?v.result:[],console.log("check scheme list",this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].SchemeList)},v=>{c.SchemeList=[],this.alertService.error(v)})}descEnter(){let _=this._trnMainService.TrnMainObj.MWAREHOUSE;_||(_=this._trnMainService.userProfile.userWarehouse),this.gridPopupSettings=this.productHelperService.getGridPopUpSettingForMenuItem(this.showStockedQuantityOnly,this._trnMainService.TrnMainObj,""),this.gridPopupSettings.apiEndpoints=`/getMenuitemWithStockPagedList/${this.showStockedQuantityOnly}/A/all/${this._trnMainService.TrnMainObj.VoucherPrefix}/${_}`,this.gridPopupSettings.multiSelect=!0,this.genericGrid.show()}dblClickPopupItem(c){console.log("event",c),this._trnMainService.TrnMainObj.ProdList.length>1&&this.removeInvalidRowsFromprod(),this.loadDescriptionWiseProduct=!0,this._trnMainService.barCodes.DESCA=c.DESCA,this._trnMainService.barCodes.BC=c.MENUCODE,this.checkDublicateonItemEnter(c)||this.addRow(c,0)}dblClickBarcodeWisePopupItem(c){console.log("event",c),this._trnMainService.TrnMainObj.ProdList.length>1&&this.removeInvalidRowsFromprod(),(this._trnMainService.TrnMainObj.VoucherType==s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==s.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType==s.Km.BranchTransferOut||this._trnMainService.TrnMainObj.VoucherType==s.Km.CreditNote&&1==this.userSetting.REFBILLCOMPULSORINCNOTE)&&2==this.userSetting.OneToOneBarcodeMode&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList.find(_=>_.MCODE==c.MCODE)?.ALTERNATEQUANTIY)>=this._trnMainService.nullToZeroConverter(c.STOCK)?0==this._trnMainService.nullToZeroConverter(c.STOCK)?this.alertService.info("Product is out of stock"):this.alertService.info("Quantity exceeded the available stock"):(this.loadDescriptionWiseProduct=!0,this._trnMainService.barCodes.DESCA=c.DESCA,this._trnMainService.barCodes.BC=c.BARCODE,(this._trnMainService.TrnMainObj.VoucherType==s.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==s.Km.CreditNote)&&(this.checkDublicateonItemEnter(c)||this.addRow(c,0,!1,!0)),(this._trnMainService.TrnMainObj.VoucherType==s.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==s.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType==s.Km.BranchTransferOut)&&(this.currentProdObj=c,this.checkDublicateonItemEnter(c)||this.majorMethods(c,!0)))}checkDublicateonItemEnter(c){return this._trnMainService.TrnMainObj.ProdList.filter(l=>l.MENUCODE==c.MENUCODE&&l.BATCH==c.BATCH)?.length>0&&(this._trnMainService.TrnMainObj.ProdList.forEach(l=>{l.MENUCODE==c.MENUCODE&&l.BATCH==c.BATCH&&(l.ALTERNATEQUANTIY+=1)}),this._trnMainService.ReCalculateBillWithNormal(),document.getElementById("barcodeDesc").focus(),!0)}onSupplierEnter(){this._trnMainService.TrnMainObj.BILLTO="",this.genericGridForSupplierSetting=this.masterService.getGenericGridPopUpSettings("SupplierList"),this.genericGridForSupplier.show()}dblClickLoadOnSupplierClick(c){console.log("event",c),this.spinnerService.show("Loading..."),this._trnMainService.TrnMainObj.TRNAC=c.ACID,this._trnMainService.TrnMainObj.PARAC=c.ACID,this._trnMainService.TrnMainObj.BILLTO=c.ACNAME,this.spinnerService.hide()}enbaleStock(){return!("requisition-log"==this.activeurlpath||95==this._trnMainService.TrnMainObj.VoucherType||84==this._trnMainService.TrnMainObj.VoucherType||85==this._trnMainService.TrnMainObj.VoucherType||96==this._trnMainService.TrnMainObj.VoucherType||87==this._trnMainService.TrnMainObj.VoucherType)}onChangeEvent(c){0==c&&(this._trnMainService.TrnMainObj.BILLTO="",this._trnMainService.TrnMainObj.PARAC=null)}updown(c){"F11"==c.code&&c.ctrlKey&&(c.preventDefault(),this._trnMainService.barCodes.BC&&null!=this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MCODE&&(this.PlistTitle="Batch Price Selection"))}altrateChangeForReplaceRate(c,_){_.existingBarcode&&"replacerate"===c.message&&(this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTRATE=_.CONFACTOR*_.CRATE,this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ALTUNIT=_.ALTUNIT)}onMultiItemSelected(c){this._trnMainService.TrnMainObj.ProdList.length>1&&this.removeInvalidRowsFromprod(),this.loadDescriptionWiseProduct=!0,c.forEach(_=>{this.checkDublicateonItemEnter(_)||this.addRow(_,0)})}}return b.\u0275fac=function(c){return new(c||b)(p.Y36(F.P),p.Y36(Q.p),p.Y36(L.c),p.Y36(I.gz),p.Y36(m.e),p.Y36(S.V),p.Y36(g.h))},b.\u0275cmp=p.Xpm({type:b,selectors:[["discounts-insert"]],viewQuery:function(c,_){if(1&c&&(p.Gf(E,5),p.Gf(y,5),p.Gf(P,5),p.Gf(x,5)),2&c){let l;p.iGM(l=p.CRH())&&(_.multiselectGenericGrid=l.first),p.iGM(l=p.CRH())&&(_.genericGrid=l.first),p.iGM(l=p.CRH())&&(_.genericGridForSupplier=l.first),p.iGM(l=p.CRH())&&(_.genericGridForBarcodeWiseProduct=l.first)}},hostBindings:function(c,_){1&c&&p.NdJ("keydown",function(v){return _.updown(v)},!1,p.evT)},decls:30,vars:13,consts:[[1,"pd0","mr3","plainBackGround",2,"margin-left","0px  !important"],[1,"row"],[1,"col-md-2"],[2,"width","25%","font-weight","bold"],["id","barcodeField","type","text","autocomplete","off","placeholder","Enter Barcode","onclick","this.select()",2,"width","64%","margin-top","4px",3,"disabled","ngModel","focus","ngModelChange","keydown.Tab","keydown.enter","keydown.insert"],[1,"col-md-4"],[2,"width","20%","font-weight","bold"],["type","text","autocomplete","off","style","width:64%; margin-top: 4px;","placeholder","Description",3,"disabled","ngModel","ngModelChange",4,"ngIf"],["type","text","autocomplete","off","id","barcodeDesc","style","width:64%; margin-top: 4px;","placeholder","Press ENTER to Select Item","readonly","",3,"ngModel","disabled","ngModelChange","keydown.enter","keypress",4,"ngIf"],["type","number","id","quantityBarcode","autocomplete","off",2,"width","34%","margin-top","4px",3,"ngModel","disabled","ngModelChange","keydown.Tab","keydown.enter"],["class","row",4,"ngIf"],["class","PList",4,"ngIf"],[3,"popupsettings","onItemDoubleClick","onItemsSelected"],["genericGrid",""],[3,"popupsettings","onItemDoubleClick"],["genericGridForSupplier",""],["genericGridForBarcodeWiseProduct",""],[3,"popupsettings","onItemsSelected"],["multiselectGenericGrid",""],["type","text","autocomplete","off","placeholder","Description",2,"width","64%","margin-top","4px",3,"disabled","ngModel","ngModelChange"],["type","text","autocomplete","off","id","barcodeDesc","placeholder","Press ENTER to Select Item","readonly","",2,"width","64%","margin-top","4px",3,"ngModel","disabled","ngModelChange","keydown.enter","keypress"],[2,"width","45%","font-weight","bold"],[3,"ngStyle"],[2,"width","95%","border-radius","3px"],[1,"legend-class",2,"font-size","14px","width","36%"],["type","checkbox","id","supplierSelect",3,"ngModel","checked","disabled","ngModelChange","change"],[1,"col-sm-4"],[1,"col-sm-7"],["type","text","placeholder","Press ENTER to Select","autocomplete","off",2,"width","100%",3,"disabled","ngModel","keydown.Enter","keyup","keypress","ngModelChange"],[1,"PList"],[3,"AlternateUnits","activerowIndex","title","BList","voucherType","activeurlpath","dbClickEvent","BatchClosedClick","returnBatchValue"]],template:function(c,_){1&c&&(p.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",1)(4,"label",3),p._uU(5,"BarCode:"),p.qZA(),p.TgZ(6,"input",4),p.NdJ("focus",function(){return _.hideDetails()})("ngModelChange",function(v){return _._trnMainService.barCodes.BC=v})("ngModelChange",function(){return _.productHelperService.clearBarcodeGrid()})("keydown.Tab",function(){return _.ItemBarCodeTabEnter()})("keydown.enter",function(v){return _.ItemBarCodeClick(v)})("keydown.insert",function(){return _.ItemBarcodeInsert()}),p.qZA()()(),p.TgZ(7,"div",5)(8,"div",1)(9,"label",6),p._uU(10,"Description:"),p.qZA(),p.YNc(11,O,1,2,"input",7),p.YNc(12,j,1,2,"input",8),p.qZA()(),p.TgZ(13,"div",2)(14,"div",1)(15,"label",3),p._uU(16,"Quantity:"),p.qZA(),p.TgZ(17,"input",9),p.NdJ("ngModelChange",function(v){return _._trnMainService.barCodes.Quantity=v})("keydown.Tab",function(){return _.ItemQuantityTabEnter()})("keydown.enter",function(v){return _.barcodeQuantityClick(v)}),p.qZA()()(),p.TgZ(18,"div",5),p.YNc(19,W,5,4,"div",10),p.YNc(20,$,10,5,"div",10),p.qZA()()(),p.YNc(21,N,2,6,"div",11),p.TgZ(22,"generic-popup-grid",12,13),p.NdJ("onItemDoubleClick",function(v){return _.dblClickPopupItem(v)})("onItemsSelected",function(v){return _.onMultiItemSelected(v)}),p.qZA(),p.TgZ(24,"generic-popup-grid",14,15),p.NdJ("onItemDoubleClick",function(v){return _.dblClickLoadOnSupplierClick(v)}),p.qZA(),p.TgZ(26,"generic-popup-grid",14,16),p.NdJ("onItemDoubleClick",function(v){return _.dblClickBarcodeWisePopupItem(v)}),p.qZA(),p.TgZ(28,"multiselect-generic-grid",17,18),p.NdJ("onItemsSelected",function(v){return _.onMultiItemSelected(v)}),p.qZA()),2&c&&(p.xp6(6),p.Q6J("disabled",_.disableBarcode()||_._trnMainService.fromNotification)("ngModel",_._trnMainService.barCodes.BC),p.xp6(5),p.Q6J("ngIf","requisition-log"!=_._trnMainService.activeurlpath),p.xp6(1),p.Q6J("ngIf","requisition-log"==_._trnMainService.activeurlpath),p.xp6(5),p.Q6J("ngModel",_._trnMainService.barCodes.Quantity)("disabled",_.disableBarcode()),p.xp6(2),p.Q6J("ngIf",_.enbaleStock()),p.xp6(1),p.Q6J("ngIf","requisition-log"==_.activeurlpath),p.xp6(1),p.Q6J("ngIf","Batch Price Selection"==_.PlistTitle),p.xp6(1),p.Q6J("popupsettings",_.gridPopupSettings),p.xp6(2),p.Q6J("popupsettings",_.genericGridForSupplierSetting),p.xp6(2),p.Q6J("popupsettings",_.genericGridForBarcodeWiseProductSetting),p.xp6(2),p.Q6J("popupsettings",_.multiselectPopupSettings))},dependencies:[R.O5,R.PC,u.Fj,u.wV,u.Wl,u.JJ,u.On,h.Zl,a.K,V.ky],styles:[".prefixYes[_ngcontent-%COMP%] {\n        width: 34%;\n    }\n\n    .prefixNo[_ngcontent-%COMP%] {\n        width: 88%;\n    }\n\n    .btn[_ngcontent-%COMP%] {\n        width: 65px;\n    }"]}),b})()},27009:(z,Z,M)=>{M.d(Z,{H:()=>b});var t=M(7587),e=M(53181),s=M(42326),h=M(66274),V=M(51405),p=M(53074),F=M(87584),Q=M(67311),L=M(92752);const I=["color"],m=["imeino"],S=["imei1"],g=function(){return{standalone:!0}};function R(c,_){if(1&c){const l=h.EpF();h.TgZ(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",21),h._uU(4,"Item :"),h.qZA(),h.TgZ(5,"div",22)(6,"div",23),h._uU(7),h.qZA()()(),h.TgZ(8,"div",20)(9,"div",21),h._uU(10,"Warranty Period (months):"),h.qZA(),h.TgZ(11,"div",24)(12,"div",23),h._uU(13),h.qZA()()(),h.TgZ(14,"div",25)(15,"div",21),h._uU(16,"IMEI NO :"),h.qZA(),h.TgZ(17,"div",26)(18,"input",27,28),h.NdJ("ngModelChange",function(T){h.CHM(l);const A=h.oxw();return h.KtG(A.IMEINO1=T)})("keydown.enter",function(T){h.CHM(l);const A=h.oxw();return h.KtG(A.checkBarCodeItem(T.target.value))})("keydown.tab",function(T){h.CHM(l);const A=h.oxw();return h.KtG(A.checkBarCodeItem(T.target.value))}),h.qZA()()()()()}if(2&c){const l=h.oxw();h.xp6(7),h.hij("",l.data.message.ITEMDESC," "),h.xp6(6),h.hij("",l.data.message.WARRANTY," "),h.xp6(5),h.Q6J("ngModel",l.IMEINO1)("ngModelOptions",h.DdM(4,g))}}function u(c,_){if(1&c&&(h.TgZ(0,"option",43),h._uU(1),h.qZA()),2&c){const l=_.$implicit;h.s9C("value",null==l?null:l.colorName),h.xp6(1),h.hij(" ",null==l?null:l.colorName,"")}}function a(c,_){if(1&c){const l=h.EpF();h.TgZ(0,"td",38)(1,"select",39,40),h.NdJ("change",function(T){h.CHM(l);const A=h.oxw(3);return h.KtG(A.onChaneColor(T))})("keydown.enter",function(){h.CHM(l);const T=h.oxw().index,A=h.oxw(2);return h.KtG(A.colorEnterClicked(T))}),h.ynx(3,41),h.YNc(4,u,2,2,"option",42),h.BQk(),h.qZA()()}if(2&c){const l=h.oxw(3);h.xp6(4),h.Q6J("ngForOf",l.colorLists)}}function E(c,_){if(1&c&&(h.TgZ(0,"td",38),h._UZ(1,"input",44),h.qZA()),2&c){const l=h.oxw(3);h.xp6(1),h.s9C("value",l.colorLists.colorName),h.Q6J("readonly",!0)}}function y(c,_){if(1&c){const l=h.EpF();h.TgZ(0,"td",45)(1,"input",46),h.NdJ("change",function(T){h.CHM(l);const A=h.oxw(3);return h.KtG(A.onChangeIMEINO1(T))})("keydown.enter",function(){h.CHM(l);const T=h.oxw().index,A=h.oxw(2);return h.KtG(A.imei1EnterClicked(T))}),h.qZA()()}if(2&c){const l=h.oxw().index,v=h.oxw(2);h.xp6(1),h.MGl("id","imei1",l,""),h.Q6J("readOnly","VIEW"==v.mode)}}function P(c,_){if(1&c&&(h.TgZ(0,"option",43),h._uU(1),h.qZA()),2&c){const l=_.$implicit;h.Q6J("value",l.BARCODE),h.xp6(1),h.Oqu(l.BARCODE)}}function x(c,_){if(1&c){const l=h.EpF();h.TgZ(0,"td",45)(1,"input",47),h.NdJ("keydown.enter",function(){h.CHM(l);const T=h.oxw().index,A=h.oxw(2);return h.KtG(A.imei1EnterClicked(T))})("change",function(T){h.CHM(l);const A=h.oxw(3);return h.KtG(A.onChangeIEMINO1(T))}),h.qZA(),h.TgZ(2,"datalist",48),h.YNc(3,P,2,2,"option",42),h.qZA()()}if(2&c){const l=h.oxw().index,v=h.oxw(2);h.xp6(1),h.MGl("id","imei1",l,""),h.xp6(2),h.Q6J("ngForOf",v.IMEINO1List)}}function O(c,_){if(1&c){const l=h.EpF();h.TgZ(0,"td",45)(1,"input",49),h.NdJ("keydown.enter",function(){h.CHM(l);const T=h.oxw().index,A=h.oxw(2);return h.KtG(A.addItems(T))})("keydown.tab",function(){h.CHM(l);const T=h.oxw().index,A=h.oxw(2);return h.KtG(A.addItems(T))}),h.qZA()()}if(2&c){const l=h.oxw().index,v=h.oxw(2);h.xp6(1),h.MGl("id","imei2",l,""),h.Q6J("readOnly","VIEW"==v.mode)}}function j(c,_){if(1&c&&(h.TgZ(0,"option",43),h._uU(1),h.qZA()),2&c){const l=_.$implicit;h.Q6J("value",l.VEHICLECHASISNO),h.xp6(1),h.Oqu(l.VEHICLECHASISNO)}}function D(c,_){if(1&c){const l=h.EpF();h.TgZ(0,"td",45)(1,"input",50),h.NdJ("keydown.enter",function(){h.CHM(l);const T=h.oxw().index,A=h.oxw(2);return h.KtG(A.addItems(T))})("keydown.tab",function(){h.CHM(l);const T=h.oxw().index,A=h.oxw(2);return h.KtG(A.addItems(T))}),h.qZA(),h.TgZ(2,"datalist",51),h.YNc(3,j,2,2,"option",42),h.qZA()()}if(2&c){const l=h.oxw().index,v=h.oxw(2);h.xp6(1),h.MGl("id","imei2",l,""),h.xp6(2),h.Q6J("ngForOf",v.IMEINO2List)}}function U(c,_){if(1&c){const l=h.EpF();h.TgZ(0,"div",52)(1,"button",53),h.NdJ("click",function(){h.CHM(l);const T=h.oxw().index,A=h.oxw(2);return h.KtG(A.removeItems(T))}),h._uU(2,"Remove"),h.qZA()()}if(2&c){const l=h.oxw(3);h.xp6(1),h.Q6J("disabled","VIEW"==l.mode)}}function W(c,_){if(1&c&&(h.TgZ(0,"tr",31)(1,"td",32),h._uU(2),h.qZA(),h.YNc(3,a,5,1,"td",33),h.YNc(4,E,2,2,"td",34),h.YNc(5,y,2,2,"td",35),h.YNc(6,x,4,2,"td",35),h.YNc(7,O,2,2,"td",35),h.YNc(8,D,4,2,"td",35),h.TgZ(9,"td",36),h.YNc(10,U,3,1,"div",37),h.qZA()()),2&c){const l=_.index,v=h.oxw(2);h.Q6J("formGroupName",l),h.xp6(2),h.Oqu(l+1),h.xp6(1),h.Q6J("ngIf","VIEW"!=v.mode),h.xp6(1),h.Q6J("ngIf","VIEW"==v.mode&&("PI"==v.type||"OP"==v.type)),h.xp6(1),h.Q6J("ngIf",v.isShowField()),h.xp6(1),h.Q6J("ngIf","NEW"==v.mode&&"TI"==v.type),h.xp6(1),h.Q6J("ngIf",v.isShowField()),h.xp6(1),h.Q6J("ngIf","NEW"==v.mode&&"TI"==v.type),h.xp6(2),h.Q6J("ngIf",v.isShowField())}}function $(c,_){if(1&c&&(h.TgZ(0,"tbody",29),h.YNc(1,W,11,9,"tr",30),h.qZA()),2&c){const l=h.oxw();h.xp6(1),h.Q6J("ngForOf",l.productArray.controls)}}function N(c,_){if(1&c){const l=h.EpF();h.TgZ(0,"tr",45)(1,"td",32),h._uU(2),h.qZA(),h.TgZ(3,"td",38),h._uU(4),h.qZA(),h.TgZ(5,"td",38),h._uU(6),h.qZA(),h.TgZ(7,"td",38),h._uU(8),h.qZA(),h.TgZ(9,"td",56)(10,"button",57),h.NdJ("click",function(){const A=h.CHM(l).index,K=h.oxw(2);return h.KtG(K.removeItems(A))}),h._uU(11,"Remove"),h.qZA()()()}if(2&c){const l=_.$implicit,v=_.index,T=h.oxw(2);h.xp6(2),h.Oqu(v+1),h.xp6(2),h.Oqu(l.color),h.xp6(2),h.Oqu(l.IEMI1),h.xp6(2),h.Oqu(l.IEMI2),h.xp6(2),h.Q6J("disabled","VIEW"==T.mode)}}function k(c,_){if(1&c&&(h.TgZ(0,"tbody",54),h.YNc(1,N,12,5,"tr",55),h.qZA()),2&c){const l=h.oxw();h.xp6(1),h.Q6J("ngForOf",l.productDetailsList)}}let b=(()=>{class c{constructor(l,v,T,A,K,q,G,J){this.fb=l,this.productMasterService=v,this.masterService=T,this._transactionService=A,this.dialogref=K,this.changeDetection=q,this.alterService=G,this.data=J,this.currentPage=1,this.limit=10,this.offset=0,this.productDetailsList=[],this.curretnIndexPrevDetials=[],this.productList=[],this.IMEINO1List=[],this.IMEINO2List=[],this.isSubmitting=!1,this.isLoader=!1,this.isSubmitted=!1,this.lastColor="",J&&(this.type=J.type,this.productDetails=J.message,this.mode=J.mode,this.productList=J.productList,this.batch=J.message.BATCH,this.warehouse=J.warehouse,this.curretnIndexPrevDetials=J.curretnIndexPrevDetials,this.mcode=this.productDetails&&this.productDetails.MCODE?this.productDetails.MCODE:"",this.TrnMainObj=J.TrnMainObj),this.mcode&&this.getColor(this.mcode);const ie=this.productDetails&&this.productDetails.productDetails?this.productDetails.productDetails:[];ie&&ie.length>0&&this.formReset(ie)}get productArray(){return this.form.get("productColorList")}updown(l){"End"===l.code&&(l.preventDefault(),this.submit()),"Escape"===l.code&&(l.preventDefault(),this.closeModalAtEscape())}productDetailTitle(){let l;return"VIEW"==this.mode?(l="Product Details List",l):(l="Insert Product Details",l)}ngAfterContentChecked(){this.changeDetection.detectChanges()}getColor(l){this.masterService.getProductColorByMCode(l).subscribe(v=>{this.colorLists=v&&v.result?v.result:[]})}onChaneColor(l){this.selectedColor=l.target.value,"TI"==this.type&&this.getProductIMEINOColorWise(this.mcode,this.selectedColor)}getProductIMEINOColorWise(l,v){this.masterService.getProductIMEINOByMCodeAndColor(l,v,this.batch).subscribe(T=>{this.IMEINO1List=T.result.length<1?[]:T&&T.result?T.result:[]})}onChangeIEMIN1(l){if(0==this.IMEINO1List.filter(T=>T.BARCODE==l.target.value).length)return this.alterService.info("Entered IMEINO1 is not belong to this product"),!1;this.getProductIMEINOTwoColorWise(this.mcode,this.selectedColor,l.target.value)}getProductIMEINOTwoColorWise(l,v,T){this.masterService.getProductIMEINOTwoByMCodeAndColor(l,v,T).subscribe(A=>{this.IMEINO2List=A&&A.result?A.result:[]})}ngOnInit(){"VIEW"==this.productDetails.rowMode||"EDIT"==this.productDetails.rowMode||this.curretnIndexPrevDetials?.length>=1?this.prepareProductDetailForViewandEDIT():this.form=this.fb.group({productColorList:this.fb.array([this.addProductItems()])})}ngAfterViewInit(){console.log("enm",this.colorElement,this.imeinoEl),"VIEW"!=this.productDetails.rowMode&&("PI"==this.type||"OP"==this.type?this.colorElement&&setTimeout(()=>this.colorElement.nativeElement.focus()):"TI"==this.type&&"NEW"==this.mode&&this.imeinoEl&&setTimeout(()=>this.imeinoEl.nativeElement.focus())),this.imei1Element.changes.subscribe(()=>{setTimeout(()=>{},10)})}formReset(l){this.form.setControl("productColorList",this.setExistingColor(l&&l.productColorList?l.productColorList:""))}setExistingColor(l){const v=new t.Oe([]);return l.forEach(T=>{v.push(this.fb.group({id:T.id?T.id:"",color:T.color?T.color:"",quantity:T.quantity?T.quantity:1,IEMI1:T.IEMI1?T.IEMI1:"",IEMI2:T.IEMI2?T.IEMI2:""}))}),v}addProductItems(){return this.fb.group({color:[this.lastColor,[t.kI.required]],quantity:[1],MCODE:[this.data.message.MCODE],IEMI1:["",[t.kI.required]],IEMI2:[""]})}prepareProductDetailForViewandEDIT(){let l=this.productDetails.ProductDetails.length?this.productDetails.ProductDetails:this.curretnIndexPrevDetials;this.form=this.fb.group({productColorList:this.fb.array([this.addProductItems()])}),this.productArray.removeAt(0);for(const A of l){var v=this.fb.group({color:A.color,quantity:1,IEMI1:A.IEMI1,IEMI2:A.IEMI2}),T={};T.color=A.color,T.Quantity=1,T.IEMI1=A.IEMI1,T.IEMI2=A.IEMI2,this.productDetailsList.push(T),this.productArray.push(v)}}prepareProductDetailsInSales(){let l=this.productDetails.ProductDetails.length?this.productDetails.ProductDetails:this.curretnIndexPrevDetials;this.form=this.fb.group({productColorList:this.fb.array([this.addProductItems()])}),this.productArray.removeAt(0);for(const T of l){var v={};v.color=T.color,v.Quantity=1,v.IEMI1=T.IEMI1,v.IEMI2=T.IEMI2,this.productDetailsList.push(v)}}closeModel(){if(confirm("You Are Going To Cancel Your Current Entry. Do You Want To Procced Anyway ?  ")){const l=this.form.value;"NEW"!=this.mode?this.dialogref.close({data:l}):this.dialogref.close(),this.form.reset()}}removeItems(l){"TI"==this.type||"CN"==this.type||"DN"==this.type||"QT"==this.type||"PP"==this.type||"TO"==this.type?this.productDetailsList.splice(l,1):this.productArray.removeAt(l)}addItems(l){const v=this.form.value.productColorList,T=v[v.length-1];if(null===T.color||""===T.color||null===T.IEMI1||""===T.IEMI1)return;if(v.filter(K=>K.IEMI1===T.IEMI1).length>1)return void this.alterService.error("Duplicate IMEI number!");this.lastColor=T.color,this.productArray.push(this.addProductItems());let A=l+1;setTimeout(()=>{null!=document.getElementById("imei1"+A)&&document.getElementById("imei1"+A).focus()},20)}checkBarCodeItem(l){if(l){let v=[],T=this.productDetailsList.filter(K=>K.IEMI1==l);if(null!=T&&T.length)return void this.alterService.info(`Duplicate IMEI1 :${l} is found`);if(v=this.productList.filter(K=>null!=K.BC&&""!=K.BC),v.length&&null!=v.filter(q=>q.BC==l)[0])return void this.alterService.info(`Duplicate IMEI1 :${l} found on Product Entry Grid`);this.productList.filter(K=>6==K.PTYPE).forEach(K=>K.ProductDetails?.forEach(q=>{if(q.IEMI1==l)return this.alterService.info(`Duplicte IMEI1 :${q.IEMI1} is found on Bulk Entry Grid`),l=null,!1})),l&&(this._transactionService.TrnMainObj.VoucherType===s.Km.CreditNote||"CN"==this.type?this._transactionService.checkBarcodeForSalesReturn(l,this.TrnMainObj.REFBILL).subscribe(K=>{"ok"==K.status?this.addItemsScanned(l):this.alterService.info(K.result)},K=>{this.alterService.info(K.result)}):this._transactionService.TrnMainObj.VoucherType===s.Km.BranchTransferOut||"TO"==this.type||"DN"==this.type?this.masterService.getBarcodeWiseBatchDetails(l).subscribe(K=>{"ok"==K.status&&this.addItemsScannedStockOut(l,K.result)}):this._transactionService.checkBarcode(l,this.warehouse).subscribe(K=>{"ok"==K.status?this.addItemsScanned(l):(this.alterService.info(K.result),this.alterService.emitShowHideSubject.subscribe(q=>{setTimeout(()=>{document.getElementById("imeino").focus()},0)}))},K=>{this.alterService.info(K.result)}))}}addItemsScannedStockOut(l,v){let T={};T.color=v.COLOR,T.IEMI1=this.IMEINO1,T.IEMI2=v.BARCODE,T.Quantity=1,T.LANDINGCOST=v.LANDINGCOST,T.Costprice=v.Costprice,this.productDetailsList.push(T),this.IMEINO1=""}addItemsScanned(l){if(l){let v=[];this._transactionService.CheckIfSalesReturn()?this.masterService.getProductBCodeDetailForSalsReturn(this.mcode,l).subscribe(T=>{if("ok"==T.status){v=T&&T.result?T.result:[];let A={};A.color=v[0].COLOR,A.IEMI1=this.IMEINO1,A.IEMI2=v[0].IMEINO2,A.Quantity=1,this.productDetailsList.push(A),this.IMEINO1=""}}):this._transactionService.TrnMainObj.VoucherType===s.Km.CreditNote||"CN"==this.type?this.masterService.getProductBarCodeForMobileItem(this.mcode,l).subscribe(T=>{if("ok"==T.status){v=T&&T.result?T.result:[];let A={};A.color=v[0].COLOR,A.IEMI1=this.IMEINO1,A.IEMI2=v[0].IMEINO2,A.Quantity=1,this.productDetailsList.push(A),this.IMEINO1=""}},T=>{this.alterService.error(T.error)}):this.masterService.getProductDetailsbyMCodeAndIMEINO1(this.mcode,l).subscribe(T=>{if("ok"==T.status){v=T&&T.result?T.result:[];let A={};A.color=v[0].COLOR,A.IEMI1=this.IMEINO1,A.IEMI2=v[0].IMEINO2,A.Quantity=1,this.productDetailsList.push(A),this.IMEINO1=""}})}else this.alterService.info("Please Enter IMEI No first.")}isShowTableBody(){return"PI"==this.type||"OP"==this.type}isShowItemScanedTable(){return"TI"===this.type||"CN"===this.type||"DN"===this.type||"QT"===this.type||"PP"==this.type||"TO"==this.type}isShowScanField(){return"NEW"==this.mode&&("TI"==this.type||"DN"===this.type)}isShowField(){return"NEW"==this.mode&&"TI"!=this.type||("VIEW"==this.mode||"EDIT"==this.mode)&&"TI"!=this.type}onChangeIMEINO1(l){}submit(){const l=this.form.value.productColorList,v=l[l.length-1];let T=[];if("PI"==this.type||"OP"==this.type){if(T=this.form.value.productColorList.filter(K=>""!=K.IEMI2),T.length&&T.some(K=>""==K.IEMI1))return this.isSubmitting=!0,void this.alterService.info("IMEI numbe one is mandatory!");if(l.filter(K=>K.IEMI1===v.IEMI1).length>1)return void this.alterService.error("Duplicate IMEI number!"+v.IEMI1);if(this.isSubmitted)return;this.isSubmitted=!0;const A=this.form.value;A.productColorList=A.productColorList.filter(K=>""!=K.IEMI1),"NEW"==this.mode?.toUpperCase()?this.masterService.masterPostmethod("/getProductDetailsListOfItem",A.productColorList).subscribe(K=>{"ok"==K.status?this.dialogref.close({data:A}):(this.isSubmitted=!1,this.alterService.info(K.result))}):this.dialogref.close({data:A})}("TI"==this.type||"CN"==this.type||"DN"===this.type||"QT"===this.type||"PP"===this.type||"TO"===this.type)&&(this.productDetailsList=this.productDetailsList.filter(A=>null!=A.IEMI1&&""!=A.IEMI1),console.log("this.productDetails",this.productDetailsList),this.dialogref.close({data:this.productDetailsList}))}colorEnterClicked(l){document.getElementById("imei1"+l).focus()}imei1EnterClicked(l){document.getElementById("imei2"+l).focus()}closeModalAtEscape(){const l=this.form.value;let v=l.productColorList.filter(T=>""!=T.IEMI1);"NEW"!=this.mode?this.dialogref.close({data:l}):"NEW"==this.mode&&v.length>0?this.dialogref.close("TI"==this.type?{data:l.productColorList}:{data:l}):this.dialogref.close(),this.form.reset()}}return c.\u0275fac=function(l){return new(l||c)(h.Y36(t.qu),h.Y36(V.L),h.Y36(p.P),h.Y36(F.p),h.Y36(e.so),h.Y36(h.sBO),h.Y36(Q.c),h.Y36(e.WI))},c.\u0275cmp=h.Xpm({type:c,selectors:[["addproductdetails"]],viewQuery:function(l,v){if(1&l&&(h.Gf(I,5),h.Gf(m,5),h.Gf(S,5)),2&l){let T;h.iGM(T=h.CRH())&&(v.colorElement=T.first),h.iGM(T=h.CRH())&&(v.imeinoEl=T.first),h.iGM(T=h.CRH())&&(v.imei1Element=T)}},hostBindings:function(l,v){1&l&&h.NdJ("keydown",function(A){return v.updown(A)},!1,h.evT)},decls:34,vars:7,consts:[[1,""],["role","document",1,"",2,"max-width","100%","max-height","450px","overflow","hidden"],[1,"modal-content",2,"padding","14px 16px 10px 16px","margin","0","width","46vw"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","text-center",2,"padding","0"],[3,"formGroup"],[1,"form-header"],[1,"title","h5",2,"margin-bottom","0","font-size","1.2rem","text-align","left"],["type","button",1,"btn","btn-info",2,"margin-right","5px",3,"disabled","click"],["type","button",1,"btn","btn-info",3,"disabled","click"],[1,"form_wrapper"],["class","row",4,"ngIf"],[1,"scrolldown"],["scope","col",2,"width","3%"],["scope","col"],["formArrayName","productColorList",4,"ngIf"],["style","height: 30vh;",4,"ngIf"],[1,"row"],[1,"col-lg-12",2,"padding","0"],[1,"row",2,"margin-bottom","0.2rem !important"],[1,"title","h5",2,"font-size","1rem"],[1,"col-sm-7"],[1,"title","h5",2,"font-size","1rem","text-align","left"],[1,"col-sm-4"],[1,"form-group","row",2,"margin-bottom","0.5rem !important"],[1,"col-sm-6"],["type","text","id","imeino","placeholder","Enter IMEI NO","autocomplete","off",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange","keydown.enter","keydown.tab"],["imeino",""],["formArrayName","productColorList"],["style","border: 1px solid #e6e6e6;",3,"formGroupName",4,"ngFor","ngForOf"],[2,"border","1px solid #e6e6e6",3,"formGroupName"],[2,"border","1px solid #e6e6e6","padding-left","2px","width","5%"],["style","border: 1px solid #e6e6e6;width: 27%; ",4,"ngIf"],["style","border: 1px solid #e6e6e6;width: 27%;",4,"ngIf"],["style","border: 1px solid #e6e6e6;",4,"ngIf"],[2,"border","1px solid #e6e6e6","width","13%"],["class","form-group",4,"ngIf"],[2,"border","1px solid #e6e6e6","width","27%"],["id","color","formControlName","color",1,"form-control",3,"change","keydown.enter"],["color",""],[1,"colorLists","&&","colorLists.length",">","0"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","color",1,"form-control",3,"readonly","value"],[2,"border","1px solid #e6e6e6"],["type","text","list","imeinofirst","placeholder","Enter IMEI 1*","formControlName","IEMI1","autocomplete","off",1,"form-control",3,"id","readOnly","change","keydown.enter"],["type","text","list","codes","placeholder","Enter IMEI 1*","formControlName","IEMI1",1,"form-control",3,"id","keydown.enter","change"],["id","codes"],["type","text","name","imei2","autocomplete","off","placeholder","Enter IMEI 2","list","imeino2","formControlName","IEMI2",1,"form-control",3,"id","readOnly","keydown.enter","keydown.tab"],["type","text","list","code","placeholder","Enter IMEI 2*","formControlName","IEMI2",1,"form-control",3,"id","keydown.enter","keydown.tab"],["id","code"],[1,"form-group"],["type","button",1,"btn","btn-sm","btn-danger",2,"line-height","1.2","width","-webkit-fill-available",3,"disabled","click"],[2,"height","30vh"],["style","border: 1px solid #e6e6e6;",4,"ngFor","ngForOf"],[2,"border","1px solid #e6e6e6","width","11%"],["type","button",1,"btn","btn-sm","btn-danger",2,"line-height","1.2",3,"disabled","click"]],template:function(l,v){1&l&&(h.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"button",3),h.NdJ("click",function(){return v.closeModalAtEscape()}),h.TgZ(5,"span",4),h._uU(6,"\xd7"),h.qZA()()(),h.TgZ(7,"div",5)(8,"form",6)(9,"div",7)(10,"div",8),h._uU(11),h.qZA(),h.TgZ(12,"div",0)(13,"button",9),h.NdJ("click",function(){return v.closeModel()}),h._uU(14,"CANCEL"),h.qZA(),h.TgZ(15,"button",10),h.NdJ("click",function(){return v.submit()}),h._uU(16,"SUBMIT"),h.qZA()()(),h.TgZ(17,"div",11),h.YNc(18,R,20,5,"div",12),h.TgZ(19,"table",13)(20,"thead")(21,"tr")(22,"th",14),h._uU(23,"SNo"),h.qZA(),h.TgZ(24,"th",15),h._uU(25,"Item Color"),h.qZA(),h.TgZ(26,"th",15),h._uU(27,"IMEI No-1"),h.qZA(),h.TgZ(28,"th",15),h._uU(29,"IMEI No-2"),h.qZA(),h.TgZ(30,"th",15),h._uU(31,"Action"),h.qZA()()(),h.YNc(32,$,2,1,"tbody",16),h.YNc(33,k,2,1,"tbody",17),h.qZA()()()()()()()),2&l&&(h.xp6(8),h.Q6J("formGroup",v.form),h.xp6(3),h.Oqu(v.productDetailTitle()),h.xp6(2),h.Q6J("disabled","VIEW"==v.mode),h.xp6(2),h.Q6J("disabled","VIEW"==v.mode),h.xp6(3),h.Q6J("ngIf",!("NEW"!=v.mode&&"EDIT"!=v.mode||"TI"!=v.type&&"CN"!=v.type&&"DN"!=v.type&&"QT"!=v.type&&"PP"!=v.type&&"TO"!=v.type)),h.xp6(14),h.Q6J("ngIf",v.isShowTableBody()),h.xp6(1),h.Q6J("ngIf",v.isShowItemScanedTable()))},dependencies:[L.sg,L.O5,t._Y,t.YN,t.Kr,t.Fj,t.EJ,t.JJ,t.JL,t.On,t.sg,t.u,t.x0,t.CE],styles:[".form-group[_ngcontent-%COMP%] {\n    text-align: left;\n  }\n\n  .form-control[_ngcontent-%COMP%] {\n    height: 27px !important;\n    font-size: 0.8rem;\n  }\n\n  .form-header[_ngcontent-%COMP%] {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 8px;\n  }\n\n  .form-group[_ngcontent-%COMP%] {\n    margin-bottom: 0 !important;\n  }\n\n  tr[_ngcontent-%COMP%] {\n    font-size: 11px;\n  }\n\n  tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%] {\n    padding: 0.4rem;\n    background: silver;\n    color: black;\n    border-top: 2px solid #E6E6E6;\n    border-bottom: 2px solid #E6E6E6;\n  }\n\n  .selected-row[_ngcontent-%COMP%] {\n    background-color: #ced6d3 !important;\n  }\n\n  table[_ngcontent-%COMP%] {\n    border-collapse: collapse;\n  }\n\n  tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%] {\n    padding: 2px !important;\n    margin: 0 !important;\n    vertical-align: middle;\n  }\n\n  table.scrolldown[_ngcontent-%COMP%] {\n    border-spacing: 0;\n    width: 100%;\n  }\n\n  table.scrolldown[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%], table.scrolldown[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%] {\n    display: block;\n  }\n\n\n  table.scrolldown[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%] {\n\n    \n    height: 321px;\n\n    \n    overflow-y: auto;\n\n    \n    overflow-x: hidden;\n  }"]}),c})()},33612:(z,Z,M)=>{M.d(Z,{i:()=>L});var t=M(92340),e=M(42326),s=M(66274),h=M(67297),V=M(69389),p=M(48083),F=M(87584),Q=M(53074);let L=(()=>{class I{constructor(S,g,R,u,a){this.authservice=S,this.setting=g,this.arouter=R,this._trnMainService=u,this.masterService=a,this.AppSettings=g.appSetting,this.userprofile=S.getUserProfile(),this.userSetting=S.getSetting(),this.AppMode=t.N.appMode}afterEnterFocousItem(S,g,R){this.activerowIndex=g,1!=S||"add-sales-invoice"!=R&&"abbreviated-sales-invoice"!=R&&"quotation"!=R&&"performa-invoice"!=R&&"salesorder"!=R?"requisition-entry"==R?setTimeout(()=>{document.getElementById("alternateQty"+g).focus()},5):(this._trnMainService.allowDescriptionEdit=!1,this.focusAfterItemSelect(g)):(this._trnMainService.allowDescriptionEdit=!0,setTimeout(()=>{document.getElementById("itemDesc"+g).focus()},5))}focusAfterItemSelect(S){2==this.userSetting.EnableBatch||this._trnMainService.TrnMainObj.VoucherType==e.Km.BatchAdjustment?null!=document.getElementById("batch"+S)&&setTimeout(()=>{document.getElementById("batch"+S).focus()},20):(null!=document.getElementById("alternateunit"+S)&&setTimeout(()=>{document.getElementById("alternateunit"+S).focus()},20),74===this._trnMainService.TrnMainObj.VoucherType&&null!=document.getElementById("alternateqty"+S)&&setTimeout(()=>{document.getElementById("alternateqty"+S).focus()},20))}autoFocus(S,g,R={},u){this.getTableRowByIndex(S,g,R,u)}getTableRowByIndex(S,g,R={},u="productinserttable"){let a=document.getElementById(u);if(!((S+=1)>=1&&S<a.rows.length))return null;this.focusFirstFocusableElement(a.rows[S],g,R)}isFocusable(S){const g="function"==typeof S.focus,R=!0===S.disabled,u=!0===S.readOnly,a=null===S.offsetParent||"hidden"===S.style.visibility,y=S.hasAttribute("tabindex")&&"-1"!==S.getAttribute("tabindex"),P=["input","select","textarea","a"].includes(S.tagName.toLowerCase());return g&&!R&&!u&&!a&&(P||y)}removeElementsById(S,g){return S.filter(R=>!g.includes(R.id))}removeElementsBefore(S,g){const R=S.indexOf(g);return-1===R?S:S.slice(R+1)}focusFirstFocusableElement(S,g,R={}){const u=Array.from(S.querySelectorAll("input, button, a, select, textarea, [tabindex]:not([tabindex='-1'])")),a=this.removeElementsBefore(u,g);for(const E of a)if(this.isFocusable(E)){E.focus(),R.isFocusAchieved=!0;break}}}return I.\u0275fac=function(S){return new(S||I)(s.LFG(h.e),s.LFG(V.R),s.LFG(p.gz),s.LFG(F.p),s.LFG(Q.P))},I.\u0275prov=s.Yz7({token:I,factory:I.\u0275fac}),I})()},60694:(z,Z,M)=>{M.d(Z,{T:()=>I});var t=M(48083),e=M(42326),s=M(66274),h=M(53074),V=M(67297),p=M(67311),F=M(14970),Q=M(69389),L=M(87584);let I=(()=>{class m{constructor(g,R,u,a,E,y,P,x){this.masterService=g,this.authservice=R,this.alertService=u,this.loadService=a,this.setting=E,this.arouter=y,this.router=P,this.trnmainservice=x,this.AppSettings=E.appSetting,this.userprofile=R.getUserProfile(),this.userSetting=R.getSetting(),this.activeurlpath=y.snapshot?.url[0]?.path,this.router.events.subscribe(O=>{if(O instanceof t.m2){let j=O.url.split("/");this.urlpath=j[j.length-1]}})}getProperMessageForRefBill(g){console.log("from reponse messag service",g.VoucherType);let R="";switch(g.VoucherType){case e.Km.Purchase:R="Please Load the PO Reference bill!!!",0!=this.userSetting.ENABLE_GRN_IN_PI&&(R="Please Load GRN reference bill!!!");break;case e.Km.TaxInvoice:R="Please Load the SO Reference bill!!!";break;case e.Km.GoodsReceived:R="Please Load the PO Reference bill!!!";break;case e.Km.StockIssueReturn:R="Please Load the Stock Issue Reference bill!!!";break;case e.Km.PerformaSalesInvoice:R="Please Load the SO Reference bill!!!";break;default:R="Please Load the Reference Bill for return!!!"}return R}}return m.\u0275fac=function(g){return new(g||m)(s.LFG(h.P),s.LFG(V.e),s.LFG(p.c),s.LFG(F.V),s.LFG(Q.R),s.LFG(t.gz),s.LFG(t.F0),s.LFG(L.p))},m.\u0275prov=s.Yz7({token:m,factory:m.\u0275fac}),m})()},7782:(z,Z,M)=>{M.d(Z,{y:()=>L});var t=M(48083),e=M(42326),s=M(66274),h=M(67297),V=M(67311),p=M(14970),F=M(69389),Q=M(87584);let L=(()=>{class I{constructor(S,g,R,u,a,E,y){this.authservice=S,this.alertService=g,this.loadService=R,this.setting=u,this.arouter=a,this._trnMainService=E,this.router=y,this.showAuthPopup=!1,console.log("USER RIGHT AUTH SERVICE CALLED"),this.AppSettings=u.appSetting,this.userprofile=S.getUserProfile(),this.userSetting=S.getSetting(),this.activeurlpath=a.snapshot?.url[0]?.path,this.router.events.subscribe(P=>{if(P instanceof t.m2){let x=P.url.split("/");this.urlpath=x[x.length-1]}})}checkuserrightfordelete(S,g){if(1==this.userSetting.ENABLESINGLEBATCHMODE){if(g==e.Km.Purchase){if(0==this.userSetting.ALLOWMINUSTOCK_PURCHASE||1==this.userSetting.ALLOWMINUSTOCK_PURCHASE)return!1;if(2==this.userSetting.ALLOWMINUSTOCK_PURCHASE)return!this.checkForUserMinusStockAuth()&&(this.showAuthPopup=!0,!0)}if(g==e.Km.OpeningStockBalance){if(0==this.userSetting.ALLOWMINUSTOCK_OPENING||1==this.userSetting.ALLOWMINUSTOCK_OPENING)return!1;if(2==this.userSetting.ALLOWMINUSTOCK_OPENING)return!this.checkForUserMinusStockAuth()&&(this.showAuthPopup=!0,!0)}if(g==e.Km.BranchTransferOut){if(0==this.userSetting.ALLOWMINUSTOCK_TRANSFEROUT||1==this.userSetting.ALLOWMINUSTOCK_TRANSFEROUT)return!1;if(2==this.userSetting.ALLOWMINUSTOCK_TRANSFEROUT)return!this.checkForUserMinusStockAuth()&&(this.showAuthPopup=!0,!0)}}return!1}checkForUserMinusStockAuth(){return console.log("checkForUserMinusStockAuth",this.userprofile.userRights.filter(S=>"AllowMinusStock"==S.right)[0]),1==this.userprofile.userRights.filter(S=>"AllowMinusStock"==S.right)[0]?.value}checkUserRightsForCreditSales(){return 1==this.userprofile.userRights.find(S=>"CSALES"==S.right.toUpperCase())?.value}}return I.\u0275fac=function(S){return new(S||I)(s.LFG(h.e),s.LFG(V.c),s.LFG(p.V),s.LFG(F.R),s.LFG(t.gz),s.LFG(Q.p),s.LFG(t.F0))},I.\u0275prov=s.Yz7({token:I,factory:I.\u0275fac}),I})()},74263:(z,Z,M)=>{M.d(Z,{R:()=>L});var t=M(48083),e=M(42326),s=M(66274),h=M(67297),V=M(67311),p=M(14970),F=M(69389),Q=M(87584);let L=(()=>{class I{constructor(S,g,R,u,a,E,y){this.authservice=S,this.alertService=g,this.loadService=R,this.setting=u,this.arouter=a,this._trnMainService=E,this.router=y,this.AppSettings=u.appSetting,this.userprofile=S.getUserProfile(),this.userSetting=S.getSetting(),this.activeurlpath=a.snapshot?.url[0]?.path,this.router.events.subscribe(P=>{if(P instanceof t.m2){let x=P.url.split("/");this.urlpath=x[x.length-1]}})}validateDuplicateItemEntry(S,g){if(S.VoucherType===e.Km.DebitNote&&(1==this.userSetting.EnableBatch||2==this.userSetting.EnableBatch))return void 0===S.ProdList.find(u=>u.MENUCODE==g.MENUCODE&&u.BATCH==g.BATCH&&u.CRATE==g.CRATE);if(S.VoucherType===e.Km.Purchase&&0!==this.userSetting.PODELIVERYMODE&&"IMPORT_PURCHASE"!==S.AdditionalObj.tag&&1==this.userSetting.DisableDuplicateItemEntry||S.VoucherType===e.Km.Purchase&&0!==this.userSetting.IMPORTPOBILLMODE&&"IMPORT_PURCHASE"===S.AdditionalObj.tag&&1==this.userSetting.DisableDuplicateItemEntry||S.VoucherType===e.Km.TaxInvoice&&0!==this.userSetting.ENABLE_SOINTI&&S.REFORDBILL||S.VoucherType===e.Km.SalesOrder&&this.userSetting.ENABLE_QUOTATTION_INSO&&S.REFORDBILL||S.VoucherType===e.Km.GoodsReceived&&0!==this.userSetting.PODELIVERYMODE||S.VoucherType===e.Km.DebitNote&&1==this.userSetting.DisableDuplicateItemEntry||S.VoucherType===e.Km.ProductionEntry||S.VoucherType===e.Km.CreditNote&&1==this.userSetting.DisableDuplicateItemEntry){let R;return R=S.ProdList.find(1==this.userSetting.EnableVariantCategory&&1==g.HASVARIANT?u=>u.MENUCODE==g.MENUCODE&&u.BC==g.BC:S.VoucherType===e.Km.TaxInvoice?u=>u.MENUCODE==g.MENUCODE&&u.ALTRATE==g.PRATE:u=>u.MENUCODE==g.MENUCODE&&u.BATCH==g.BATCH),void 0===R}}checkStockforApprovalQty(S){let g;return g=S.ALTUNIT===S.BASEUNIT?this._trnMainService.nullToZeroConverter(S.APPROVEDALTQTY):this._trnMainService.nullToZeroConverter(S.APPROVEDALTQTY)*this._trnMainService.nullToZeroConverter(S.ALTCONFACTOR),g>S.STOCK}calculateTotalQuantity(S,g=!1,R=!1){let u=0,a="ALTERNATEQUANTIY";return g&&(a="APPROVEDALTQTY"),u=S.ALTUNIT===S.BASEUNIT?this._trnMainService.nullToZeroConverter(S[a]):this._trnMainService.nullToZeroConverter(S[a])*this._trnMainService.nullToZeroConverter(S.ALTCONFACTOR),u}validateRequestQtyDoingTransferOut(S,g){let R=this.calculateTotalQuantity(S,!1,!0);if(R>S.RSTOCK)return this.alertService.info(`Input Quantity:${R} exceeds the request quantity :${S.RSTOCK} of ${S.ITEMDESC}... Please Check Your Entry.`),!1;let u=g.filter(a=>a.MCODE==S.MCODE).map(a=>a.Quantity).reduce((a,E)=>a+E,0);return!(u>S.RSTOCK&&(this.alertService.info(`Input Quantity:${u} exceeds the request quantity :${S.RSTOCK} of ${S.ITEMDESC}... Please Check Your Entry.`),1))}validateStockinReqApproval(S,g,R=!1){let u=this.calculateTotalQuantity(S,!0,!1);return!((!(S.PTYPE>=10||7==S.NATURETYPE)||u>S.ALTERNATEQUANTIY)&&(S.APPROVEDALTQTY>S.ALTERNATEQUANTIY&&!confirm(`Approved Quantity:${S.APPROVEDALTQTY} exceeds the request quantity :${S.ALTERNATEQUANTIY} of ${S.ITEMDESC}. Do You Want to Proceed?`)||!R&&u>S.STOCK&&!confirm(`Approved Quantity:${u} (${S.APPROVEDALTQTY} ${S.BASEUNIT} * ${S.ALTCONFACTOR}) exceeds the available stock :${S.STOCK} of ${S.ITEMDESC}. Do You Want to Proceed?`))&&(S.APPROVEDALTQTY=0,this.alertService.emitShowHideSubject.subscribe(a=>{setTimeout(()=>{document.getElementById("approvedQty"+g).focus()},0)}),1))}validateCreditLimit(S,g,R){return S+g>=R}checkEmptyUnit(S){return!!S&&(this.alertService.error(`Unit of ${S.ITEMDESC} is missing, please enter the unit!`),!0)}validateDuplicateBarcode(S,g){return!(g&&g?.length>0&&g.filter(u=>u.BC===S.BC).length>0&&(this.alertService.info("Selected item/variant is already in the list."),1))}validateEmptySubLedger(S){if(S&&S.length>0){let g=S.filter(R=>1==R.HASSUBLEDGER)[0];if(g&&!g.SL_ACNAME)return this.alertService.info(`Sub Ledger can not be empty for Account :${g.ACNAME} `),!1}return!0}validateSalesOrderAdvancePayment(S){if(!(1!==this.userSetting.EnableDeliveryDateInSOrder||S.DeliveryDate&&S.DeliveryTime))return this.alertService.info("Delivery Date & Time is not selected"),!1;if(1===this.userSetting.EnableAdvPaymentInSOrder&&"credit"!=S.TRNMODE){if(0==this._trnMainService.nullToZeroConverter(S.ADVANCE)&&"NEW"==S.Mode.toUpperCase())return!!confirm("ADVANCE AMOUNT IS EMPTY. DO YOU WANT TO PROCEED ANYWAY ?")&&(1==this.userSetting.EnableCusProfileInSOrder?(S.TRNMODE=null,S.TRNACName=null,S.TRNAC=null):(S.TRNMODE="credit",S.TRNACName=null,S.TRNAC=S.PARAC),!0);if(S.ADVANCE){let g;if(g=1==this.userSetting.EnableRoundoff?Math.round(this._trnMainService.nullToZeroConverter(S.ADVANCE)):S.ADVANCE,g>S.NETAMNT)return this.alertService.info("Advance Amount is greater than Net Amount"),!1;if(!S.TRNMODE)return this.alertService.info("Payment Mode is not selected"),!1;if(!S.TRNAC)return this.alertService.info("Account is not selected"),!1}}return!0}validateVariantProduct(S){if(S.VoucherType==e.Km.Purchase||S.VoucherType==e.Km.TaxInvoice||S.VoucherType==e.Km.DebitNote||S.VoucherType==e.Km.CreditNote||S.VoucherType==e.Km.Sales){let g="";if(S.ProdList?.length>0&&S.ProdList.forEach(R=>{1==R.HASVARIANT&&(!R.VARIANTLIST||null==R.VARIANTLIST||null==R.VARIANTLIST)&&(g+=" : "+R.ITEMDESC)}),g)return this.alertService.info(`Variant is not mapped in product${g} `),!1}return!0}validateEmptyACName(S){if(S&&S.length>0){let g=S.filter(R=>""==R.ACID||null==R.ACID);if(g&&g.length>0)return this.alertService.info("Account Name can not be empty."),!1}return!0}validateExportsales(S){return S?.AdditionalObj?.PAYMENTTERMS?S?.FCurrency?void 0:(this.alertService.info("Currency is not selected"),!0):(this.alertService.info("Payment Terms is not selected"),!0)}}return I.\u0275fac=function(S){return new(S||I)(s.LFG(h.e),s.LFG(V.c),s.LFG(p.V),s.LFG(F.R),s.LFG(t.gz),s.LFG(Q.p),s.LFG(t.F0))},I.\u0275prov=s.Yz7({token:I,factory:I.\u0275fac}),I})()},64657:(z,Z,M)=>{M.d(Z,{F:()=>e});var t=M(66274);let e=(()=>{class s{constructor(V){this.el=V,this.specialKeys=["Backspace","Tab","End","Home"]}onKeyDown(V){if(this.decimalPlacesRestriction){if(this.regex=new RegExp(`^\\d*\\.?\\d{0,${this.decimalPlacesRestriction}}$`,"g"),-1!==this.specialKeys.indexOf(V.key))return;let Q=this.el.nativeElement.value.concat(V.key);Q&&!String(Q).match(this.regex)&&V.preventDefault()}}}return s.\u0275fac=function(V){return new(V||s)(t.Y36(t.SBq))},s.\u0275dir=t.lG2({type:s,selectors:[["","decimalPlacesRestriction",""]],hostBindings:function(V,p){1&V&&t.NdJ("keydown",function(Q){return p.onKeyDown(Q)})},inputs:{decimalPlacesRestriction:"decimalPlacesRestriction"}}),s})()},90994:(z,Z,M)=>{M.d(Z,{r:()=>e});var t=M(66274);let e=(()=>{class s{onKeyDown(V){this.OnlyWholeNumber&&"."==V.key&&"110"==V.keyCode&&V.preventDefault()}}return s.\u0275fac=function(V){return new(V||s)},s.\u0275dir=t.lG2({type:s,selectors:[["","OnlyWholeNumber",""]],hostBindings:function(V,p){1&V&&t.NdJ("keydown",function(Q){return p.onKeyDown(Q)})},inputs:{OnlyWholeNumber:"OnlyWholeNumber"}}),s})()},8630:(z,Z,M)=>{M.d(Z,{n:()=>h});var t=M(66274),e=M(67297),s=M(53074);let h=(()=>{class V{constructor(F,Q,L,I){this.authService=F,this.el=Q,this.renderer=L,this.masterService=I,this.disallowSalesRateChangeValue=!1}ngOnInit(){this.userSetting=this.authService.getSetting();let F=this.masterService.userProfile.userRights.find(Q=>"AllowRateChangeInSO"==Q.right);F&&0==F?.value&&(this.disallowSalesRateChangeValue=!0,this.renderer.setAttribute(this.el.nativeElement,"disabled","true"))}disallowSalesRateChange(){return this.disallowSalesRateChangeValue}}return V.\u0275fac=function(F){return new(F||V)(t.Y36(e.e),t.Y36(t.SBq),t.Y36(t.Qsj),t.Y36(s.P))},V.\u0275dir=t.lG2({type:V,selectors:[["","appSalesRateDisableFromUserProfile",""]],exportAs:["appSalesRateDisableFromUserProfile"]}),V})()},63688:(z,Z,M)=>{M.d(Z,{v:()=>e});var t=M(66274);let e=(()=>{class s{transform(V){return console.log("ya ta aaucha ni",V),V||(V=0),Number(V).toFixed(3)}}return s.\u0275fac=function(V){return new(V||s)},s.\u0275pipe=t.Yjl({name:"threeDigitNumber",type:s,pure:!0}),s})()},89952:(z,Z,M)=>{M.d(Z,{g:()=>e});var t=M(66274);let e=(()=>{class s{transform(V){return V||(V=0),Number(V).toFixed(2)}}return s.\u0275fac=function(V){return new(V||s)},s.\u0275pipe=t.Yjl({name:"twoDigitNumber",type:s,pure:!0}),s})()},77398:(z,Z,M)=>{M.d(Z,{e:()=>F});var t=M(42326),e=M(15613),s=M(66274),h=M(87584),V=M(53074),p=M(94534);let F=(()=>{class Q{constructor(I,m,S,g){this._trnMainService=I,this.masterService=m,this.genericProductService=S,this.injector=g}transform(I,m,S){let g;return g="asset-purchase-invoice"===this._trnMainService.activeurlpath||"assets-openingstockentry"===this._trnMainService.activeurlpath?this.DisableInAssetProdInsert(I,m,S):this.DisableInProductInsert(I,m,S),g}DisableInProductInsert(I,m,S=!1){let g=this._trnMainService.TrnMainObj.ProdList[m],R=!1;switch(I){case"disableRateandDiscount":if(this.injector.get(e.P).indexOf(this._trnMainService.TrnMainObj.VoucherType)>=0){if(1===this._trnMainService.userSetting.EnableBatchWisePrice)return 1!==this._trnMainService.userSetting.ENABLEMANUALSALESRETURN;let u=this.masterService.userProfile.userRights.find(a=>"AllowRateChangeInSO"==a.right);if(u&&(0==u?.value||1===this._trnMainService.TrnMainObj.ProdList[m].HASBATCH))return!0}if(this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder&&this._trnMainService.TrnMainObj.REFORDBILL&&this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("QT")||"stock-adjustment"===this._trnMainService.activeurlpath||"add-stock-issue"===this._trnMainService.activeurlpath||1==this.masterService.userSetting.LinkProductionwithconsumption&&this.masterService.userSetting.Enableconsumtionbaseproductionrate&&"production-entry"==this._trnMainService.activeurlpath)return!0;if((0==this.masterService.userSetting.LinkProductionwithconsumption||!this.masterService.userSetting.Enableconsumtionbaseproductionrate)&&"production-entry"==this._trnMainService.activeurlpath)return!1;if(1==this._trnMainService.userSetting.EnableRateFromConsumption&&"production-entry"==this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType==t.Km.Repack||this._trnMainService.TrnMainObj.VoucherType==t.Km.RequisitionApproval||this.disableProductDeleteAndGrid())return!0;if(("add-purchase-invoice"==this._trnMainService.activeurlpath||"goods-received-note"==this._trnMainService.activeurlpath)&&"NEW"==this._trnMainService.TrnMainObj.Mode){let u=this.masterService.userProfile.roleRights.find(a=>"ALLOWRATECHANGEINPI"==a.right);if(u&&0==this._trnMainService.disableRateOnGRNload&&0!=this._trnMainService.userSetting.PODELIVERYMODE&&1==this._trnMainService.userSetting.RATECHANGE_IN_POBASEPI&&1==u?.value)return!1}if(this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut&&0==this._trnMainService.userSetting.EnableBatch&&1==this._trnMainService.userSetting.ENABLESINGLEBATCHMODE&&1==this._trnMainService.userSetting.AllowRateEditInTransferOut)return!1;if(this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut&&(2==this._trnMainService.userSetting.EnableBatch||1==this._trnMainService.userSetting.EnableBatch||0==this._trnMainService.userSetting.AllowRateEditInTransferOut)||this._trnMainService.TrnMainObj.VoucherType==t.Km.DebitNote&&this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE&&1==this._trnMainService.TrnMainObj.DOFULLRETURN||this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.DELIVERYREF?.length>0&&this._trnMainService.TrnMainObj.ProdList.filter(u=>u.MCODE)?.length>0||this.disablePurchaseFields_PI_GRN(I))return!0;if(!("VIEW"==g.rowMode||g.isDisabled||this.disableRAteDisandAmt()||1==this._trnMainService.disableAllFieldinPurchase||g.isPurchaseOrderItem||7==this._trnMainService.TrnMainObj.VoucherType||"transfer-out-approval"==this._trnMainService.activeurlpath||"stock-issue-approval"==this._trnMainService.activeurlpath||this._trnMainService.disableRateOnPOselect||("add-sales-invoice"==this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType==t.Km.Sales)&&this._trnMainService.TrnMainObj.REFORDBILL||null!=this._trnMainService.TrnMainObj.DCRATE&&0!=this._trnMainService.TrnMainObj.DCRATE&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote||null!=this._trnMainService.TrnMainObj.FLATDCAMNT&&0!=this._trnMainService.TrnMainObj.FLATDCAMNT&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote||this._trnMainService.disableOnPerFormaSelect||this._trnMainService.disableRateOnGRNload||this._trnMainService.TrnMainObj.VoucherType==t.Km.PerformaSalesInvoice&&this._trnMainService.TrnMainObj.REFORDBILL||"self-billing"==this._trnMainService.activeurlpath||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn))return!1;R=!0;break;case"disableBarcodeField":return!!(1==this._trnMainService.disableAllFieldinPurchase||g.isPurchaseOrderItem||7==this._trnMainService.TrnMainObj.VoucherType||"transfer-out-approval"==this._trnMainService.activeurlpath||"stock-issue-approval"==this._trnMainService.activeurlpath||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&0==this._trnMainService.userSetting.ENABLEMANUALSALESRETURN||null!=this._trnMainService.TrnMainObj.DCRATE&&0!=this._trnMainService.TrnMainObj.DCRATE&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.SalesOrder&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.PerformaSalesInvoice||null!=this._trnMainService.TrnMainObj.FLATDCAMNT&&0!=this._trnMainService.TrnMainObj.FLATDCAMNT&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.SalesOrder&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.PerformaSalesInvoice||this._trnMainService.disableOnPerFormaSelect||this.disableProductDeleteAndGrid());case"disableItemDesc":if("EDIT"===this._trnMainService.TrnMainObj.ProdList[m].rowMode?.toUpperCase())return this._trnMainService.TrnMainObj.VoucherType!=t.Km.Purchase||"purchase-import"==this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.ProdList[m].TOTALOUTWARDSTOCK>0;if("stock-adjustment"===this._trnMainService.activeurlpath||"add-sales-invoice"==this._trnMainService.activeurlpath&&this._trnMainService.disableOnDCselect||g.isBarcodeOfPtypeSix||"VIEW"===g.rowMode||!0===this._trnMainService.disableAllFieldinPurchase||g.isPurchaseOrderItem||7===this._trnMainService.TrnMainObj.VoucherType||"transfer-out-approval"==this._trnMainService.activeurlpath||"stock-issue-approval"==this._trnMainService.activeurlpath||null!=this._trnMainService.TrnMainObj.DCRATE&&0!=this._trnMainService.TrnMainObj.DCRATE&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.SalesOrder&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.Sales&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.PerformaSalesInvoice||null!=this._trnMainService.TrnMainObj.FLATDCAMNT&&0!=this._trnMainService.TrnMainObj.FLATDCAMNT&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.SalesOrder&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.Sales&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.PerformaSalesInvoice||!0===this._trnMainService.disableOnPerFormaSelect||this._trnMainService.disableItemSelectOnPOselect||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockSettlement&&"VIEW"==this._trnMainService.TrnMainObj.Mode||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn)return!0;if(0===this._trnMainService.userSetting.ENABLEMANUALSALESRETURN&&1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote)return!0;if(1===this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE&&1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote)return!0;if(1==this._trnMainService.TrnMainObj.DOFULLRETURN&&(0!==this._trnMainService.userSetting.PODELIVERYMODE||0!==this._trnMainService.userSetting.ENABLE_GRN_IN_PI)&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&0==this._trnMainService.userSetting.DisablePOReferenceRequired&&"IMPORT_PURCHASE"!=this._trnMainService.TrnMainObj.AdditionalObj.tag)return!0;if(0==this._trnMainService.userSetting.PODELIVERYMODE&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_PI&&"add-purchase-invoice"==this._trnMainService.activeurlpath)return!0;if(1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL&&0!==this._trnMainService.userSetting.PODELIVERYMODE&&this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived&&0==this._trnMainService.userSetting.DisablePOReferenceRequired)return console.log("check check ?"),!0;if(this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.DELIVERYREF?.length>0&&this._trnMainService.TrnMainObj.ProdList.filter(u=>u.MCODE)?.length>0||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&0!=this._trnMainService.userSetting.IMPORTPOBILLMODE&&("purchase-import"===this._trnMainService.activeurlpath||"goods-received-note-import"===this._trnMainService.activeurlpath&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI))return!0;if(1==this._trnMainService.TrnMainObj.DOFULLRETURN&&0!==this._trnMainService.userSetting.IMPORTPOBILLMODE&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag)return!0;if(0==this._trnMainService.userSetting.IMPORTPOBILLMODE&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag)return!0;if(this._trnMainService.disableOnCreditSelect&&0!==this._trnMainService.userSetting.ENABLE_SOINTI&&(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==t.Km.Sales))return console.log("disableitemdesc2"),!0;if(this._trnMainService.TrnMainObj.VoucherType!==t.Km.RequisitionApproval)return!!(this.disableProductDeleteAndGrid()||this._trnMainService.TrnMainObj.ProdList[m].ITEMDESC&&this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL&&0!=this._trnMainService.userSetting.PODELIVERYMODE&&(this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived))||!(this._trnMainService.TrnMainObj.VoucherType!==t.Km.BranchTransferOut||1!=this._trnMainService.userSetting.EnablePIReferenceInTransferOut&&2!=this._trnMainService.userSetting.EnablePIReferenceInTransferOut||!this._trnMainService.TrnMainObj.REFBILL);if(null!=this._trnMainService.TrnMainObj.REFORDBILL)return!0;break;case"disableGridForReqApproval":return this._trnMainService.TrnMainObj.VoucherType===t.Km.RequisitionApproval&&null!=this._trnMainService.TrnMainObj.REFORDBILL;case"disableBatch":if(this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry&&0==this.masterService.userSetting.EnableManualBatchinproduction)return!0;if(2==this._trnMainService.userSetting.EnableBatch&&(this._trnMainService.TrnMainObj.VoucherType==t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==t.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType==t.Km.CreditNote&&1==this._trnMainService.TrnMainObj.DOMANUALSALESRETURN))return!1;if(1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferIn||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut&&(1==this._trnMainService.userSetting.EnablePIReferenceInTransferOut||2==this._trnMainService.userSetting.EnablePIReferenceInTransferOut)&&this._trnMainService.TrnMainObj.REFBILL||1==this._trnMainService.userSetting.EnableBatch&&(this._trnMainService.TrnMainObj.VoucherType==t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==t.Km.OpeningStockBalance)||"StockSettlementEntry"==this._trnMainService.activeurlpath&&this._trnMainService.viewModeForStockSettle||(this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryChalan)&&this._trnMainService.TrnMainObj.REFORDBILL&&this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("SO")||this.disableProductDeleteAndGrid())return!0;if(0===g.REQEXPDATE||null===g.REQEXPDATE||void 0===g.REQEXPDATE&&89!=this._trnMainService.TrnMainObj.VoucherType)return!1;break;case"disableConsumptionBatch":case"disableConsumptionRate":return!0;case"disableAltUnit":return console.log("prod",g),!(!("VIEW"===g.rowMode||g.isDisabled||1==this._trnMainService.disableAllFieldinPurchase||g.isPurchaseOrderItem||7===this._trnMainService.TrnMainObj.VoucherType||"transfer-out-approval"===this._trnMainService.activeurlpath||"stock-issue-approval"===this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType===t.Km.RequisitionEntry||this._trnMainService.disableOnGRNload||null!=this._trnMainService.TrnMainObj.DCRATE&&0!=this._trnMainService.TrnMainObj.DCRATE&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.SalesOrder&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.Sales&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.PerformaSalesInvoice||null!=this._trnMainService.TrnMainObj.FLATDCAMNT&&0!=this._trnMainService.TrnMainObj.FLATDCAMNT&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.SalesOrder&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.Sales&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.PerformaSalesInvoice||this._trnMainService.disableOnPerFormaSelect||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockSettlement&&"VIEW"==this._trnMainService.TrnMainObj.Mode||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryChalan&&2==this._trnMainService.userSetting.EnablePartialSalesFromDeliveryChalan||"stock-adjustment"===this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType==t.Km.BranchTransferOut&&"EDIT"==g.rowMode&&this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.DELIVERYREF?.length>0&&this._trnMainService.TrnMainObj.ProdList.filter(u=>u.MCODE)?.length>0||this._trnMainService.disableOnCreditSelect&&0!==this._trnMainService.userSetting.ENABLE_SOINTI&&(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==t.Km.Sales)||0===this._trnMainService.userSetting.ENABLEMANUALSALESRETURN&&1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote||"add-sales-invoice"==this._trnMainService.activeurlpath&&this._trnMainService.disableOnDCselect)&&(1===this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE&&1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote?(console.log("d1"),0):!(1==this._trnMainService.TrnMainObj.DOFULLRETURN&&0!==this._trnMainService.userSetting.ENABLE_SOINTI&&this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||1===this._trnMainService.TrnMainObj.ProdList[m].NATURETYPE&&this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote&&1==this._trnMainService.userSetting.EnableTelcomDevices||(this._trnMainService.TrnMainObj.ProdList[m].ALTUNIT||this._trnMainService.TrnMainObj.ProdList[m].ALTERNATEUNIT||this._trnMainService.TrnMainObj.ProdList[m].BASEUNIT)&&this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry||this.disablePurchaseFields_PI_GRN(I)||this.disableProductDeleteAndGrid()||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut&&(1==this._trnMainService.userSetting.EnablePIReferenceInTransferOut||2==this._trnMainService.userSetting.EnablePIReferenceInTransferOut)&&this._trnMainService.TrnMainObj.REFBILL)));case"disableAltQty":return!(!("VIEW"==g.rowMode||g.isDisabled||g.isBarcodeOfPtypeSix||1==this.masterService.disableQtyInStockIssueReturn||1==this._trnMainService.disableAllFieldinPurchase||g.isPurchaseOrderItem||7==this._trnMainService.TrnMainObj.VoucherType||"transfer-out-approval"==this._trnMainService.activeurlpath||"stock-issue-approval"==this._trnMainService.activeurlpath||this._trnMainService.disableOnGRNload||null!=this._trnMainService.TrnMainObj.DCRATE&&0!=this._trnMainService.TrnMainObj.DCRATE&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.SalesOrder&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.Sales&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.PerformaSalesInvoice||null!=this._trnMainService.TrnMainObj.FLATDCAMNT&&0!=this._trnMainService.TrnMainObj.FLATDCAMNT&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.SalesOrder&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.Sales&&this._trnMainService.TrnMainObj.VoucherType!=t.Km.PerformaSalesInvoice||this._trnMainService.disableOnPerFormaSelect||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockSettlement&&"VIEW"==this._trnMainService.TrnMainObj.Mode||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn||this._trnMainService.TrnMainObj.VoucherType==t.Km.BranchTransferOut&&"EDIT"==g.rowMode&&this._trnMainService.TrnMainObj.REFBILL&&1==this._trnMainService.userSetting.EnablePIReferenceInTransferOut||"stock-adjustment"==this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.DELIVERYREF?.length>0&&this._trnMainService.TrnMainObj.ProdList.filter(u=>u.MCODE)?.length>0||"add-sales-invoice"==this._trnMainService.activeurlpath&&this._trnMainService.disableOnDCselect||0===this._trnMainService.userSetting.ENABLEMANUALSALESRETURN&&1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote)&&(1===this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE&&1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&"edit"!=this._trnMainService.TrnMainObj.Mode?.toLocaleLowerCase()?(console.log("mode",this._trnMainService.TrnMainObj),0):!(this._trnMainService.disableOnCreditSelect&&1==this._trnMainService.userSetting.ENABLE_SOINTI&&1==this._trnMainService.TrnMainObj.LOADFULLFROMQT&&(this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==t.Km.Sales||this._trnMainService.TrnMainObj.VoucherType!=t.Km.PerformaSalesInvoice)||this._trnMainService.TrnMainObj.VoucherType===t.Km.RequisitionApproval||1===this._trnMainService.TrnMainObj.ProdList[m].NATURETYPE&&this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote&&1==this._trnMainService.userSetting.EnableTelcomDevices||1==this.masterService.userSetting.EnableBomBaseConsumption&&this._trnMainService.TrnMainObj.ProdList[m].ALTERNATEQUANTIY&&this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry&&"EDIT"!=g.rowMode||this.disableProductDeleteAndGrid()||this.disablePurchaseFields_PI_GRN(I))));case"disableAltRate":return!("VIEW"!=g.rowMode&&(this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&0==this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE&&1===this._trnMainService.userSetting.ENABLESINGLEBATCHMODE||this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&"StockSettlementEntry"!=this._trnMainService.activeurlpath&&!this.disablePurchaseFields_PI_GRN(I)&&!this.disableProductDeleteAndGrid()));case"disableRequestQTY":return this._trnMainService.TrnMainObj.VoucherType===t.Km.RequisitionApproval;case"disableSupplier":return this._trnMainService.TrnMainObj.VoucherType===t.Km.RequisitionEntry;case"disableAprroveQty":return"VIEW"==g.rowMode;case"disableGridForReqApproval":return this._trnMainService.TrnMainObj.VoucherType===t.Km.RequisitionApproval&&null!=this._trnMainService.TrnMainObj.REFORDBILL;case"disableFCrate":if("VIEW"==this._trnMainService.TrnMainObj.Mode||this._trnMainService.disableRateOnPOselect||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&0!=this._trnMainService.userSetting.IMPORTPOBILLMODE&&("purchase-import"===this._trnMainService.activeurlpath||"goods-received-note-import"===this._trnMainService.activeurlpath&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI)||0==this._trnMainService.TrnMainObj.DOFULLRETURN&&2==this._trnMainService.userSetting.IMPORTPOBILLMODE&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI&&"goods-received-note-import"===this._trnMainService.activeurlpath)return!0;if(0==this._trnMainService.userSetting.IMPORTPOBILLMODE&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag)return!0;case"disableDiscountRate":if(this.disableRAteDisandAmt()||"VIEW"==g.rowMode||1==this._trnMainService.disableAllFieldinPurchase||1==g.isPurchaseOrder||null!=this._trnMainService.TrnMainObj.DCRATE&&0!=this._trnMainService.TrnMainObj.DCRATE&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote||null!=this._trnMainService.TrnMainObj.FLATDCAMNT&&0!=this._trnMainService.TrnMainObj.FLATDCAMNT&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.CreditNote||"add-purchase-invoice"==this._trnMainService.activeurlpath&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_PI&&this._trnMainService.TrnMainObj.REFORDBILL&&"NEW"==this._trnMainService.TrnMainObj.Mode||this._trnMainService.disableOnPerFormaSelect||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&1==this.masterService.userSetting.REFBILLCOMPULSORINDNOTE&&this._trnMainService.TrnMainObj.REFBILL)return!0;if(this.disableProductDeleteAndGrid())return!0;if("add-sales-invoice"==this._trnMainService.activeurlpath&&this._trnMainService.disableOnDCselect||0!=this._trnMainService.userSetting.IMPORTPOBILLMODE&&("purchase-import"===this._trnMainService.activeurlpath||"goods-received-note-import"===this._trnMainService.activeurlpath&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI&&1==this._trnMainService.TrnMainObj.DOFULLRETURN))return!0;if(0==this._trnMainService.userSetting.IMPORTPOBILLMODE&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag)return!0;if(1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL&&0!=this._trnMainService.userSetting.PODELIVERYMODE&&(this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived))return!0;break;case"disableDiscountAmount":if(this.disableRAteDisandAmt()||"VIEW"==g.rowMode||"NON-DISCOUNTABLE"==this._trnMainService.TrnMainObj.ProdList[m].DISMODE?.toUpperCase()&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.Purchase&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.GoodsReceived&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.PurchaseOrder||1==this._trnMainService.disableAllFieldinPurchase||1==g.isPurchaseOrder||this._trnMainService.disableOnGRNload||null!=this._trnMainService.TrnMainObj.DCRATE&&0!=this._trnMainService.TrnMainObj.DCRATE&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote||null!=this._trnMainService.TrnMainObj.FLATDCAMNT&&0!=this._trnMainService.TrnMainObj.FLATDCAMNT&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote||this._trnMainService.disableOnPerFormaSelect||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&1==this.masterService.userSetting.REFBILLCOMPULSORINDNOTE&&this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.SalesDeliveryList&&this._trnMainService.TrnMainObj.SalesDeliveryList.length>m&&"NON-DISCOUNTABLE"==this._trnMainService.TrnMainObj.SalesDeliveryList[m].DISMODE?.toUpperCase())return!0;if(this.disableProductDeleteAndGrid())return!0;if("add-sales-invoice"==this._trnMainService.activeurlpath&&this._trnMainService.disableOnDCselect||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&0!=this._trnMainService.userSetting.IMPORTPOBILLMODE&&("purchase-import"===this._trnMainService.activeurlpath||"goods-received-note-import"===this._trnMainService.activeurlpath&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI))return!0;if(0==this._trnMainService.userSetting.IMPORTPOBILLMODE&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag)return!0;if(1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL&&0!=this._trnMainService.userSetting.PODELIVERYMODE&&(this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived))return!0;break;case"disableDiscountRateImpPurchase":case"disableDiscountAmountImpPurchase":if(this.disableRAteDisandAmt()||"VIEW"==g.rowMode||1==this._trnMainService.disableAllFieldinPurchase||g.isPurchaseOrderItem)return!0;break;case"disableMfgDate":return!!(this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry&&1==this.masterService.userSetting.EnableManualBatchinproduction||2==this._trnMainService.userSetting.EnableBatch||"VIEW"==g.rowMode||g.isDisabled||g.isPurchaseOrder||"stock-issue-approval"==this._trnMainService.activeurlpath||this._trnMainService.disableOnGRNload||null!=g.BATCH&&1==g.REQEXPDATE&&5==this._trnMainService.TrnMainObj.VoucherType||7==this._trnMainService.TrnMainObj.VoucherType||0==g.REQEXPDATE&&(3==this._trnMainService.TrnMainObj.VoucherType||88==this._trnMainService.TrnMainObj.VoucherType||74==this._trnMainService.TrnMainObj.VoucherType||31==this._trnMainService.TrnMainObj.VoucherType||24==this._trnMainService.TrnMainObj.VoucherType||15==this._trnMainService.TrnMainObj.VoucherType&&1==this.masterService.userSetting.ENABLEMANUALSALESRETURN))||!!this.disableProductDeleteAndGrid();case"disableExpDate":return!!(this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry&&1==this.masterService.userSetting.EnableManualBatchinproduction||2==this._trnMainService.userSetting.EnableBatch||"VIEW"==g.rowMode||g.isDisabled||g.isPurchaseOrderItem||"stock-issue-approval"==this._trnMainService.activeurlpath||this._trnMainService.disableOnGRNload||null!=g.BATCH&&1==g.REQEXPDATE&&5==this._trnMainService.TrnMainObj.VoucherType||7==this._trnMainService.TrnMainObj.VoucherType||0==g.REQEXPDATE&&(3==this._trnMainService.TrnMainObj.VoucherType||88==this._trnMainService.TrnMainObj.VoucherType||74==this._trnMainService.TrnMainObj.VoucherType||31==this._trnMainService.TrnMainObj.VoucherType||24==this._trnMainService.TrnMainObj.VoucherType||15==this._trnMainService.TrnMainObj.VoucherType&&1==this.masterService.userSetting.ENABLEMANUALSALESRETURN))||!!this.disableProductDeleteAndGrid();case"disableRowDelete":return("asset-purchase-invoice"!=this._trnMainService.activeurlpath||"VIEW"!=this._trnMainService.TrnMainObj.Mode)&&(!!("VIEW"==g.rowMode||"VIEW"==this._trnMainService.TrnMainObj.Mode||null==this._trnMainService.TrnMainObj.ProdList[m]?.MCODE&&1==this._trnMainService.TrnMainObj.ProdList.length||15==this._trnMainService.TrnMainObj.VoucherType&&1==this._trnMainService.TrnMainObj.DOFULLRETURN||"TI"==this._trnMainService.TrnMainObj.VoucherPrefix&&this._trnMainService.disableOnPerFormaSelect||this._trnMainService.TrnMainObj.REFORDBILL&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_PI&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase||(this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase)&&0!=this._trnMainService.userSetting.PODELIVERYMODE&&this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL&&this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("PO")||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssueReturn&&this._trnMainService.TrnMainObj.REFORDBILL||(this._trnMainService.TrnMainObj.VoucherType==t.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType==t.Km.Purchase)&&this._trnMainService.TrnMainObj.ProdList[m].TOTALOUTWARDSTOCK>0&&0==this.masterService.userSetting.ENABLESINGLEBATCHMODE&&"EDIT"==this._trnMainService.TrnMainObj.Mode||"stock-adjustment"==this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType==t.Km.BranchTransferOut&&1==this._trnMainService.TrnMainObj.DOFULLRETURN||this.disableProductDeleteAndGrid())||3==this._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI);case"disableConsumptionRowDelete":if(2==this.masterService.userSetting.EnableBomBaseConsumption&&this._trnMainService.TrnMainObj.ProdList[m].disableRowDeleteInBomBase&&this._trnMainService.TrnMainObj.VoucherType==t.Km.ProductionEntry)return!0;case"disableItemDescInMultipleConsumption":return!!(g.isBarcodeOfPtypeSix||!0===this._trnMainService.disableAllFieldinPurchase||g.isPurchaseOrderItem||7===this._trnMainService.TrnMainObj.VoucherType||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&0==this._trnMainService.userSetting.ENABLEMANUALSALESRETURN);case"disableDeleteRow":return"salesorder"==this.genericProductService.activeurlpath&&1==this._trnMainService.TrnMainObj.DOFULLRETURN||"VIEW"==this._trnMainService.TrnMainObj.Mode;case"disableOnView":return"VIEW"===this._trnMainService.TrnMainObj.Mode;case"disableQtyInTR":if("VIEW"==this._trnMainService.TrnMainObj.Mode)return!0;case"disableRemarks":case"disableOtherComments":return"VIEW"==this._trnMainService.TrnMainObj.Mode;case"disableECSAmount":return!("add-purchase-invoice"!=this._trnMainService.activeurlpath||!("GR"==this._trnMainService.TrnMainObj.VoucherAbbName||this._trnMainService.TrnMainObj.CHALANNO&&this._trnMainService.TrnMainObj.CHALANNO.startsWith("GR")))||(1==this._trnMainService.TrnMainObj.ProdList[m].HASECSCHARGE?1==this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[m]?.HASECSRATE)&&"EDIT"==this._trnMainService.TrnMainObj.Mode||this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[m].ECSRATE)>0&&"EDIT"!=this._trnMainService.TrnMainObj.Mode||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&1==this.masterService.userSetting.REFBILLCOMPULSORINDNOTE&&"EDIT"==this._trnMainService.TrnMainObj.Mode:!!(this._trnMainService.TrnMainObj.ProdList[m].ECSRATE>0||0==this._trnMainService.TrnMainObj.ProdList[m].HASECSCHARGE||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&1==this.masterService.userSetting.REFBILLCOMPULSORINDNOTE&&this._trnMainService.TrnMainObj.REFBILL))}return R}disableRAteDisandAmt(){return this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote&&1===this._trnMainService.TrnMainObj.DOFULLRETURN&&1!==this._trnMainService.TrnMainObj.DONONSALEABLERETURN&&0==this._trnMainService.userSetting.ENABLEMANUALSALESRETURN||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&1===this._trnMainService.TrnMainObj.DOFULLRETURN&&1==this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE||this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote&&0===this._trnMainService.TrnMainObj.DOFULLRETURN&&0==this._trnMainService.userSetting.ENABLEMANUALSALESRETURN&&null!=this._trnMainService.TrnMainObj.REFBILL&&""!=this._trnMainService.TrnMainObj.REFBILL&&null!=this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn&&0===this._trnMainService.TrnMainObj.DOFULLRETURN||!!this.disableProductDeleteAndGrid()}DisableInAssetProdInsert(I,m,S=!1){let g=this._trnMainService.TrnMainObj.AssetsProdList[m];switch(I){case"disableAssetItemDesc":return"VIEW"===this._trnMainService.TrnMainObj.Mode||!!g.IsDepreciationDone;case"disableSubLedger":return"VIEW"===this._trnMainService.TrnMainObj.Mode||"EDIT"!==this._trnMainService.TrnMainObj.Mode&&"NEW"!==this._trnMainService.TrnMainObj.Mode||1!=g.HASSUBLEDGER}}disableProductDeleteAndGrid(){return 0!=this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.FLATDCAMNT)||0!=this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.DCRATE)?!(this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL&&this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("QT")||(this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryChalan)&&(0==this._trnMainService.TrnMainObj.LOADFULLFROMQT||2==this._trnMainService.userSetting.ENABLE_SOINTI)&&this._trnMainService.TrnMainObj.REFORDBILL&&this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("SO")||this._trnMainService.TrnMainObj.VoucherType===t.Km.DebitNote&&0===this._trnMainService.TrnMainObj.DOFULLRETURN&&1==this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE&&this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote&&0===this._trnMainService.TrnMainObj.DOFULLRETURN&&0==this._trnMainService.userSetting.ENABLEMANUALSALESRETURN):!(this._trnMainService.TrnMainObj.VoucherType!==t.Km.SalesOrder||1!=this._trnMainService.TrnMainObj.DOFULLRETURN||!this._trnMainService.TrnMainObj.REFORDBILL||!this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("QT"))}disablePurchaseFields_PI_GRN(I){if(["disableAltQty","disableAltUnit"].includes(I)){if(this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&1===this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL){if("purchase-import"!==this._trnMainService.activeurlpath&&0!==this._trnMainService.userSetting.PODELIVERYMODE&&(0===this._trnMainService.userSetting.AllowQtyExceedInPo&&1!==this._trnMainService.userSetting.ENABLE_GRN_IN_PI||1===this._trnMainService.userSetting.ENABLE_GRN_IN_PI))return!0;if("purchase-import"===this._trnMainService.activeurlpath&&0!==this._trnMainService.userSetting.IMPORTPOBILLMODE&&(0===this._trnMainService.userSetting.AllowQtyExceedInPo&&1!==this._trnMainService.userSetting.ENABLE_GRN_IN_PI||1===this._trnMainService.userSetting.ENABLE_GRN_IN_PI))return!0}if(this._trnMainService.TrnMainObj.VoucherType===t.Km.GoodsReceived&&0===this._trnMainService.userSetting.AllowQtyExceedInPo&&this._trnMainService.TrnMainObj.REFORDBILL){if("goods-received-note-import"!==this._trnMainService.activeurlpath&&(1==this._trnMainService.userSetting.PODELIVERYMODE||1===this._trnMainService.TrnMainObj.DOFULLRETURN))return!0;if("goods-received-note-import"===this._trnMainService.activeurlpath&&0!==this._trnMainService.userSetting.IMPORTPOBILLMODE)return!0}return!1}return!(!["disableRateandDiscount","disableAltRate"].includes(I)||"purchase-import"!==this._trnMainService.activeurlpath&&"purchase-import-order"!==this._trnMainService.activeurlpath&&"goods-received-note-import"!==this._trnMainService.activeurlpath&&(0===this._trnMainService.userSetting.PODELIVERYMODE||!this._trnMainService.TrnMainObj.REFORDBILL||1!==this._trnMainService.TrnMainObj.DOFULLRETURN&&0!==this._trnMainService.userSetting.RATECHANGE_IN_POBASEPI||this._trnMainService.TrnMainObj.VoucherType!==t.Km.Purchase&&this._trnMainService.TrnMainObj.VoucherType!==t.Km.GoodsReceived))}}return Q.\u0275fac=function(I){return new(I||Q)(s.Y36(h.p,16),s.Y36(V.P,16),s.Y36(p.w,16),s.Y36(s.zs3,16))},Q.\u0275pipe=s.Yjl({name:"disable",type:Q,pure:!0}),Q})()},84260:(z,Z,M)=>{M.d(Z,{R:()=>V});var t=M(42326),e=M(66274),s=M(87584),h=M(94534);let V=(()=>{class p{constructor(Q,L){this._trnMainService=Q,this.genericProductService=L}transform(Q,L){return this.Hide(Q,L)}Hide(Q,L=!1){if("hideAddButton"===Q)return!("VIEW"==this._trnMainService.TrnMainObj.Mode||"stock-adjustment"==this._trnMainService.activeurlpath||(this._trnMainService.TrnMainObj.VoucherType!==t.Km.StockSettlement||"VIEW"!=this._trnMainService.TrnMainObj.Mode)&&("goods-received-note"==this._trnMainService.activeurlpath&&(2==this._trnMainService.userSetting.PODELIVERYMODE||1==this._trnMainService.userSetting.PODELIVERYMODE)&&1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL||("salesorder"==this.genericProductService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType===t.Km.DeliveryReturn)&&1==this._trnMainService.TrnMainObj.DOFULLRETURN||"TI"==this._trnMainService.TrnMainObj.VoucherPrefix&&this._trnMainService.disableOnPerFormaSelect||"RQ"==this._trnMainService.TrnMainObj.VoucherPrefix&&"EDIT"==this._trnMainService.TrnMainObj.Mode&&10==this._trnMainService.TrnMainObj.STATUS||this._trnMainService.TrnMainObj.VoucherType===t.Km.ProductionEntry&&1==this._trnMainService.userSetting.LinkProductionwithconsumption&&"EDIT"==this._trnMainService.TrnMainObj.Mode||this._trnMainService.TrnMainObj.VoucherType===t.Km.BranchTransferOut&&this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.VoucherType===t.Km.StockIssue&&"FROMREQUESITION"==this._trnMainService.TrnMainObj.tag&&this._trnMainService.TrnMainObj.REFBILL||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.REFORDBILL&&1==this._trnMainService.TrnMainObj.LOADFULLFROMQT||this._trnMainService.TrnMainObj.VoucherType==t.Km.TaxInvoice&&this._trnMainService.TrnMainObj.DELIVERYREF?.length>0&&this._trnMainService.TrnMainObj.ProdList.filter(I=>I.MCODE)?.length>0||this.hideProductAdd()||(this._trnMainService.TrnMainObj.VoucherType!==t.Km.SalesOrder||1!=this._trnMainService.TrnMainObj.DOFULLRETURN||!this._trnMainService.TrnMainObj.REFORDBILL||!this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("QT"))&&(82==this._trnMainService.TrnMainObj.VoucherType||90==this._trnMainService.TrnMainObj.VoucherType&&"supplier"==this._trnMainService.TrnMainObj.filterByInReqApproval||95==this._trnMainService.TrnMainObj.VoucherType||84==this._trnMainService.TrnMainObj.VoucherType||85==this._trnMainService.TrnMainObj.VoucherType||96==this._trnMainService.TrnMainObj.VoucherType||1==this._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag||this._trnMainService.TrnMainObj.REFORDBILL&&2==this._trnMainService.userSetting.PODELIVERYMODE&&1==this._trnMainService.userSetting.ENABLE_GRN_IN_PI&&this._trnMainService.TrnMainObj.VoucherType===t.Km.Purchase&&("GR"==this._trnMainService.TrnMainObj.VoucherAbbName||this._trnMainService.TrnMainObj.CHALANNO&&this._trnMainService.TrnMainObj.CHALANNO.startsWith("GR")))))}hideProductAdd(){return!(0==this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.FLATDCAMNT)&&0==this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.DCRATE)||this._trnMainService.TrnMainObj.VoucherType===t.Km.SalesOrder&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.TrnMainObj.REFORDBILL&&this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("QT")||(this._trnMainService.TrnMainObj.VoucherType===t.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===t.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===t.Km.PerformaSalesInvoice)&&0==this._trnMainService.TrnMainObj.LOADFULLFROMQT||(this._trnMainService.TrnMainObj.VoucherType!==t.Km.DebitNote||1!==this._trnMainService.TrnMainObj.DOFULLRETURN||1!=this._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE)&&(this._trnMainService.TrnMainObj.VoucherType===t.Km.CreditNote&&0==this._trnMainService.TrnMainObj.DOFULLRETURN||"EDIT"===this._trnMainService.TrnMainObj.Mode))}}return p.\u0275fac=function(Q){return new(Q||p)(e.Y36(s.p,16),e.Y36(h.w,16))},p.\u0275pipe=e.Yjl({name:"hide",type:p,pure:!0}),p})()},56529:(z,Z,M)=>{M.d(Z,{A:()=>h});var t=M(92752),e=M(66274),s=M(87584);let h=(()=>{class V{constructor(F){this._trnMainService=F}transform(F){if(console.log("value ma k aaucha",F),null==F||null==F||""==F)return"";let Q=new Date(F);return 0==this._trnMainService.userSetting.enableDayWiseMfgEXPDate?Q.toLocaleDateString("en-US",{month:"long",year:"numeric"}):(0,t.p6)(F,"MM/dd/yyyy","en-US")}}return V.\u0275fac=function(F){return new(F||V)(e.Y36(s.p,16))},V.\u0275pipe=e.Yjl({name:"monthYear",type:V,pure:!0}),V})()},94619:(z,Z,M)=>{M.d(Z,{m:()=>$});var t=M(66274),e=M(7587),s=M(53074),h=M(87584),V=M(67311),p=M(14970),F=M(92752),Q=M(56529);function L(N,k){1&N&&(t.TgZ(0,"h5",17),t._uU(1,"Authorization"),t.qZA())}function I(N,k){1&N&&(t.TgZ(0,"h5",17),t._uU(1,"Expired Item List"),t.qZA())}function m(N,k){if(1&N){const b=t.EpF();t.TgZ(0,"div",18)(1,"label",19),t._uU(2,"Username :"),t.qZA(),t.TgZ(3,"div",20)(4,"input",21),t.NdJ("ngModelChange",function(c){t.CHM(b);const _=t.oxw(2);return t.KtG(_.AuthObj.username=c)})("keydown.enter",function(){t.CHM(b);const c=t.oxw(2);return t.KtG(c.focusToPassword())}),t.qZA()()()}if(2&N){const b=t.oxw(2);t.xp6(4),t.Q6J("ngModel",b.AuthObj.username)}}function S(N,k){if(1&N){const b=t.EpF();t.TgZ(0,"div",22)(1,"label",23),t._uU(2,"Password:"),t.qZA(),t.TgZ(3,"div",20)(4,"input",24),t.NdJ("ngModelChange",function(c){t.CHM(b);const _=t.oxw(2);return t.KtG(_.AuthObj.password=c)})("keydown.enter",function(){t.CHM(b);const c=t.oxw(2);return t.KtG(c.authConfirm())}),t.qZA()()()}if(2&N){const b=t.oxw(2);t.xp6(4),t.Q6J("ngModel",b.AuthObj.password)}}function g(N,k){1&N&&(t.TgZ(0,"th",33),t._uU(1,"Cost Rate"),t.qZA())}function R(N,k){1&N&&(t.TgZ(0,"th",33),t._uU(1,"Dis%"),t.qZA())}function u(N,k){1&N&&(t.TgZ(0,"th",33),t._uU(1,"Dis Amnt."),t.qZA())}function a(N,k){1&N&&(t.TgZ(0,"th",33),t._uU(1,"Expiry Date"),t.qZA())}function E(N,k){if(1&N&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"number"),t.qZA()),2&N){const b=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,b.PRATE,"1.2-2"))}}function y(N,k){if(1&N&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"number"),t.qZA()),2&N){const b=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,b.INDDISCOUNTRATE,"1.2-2"))}}function P(N,k){if(1&N&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"number"),t.qZA()),2&N){const b=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,b.INDDISCOUNT,"1.2-2"))}}function x(N,k){if(1&N&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"monthYear"),t.qZA()),2&N){const b=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,b.EXPDATE))}}function O(N,k){if(1&N&&(t.TgZ(0,"tr")(1,"td",34),t._uU(2),t.qZA(),t.TgZ(3,"td",35),t._uU(4),t.qZA(),t.YNc(5,E,3,4,"td",36),t.YNc(6,y,3,4,"td",36),t.YNc(7,P,3,4,"td",36),t.YNc(8,x,3,3,"td",36),t.qZA()),2&N){const b=k.$implicit,w=k.index,c=t.oxw(4);t.xp6(2),t.Oqu(w+1),t.xp6(2),t.Oqu(b.ITEMDESC),t.xp6(1),t.Q6J("ngIf","showExpItemList"!=c.authorizeFor),t.xp6(1),t.Q6J("ngIf","discountCheck"==c.authorizeFor||"GblDiscountCheck"==c.authorizeFor),t.xp6(1),t.Q6J("ngIf","discountCheck"==c.authorizeFor||"GblDiscountCheck"==c.authorizeFor),t.xp6(1),t.Q6J("ngIf","showExpItemList"==c.authorizeFor)}}function j(N,k){if(1&N&&(t.TgZ(0,"div",13)(1,"label",26),t._uU(2,"Item Details: "),t.qZA(),t.TgZ(3,"table",27)(4,"thead")(5,"tr",28)(6,"th",29),t._uU(7,"S.n"),t.qZA(),t.TgZ(8,"th",30),t._uU(9,"Item Name"),t.qZA(),t.YNc(10,g,2,0,"th",31),t.YNc(11,R,2,0,"th",31),t.YNc(12,u,2,0,"th",31),t.YNc(13,a,2,0,"th",31),t.qZA()(),t.TgZ(14,"tbody"),t.YNc(15,O,9,6,"tr",32),t.qZA()()()),2&N){const b=t.oxw(3);t.xp6(10),t.Q6J("ngIf","showExpItemList"!=b.authorizeFor),t.xp6(1),t.Q6J("ngIf","discountCheck"==b.authorizeFor||"GblDiscountCheck"==b.authorizeFor),t.xp6(1),t.Q6J("ngIf","discountCheck"==b.authorizeFor||"GblDiscountCheck"==b.authorizeFor),t.xp6(1),t.Q6J("ngIf","showExpItemList"==b.authorizeFor),t.xp6(2),t.Q6J("ngForOf",b.itemList)}}function D(N,k){if(1&N&&(t.TgZ(0,"div"),t.YNc(1,j,16,5,"div",25),t.qZA()),2&N){const b=t.oxw(2);t.xp6(1),t.Q6J("ngIf",b.itemList&&b.itemList.length>0)}}function U(N,k){1&N&&(t.TgZ(0,"div",38)(1,"span",39)(2,"strong"),t._uU(3,"Note:"),t.qZA(),t._uU(4," Press confirm to save transaction."),t.qZA()())}function W(N,k){if(1&N){const b=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3),t.YNc(3,L,2,0,"h5",4),t.YNc(4,I,2,0,"h5",4),t.TgZ(5,"div",5)(6,"button",6),t.NdJ("click",function(){t.CHM(b);const c=t.oxw();return t.KtG(c.closeDialog())}),t.TgZ(7,"span",7),t._uU(8,"\xd7"),t.qZA()()()(),t.TgZ(9,"div",8),t.YNc(10,m,5,1,"div",9),t.YNc(11,S,5,1,"div",10),t.YNc(12,D,2,1,"div",11),t.qZA(),t.TgZ(13,"div",12)(14,"div",13),t.YNc(15,U,5,0,"div",14),t.TgZ(16,"div",15)(17,"button",16),t.NdJ("click",function(){t.CHM(b);const c=t.oxw();return t.KtG(c.authConfirm())})("keydown.enter",function(){t.CHM(b);const c=t.oxw();return t.KtG(c.authConfirm())}),t._uU(18,"Confirm"),t.qZA()()()()()()}if(2&N){const b=t.oxw();t.xp6(3),t.Q6J("ngIf","showExpItemList"!=b.authorizeFor),t.xp6(1),t.Q6J("ngIf","showExpItemList"==b.authorizeFor),t.xp6(6),t.Q6J("ngIf","showExpItemList"!=b.authorizeFor),t.xp6(1),t.Q6J("ngIf","showExpItemList"!=b.authorizeFor),t.xp6(1),t.Q6J("ngIf",90!=b._trnMainService.TrnMainObj.VoucherType),t.xp6(3),t.Q6J("ngIf","showExpItemList"==b.authorizeFor)}}let $=(()=>{class N{constructor(b,w,c,_,l){this.fb=b,this.masterservice=w,this._trnMainService=c,this.alertService=_,this.spinnerService=l,this.isActive=!1,this.AuthObj={},this.onUserRightReceived=new t.vpe,this.onDiscountLimitReceived=new t.vpe,this.onRoleRightsReceived=new t.vpe,this.onCreditLimitReceived=new t.vpe,this.allowExpiredItemforSave=new t.vpe,this.itemList=[]}ngOnInit(){}closeDialog(){this.isActive=!1}show(b=[],w){this.isActive=!0,console.log("filter list in ",b,w),this.itemList=b,this.authorizeFor=w,setTimeout(()=>{document.getElementById("AuthUsername").focus()},500)}hide(){this.isActive=!1}authConfirm(){console.log("atuh obj",this.AuthObj),""!=this.AuthObj.username&&null!=this.AuthObj.username||"showExpItemList"==this.authorizeFor?""!=this.AuthObj.password&&null!=this.AuthObj.password||"showExpItemList"==this.authorizeFor?(this.spinnerService.show("showExpItemList"==this.authorizeFor?"Saving Data. Please Wait...":"Asking for Authorization. Please Wait.."),this.authCheckCreditLimit(),"prateCheck"==this.authorizeFor?this.masterservice.authorizeSalesBelowCRate(this.AuthObj).subscribe(b=>{this.spinnerService.hide(),"ok"==b.status&&this.onUserRightReceived.emit(b.result)},b=>{this.spinnerService.hide(),this.alertService.info(b)}):"discountCheck"==this.authorizeFor?(console.log("CHECK DISOCUNT LIMIT"),this.masterservice.authorizeDiscountLimitInSO(this.AuthObj).subscribe(b=>{this.spinnerService.hide(),"ok"==b.status&&this.onDiscountLimitReceived.emit(b.result)},b=>{this.spinnerService.hide(),this.alertService.info(b)})):"GblDiscountCheck"==this.authorizeFor?(console.log("CHECK DISOCUNT LIMIT"),this.masterservice.authorizeGblDiscountLimit(this.AuthObj).subscribe(b=>{this.spinnerService.hide(),"ok"==b.status&&this.onRoleRightsReceived.emit(b.result)},b=>{this.spinnerService.hide(),this.alertService.info(b)})):"ReqApproval"==this.authorizeFor?this.masterservice.authorizeApprovedQtyWLessStock(this.AuthObj).subscribe(b=>{this.spinnerService.hide(),"ok"==b.status&&this.onUserRightReceived.emit(b.result)},b=>{this.spinnerService.hide(),this.alertService.info(b)}):"showExpItemList"==this.authorizeFor&&(this.spinnerService.hide(),this.allowExpiredItemforSave.emit("ALLOWSAVE")),this.AuthObj.password="",this.AuthObj.username=""):this.alertService.warning("Please enter password !"):this.alertService.warning("Please enter username !")}focusToPassword(){setTimeout(()=>{document.getElementById("AuthPassword").focus()},500)}authCheckCreditLimit(){"AuthorizeCreditLimitCheck"==this.authorizeFor&&this.masterservice.AuthorizeCreditLimitCheck(this.AuthObj).subscribe(b=>{this.spinnerService.hide(),"ok"==b.status&&this.onCreditLimitReceived.emit(b.result)},b=>{this.spinnerService.hide(),this.alertService.info(b)})}}return N.\u0275fac=function(b){return new(b||N)(t.Y36(e.qu),t.Y36(s.P),t.Y36(h.p),t.Y36(V.c),t.Y36(p.V))},N.\u0275cmp=t.Xpm({type:N,selectors:[["authentication-entry"]],outputs:{onUserRightReceived:"onUserRightReceived",onDiscountLimitReceived:"onDiscountLimitReceived",onRoleRightsReceived:"onRoleRightsReceived",onCreditLimitReceived:"onCreditLimitReceived",allowExpiredItemforSave:"allowExpiredItemforSave"},decls:1,vars:1,consts:[["class","customer_container",4,"ngIf"],[1,"customer_container"],[1,"card"],[1,"card-header"],["class","page-title",4,"ngIf"],[1,"button-group"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"card-body"],["class","form-group row","style","margin-top: 1rem;",4,"ngIf"],["class","form-group row",4,"ngIf"],[4,"ngIf"],[1,"card-footer"],[1,"row"],["class","col-9",4,"ngIf"],[1,"col"],["type","button",1,"btn","btn-info",2,"margin-left","50px !important",3,"click","keydown.enter"],[1,"page-title"],[1,"form-group","row",2,"margin-top","1rem"],[1,"col-sm-3","form-control-label"],[1,"col-md-8"],["id","AuthUsername","type","text","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange","keydown.enter"],[1,"form-group","row"],[1,"col-md-3","form-control-label"],["id","AuthPassword","type","password","autocomplete","off",1,"form-control",2,"width","100%",3,"ngModel","ngModelChange","keydown.enter"],["class","row",4,"ngIf"],[2,"font-size","12px","font-weight","bold","height","20px"],[1,"table","table-striped"],[2,"position","sticky","top","0","line-height","1rem"],["scope","col",2,"width","7%"],["scope","col",2,"width","50%"],["scope","col","style","width: 15%; text-align: right;",4,"ngIf"],[4,"ngFor","ngForOf"],["scope","col",2,"width","15%","text-align","right"],[2,"width","7%"],[2,"width","50%"],["style","width: 15%; text-align: right;",4,"ngIf"],[2,"width","15%","text-align","right"],[1,"col-9"],[2,"font-size","12px"]],template:function(b,w){1&b&&t.YNc(0,W,19,6,"div",0),2&b&&t.Q6J("ngIf",w.isActive)},dependencies:[F.sg,F.O5,e.Fj,e.JJ,e.On,F.JJ,Q.A],styles:[".customer_container[_ngcontent-%COMP%]{position:fixed!important;transform:translate(-50px,-50px);background:#ffffff;z-index:99999;width:40%;top:25%;left:60%}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{border:1px solid #cbcbcb;border-radius:3px;height:4vh;color:#000}.page-title[_ngcontent-%COMP%]{text-align:center}.form-control[_ngcontent-%COMP%]{font-size:12px}.button-group[_ngcontent-%COMP%]{position:absolute;right:3%;top:3%}.card-body[_ngcontent-%COMP%]{line-height:.4rem;padding:5px}.card-header[_ngcontent-%COMP%]{padding:5px 3px;background:silver}.card-footer[_ngcontent-%COMP%]{padding:5px 3px}label[_ngcontent-%COMP%]{font-size:13px;font-weight:500}tbody[_ngcontent-%COMP%]{display:block;height:11vh;overflow:auto}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.4rem!important}th[_ngcontent-%COMP%]{font-size:14px}td[_ngcontent-%COMP%]{font-size:13px}table[_ngcontent-%COMP%]{width:97.5%!important}"]}),N})()},32711:(z,Z,M)=>{M.d(Z,{ed:()=>$,im:()=>N});var t=M(64762),e=M(66274),s=M(68277),h=M(28049),V=M(54395),p=M(92340),F=M(53181),Q=M(87584),L=M(92752),I=M(7587),m=M(72533);const S=["inputBox"];function g(c,_){if(1&c&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&c){const l=e.oxw().$implicit;e.xp6(1),e.Oqu(l.title)}}function R(c,_){if(1&c&&(e.ynx(0),e.YNc(1,g,2,1,"th",2),e.BQk()),2&c){const l=_.$implicit;e.xp6(1),e.Q6J("ngIf",!l.hidden)}}function u(c,_){1&c&&(e.TgZ(0,"th"),e._uU(1,"Action"),e.qZA())}function a(c,_){if(1&c&&(e.TgZ(0,"td")(1,"div",20),e._uU(2),e.qZA()()),2&c){const l=e.oxw().$implicit,v=e.oxw().$implicit;e.xp6(1),e.s9C("title",v[l.key]),e.xp6(1),e.hij(" ",v[l.key]," ")}}function E(c,_){if(1&c&&(e.ynx(0),e.YNc(1,a,3,2,"td",2),e.BQk()),2&c){const l=_.$implicit;e.xp6(1),e.Q6J("ngIf",!l.hidden)}}function y(c,_){if(1&c){const l=e.EpF();e.ynx(0),e.TgZ(1,"span")(2,"i",21),e.NdJ("click",function(){const A=e.CHM(l).$implicit,K=e.oxw(2).index,q=e.oxw(3);return e.KtG(q.onActionClicked(A.text,K))}),e.qZA()(),e.BQk()}if(2&c){const l=_.$implicit;e.xp6(2),e.Tol(l.icon),e.s9C("title",l.title)}}function P(c,_){if(1&c&&(e.ynx(0),e.TgZ(1,"td"),e.YNc(2,y,3,4,"ng-container",14),e.qZA(),e.BQk()),2&c){const l=e.oxw(4);e.xp6(2),e.Q6J("ngForOf",l.popupsettings.actionKeys)}}function x(c,_){if(1&c){const l=e.EpF();e.TgZ(0,"tr",19),e.NdJ("dblclick",function(){const A=e.CHM(l).$implicit,K=e.oxw(3);return e.KtG(K.doubleClick(A))})("click",function(){const A=e.CHM(l).index,K=e.oxw(3);return e.KtG(K.singleClick(A))}),e.YNc(1,E,2,1,"ng-container",14),e.YNc(2,P,3,1,"ng-container",2),e.qZA()}if(2&c){const l=_.index,v=e.oxw(3);e.ekj("selected-row",v.selectedRowIndex==l),e.xp6(1),e.Q6J("ngForOf",v.popupsettings.columns),e.xp6(1),e.Q6J("ngIf",v.popupsettings.showActionButton&&v.popupsettings.actionKeys.length)}}const O=function(c,_,l,v){return{id:c,itemsPerPage:_,currentPage:l,totalItems:v}};function j(c,_){if(1&c&&(e.TgZ(0,"tbody"),e.YNc(1,x,3,4,"tr",18),e.ALo(2,"paginate"),e.qZA()),2&c){const l=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,l.itemList,e.l5B(4,O,l.tabindex,l.pageSize,l.pageNumber,l.totalItems)))}}function D(c,_){if(1&c){const l=e.EpF();e.TgZ(0,"div",22)(1,"pagination-controls",23),e.NdJ("pageChange",function(T){e.CHM(l);const A=e.oxw(2);return e.KtG(A.onPageChange(T))}),e.qZA()()}if(2&c){const l=e.oxw(2);e.xp6(1),e.Q6J("id",l.tabindex)}}function U(c,_){if(1&c&&e._UZ(0,"div",24),2&c){const l=e.oxw(2);e.Q6J("innerHTML",l.summary,e.oJD)}}function W(c,_){if(1&c){const l=e.EpF();e.TgZ(0,"div")(1,"div")(2,"div",3)(3,"h4",4),e._uU(4),e.qZA(),e.TgZ(5,"button",5),e.NdJ("click",function(){e.CHM(l);const T=e.oxw();return e.KtG(T.hide())}),e.TgZ(6,"span",6),e._uU(7,"\xd7"),e.qZA()()(),e.TgZ(8,"div",7)(9,"div",8),e._UZ(10,"input",9,10),e.qZA()(),e.TgZ(12,"div",11)(13,"table",12)(14,"thead")(15,"tr",13),e.YNc(16,R,2,1,"ng-container",14),e.YNc(17,u,2,0,"th",2),e.qZA()(),e.YNc(18,j,3,9,"tbody",2),e.qZA(),e.TgZ(19,"div",15),e.YNc(20,D,2,1,"div",16),e.qZA()()(),e.YNc(21,U,1,1,"div",17),e.qZA()}if(2&c){const l=e.oxw();e.xp6(4),e.hij(" ",l.popupsettings.title," "),e.xp6(6),e.Q6J("formControl",l.filterValue),e.xp6(6),e.Q6J("ngForOf",l.popupsettings.columns),e.xp6(1),e.Q6J("ngIf",l.popupsettings.showActionButton&&l.popupsettings.actionKeys.length),e.xp6(1),e.Q6J("ngIf",l.itemList.length),e.xp6(2),e.Q6J("ngIf",l.itemList.length),e.xp6(1),e.Q6J("ngIf",l.summary)}}class $ extends s.nd{constructor(_,l,v){super(_),this.injector=_,this.dialog=l,this._trnMainService=v,this.requestUrl="",this.isActive=!1,this.itemList=[],this.selectedRowIndex=0,this.tabindex="list",this.hideGridOnDoubleClick=!0,this.billTo="",this.tag="",this.isForCancelOrder=!1,this.onPopUpClose=new e.vpe,this.onItemDoubleClick=new e.vpe,this.onDeleteClicked=new e.vpe}ngAfterViewInit(){this.filterValue.valueChanges.pipe((0,V.b)(500)).subscribe(_=>{this.refreshPage(),this.refresh()})}show(_="",l=!1,v="",T=!0){this.hideGridOnDoubleClick=T,setTimeout(()=>{this.inputBox.nativeElement.focus()},10),this.summary=null,this.billTo=_,this.isForCancelOrder=l,this.itemList=[],this.isActive=!0,this.selectedRowIndex=0,this.tag=v,setTimeout(()=>{this.setFilterOption(),this.refreshPage(),this.refresh()},100)}setFilterOption(){if(this.popupsettings&&this.popupsettings.columns.length){const _=this.popupsettings.defaultFilterIndex?this.popupsettings.defaultFilterIndex:0;if(this.popupsettings.columns.length<=_)return;this.filterValue.setValue(""),this.filterOption=this.popupsettings.columns[_].key}}getData(){this.summary=null,this.selectedRowIndex=0;let v=`${p.N.apiUrl}${this.popupsettings.apiEndpoints}?currentPage=${this.pageNumber}&maxResultCount=${this.pageSize}`;return this.billTo&&""!==this.billTo&&null!=this.billTo&&void 0!==this.billTo&&(v+=`&billTo=${this.billTo}`),this.tag&&""!==this.tag&&null!=this.tag&&void 0!==this.isTableLoading&&(v+=`&tag=${this.tag}`),this.isForCancelOrder&&(v+=`&isForCancelOrder=${this.isForCancelOrder}`),this.requestUrl=this.getFilterOption(v,1==this._trnMainService.userSetting.ProductSearchMode?1:0),this._http.get(this.requestUrl).pipe((0,h.P)()).subscribe(T=>{this.totalItems=T?T.totalCount:0,this.itemList=T?T.data:[],this.itemList.forEach(function(A){null!=A.TRNDATE&&void 0!==A.TRNDATE&&(A.TRNDATE=A.TRNDATE.toString().substring(0,10)),null!=A.DATE&&void 0!==A.DATE&&(A.DATE=A.DATE.toString().substring(0,10))}),this.itemList.length>0&&0===this.selectedRowIndex&&this.itemList[this.selectedRowIndex].itemSummary&&(this.summary=this.itemList[this.selectedRowIndex].itemSummary)})}hide(){this.itemList=[],this.pageNumber=1,this.totalItems=0,this.isActive=!1}triggerSearch(){null==this.filterOption||void 0===this.filterOption||""===this.filterOption||(this.filterValue.setValue(""),this.refreshPage(),this.refresh())}singleClick(_){this.selectedRowIndex=_,this.summary=this.itemList[_].itemSummary}doubleClick(_){this.onItemDoubleClick.emit(_),this.hideGridOnDoubleClick&&this.hide()}updown(_){if(!this.isActive)return!0;if("ArrowDown"===_.code)_.preventDefault(),this.selectedRowIndex++,null!=this.itemList[this.selectedRowIndex]&&(this.summary=this.itemList[this.selectedRowIndex].itemSummary),this.calculateTotalPages(),this.selectedRowIndex===this.itemList.length&&this.pageNumber<this.totalPages?(this.pageNumber=this.pageNumber+1,this.refresh(),this.selectedRowIndex=0,this.itemListClosed()):this.selectedRowIndex===this.itemList.length&&this.pageNumber===this.totalPages&&(this.selectedRowIndex=this.itemList.length-1);else if("ArrowUp"===_.code)_.preventDefault(),this.selectedRowIndex--,null!=this.itemList[this.selectedRowIndex]&&(this.summary=this.itemList[this.selectedRowIndex].itemSummary),-1===this.selectedRowIndex&&this.pageNumber>1?(this.pageNumber=this.pageNumber-1,this.refresh(),this.selectedRowIndex=this.itemList.length-1,this.itemListClosed()):-1===this.selectedRowIndex&&1===this.pageNumber&&(this.selectedRowIndex=0);else if(("Enter"===_.code||"NumpadEnter"===_.code)&&this.selectedRowIndex>=0&&this.selectedRowIndex<this.itemList.length)_.preventDefault(),"BARCODE"===this.filterOption||(this.onItemDoubleClick.emit(this.itemList[this.selectedRowIndex]),this.hide(),this.itemListClosed());else if("Escape"===_.code)_.preventDefault(),this.hide(),this.itemListClosed();else if("ArrowRight"===_.code){if(_.preventDefault(),this.calculateTotalPages(),this.pageNumber>=this.totalPages)return void(this.pageNumber=this.totalPages);this.selectedRowIndex=0,this.pageNumber=this.pageNumber+1,this.refresh()}else if("ArrowLeft"===_.code){if(_.preventDefault(),this.pageNumber<=1)return void(this.pageNumber=1);this.selectedRowIndex=0,this.pageNumber=this.pageNumber-1,this.refresh()}}itemListClosed(){this.onPopUpClose.emit()}ngOnChanges(_){this.popupsettings=_.popupsettings.currentValue}onActionClicked(_,l){if(""!==_&&null!=_&&void 0!==_){const v=_.toLowerCase();switch(v){case"delete":case"cancel":confirm(`Are you sure to ${v} this row ?.`)&&this.onDeleteClicked.emit(this.itemList[l])}}}}$.\u0275fac=function(_){return new(_||$)(e.Y36(e.zs3),e.Y36(F.uw),e.Y36(Q.p))},$.\u0275cmp=e.Xpm({type:$,selectors:[["barcode-popup-grid"]],viewQuery:function(_,l){if(1&_&&e.Gf(S,5),2&_){let v;e.iGM(v=e.CRH())&&(l.inputBox=v.first)}},hostBindings:function(_,l){1&_&&e.NdJ("keydown",function(T){return l.updown(T)},!1,e.evT)},inputs:{popupsettings:"popupsettings",summary:"summary"},outputs:{onPopUpClose:"onPopUpClose",onItemDoubleClick:"onItemDoubleClick",onDeleteClicked:"onDeleteClicked"},features:[e.qOj,e.TTD],decls:3,vars:3,consts:[[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","25px"],[1,"modal-content","modal-content-main-area"],[4,"ngIf"],[1,"modal-header",2,"padding","0px","background","#7ed0ff"],[1,"modal-title",2,"padding-left","5px","font-size","1.2rem"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"row"],[1,"col-md-12",2,"margin","2px 0px","display","flex","padding-right","0px"],["type","text","placeholder","Enter keyword to search",2,"width","100%",3,"formControl"],["inputBox",""],[1,"col-md-12","table-scroll"],[1,"table"],[2,"background","#7ed0ff"],[4,"ngFor","ngForOf"],[1,"row",2,"float","center","margin","4px 0px"],["class","col-md-12","style","width:100%;margin-top: -1.8rem;",4,"ngIf"],["style","margin-left: 25px; margin-top: -25px;\n        font-size: 12px;",3,"innerHTML",4,"ngIf"],["class","highlight","title","double click for detail view",3,"selected-row","dblclick","click",4,"ngFor","ngForOf"],["title","double click for detail view",1,"highlight",3,"dblclick","click"],[3,"title"],[3,"title","click"],[1,"col-md-12",2,"width","100%","margin-top","-1.8rem"],["maxSize","9","directionLinks","true","autoHide","true","responsive","true","previousLabel","Previous","nextLabel","Next","screenReaderPaginationLabel","Pagination","screenReaderPageLabel","page","screenReaderCurrentLabel","You're on page",2,"margin-left","6rem","margin-bottom","0","font-size","0.8rem",3,"id","pageChange"],[2,"margin-left","25px","margin-top","-25px","font-size","12px",3,"innerHTML"]],template:function(_,l){1&_&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,W,22,7,"div",2),e.qZA()()),2&_&&(e.ekj("modal-sticky-hide",!l.isActive),e.xp6(2),e.Q6J("ngIf",l.popupsettings))},dependencies:[L.sg,L.O5,I.Fj,I.JJ,I.oH,m.LS,m._s],styles:[".modal-content[_ngcontent-%COMP%] {\n      padding: 1px;\n      margin: 0px;\n      float: right;\n      width: 80% !important;\n    }\n  \n    tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover {\n      background-color: #f3f5f4;\n      cursor: pointer;\n    }\n  \n    tr[_ngcontent-%COMP%] {\n      font-size: 11px;\n    }\n  \n    .selected-row[_ngcontent-%COMP%] {\n      background-color: #ced6d3 !important;\n    }\n  \n    .table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%] {\n      line-height: 18px !important;\n      padding: 5px 10px;\n      vertical-align: middle;\n    }\n  \n    .table[_ngcontent-%COMP%] > thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%] {\n      line-height: 5px !important;\n    }\n  \n    .table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child {\n      text-align: left !important;\n      padding: 0px 0px 0px 11px !important;\n    }\n  \n    .modal-content[_ngcontent-%COMP%] {\n      box-shadow: -10px 0px 10px 1px #aaaaaa;\n    }\n  \n    .modal-content-main-area[_ngcontent-%COMP%] {\n      max-height: 100%;\n      height: 100%;\n      overflow: auto;\n      overflow-x: hidden;\n    }\n  \n    .modal-content-summary-area[_ngcontent-%COMP%] {\n      max-height: 20%;\n      height: 20%;\n      overflow: auto;\n      overflow-x: hidden;\n    }\n  \n    .ellipsis[_ngcontent-%COMP%] {\n      \n      white-space: nowrap;\n    }"]}),(0,t.gn)([function w(c){return function(_,l,v){const T=v.value,A=`__timeout__${l}`;return v.value=function(...K){clearTimeout(this[A]),this[A]=setTimeout(()=>T.apply(this,K),c)},v}}(10)],$.prototype,"updown",null);class N{constructor(){this.columns=[],this.defaultFilterIndex=0,this.showActionButton=!1,this.actionKeys=[]}}},88762:(z,Z,M)=>{M.d(Z,{B:()=>F});var t=M(66274),e=M(42326),s=M(67311),h=M(53074),V=M(87584),p=M(7587);let F=(()=>{class Q{constructor(I,m,S){this.alertService=I,this.masterService=m,this._trnMainService=S,this.emitCloseBatch=new t.vpe,this.emitCreatedBatch=new t.vpe,this.batchName="",this.pLifeUnit="year",this.disableDate=!1,this.focusOut=!0,this.todayDate=(new Date).toISOString().split("T")[0]}ngOnInit(){}ngOnChanges(){this.disableDate=0==this._trnMainService.TrnMainObj.ProdList[this.activeIndex].REQEXPDATE}calculateExpDate(){if(this.pLifeValue<1&&(this.pLifeValue=1),this.mfgDate&&this.pLifeValue&&this.pLifeUnit){var I=new Date(this.mfgDate);new Date,"year"===this.pLifeUnit?I.setFullYear(I.getFullYear()+parseInt(this.pLifeValue)):"month"===this.pLifeUnit&&I.setMonth(I.getMonth()+parseInt(this.pLifeValue)),this.expDate=I.toISOString().split("T")[0]}}onResetClick(){this.batchName="",this.mfgDate="",this.pLifeValue=null,this.pLifeUnit="",this.expDate=""}onApplyClick(){if(!this.focusOut)return void(this.focusOut=!0);if(!this._trnMainService.TrnMainObj.ProdList.find(g=>g.BATCH==this.batchName)&&this.batchName&&this._trnMainService.TrnMainObj.ProdList.find(g=>g.BATCH?.toLowerCase()==this.batchName.toLowerCase()))return void this.alertService.info(`Batch${this.batchName} is already present in grid`);if(!this.batchName)return void this.alertService.warning("Batch Name cannot be Empty!!");if(!this.mfgDate&&!this.disableDate)return void this.alertService.warning("Manufactured Date cannot be Empty!!");if(!this.expDate&&!this.disableDate)return void this.alertService.warning("Expiry Date cannot be Empty!!");if(this.mfgDate&&this.expDate&&this.mfgDate==this.expDate)return void this.alertService.warning("Manufactured and Expiry date cannot be the same!!");let I={batchName:this.batchName,mfgDate:this.mfgDate,expDate:this.expDate};const m=this._trnMainService.TrnMainObj.ProdList[this.activeIndex],S=m?.MCODE;if(m&&S){const g=this._trnMainService.TrnMainObj.ProdList.some(R=>R!==m&&R.MCODE==S&&R.BATCH==this.batchName&&1==R.showPriceChangePopup);this._trnMainService.TrnMainObj.ProdList[this.activeIndex].showPriceChangePopup=!g}this._trnMainService.TrnMainObj.VoucherType==e.Km.OpeningStockBalance&&(this._trnMainService.TrnMainObj.ProdList[this.activeIndex].enableSalesPrice=!0),this.emitCreatedBatch.emit(I),this.emitCloseBatch.emit()}onBackClick(){this.emitCloseBatch.emit()}onEnteredBatch(){this.focusOut=!0,this.batchName&&this.masterService.http.get(`${this.masterService.apiUrl}/CheckEnteredBatch?mcode=${this._trnMainService.TrnMainObj.ProdList[this.activeIndex].MCODE}&batch=${this.batchName}`).subscribe(m=>{"ok"==m.status&&m.result&&m.result?.length>0&&(this.alertService.info("Batch has already been created!!"),this.batchName=null,this.focusOut=!1)})}}return Q.\u0275fac=function(I){return new(I||Q)(t.Y36(s.c),t.Y36(h.P),t.Y36(V.p))},Q.\u0275cmp=t.Xpm({type:Q,selectors:[["create-manual-batch-popup"]],inputs:{activeIndex:"activeIndex"},outputs:{emitCloseBatch:"closeBatchPopupEvent",emitCreatedBatch:"emitCreatedBatchEvent"},features:[t.TTD],decls:39,vars:11,consts:[[1,"backdrop"],["id","popup",1,"popup"],[1,"popup-content"],[1,"section1"],[1,"section2"],["type","text","name","batchname",3,"ngModel","ngModelChange","focusout"],["type","date","name","mfgdate",3,"ngModel","max","disabled","ngModelChange","change"],["type","number","name","plife",2,"width","30px","margin-right","1px",3,"ngModel","disabled","ngModelChange","change"],["name","plifeunit",2,"width","40px",3,"ngModel","disabled","ngModelChange","change"],["value","year"],["value","month"],["type","date","name","expdate",3,"ngModel","min","disabled","ngModelChange"],[1,"section3"],["id","applyBtn",1,"button",3,"click"],["id","resetBtn",1,"button",3,"click"],["id","backBtn",1,"button",3,"click"]],template:function(I,m){1&I&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4,"Create Batch[NEW]"),t.qZA(),t.TgZ(5,"div",4)(6,"table")(7,"thead")(8,"tr")(9,"th"),t._uU(10,"Batch Name"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"MFG Date"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Product Life"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Exp Date"),t.qZA()()(),t.TgZ(17,"tbody")(18,"tr")(19,"td")(20,"input",5),t.NdJ("ngModelChange",function(g){return m.batchName=g})("focusout",function(){return m.onEnteredBatch()}),t.qZA()(),t.TgZ(21,"td")(22,"input",6),t.NdJ("ngModelChange",function(g){return m.mfgDate=g})("change",function(){return m.calculateExpDate()}),t.qZA()(),t.TgZ(23,"td")(24,"input",7),t.NdJ("ngModelChange",function(g){return m.pLifeValue=g})("change",function(){return m.calculateExpDate()}),t.qZA(),t.TgZ(25,"select",8),t.NdJ("ngModelChange",function(g){return m.pLifeUnit=g})("change",function(){return m.calculateExpDate()}),t.TgZ(26,"option",9),t._uU(27,"Y"),t.qZA(),t.TgZ(28,"option",10),t._uU(29,"M"),t.qZA()()(),t.TgZ(30,"td")(31,"input",11),t.NdJ("ngModelChange",function(g){return m.expDate=g}),t.qZA()()()()()(),t.TgZ(32,"div",12)(33,"button",13),t.NdJ("click",function(){return m.onApplyClick()}),t._uU(34,"APPLY"),t.qZA(),t.TgZ(35,"button",14),t.NdJ("click",function(){return m.onResetClick()}),t._uU(36,"RESET"),t.qZA(),t.TgZ(37,"button",15),t.NdJ("click",function(){return m.onBackClick()}),t._uU(38,"BACK"),t.qZA()()()()()),2&I&&(t.xp6(20),t.Q6J("ngModel",m.batchName),t.xp6(2),t.Q6J("ngModel",m.mfgDate)("max",m.todayDate)("disabled",m.disableDate),t.xp6(2),t.Q6J("ngModel",m.pLifeValue)("disabled",!m.mfgDate||m.disableDate),t.xp6(1),t.Q6J("ngModel",m.pLifeUnit)("disabled",!m.mfgDate||m.disableDate),t.xp6(6),t.Q6J("ngModel",m.expDate)("min",m.todayDate)("disabled",!m.mfgDate||m.disableDate))},dependencies:[p.YN,p.Kr,p.Fj,p.wV,p.EJ,p.JJ,p.On],styles:[".backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#3d3c3c80;z-index:9999}.popup[_ngcontent-%COMP%]{position:fixed;top:50%;right:50%;transform:translate(50%,-50%);background-color:#fff;border:1px solid #ccc;box-shadow:0 0 10px #0000001a;z-index:99999}.section1[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:10px}.section2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-collapse:collapse;background-color:#e5e7e8;margin:10px}.section2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .section2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center}.section3[_ngcontent-%COMP%]{margin:20px;text-align:center}.button[_ngcontent-%COMP%]{margin:0 5px;padding:5px 15px;cursor:pointer;border:none;background-color:#007bff;color:#fff}"]}),Q})()},87454:(z,Z,M)=>{M.d(Z,{t:()=>y});var t=M(66274),e=M(42326),s=M(67311),h=M(87584),V=M(67297),p=M(92752),F=M(7587),Q=M(89952);function L(P,x){if(1&P&&(t.ynx(0),t.TgZ(1,"th",19),t._uU(2),t.qZA(),t.BQk()),2&P){const O=x.$implicit;t.xp6(2),t.Oqu(O)}}function I(P,x){if(1&P&&(t.TgZ(0,"option",26),t._uU(1),t.qZA()),2&P){const O=x.$implicit;t.Q6J("ngValue",O),t.xp6(1),t.hij(" ",O.NAME,"")}}function m(P,x){if(1&P){const O=t.EpF();t.TgZ(0,"select",24),t.NdJ("click",function(){t.CHM(O);const D=t.oxw(2).index,U=t.oxw(3);return t.KtG(U.SELECTEDINDEX=D)})("ngModelChange",function(D){t.CHM(O);const U=t.oxw().$implicit,W=t.oxw().$implicit;return t.KtG(W[U]=D)})("change",function(){t.CHM(O);const D=t.oxw().$implicit,U=t.oxw().index,W=t.oxw(3);return t.KtG(W.onAttributeChange(D,U))}),t.YNc(1,I,2,2,"option",25),t.qZA()}if(2&P){const O=t.oxw().$implicit,j=t.oxw(),D=j.index,U=j.$implicit,W=t.oxw(3);t.hYB("name","",O,"",D,"")("id","",O,"",D,""),t.Q6J("ngModel",U[O]),t.xp6(1),t.Q6J("ngForOf",W.getvariantValues(O))}}function S(P,x){if(1&P){const O=t.EpF();t.TgZ(0,"input",27),t.NdJ("keydown.Enter",function(){t.CHM(O);const D=t.oxw().$implicit,U=t.oxw().index,W=t.oxw(3);return t.KtG(W.onAttributeChange(D,U))})("change",function(){t.CHM(O);const D=t.oxw().$implicit,U=t.oxw().index,W=t.oxw(3);return t.KtG(W.onAttributeChange(D,U))})("click",function(){t.CHM(O);const D=t.oxw(2).index,U=t.oxw(3);return t.KtG(U.SELECTEDINDEX=D)})("ngModelChange",function(D){t.CHM(O);const U=t.oxw().$implicit,W=t.oxw().$implicit;return t.KtG(W[U]=D)})("keyup",function(){t.CHM(O);const D=t.oxw(5);return t.KtG(D.applyPipe=!1)})("focusout",function(){t.CHM(O);const D=t.oxw(5);return t.KtG(D.focusOut())})("keydown.Shift.delete",function(){t.CHM(O);const D=t.oxw(5);return t.KtG(D.deleteRow())}),t.ALo(1,"twoDigitNumber"),t.qZA()}if(2&P){const O=t.oxw().$implicit,j=t.oxw(),D=j.index,U=j.$implicit,W=t.oxw(3);t.hYB("name","",O,"",D,"")("id","",O,"",D,""),t.Q6J("ngModel",W.applyPipe?t.lcZ(1,5,U[O]):U[O])}}function g(P,x){if(1&P){const O=t.EpF();t.TgZ(0,"input",28),t.NdJ("change",function(){t.CHM(O);const D=t.oxw(2),U=D.index,W=D.$implicit,$=t.oxw(3);return t.KtG($.validateBarcode(U,W))})("click",function(){t.CHM(O);const D=t.oxw(2).index,U=t.oxw(3);return t.KtG(U.SELECTEDINDEX=D)})("keydown.Enter",function(){t.CHM(O);const D=t.oxw(2),U=D.index,W=D.$implicit,$=t.oxw(3);return t.KtG($.addRows(U,W))})("ngModelChange",function(D){t.CHM(O);const U=t.oxw().$implicit,W=t.oxw().$implicit;return t.KtG(W[U]=D)})("keydown.Shift.delete",function(){t.CHM(O);const D=t.oxw(5);return t.KtG(D.deleteRow())}),t.qZA()}if(2&P){const O=t.oxw().$implicit,j=t.oxw(),D=j.index,U=j.$implicit;t.hYB("name","",O,"",D,"")("id","",O,"",D,""),t.Q6J("ngModel",U[O])}}function R(P,x){if(1&P&&(t.ynx(0),t.TgZ(1,"td",19),t.YNc(2,m,2,6,"select",21),t.YNc(3,S,2,7,"input",22),t.YNc(4,g,1,5,"input",23),t.qZA(),t.BQk()),2&P){const O=x.$implicit,j=t.oxw(4);t.xp6(2),t.Q6J("ngIf",j.selectInputType(O,"select")),t.xp6(1),t.Q6J("ngIf",j.selectInputType(O,"input")&&"BARCODE"!=O),t.xp6(1),t.Q6J("ngIf","BARCODE"==O)}}function u(P,x){if(1&P){const O=t.EpF();t.TgZ(0,"tr",20),t.NdJ("click",function(){const U=t.CHM(O).index,W=t.oxw(3);return t.KtG(W.SELECTEDINDEX=U)}),t.YNc(1,R,5,3,"ng-container",16),t.qZA()}if(2&P){const O=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",O.keys)}}function a(P,x){if(1&P&&(t.TgZ(0,"div",12)(1,"table",13,14)(3,"thead")(4,"tr",15),t.YNc(5,L,3,1,"ng-container",16),t.qZA()(),t.TgZ(6,"tbody",17),t.YNc(7,u,2,1,"tr",18),t.qZA()()()),2&P){const O=t.oxw(2);t.xp6(5),t.Q6J("ngForOf",O.headerKeys),t.xp6(2),t.Q6J("ngForOf",O.matrixItemRows)}}function E(P,x){if(1&P){const O=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"button",4),t.NdJ("click",function(){t.CHM(O);const D=t.oxw();return t.KtG(D.hide())}),t.TgZ(4,"span",5),t._uU(5,"\xd7"),t.qZA()(),t.TgZ(6,"h4",6),t._uU(7),t.qZA()(),t.YNc(8,a,8,2,"div",7),t.TgZ(9,"div",8)(10,"div")(11,"input",9),t.NdJ("ngModelChange",function(D){t.CHM(O);const U=t.oxw();return t.KtG(U.loadRate=D)})("change",function(D){t.CHM(O);const U=t.oxw();return t.KtG(U.onAutoFillRateClick(D))}),t.qZA(),t.TgZ(12,"span")(13,"b"),t._uU(14,"Load Old Rate"),t.qZA()()(),t.TgZ(15,"div")(16,"button",10),t.NdJ("click",function(){t.CHM(O);const D=t.oxw();return t.KtG(D.okClicked())}),t._uU(17,"Apply"),t.qZA(),t.TgZ(18,"button",11),t.NdJ("click",function(){t.CHM(O);const D=t.oxw();return t.KtG(D.hide())}),t._uU(19,"Cancel"),t.qZA()()()()()}if(2&P){const O=t.oxw();t.ekj("modal-sticky-hide",!O.isActive),t.xp6(7),t.hij(" ",O.itemname," "),t.xp6(1),t.Q6J("ngIf",O.matrixItemAtrribute&&O.matrixItemAtrribute.length),t.xp6(3),t.Q6J("ngModel",O.loadRate)}}let y=(()=>{class P{constructor(O,j,D){this.alertService=O,this._trnMainService=j,this.authservice=D,this.itemname="",this.productObj={},this.isActive=!1,this.keys=[],this.headerKeys=[],this.matrixItemRows=[],this.SELECTEDINDEX=0,this.applyPipe=!0,this.validation=!0,this.loadRate=!0,this.onApplyClicked=new t.vpe,this.addRows=(U,W)=>{if(this.validateVariantsForEachRow(U,W)){var $={};this.keys.forEach(k=>$[k]=null),this.matrixItemRows.push($);var N=parseFloat(U)+1;this.SELECTEDINDEX=N,this.loadRate&&this.loadRateInitially(this.SELECTEDINDEX),setTimeout(()=>{this.onAttributeChange("NONE",N)},0)}},this.onAttributeChange=(U,W)=>{let $=this.keys.findIndex(b=>b==U),N=[];for(var k in N=$>-1?this.keys.slice($+1):this.keys,N)if("SRATE"==N[k]&&this.calulateSRATE(),"BARCODE"==N[k]&&this.calculateMRP(),this.validateSRATEandPRATE($),document.getElementById(N[k]+W))return void setTimeout(()=>{const b=document.getElementById(N[k]+W);b.focus(),b.select()},100)},this.getvariantValues=U=>{var W=this.matrixItemAtrribute.filter($=>$.VARIANTNAME==U);return W.length?W[0].VARIANT_ATTRIBUTE_LIST:[]},this.selectInputType=(U,W)=>{if("input"===W&&["QTY","PRATE","MRP","SRATE","BARCODE"].indexOf(U)>-1||"select"===W&&-1==["QTY","PRATE","MRP","SRATE","BARCODE"].indexOf(U))return!0},this.okClicked=()=>{this.matrixItemRows.forEach(U=>{null===U.PRATE&&(U.PRATE=0)}),this.removeInvalidRows(),this.validateVariants()&&(this.onApplyClicked.emit(this.matrixItemRows),console.log("ans",this.matrixItemRows),this.hide())},this.show=()=>{console.log("show"),this.isActive=!0,setTimeout(()=>{this.onAttributeChange("NONE",0)},0)},this.hide=()=>{this.matrixItemRows.filter(W=>null!=W.QTY&&""!=W.QTY),this.isActive=!1,this.matrixItemAtrribute=[],this.keys=[],this.matrixItemRows=[]},this.userSetting=D.getSetting()}ngOnChanges(O){this.matrixItemAtrribute=O.matrixItemAtrribute?.currentValue,this.keys=[],this.headerKeys=[],this.matrixItemAtrribute?.forEach(D=>{D.VARIANT_ATTRIBUTE_LIST=JSON.parse(D.VARIANT_ATTRIBUTE),this.keys.push(D.VARIANTNAME),this.headerKeys.push(D.VARIANTNAME)}),this.keys.push("QTY"),this.keys.push("PRATE"),this.keys.push("MRP"),this.keys.push("SRATE"),this.keys.push("BARCODE"),this.headerKeys.push("QTY"),this.headerKeys.push("PRATE"),this.headerKeys.push("SRATE(W/V)"),this.headerKeys.push("SRATE"),this.headerKeys.push("BARCODE"),this.matrixItemRows=[];var j={};this.keys.forEach(D=>j[D]=null),this.matrixItemRows.push(j),console.log("matric item rows",this.matrixItemRows,"matric item rows Obj",j),this.loadRate&&this.loadRateInitially(this.SELECTEDINDEX)}loadRateInitially(O){this.matrixItemRows[O].PRATE=this._trnMainService.TrnMainObj.ProdList[this.activerowIndex]?.PRATE,this.matrixItemRows[O].MRP=this._trnMainService.TrnMainObj.ProdList[this.activerowIndex]?.MRP,this.calulateSRATE()}calulateSRATE(){this.matrixItemRows[this.SELECTEDINDEX].SRATE=1==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex]?.ISVAT?this.matrixItemRows[this.SELECTEDINDEX].MRP/this.userSetting.VatConRate:this.matrixItemRows[this.SELECTEDINDEX].MRP}calculateMRP(){this.matrixItemRows[this.SELECTEDINDEX].MRP=1==this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].ISVAT?this.matrixItemRows[this.SELECTEDINDEX].SRATE*this.userSetting.VatConRate:this.matrixItemRows[this.SELECTEDINDEX].SRATE}removeInvalidRows(){this.matrixItemRows=this.matrixItemRows.filter(O=>null!=O.PRATE&&null!=O.QTY&&null!=O.SRATE&&null!=O.MRP),console.log("filtered",this.matrixItemRows)}validateVariants(){for(var O of this.matrixItemRows)if(0==O.QTY||null==O.QTY)return this.alertService.warning("Please enter quantity"),!1;let j=0;for(var D of(console.log("matrix",this.matrixItemRows),this.matrixItemRows))for(var U in D)-1==["QTY","PRATE","MRP","SRATE","BARCODE"].indexOf(U)&&(console.log("hmmm",U,D[U]),null==D[U]&&j++);return j>0?(this.alertService.warning("Please enter for all the variant attirbutes"),!1):!!this.validation||(this.validation=!0,!1)}validateVariantsForEachRow(O,j){if(null==this.matrixItemRows[O].QTY||0==this.matrixItemRows[O].QTY)return this.alertService.warning("Please enter quantity first!"),!1;let D=this.matrixItemRows[O],U=0;for(var W in D)-1==["QTY","PRATE","MRP","SRATE","BARCODE"].indexOf(W)&&null==D[W]&&U++;if(U>0)return this.alertService.warning("Please enter for all the variant attributes"),!1;if((this._trnMainService.TrnMainObj.VoucherType===e.Km.OpeningStockBalance||this._trnMainService.TrnMainObj.VoucherType===e.Km.Purchase)&&1===this.userSetting.EnableBatchWisePrice){if(null==this.matrixItemRows[O].MRP||0==this.matrixItemRows[O].MRP)return this.alertService.warning("Please enter the MRP!!!"),!1;if(null==this.matrixItemRows[O].SRATE||0==this.matrixItemRows[O].SRATE)return this.alertService.warning("Please enter the Selling Rate!!!"),!1;if(this.dublicateBarcode(O,j))return!1}return!0}dublicateBarcode(O,j){for(let D=0;D<O;D++)return!(!j.BARCODE||this.matrixItemRows[D].BARCODE!=j.BARCODE||(this.alertService.info("Duplicate barcode detected! Please enter unique barcode."),j.BARCODE="",this.validation=!1,0))}deleteRow(){confirm("Are you sure u you want to delete the Row?")&&this.matrixItemRows.splice(this.SELECTEDINDEX,1)}focusOut(){this.applyPipe=!0}validateBarcode(O,j){if(j?.BARCODE?.length>13)return this.alertService.warning("Barcode cannot have more than 13 characters!"),j.BARCODE="",void(this.validation=!1);this.dublicateBarcode(O,j)}onAutoFillRateClick(O){this.loadRate=this.loadRate=!!O.target.checked}assignPRATEandMRP(O){"PRATE"==this.keys[O]&&(null==this.matrixItemRows[this.SELECTEDINDEX].PRATE||0==this.matrixItemRows[this.SELECTEDINDEX].PRATE)&&(this.matrixItemRows[this.SELECTEDINDEX].PRATE=this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].PRATE),"MRP"==this.keys[O]&&(null==this.matrixItemRows[this.SELECTEDINDEX].MRP||0==this.matrixItemRows[this.SELECTEDINDEX].MRP)&&(this.matrixItemRows[this.SELECTEDINDEX].MRP=this._trnMainService.TrnMainObj.ProdList[this.activerowIndex].MRP)}validateSRATEandPRATE(O){("MRP"==this.keys[O]||"SRATE"==this.keys[O])&&this.matrixItemRows[this.SELECTEDINDEX].PRATE>this.matrixItemRows[this.SELECTEDINDEX].SRATE&&this.alertService.warning("Sales Rates should not be less than Purchase Rate!")}select(O,j){this.keys.findIndex(U=>U==j),setTimeout(()=>{O.target.select()},10)}}return P.\u0275fac=function(O){return new(O||P)(t.Y36(s.c),t.Y36(h.p),t.Y36(V.e))},P.\u0275cmp=t.Xpm({type:P,selectors:[["matrix-item-grid"]],inputs:{itemname:"itemname",matrixItemAtrribute:"matrixItemAtrribute",productObj:"productObj",activerowIndex:"activerowIndex"},outputs:{onApplyClicked:"onApplyClicked"},features:[t.TTD],decls:1,vars:1,consts:[["class","modal-sticky","style","display : block; padding: 0px;  margin-bottom: 25px;",3,"modal-sticky-hide",4,"ngIf"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","25px"],[1,"modal-content","modal-content-main-area"],[1,"modal-header",2,"padding","0px","background","#ecad79"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-title",2,"text-align","center"],["class","modal-body","style","max-height: 63vh;overflow-y: auto;",4,"ngIf"],[1,"modal-footer"],["type","checkbox",3,"ngModel","ngModelChange","change"],[1,"btn","btn-info","pull-right",3,"click"],[1,"btn","btn-info","pull-right",2,"margin-right","5px",3,"click"],[1,"modal-body",2,"max-height","63vh","overflow-y","auto"],["id","BlueHeaderResizableTable",1,"matrix-table",2,"font-size","12px","width","98%","overflow-x","auto"],["reportHtmlTable",""],[2,"border-bottom","2px solid #e6e6e6","border-top","2px solid #e6e6e6","height","30px","background","silver","color","black"],[4,"ngFor","ngForOf"],[2,"width","fit-content"],["style","border: 1px solid #e6e6e6; max-height: 25px",3,"click",4,"ngFor","ngForOf"],["width","100px"],[2,"border","1px solid #e6e6e6","max-height","25px",3,"click"],[3,"name","id","ngModel","click","ngModelChange","change",4,"ngIf"],["type","number",3,"name","id","ngModel","keydown.Enter","change","click","ngModelChange","keyup","focusout","keydown.Shift.delete",4,"ngIf"],["type","text",3,"name","id","ngModel","change","click","keydown.Enter","ngModelChange","keydown.Shift.delete",4,"ngIf"],[3,"name","id","ngModel","click","ngModelChange","change"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],["type","number",3,"name","id","ngModel","keydown.Enter","change","click","ngModelChange","keyup","focusout","keydown.Shift.delete"],["type","text",3,"name","id","ngModel","change","click","keydown.Enter","ngModelChange","keydown.Shift.delete"]],template:function(O,j){1&O&&t.YNc(0,E,20,5,"div",0),2&O&&t.Q6J("ngIf",j.isActive)},dependencies:[p.sg,p.O5,F.YN,F.Kr,F.Fj,F.wV,F.Wl,F.EJ,F.JJ,F.On,Q.g],styles:[".modal-content[_ngcontent-%COMP%]{padding:1px;margin:0;float:right}.modal-content-main-area[_ngcontent-%COMP%]{height:75vh!important}.modal-sticky[_ngcontent-%COMP%]{width:70vw im!important}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.modal-footer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:6px;font-size:14px}tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover{background-color:#f3f5f4;cursor:pointer}tr[_ngcontent-%COMP%]{font-size:11px}.selected-row[_ngcontent-%COMP%]{background-color:#ced6d3!important}.table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{line-height:30px!important}.table[_ngcontent-%COMP%] > thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{line-height:5px!important}.table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child{text-align:left!important;padding:0 0 0 11px!important}.modal-content[_ngcontent-%COMP%]{box-shadow:-10px 0 10px 1px #aaa}.modal-content-main-area[_ngcontent-%COMP%]{max-height:100%;height:100%;width:100%!important}.modal-content-summary-area[_ngcontent-%COMP%]{max-height:20%;height:20%;overflow:auto;overflow-x:hidden}.ellipsis[_ngcontent-%COMP%]{white-space:nowrap}.matrix-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#CED6D3;border:1px solid #dbd7d7}.matrix-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{height:30px;border:1px solid #dbd7d7}.matrix-table[_ngcontent-%COMP%]   .borderdiv[_ngcontent-%COMP%]{border:1px solid rgba(119,119,119,.15)}.matrix-table[_ngcontent-%COMP%]   .rowdiv[_ngcontent-%COMP%]{border:1px solid rgba(119,119,119,.15);text-align:center}.matrix-table[_ngcontent-%COMP%]   .smalllabeldiv[_ngcontent-%COMP%]{height:16px}.matrix-table[_ngcontent-%COMP%]   .smallHeader[_ngcontent-%COMP%]{font-size:11px;font-weight:700;margin:0}.matrix-table[_ngcontent-%COMP%]   .scrolldiv[_ngcontent-%COMP%]{max-height:75px;padding-right:30px;overflow:auto;scrollbar-3dlight-color:#FFFFFF;scrollbar-arrow-color:#000000;scrollbar-base-color:#FF9999;scrollbar-darkshadow-color:#000000;scrollbar-face-color:#000000;scrollbar-highlight-color:#000000;scrollbar-shadow-color:#0033CC}.matrix-table[_ngcontent-%COMP%]   .multiboxspan[_ngcontent-%COMP%]{font-size:11px;font-weight:700;position:relative;float:left;display:block;margin:2px;border:1px solid silver;border-radius:5px;background-color:#fff0f5}.matrix-table[_ngcontent-%COMP%]   .smallBoldLabel[_ngcontent-%COMP%]{font-size:11px;font-weight:700;margin:0;float:left;color:#222}.matrix-table[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{height:77vh}.matrix-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{display:flex;flex-flow:column;height:95%}.matrix-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .matrix-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]{flex:0 0 auto;width:calc(100% - .9em)}.matrix-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{flex:1 1 auto;display:block;overflow-y:scroll}.matrix-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{width:99.6%}.matrix-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .matrix-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%], .matrix-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;table-layout:fixed}.matrix-table[_ngcontent-%COMP%]   .reportTabel[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.matrix-table[_ngcontent-%COMP%]   .reportTabel[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#deb887!important;color:#fff}.matrix-table[_ngcontent-%COMP%]   .reportTabel[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#f2f2f2}.matrix-table[_ngcontent-%COMP%]   .reportTabel[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background-color:#fff}.matrix-table[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{font-size:11px;font-weight:700;color:#222;width:auto}.matrix-table[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]{margin-bottom:1%}.matrix-table[_ngcontent-%COMP%]   .modal-content-main-area[_ngcontent-%COMP%]{margin-top:10%}.matrix-table[_ngcontent-%COMP%]   .modal-content-main-area[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-weight:600;font-size:15px;padding:0 5px}.matrix-table[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-left:0!important;padding-right:0!important;padding-bottom:1px!important}.matrix-table[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .matrix-table[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%!important;height:35px!important;border:none!important}.matrix-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-left:0!important;padding-right:0!important;padding-bottom:1px!important}.matrix-table[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .matrix-table[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%!important;height:35px!important;border:none!important}.matrix-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{height:25px!important;padding:0 5px!important}.matrix-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{overflow:hidden}"]}),P})()},64752:(z,Z,M)=>{M.d(Z,{JP:()=>W,_v:()=>U});var t=M(64762),e=M(66274),s=M(68277),h=M(53074),V=M(87584),p=M(48083),F=M(67311),Q=M(92752),L=M(7587),I=M(72533);const m=["inputBox"];function S(k,b){if(1&k&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&k){const w=e.oxw().$implicit;e.xp6(1),e.Oqu(w.title)}}function g(k,b){if(1&k&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&k){const w=e.oxw().$implicit;e.xp6(1),e.Oqu(w.title)}}function R(k,b){if(1&k&&(e.ynx(0),e.YNc(1,S,2,1,"th",2),e.YNc(2,g,2,1,"th",2),e.BQk()),2&k){const w=b.$implicit;e.xp6(1),e.Q6J("ngIf",!w.hidden),e.xp6(1),e.Q6J("ngIf",!w.isInputRequired)}}function u(k,b){if(1&k&&(e.TgZ(0,"td")(1,"div",17),e._uU(2),e.qZA()()),2&k){const w=e.oxw().$implicit,c=e.oxw().$implicit;e.xp6(1),e.s9C("title",c[w.key]),e.xp6(1),e.hij(" ",c[w.key]," ")}}function a(k,b){if(1&k){const w=e.EpF();e.TgZ(0,"td")(1,"div",17)(2,"input",18,19),e.NdJ("keyup",function(_){e.CHM(w);const l=e.oxw(5);return e.KtG(l.onChangQuantity(_))})("ngModelChange",function(_){e.CHM(w);const l=e.oxw(2).$implicit;return e.KtG(l.qty=_)}),e.qZA()()()}if(2&k){const w=e.oxw().$implicit,c=e.oxw().$implicit;e.xp6(1),e.s9C("title",c[w.key]),e.xp6(1),e.Q6J("ngModel",c.qty)}}function E(k,b){if(1&k&&(e.ynx(0),e.YNc(1,u,3,2,"td",2),e.YNc(2,a,4,2,"td",2),e.BQk()),2&k){const w=b.$implicit;e.xp6(1),e.Q6J("ngIf",!w.hidden),e.xp6(1),e.Q6J("ngIf",!w.isInputRequired)}}function y(k,b){if(1&k){const w=e.EpF();e.TgZ(0,"tr",16),e.NdJ("dblclick",function(){const l=e.CHM(w).$implicit,v=e.oxw(3);return e.KtG(v.doubleClick(l))})("click",function(){const l=e.CHM(w).index,v=e.oxw(3);return e.KtG(v.singleClick(l))})("keydown.Enter",function(){const l=e.CHM(w).$implicit,v=e.oxw(3);return e.KtG(v.doubleClickEnter(l))}),e.YNc(1,E,3,2,"ng-container",11),e.qZA()}if(2&k){const w=b.index,c=e.oxw(3);e.ekj("selected-row",c.selectedRowIndex==w),e.xp6(1),e.Q6J("ngForOf",c.popupsettings.columns)}}const P=function(k,b,w,c){return{id:k,itemsPerPage:b,currentPage:w,totalItems:c}};function x(k,b){if(1&k&&(e.TgZ(0,"tbody"),e.YNc(1,y,2,3,"tr",15),e.ALo(2,"paginate"),e.qZA()),2&k){const w=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,w._trnMainService.mulitplePriceItemList,e.l5B(4,P,w.tabindex,w.pageSize,w.pageNumber,w.totalItems)))}}function O(k,b){if(1&k){const w=e.EpF();e.TgZ(0,"div",20)(1,"pagination-controls",21),e.NdJ("pageChange",function(_){e.CHM(w);const l=e.oxw(2);return e.KtG(l.onPageChange(_))}),e.qZA()()}if(2&k){const w=e.oxw(2);e.xp6(1),e.Q6J("id",w.tabindex)}}function j(k,b){if(1&k&&e._UZ(0,"div",22),2&k){const w=e.oxw(2);e.Q6J("innerHTML",w.summary,e.oJD)}}function D(k,b){if(1&k){const w=e.EpF();e.TgZ(0,"div")(1,"div")(2,"div",3)(3,"div",4),e._uU(4,"Price List"),e.qZA(),e.TgZ(5,"div",5)(6,"button",6),e.NdJ("click",function(){e.CHM(w);const _=e.oxw();return e.KtG(_.hide())}),e._uU(7,"CLOSE"),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(_){e.CHM(w);const l=e.oxw();return e.KtG(l.doubleClickEnter(_))}),e._uU(9,"SUBMIT"),e.qZA()()(),e._UZ(10,"div",8),e.TgZ(11,"div",9)(12,"table",10)(13,"thead")(14,"tr"),e.YNc(15,R,3,2,"ng-container",11),e.qZA()(),e.YNc(16,x,3,9,"tbody",2),e.qZA(),e.TgZ(17,"div",12),e.YNc(18,O,2,1,"div",13),e.qZA()()(),e.YNc(19,j,1,1,"div",14),e.qZA()}if(2&k){const w=e.oxw();e.xp6(15),e.Q6J("ngForOf",w.popupsettings.columns),e.xp6(1),e.Q6J("ngIf",w._trnMainService.mulitplePriceItemList.length),e.xp6(2),e.Q6J("ngIf",w._trnMainService.mulitplePriceItemList.length),e.xp6(1),e.Q6J("ngIf",w.summary)}}class U extends s.nd{constructor(b,w,c,_,l){super(b),this.injector=b,this.masterService=w,this._trnMainService=c,this.route=_,this.alertService=l,this.requestUrl="",this.isActive=!1,this.selectedRowIndex=0,this.tabindex="list",this.newItem="first",this.billTo="",this.isForCancelOrder=!1,this.onPopUpClose=new e.vpe,this.onItemDoubleClick=new e.vpe}show(b="",w=!1){1==this._trnMainService.customerEvent&&setTimeout(()=>{},500),this.summary=null,this.billTo=b,this.isForCancelOrder=w,this._trnMainService.mulitplePriceItemList=[],this.isActive=!0,this.selectedRowIndex=0,setTimeout(()=>{this.setFilterOption(),this.refreshPage(),this.refresh()},100)}changebatchModel(b){}setFilterOption(){if(this.popupsettings&&this.popupsettings.columns.length){let b=this.popupsettings.defaultFilterIndex?this.popupsettings.defaultFilterIndex:0;if(this.popupsettings.columns.length<=b)return;this.filterValue.setValue(this.popupsettings.useDefinefilterValue),this.filterOption=this.popupsettings.columns[b].key}}getData(){this.summary=null,this.selectedRowIndex=0;let w=`${this.apiUrl}${this.popupsettings.apiEndpoints}?currentPage=${this.pageNumber}&maxResultCount=${this.pageSize}`;return this.billTo&&""!=this.billTo&&null!=this.billTo&&null!=this.billTo&&(w+=`&billTo=${this.billTo}`),this.isForCancelOrder&&(w+=`&isForCancelOrder=${this.isForCancelOrder}`),this.requestUrl=this.getFilterOption(w,1==this._trnMainService.userSetting.ProductSearchMode?1:0),this._http.get(this.requestUrl).subscribe(c=>{this.totalItems=c?c.totalCount:0,this._trnMainService.mulitplePriceItemList=c?c.data:[],this._trnMainService.mulitplePriceItemList.forEach(function(_){null!=_.TRNDATE&&null!=_.TRNDATE&&(_.TRNDATE=_.TRNDATE.toString().substring(0,10)),null!=_.DATE&&null!=_.DATE&&(_.DATE=_.DATE.toString().substring(0,10))}),this._trnMainService.mulitplePriceItemList.length>0&&0==this.selectedRowIndex&&this._trnMainService.mulitplePriceItemList[this.selectedRowIndex].itemSummary&&(this.summary=this._trnMainService.mulitplePriceItemList[this.selectedRowIndex].itemSummary)})}hide(){this._trnMainService.mulitplePriceItemList=[],this.pageNumber=1,this.totalItems=0,this.isActive=!1}triggerQtyChange(){}triggerSearch(){null==this.filterOption||null==this.filterOption||""==this.filterOption||null==this.filterValue.value||null==this.filterValue.value||""==this.filterValue.value||(this.refreshPage(),this.refresh())}singleClick(b){this.selectedRowIndex=b,this.summary=this._trnMainService.mulitplePriceItemList[b].itemSummary}doubleClick(b){}onChangQuantity(b){null!=this._trnMainService.mulitplePriceItemList.filter(c=>this._trnMainService.nullToZeroConverter(c.qty)>this._trnMainService.nullToZeroConverter(c.stock))[0]&&this.alertService.info("Quantity Exceed the available stock")}doubleClickEnter(b){this.onItemDoubleClick.emit(b),this.hide()}updown(b){if(!this.isActive)return!0;if("ArrowDown"==b.code)b.preventDefault(),this.selectedRowIndex++,null!=this._trnMainService.mulitplePriceItemList[this.selectedRowIndex]&&(this.summary=this._trnMainService.mulitplePriceItemList[this.selectedRowIndex].itemSummary),this.calculateTotalPages(),this.selectedRowIndex==this._trnMainService.mulitplePriceItemList.length&&this.pageNumber<this.totalPages?(this.pageNumber=this.pageNumber+1,this.refresh(),this.selectedRowIndex=0,this.itemListClosed()):this.selectedRowIndex==this._trnMainService.mulitplePriceItemList.length&&this.pageNumber==this.totalPages&&(this.selectedRowIndex=this._trnMainService.mulitplePriceItemList.length-1);else if("ArrowUp"==b.code)b.preventDefault(),this.selectedRowIndex--,null!=this._trnMainService.mulitplePriceItemList[this.selectedRowIndex]&&(this.summary=this._trnMainService.mulitplePriceItemList[this.selectedRowIndex].itemSummary),-1==this.selectedRowIndex&&this.pageNumber>1?(this.pageNumber=this.pageNumber-1,this.refresh(),this.selectedRowIndex=this._trnMainService.mulitplePriceItemList.length-1,this.itemListClosed()):-1==this.selectedRowIndex&&1==this.pageNumber&&(this.selectedRowIndex=0);else if(("Enter"==b.code||"NumpadEnter"==b.code)&&this.selectedRowIndex>=0&&this.selectedRowIndex<this._trnMainService.mulitplePriceItemList.length)b.preventDefault(),"BARCODE"==this.filterOption||(this.onItemDoubleClick.emit(this._trnMainService.mulitplePriceItemList[this.selectedRowIndex]),this.hide(),this.itemListClosed());else if("Escape"==b.code&&"addsientry"!=this.route.snapshot.url[0].path)b.preventDefault(),this.hide(),this.itemListClosed();else if("ArrowRight"==b.code){if(b.preventDefault(),this.calculateTotalPages(),this.pageNumber>=this.totalPages)return void(this.pageNumber=this.totalPages);this.selectedRowIndex=0,this.pageNumber=this.pageNumber+1,this.refresh()}else if("ArrowLeft"==b.code){if(b.preventDefault(),this.pageNumber<=1)return void(this.pageNumber=1);this.selectedRowIndex=0,this.pageNumber=this.pageNumber-1,this.refresh()}}itemListClosed(){this.onPopUpClose.emit()}ngOnChanges(b){this.popupsettings=b.popupsettings.currentValue}}U.\u0275fac=function(b){return new(b||U)(e.Y36(e.zs3),e.Y36(h.P),e.Y36(V.p),e.Y36(p.gz),e.Y36(F.c))},U.\u0275cmp=e.Xpm({type:U,selectors:[["multiple-price-popup-grid"]],viewQuery:function(b,w){if(1&b&&e.Gf(m,5),2&b){let c;e.iGM(c=e.CRH())&&(w.inputBox=c.first)}},hostBindings:function(b,w){1&b&&e.NdJ("keydown",function(_){return w.updown(_)},!1,e.evT)},inputs:{popupsettings:"popupsettings",summary:"summary"},outputs:{onPopUpClose:"onPopUpClose",onItemDoubleClick:"onItemDoubleClick"},features:[e.qOj,e.TTD],decls:3,vars:3,consts:[[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","20px"],[1,"modal-content","modal-content-main-area"],[4,"ngIf"],[1,"modal-header",2,"padding","0px"],[1,"title","h5",2,"margin-bottom","0","margin-left","8px"],[1,"header-button"],["type","button",1,"btn","btn-info","btn-sm",2,"margin-right","5px",3,"click"],["type","button",1,"btn","btn-info","btn-sm",3,"click"],[1,"row","clearfix"],[1,"col-md-12","table-scroll"],[1,"table"],[4,"ngFor","ngForOf"],[1,"row","clearfix",2,"float","center","margin","4px 0px"],["class","col-md-12","style","width:100%",4,"ngIf"],["style","margin-left: 25px ",3,"innerHTML",4,"ngIf"],["class","highlight","title","double click for detail view",3,"selected-row","dblclick","click","keydown.Enter",4,"ngFor","ngForOf"],["title","double click for detail view",1,"highlight",3,"dblclick","click","keydown.Enter"],[3,"title"],["type","number",2,"width","45%",3,"ngModel","keyup","ngModelChange"],["inputBox",""],[1,"col-md-12",2,"width","100%"],["maxSize","9","directionLinks","true","autoHide","true","responsive","true","previousLabel","Previous","nextLabel","Next","screenReaderPaginationLabel","Pagination","screenReaderPageLabel","page","screenReaderCurrentLabel","You're on page",3,"id","pageChange"],[2,"margin-left","25px",3,"innerHTML"]],template:function(b,w){1&b&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,D,20,4,"div",2),e.qZA()()),2&b&&(e.ekj("modal-sticky-hide",!w.isActive),e.xp6(2),e.Q6J("ngIf",w.popupsettings))},dependencies:[Q.sg,Q.O5,L.Fj,L.wV,L.JJ,L.On,I.LS,I._s],styles:[".modal-content[_ngcontent-%COMP%] {\n    padding: 1px;\n    margin: 0px;\n    top: 47%;\n    transform: translate(-50%, -50%);\n    width: 70% !important;\n  }\n\n  .modal-header[_ngcontent-%COMP%] {\n    margin-top: 10px;\n  }\n\n  tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover {\n    \n    cursor: pointer;\n  }\n\n  tr[_ngcontent-%COMP%] {\n    font-size: 11px;\n    border-bottom: 2px solid #E6E6E6;\n    border-top: 2px solid #E6E6E6;\n    \n    color: black;\n  }\n\n  .selected-row[_ngcontent-%COMP%] {\n    background-color: #ced6d3 !important;\n  }\n\n  .table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%] {\n    line-height: 30px !important;\n    border: 1px solid #e6e6e6;\n  }\n\n  .table[_ngcontent-%COMP%] > thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%] {\n    line-height: 5px !important;\n  }\n\n  .table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child {\n    text-align: left !important;\n    padding: 0px 0px 0px 11px !important;\n  }\n\n  .modal-content[_ngcontent-%COMP%] {\n    box-shadow: -10px 0px 10px 1px #aaaaaa;\n  }\n\n  .modal-content-main-area[_ngcontent-%COMP%] {\n    max-height: 100%;\n    height: 94%;\n    overflow: auto;\n    overflow-x: hidden;\n  }\n\n  .modal-content-summary-area[_ngcontent-%COMP%] {\n    max-height: 20%;\n    height: 20%;\n    overflow: auto;\n    overflow-x: hidden;\n  }\n\n  .ellipsis[_ngcontent-%COMP%] {\n    \n    white-space: nowrap;\n  }\n\n  .header-button[_ngcontent-%COMP%] {\n    margin-bottom: 10px;\n    margin-right: 10px;\n  }"]}),(0,t.gn)([function N(k){return function(b,w,c){const _=c.value,l=`__timeout__${w}`;return c.value=function(...v){clearTimeout(this[l]),this[l]=setTimeout(()=>_.apply(this,v),k)},c}}(10)],U.prototype,"updown",null);class W{constructor(){this.columns=[],this.defaultFilterIndex=0}}},15613:(z,Z,M)=>{M.d(Z,{P:()=>s});var t=M(66274),e=M(42326);const s=new t.OlP("SalesRate-disabled-voucherNumbers",{providedIn:"root",factory:()=>[e.Km.SalesOrder,e.Km.TaxInvoice,e.Km.Sales,e.Km.CreditNote,e.Km.Quotation,e.Km.PerformaSalesInvoice,e.Km.DeliveryChalan]})}}]);