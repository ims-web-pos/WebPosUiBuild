"use strict";(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[3388],{35732:(se,te,h)=>{h(52794)},86351:(se,te,h)=>{h(24208)},16137:(se,te,h)=>{h(14812)},23388:(se,te,h)=>{h.r(te),h.d(te,{PurchasesModule:()=>Ci});var B=h(46543),y=h(87584),N=h(48083),e=h(66274);let Se=(()=>{class a{constructor(){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["purchases"]],decls:1,vars:0,template:function(t,i){1&t&&e._UZ(0,"router-outlet")},dependencies:[N.lC],encapsulation:2}),a})();var I=h(40216),E=h(28698),Y=h(60716),b=h(42326),D=h(11192),p=h(68328),R=h(94534),Z=h(91772),K=h(48063),j=h(53074),ee=h(53181),G=h(67311),F=h(14970),H=h(67297),J=h(3937),W=h(68527),X=h(58349),q=h(78159),$=h(3047),m=h(92752),ie=h(54471),Te=h(75810),me=h(92340),he=h(76165);let ue=(()=>{class a{constructor(t){this.http=t,this.apiUrl=me.N.apiUrl}getAccountWiseBudgetLimit(t,i){return this.http.get(`${this.apiUrl}/getBudgetValidation?acid=${t}&invoiceDate=${i}`)}checkBalanceAmountForPartialDN(t){return this.http.get(`${this.apiUrl}/checkBalanceAmountForPartialDN?vchrno=${t}`)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(he.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac}),a})();var ce=h(74263),f=h(7587),pe=h(64657),ne=h(89952),Me=h(63213);const Pe=["genericGridAccount"],be=["genericGridSubLedgerAccount"];function Ae(a,c){1&a&&(e.TgZ(0,"th"),e._uU(1,"Sub-Ledger"),e.qZA())}function fe(a,c){1&a&&(e.TgZ(0,"th",13),e._uU(1,"Cost-Center"),e.qZA())}function Ce(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"td",42)(1,"input",43),e.NdJ("ngModelChange",function(n){e.CHM(t);const r=e.oxw().$implicit;return e.KtG(r.SL_ACNAME=n)})("keydown.enter",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.SubledgerAccountEnter(n))})("keyup",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.SubledgerAccountEnter(n))})("keypress",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.keyPress(n))}),e.ALo(2,"disableField"),e.qZA()()}if(2&a){const t=e.oxw(),i=t.index,n=t.$implicit,r=e.oxw();e.xp6(1),e.MGl("id","subledger",i,""),e.Q6J("disabled",0==r._trnMainService.TrnMainObj.AdditionProdList[i].HASSUBLEDGER||e.lcZ(2,3,"disableGridInMixedPurchase"))("ngModel",n.SL_ACNAME)}}function Ee(a,c){if(1&a&&(e.TgZ(0,"option",46),e._uU(1),e.qZA()),2&a){const t=c.$implicit;e.Q6J("ngValue",t.value),e.xp6(1),e.Oqu(t.COSTCENTERNAME)}}function xe(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"td",32)(1,"select",44),e.NdJ("keydown.enter",function(n){e.CHM(t);const r=e.oxw().index,o=e.oxw();return e.KtG(o.enterOnCostCenter(n,r))})("ngModelChange",function(n){e.CHM(t);const r=e.oxw().$implicit;return e.KtG(r.COSTCENTER=n)}),e.ALo(2,"disableField"),e.YNc(3,Ee,2,2,"option",45),e.qZA()()}if(2&a){const t=e.oxw(),i=t.index,n=t.$implicit,r=e.oxw();e.xp6(1),e.MGl("id","costCenter",i,""),e.Q6J("ngModel",n.COSTCENTER)("disabled",e.lcZ(2,4,"disableGridInMixedPurchase")),e.xp6(2),e.Q6J("ngForOf",r.costLists)}}function ye(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"tbody",14)(1,"tr",15),e.NdJ("click",function(){const r=e.CHM(t).index,o=e.oxw();return e.KtG(o.RowClick(r))})("keydown.Shift.delete",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteRow())}),e.TgZ(2,"td",16),e._uU(3),e.qZA(),e.TgZ(4,"td",17)(5,"input",18),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.ITEMDESC=n)})("keydown.enter",function(){const r=e.CHM(t).index,o=e.oxw();return e.KtG(o.focustoAccount(r))})("focusout",function(){const r=e.CHM(t).index,o=e.oxw();return e.KtG(o.focusOutOnDesc(r))}),e.ALo(6,"disableField"),e.qZA()(),e.TgZ(7,"td",19)(8,"input",20),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.MANUFACTURER=n)})("keydown.enter",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.AccountEnterCommand(n))})("keyup",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.AccountEnterCommand(n))})("keypress",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.keyPress(n))}),e.qZA()(),e.YNc(9,Ce,3,5,"td",21),e.YNc(10,xe,4,6,"td",22),e.TgZ(11,"td",23)(12,"select",24),e.NdJ("keydown.enter",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.EnterClickOnType(n,o))})("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.ITEMTYPE=n)}),e.ALo(13,"disableField"),e.TgZ(14,"option",25),e._uU(15,"Capitalize"),e.qZA(),e.TgZ(16,"option",26),e._uU(17,"Non-Capitalize"),e.qZA()()(),e.TgZ(18,"td",23)(19,"input",27),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.ALTUNIT=n)})("keydown.enter",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.EnterClickOnUnit(n,o))})("keydown.Tab",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.EnterClickOnUnit(n,o))}),e.ALo(20,"disableField"),e.qZA()(),e.TgZ(21,"td",28)(22,"input",29),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.ALTERNATEQUANTIY=n)})("keydown.Enter",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.EnterClickOnQuantity(o,n))})("keydown.Tab",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.EnterClickOnQuantity(o,n))})("keydown.enter",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.focustoRate())})("focusout",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.checkPartialDN(o,n))}),e.qZA()(),e.TgZ(23,"td",30)(24,"input",31),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.ALTRATE=n)})("keydown.enter",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.EnterClickOnRateChange(n,o))})("keydown.Tab",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.EnterClickOnRateChange(n,o))})("blur",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.EnterClickOnRateChange(n,o))}),e.ALo(25,"twoDigitNumber"),e.ALo(26,"disableField"),e.qZA()(),e.TgZ(27,"td",32)(28,"input",33),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.INDDISCOUNTRATE=n)})("change",function(){const r=e.CHM(t).index,o=e.oxw();return e.KtG(o.IndDiscountRateChangeEvent(r))})("keydown.enter",function(){const r=e.CHM(t).index,o=e.oxw();return e.KtG(o.discRateEnterClicked(r))})("keydown.Tab",function(){const r=e.CHM(t).index,o=e.oxw();return e.KtG(o.discRateEnterClicked(r))}),e.ALo(29,"disableField"),e.qZA()(),e.TgZ(30,"td",34)(31,"input",35),e.NdJ("keydown.Enter",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.EnterClickonDiscountAmount(n,o))})("keydown.Tab",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.EnterClickonDiscountAmount(n,o))})("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.INDDISCOUNT=n)})("keydown.enter",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.focusOnVat())}),e.ALo(32,"twoDigitNumber"),e.ALo(33,"disableField"),e.qZA()(),e.TgZ(34,"td",36),e._UZ(35,"input",37),e.ALo(36,"disableField"),e.qZA(),e.TgZ(37,"td",38),e._uU(38),e.ALo(39,"twoDigitNumber"),e.qZA(),e.TgZ(40,"td",39)(41,"input",40),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.VAT=n)})("keydown.enter",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.onEnterVat(n,o))})("keydown.Tab",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.onEnterVat(n,o))})("blur",function(n){const o=e.CHM(t).index,s=e.oxw();return e.KtG(s.onEnterVat(n,o))}),e.ALo(42,"twoDigitNumber"),e.ALo(43,"disableField"),e.qZA()(),e.TgZ(44,"td",41),e._uU(45),e.ALo(46,"twoDigitNumber"),e.qZA()()()}if(2&a){const t=c.$implicit,i=c.index,n=e.oxw();e.xp6(1),e.ekj("selected",n.isTableRowSelected(i)),e.xp6(1),e.MGl("id","sno",i,""),e.xp6(1),e.hij(" ",i+1," "),e.xp6(2),e.MGl("id","mixeddesc",i,""),e.Q6J("ngModel",t.ITEMDESC)("disabled",e.lcZ(6,41,"disableGridInMixedPurchase")),e.xp6(3),e.MGl("id","account",i,""),e.Q6J("disabled",16==n._trnMainService.TrnMainObj.VoucherType&&("VIEW"==n._trnMainService.TrnMainObj.Mode||n._trnMainService.TrnMainObj.DOFULLRETURN||1==n._trnMainService.disableAllFieldinPurchase))("ngModel",t.MANUFACTURER),e.xp6(1),e.Q6J("ngIf",1==n.masterService.userSetting.EnableSubLedger),e.xp6(1),e.Q6J("ngIf",1==n.masterService.userSetting.EnableItemWiseCostCenter),e.xp6(2),e.MGl("id","type",i,""),e.Q6J("ngModel",t.ITEMTYPE)("disabled",e.lcZ(13,43,"disableGridInMixedPurchase")),e.xp6(7),e.MGl("id","mixedunit",i,""),e.Q6J("ngModel",t.ALTUNIT)("disabled",e.lcZ(20,45,"disableGridInMixedPurchase")),e.xp6(3),e.MGl("id","mixedquantity",i,""),e.Q6J("ngModel",t.ALTERNATEQUANTIY)("disabled",16==n._trnMainService.TrnMainObj.VoucherType&&("VIEW"==n._trnMainService.TrnMainObj.Mode||n._trnMainService.TrnMainObj.DOFULLRETURN||1==n._trnMainService.disableAllFieldinPurchase)),e.xp6(2),e.MGl("id","mixedrate",i,""),e.Q6J("ngModel",n.applyPipeInRate?e.lcZ(25,47,t.ALTRATE):t.ALTRATE)("disabled",e.lcZ(26,49,"disableGridInMixedPurchase")),e.xp6(4),e.MGl("id","mixeddiscount",i,""),e.Q6J("ngModel",t.INDDISCOUNTRATE)("disabled",e.lcZ(29,51,"disableGridInMixedPurchase")),e.xp6(3),e.MGl("id","mixeddiscountAmt",i,""),e.Q6J("ngModel",n.applyPipeInRate?e.lcZ(32,53,t.INDDISCOUNT):t.INDDISCOUNT)("disabled",e.lcZ(33,55,"disableGridInMixedPurchase")),e.xp6(3),e.MGl("id","mixedmrp",i,""),e.xp6(1),e.Q6J("ngModel",t.CRATE)("disabled",e.lcZ(36,57,"disableGridInMixedPurchase"))("readonly",!0),e.xp6(2),e.MGl("id","mixedamntId",i,""),e.xp6(1),e.hij(" ",e.lcZ(39,59,n._trnMainService.nullToZeroConverter(t.AMOUNT))," "),e.xp6(3),e.MGl("id","mixedvatvalue",i,""),e.Q6J("ngModel",n.applyPipeInRate?e.lcZ(42,61,t.VAT):t.VAT)("disabled",e.lcZ(43,63,"disableGridInMixedPurchase")),e.xp6(3),e.MGl("id","mixednetamount",i,""),e.xp6(1),e.hij(" ",e.lcZ(46,65,n._trnMainService.nullToZeroConverter(t.NETAMOUNT))," ")}}let Oe=(()=>{class a{constructor(t,i,n,r,o,s){this.masterService=t,this._trnMainService=i,this.alertService=n,this.validationService=r,this.arouter=o,this.mixedPurchaseTypeService=s,this.showStockedQuantityOnly=0,this.activerowIndex=0,this.genericGridAccountSetting=new E.im,this.genericGridSubLedgerAccountSetting=new E.im,this.activeurlpath=o.snapshot.url[0].path}ngOnInit(){this.initialiseCostCenterList()}initialiseCostCenterList(){1===this.masterService.userSetting.EnableItemWiseCostCenter&&this.masterService.getAllCostCenter().subscribe(t=>{this.costLists=t.map(i=>({...i,value:i.CCID.toString()}))},t=>{this.costLists=[],this.alertService.info("Error in getting Cost Center List")})}RowClick(t){this.activerowIndex=t,this.masterService.ShowMore=!1}isTableRowSelected(t){return this.activerowIndex===t}deleteRow(){confirm("Are you sure u you want to delete the Row?")&&(this._trnMainService.TrnMainObj.AdditionProdList.splice(this.activerowIndex,1),0===this._trnMainService.TrnMainObj.AdditionProdList.length&&this._trnMainService.addRow())}AccountEnterCommand(){this.reIntialiseAccountData(),this.showPartyMasterPopup=!1,this.showCustomerProfilePopup=!1;let t="/getNonTradingAccountpagedlist/assets",i="",n=[{key:"ACID",title:"AC CODE",hidden:!1,noSearch:!1},{key:"ACNAME",title:"A/C NAME",hidden:!1,noSearch:!1}];this._trnMainService.TrnMainObj.VoucherType==b.Km.DebitNote&&1==this.masterService.userSetting.REFBILLCOMPULSORINDNOTE&&null!=this._trnMainService.TrnMainObj.REFBILL&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&(t="/getNonTradingAccountpagedlistforReturn/assets/",i=this._trnMainService.TrnMainObj.REFBILL,n=[{key:"ITEMDESC",title:"Item Description",hidden:!1,noSearch:!1},{key:"TRNAC",title:"A/C CODE",hidden:!1,noSearch:!1},{key:"ACNAME",title:"A/C NAME",hidden:!1,noSearch:!1},{key:"SL_ACNAME",title:"Sub Ledger",hidden:!1,noSearch:!1},{key:"PIAMOUNT",title:"PI Amount",hidden:!1,noSearch:!1},{key:"REMAMOUNT",title:"Remaining Amount",hidden:!1,noSearch:!1}]),console.log("retrurn ref bill",i),this.genericGridAccountSetting={title:"Accounts",apiEndpoints:t,defaultFilterIndex:1,columns:n},this.genericGridAccount.show(i,!1,"",!0)}SubledgerAccountEnter(){this.reIntialiseSubLedgerData(),this.genericGridSubLedgerAccountSetting={title:"Sub Ledger Accounts",apiEndpoints:"/getTDSAccountPagedListWithSubLedger",defaultFilterIndex:1,columns:[{key:"SL_ACID",title:"AC CODE",hidden:!1,noSearch:!1},{key:"SL_ACNAME",title:"A/C NAME",hidden:!1,noSearch:!1}]},this.genericGridSubLedgerAccount.show()}dblClickSubLedger(t){if(t){let i=this._trnMainService.TrnMainObj.AdditionProdList[this.activerowIndex];if(i.SL_ACNAME=t.SL_ACNAME,i.SL_ACID=t.SL_ACID,this.validateNonTradingRowInPI())return void(i.SL_ACNAME="")}1==this.masterService.userSetting.EnableItemWiseCostCenter?this.focusOnCostCenter():this.focusOnType()}reIntialiseAccountData(){this._trnMainService.TrnMainObj.AdditionProdList[this.activerowIndex].MANUFACTURER=null,this._trnMainService.TrnMainObj.AdditionProdList[this.activerowIndex].TRNAC=null,this._trnMainService.TrnMainObj.AdditionProdList[this.activerowIndex].SL_ACNAME=null,this._trnMainService.TrnMainObj.AdditionProdList[this.activerowIndex].SL_ACID=null,this._trnMainService.TrnMainObj.AdditionProdList[this.activerowIndex].HASSUBLEDGER=0}reIntialiseSubLedgerData(){this._trnMainService.TrnMainObj.AdditionProdList[this.activerowIndex].SL_ACNAME=null,this._trnMainService.TrnMainObj.AdditionProdList[this.activerowIndex].SL_ACID=null}checkPartialDN(t,i){this.EnterClickOnQuantity(t,i)||this._trnMainService.TrnMainObj.VoucherType==b.Km.DebitNote&&!this._trnMainService.TrnMainObj.DOFULLRETURN&&this.mixedPurchaseTypeService.checkBalanceAmountForPartialDN(this._trnMainService.TrnMainObj.REFBILL).subscribe(r=>{let s=this._trnMainService.TrnMainObj.AdditionProdList[t];if(s){let u=r.result.find(T=>T.ACC==s.TRNAC&&T.ITEMDESC==s.ITEMDESC&&T.SUB_LEDGER==s.SL_ACID);u&&s.AMOUNT+u.DNAMOUNT>u.PIAMOUNT&&(this._trnMainService.TrnMainObj.AdditionProdList[t].ALTERNATEQUANTIY=0,this._trnMainService.TrnMainObj.AdditionProdList[t].NETAMOUNT=0,this.alertService.warning("Entered Amount exceeded PI amount!!"))}},r=>{this.alertService.error(r)})}EnterClickOnQuantity(t,i){if(this._trnMainService.TrnMainObj.AdditionProdList[t].VAT=this._trnMainService.calculateVATforNonTrading(t),this._trnMainService.ReCalculateBillForNonTradingPurchase(),this._trnMainService.calculateTradingNontradingTotalinDebitNote(),this._trnMainService.TrnMainObj.VoucherType==b.Km.DebitNote&&0==this._trnMainService.TrnMainObj.DOFULLRETURN)return this._trnMainService.addRowForAdditionalProdList(),this.focusOnNextDescription(t),!1}discRateEnterClicked(t){this._trnMainService.TrnMainObj.AdditionProdList[t].VAT=this._trnMainService.calculateVATforNonTrading(t),this._trnMainService.ReCalculateBillForNonTradingPurchase(),this._trnMainService.calculateTradingNontradingTotalinDebitNote(),this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.AdditionProdList[t].INDDISCOUNTRATE)?this.focusOnVat():this.focusOnDiscountAmount()}EnterClickonDiscountAmount(t,i){this._trnMainService.TrnMainObj.AdditionProdList[i].INDDISCOUNTRATE=0,this._trnMainService.TrnMainObj.AdditionProdList[i].VAT=this._trnMainService.calculateVATforNonTrading(i),this._trnMainService.ReCalculateBillForNonTradingPurchase(),this._trnMainService.calculateTradingNontradingTotalinDebitNote()}onEnterVat(t,i){this._trnMainService.ReCalculateBillForNonTradingPurchase(),this._trnMainService.calculateTradingNontradingTotalinDebitNote(),!this.validateEmptySubLedger()&&(this._trnMainService.addRowForAdditionalProdList(),this.focusOnNextDescription(i))}validateEmptySubLedger(){if((this._trnMainService.TrnMainObj.VoucherType==b.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==b.Km.DebitNote)&&"NONTRADING"==this._trnMainService.TrnMainObj.INVOICETYPE&&1==this.masterService.userSetting.EnableSubLedger){let t=this._trnMainService.TrnMainObj.AdditionProdList.filter(i=>1==i.HASSUBLEDGER).find(i=>null==i.SL_ACNAME);return!(null==t||!t||(this.alertService.warning("Subledger field cannot be left empty for the item whose subledger field is enabled!!!"),0))}}dblClickAccountName(t){if(this._trnMainService.TrnMainObj.VoucherType!=b.Km.DebitNote||1!=this.masterService.userSetting.REFBILLCOMPULSORINDNOTE||null==this._trnMainService.TrnMainObj.REFBILL||0!=this._trnMainService.TrnMainObj.DOFULLRETURN){if(t){let i=this._trnMainService.TrnMainObj.AdditionProdList[this.activerowIndex];if(i.MANUFACTURER=t.ACNAME,i.TRNAC=t.ACID,i.ALTCONFACTOR=1,i.ACNAME=t.ACNAME,1==this.masterService.userSetting.EnableSubLedger&&(i.HASSUBLEDGER=1==t.HASSUBLEDGER?1:0),this.validateNonTradingRowInPI())return void(i.MANUFACTURER="")}1==t.HASSUBLEDGER&&1==this.masterService.userSetting.EnableSubLedger?setTimeout(()=>{document.getElementById("subledger"+this.activerowIndex).focus()},0):0==this.masterService.userSetting.EnableItemWiseCostCenter?this.focusOnType():this.focusOnCostCenter()}else this.selectAccountinPartialDebitNote(t)}selectAccountinPartialDebitNote(t){if(t){let i=this._trnMainService.TrnMainObj.AdditionProdList[this.activerowIndex];if(i.MANUFACTURER=t.ACNAME,i.ACNAME=t.ACNAME,i.ITEMDESC=t.ITEMDESC,i.SL_ACNAME=t.SL_ACNAME,i.TRNAC=t.TRNAC,i.ALTCONFACTOR=1,i.ITEMTYPE=t.ITEMTYPE,i.ALTUNIT=t.ALTUNIT,i.UNIT=t.ALTUNIT,i.ALTRATE=t.ALTRATE,i.RATE=t.RATE,i.RealQty=t.REALQTY_IN,i.PSTOCK=t.STOCK,i.Quantity=t.Quantity,i.INDDISCOUNTRATE=t.INDDISCOUNTRATE,i.INDDISCOUNT=t.INDDISCOUNT,i.VAT=t.VAT,i.SL_ACID=t.SL_ACID,1==this.masterService.userSetting.EnableSubLedger&&(i.HASSUBLEDGER=1==t.HASSUBLEDGER?1:0),this.validateNonTradingRowInDN(i))return i.MANUFACTURER="",i.ITEMDESC="",void(i.SL_ACNAME="");"NONTRADING"==this._trnMainService.TrnMainObj.INVOICETYPE&&(this._trnMainService.TrnMainObj.ProdList=[]),("TRADING"==this._trnMainService.TrnMainObj.INVOICETYPE||null==this._trnMainService.TrnMainObj.INVOICETYPE)&&(this._trnMainService.TrnMainObj.AdditionProdList=[])}this.focusOnType()}focusOutOnDesc(t){this._trnMainService.TrnMainObj.AdditionProdList[t].ITEMDESC&&this.validateNonTradingRowInPI()&&(this._trnMainService.TrnMainObj.AdditionProdList[t].ITEMDESC="")}IndDiscountRateChangeEvent(t){this._trnMainService.calculateNetRATEForNonTrading(t),console.log("additinalprod",this._trnMainService.TrnMainObj.AdditionProdList,t),this._trnMainService.TrnMainObj.AdditionProdList[t].INDDISCOUNT=0,this._trnMainService.TrnMainObj.AdditionProdList[t].INDDISCOUNTRATE<0?this._trnMainService.TrnMainObj.AdditionProdList[t].INDDISCOUNTRATE=0:this._trnMainService.TrnMainObj.AdditionProdList[t].INDDISCOUNTRATE>100&&(this._trnMainService.TrnMainObj.AdditionProdList[t].INDDISCOUNTRATE=100),this._trnMainService.ReCalculateBillForNonTradingPurchase(),this._trnMainService.calculateTradingNontradingTotalinDebitNote()}focustoAccount(t){console.log("FOCUS",this.activerowIndex),setTimeout(()=>{document.getElementById("account"+this.activerowIndex).focus()},0)}EnterClickOnUnit(t,i){console.log("eve",t),this._trnMainService.TrnMainObj.AdditionProdList[i].BASEUNIT=t.target.value,this.focustoQuantity(i)}focustoQuantity(t){console.log("FOCUS",this.activerowIndex),setTimeout(()=>{document.getElementById("mixedquantity"+this.activerowIndex).focus()},0)}focustoRate(){this._trnMainService.TrnMainObj.VoucherType==b.Km.DebitNote&&1==this.masterService.userSetting.REFBILLCOMPULSORINDNOTE&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&null!=this._trnMainService.TrnMainObj.REFBILL?setTimeout(()=>{document.getElementById("mixeddiscount"+this.activerowIndex).focus()},0):setTimeout(()=>{document.getElementById("mixedrate"+this.activerowIndex).focus()},0)}EnterClickOnRateChange(t,i){this._trnMainService.TrnMainObj.AdditionProdList[i].RATE=this._trnMainService.TrnMainObj.AdditionProdList[i].ALTRATE,this._trnMainService.TrnMainObj.AdditionProdList[i].VAT=this._trnMainService.calculateVATforNonTrading(i),this._trnMainService.ReCalculateBillForNonTradingPurchase(),this._trnMainService.calculateTradingNontradingTotalinDebitNote(),this.focustoDiscountPer(),1==this.masterService.userSetting.ENABLE_BUDGETCONTROL&&this.validateBudget(this._trnMainService.TrnMainObj.AdditionProdList[i])}validateBudget(t){this.mixedPurchaseTypeService.getAccountWiseBudgetLimit(t.TRNAC,this._trnMainService.TrnMainObj.TRNDATE).subscribe(i=>{if("ok"==i.status&&i.result&&i.result.length>0){let n=i.result[0].ACTION,r={message:""};("STOP"==n.toUpperCase()||"WARN"==n.toUpperCase())&&this.checkResultData(i,t,r)&&("STOP"==n.toUpperCase()&&(t.ALTRATE=0),this.alertService.warning(r.message))}})}checkResultData(t,i,n){let r=t.result,o=i.AMOUNT;if(1==this.masterService.userSetting.EnableItemWiseCostCenter){let u=r.filter(T=>T.CCID==i.COSTCENTER)[0];return n.message=`Dear User, selected account amount RS ${i.AMOUNT} exceed the allocated budget RS ${u.BUDGET}`,this.checkAmountExceedBudgetOrNot(o,u.BUDGET)}let s=r[0];return n.message=`Dear User, selected account amount RS ${i.AMOUNT} exceed the allocated budget RS ${s.BUDGET}`,this.checkAmountExceedBudgetOrNot(o,s.BUDGET)}checkAmountExceedBudgetOrNot(t,i){return t>i}focustoDiscountPer(){setTimeout(()=>{document.getElementById("mixeddiscount"+this.activerowIndex).focus()},0)}focusOnVat(){setTimeout(()=>{document.getElementById("mixedvatvalue"+this.activerowIndex).focus()},0)}focusOnNextDescription(t){this.activerowIndex=t+1;let i="mixeddesc";this._trnMainService.TrnMainObj.VoucherType==b.Km.DebitNote&&1==this.masterService.userSetting.REFBILLCOMPULSORINDNOTE&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&(i="account"),setTimeout(()=>{document.getElementById(i+this.activerowIndex).focus()},0)}focusOnDiscountAmount(){setTimeout(()=>{document.getElementById("mixeddiscountAmt"+this.activerowIndex).focus()},0)}focusOnUnit(){setTimeout(()=>{document.getElementById("mixedunit"+this.activerowIndex).focus()},0)}focusOnType(){setTimeout(()=>{document.getElementById("type"+this.activerowIndex).focus()},0)}EnterClickOnType(t,i){console.log("scheme",t.target.value),t.target.value&&this.focusOnUnit()}enterOnCostCenter(t,i){!t.target.value||this.focusOnType()}focusOnCostCenter(){setTimeout(()=>{document.getElementById("costCenter"+this.activerowIndex).focus()},0)}validateNonTradingRowInPI(){let i,t=this._trnMainService.TrnMainObj.AdditionProdList[this.activerowIndex];return i=t.HASSUBLEDGER?this._trnMainService.TrnMainObj.AdditionProdList.filter(n=>n!==t).some(n=>n.MANUFACTURER==t.MANUFACTURER&&n.SL_ACNAME==t.SL_ACNAME&&n.ITEMDESC==t.ITEMDESC):this._trnMainService.TrnMainObj.AdditionProdList.filter(n=>n!==t).some(n=>n.MANUFACTURER==t.MANUFACTURER&&n.ITEMDESC==t.ITEMDESC),!!i&&(this.alertService.info("Cannot add Duplicate Item!!"),!0)}validateNonTradingRowInDN(t){return!!this._trnMainService.TrnMainObj.AdditionProdList.filter(n=>n!==t).some(n=>n.MANUFACTURER==t.MANUFACTURER&&n.SL_ACNAME==t.SL_ACNAME&&n.ITEMDESC==t.ITEMDESC)&&(this.alertService.info("Cannot add Duplicate Item!!"),!0)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(j.P),e.Y36(y.p),e.Y36(G.c),e.Y36(ce.R),e.Y36(N.gz),e.Y36(ue))},a.\u0275cmp=e.Xpm({type:a,selectors:[["mixed-purchase"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Pe,5),e.Gf(be,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.genericGridAccount=n.first),e.iGM(n=e.CRH())&&(i.genericGridSubLedgerAccount=n.first)}},features:[e._Bn([ue])],decls:37,vars:5,consts:[[2,"margin-right","15px"],[1,"wrapper"],["id","purchasetypeTableheader",2,"background","silver","color","black"],["scope","col",2,"width","4%"],[4,"ngIf"],["style","width: 7%;",4,"ngIf"],[2,"width","50px"],[2,"width","100px"],[2,"width","70px"],["style","border: 1px",4,"ngFor","ngForOf"],[3,"popupsettings","onItemDoubleClick"],["genericGridAccount",""],["genericGridSubLedgerAccount",""],[2,"width","7%"],[2,"border","1px"],[2,"border","1px solid #e6e6e6","max-height","25px",3,"click","keydown.Shift.delete"],[2,"border","1px solid #e6e6e6","width","20px",3,"id"],[1,"CellWithComment",2,"height","23px","border","1px solid #e6e6e6","width","13%"],["type","text","autocomplete","off",2,"width","98%",3,"id","ngModel","disabled","ngModelChange","keydown.enter","focusout"],[2,"height","23px","border","1px solid #e6e6e6","width","8%"],["type","text","autocomplete","off","placeholder","Press Enter to select Account",2,"width","100%",3,"id","disabled","ngModel","ngModelChange","keydown.enter","keyup","keypress"],["style","height: 23px; border: 1px solid #e6e6e6; width: 10%",4,"ngIf"],["style","height: 23px; border: 1px solid #e6e6e6;",4,"ngIf"],[2,"height","23px","border","1px solid #e6e6e6","width","5%"],[3,"id","ngModel","disabled","keydown.enter","ngModelChange"],["value","Capitalize","selected",""],["value","Non-Capitalize"],[2,"width","100%",3,"id","ngModel","disabled","ngModelChange","keydown.enter","keydown.Tab"],[2,"height","23px","border","1px solid #e6e6e6","width","4%"],["type","number",2,"width","100%","text-align","right",3,"id","ngModel","disabled","ngModelChange","keydown.Enter","keydown.Tab","keydown.enter","focusout"],[2,"height","23px","border","1px solid #e6e6e6","background-color","#f9f9f9"],["type","number",2,"width","100%","text-align","right",3,"id","ngModel","disabled","ngModelChange","keydown.enter","keydown.Tab","blur"],[2,"height","23px","border","1px solid #e6e6e6"],["type","number","decimalPlacesRestriction","2","min","0","max","100",2,"width","100%","text-align","right",3,"id","ngModel","disabled","ngModelChange","change","keydown.enter","keydown.Tab"],[2,"height","23px","border","1px solid #e6e6e6","width","7%"],["type","number","decimalPlacesRestriction","2","step","0.01",2,"width","98%","text-align","right",3,"id","ngModel","disabled","keydown.Enter","keydown.Tab","ngModelChange","keydown.enter"],[2,"height","23px","border","1px solid #e6e6e6","width","40px",3,"id"],["type","text",2,"width","6rem","text-align","right",3,"ngModel","disabled","readonly"],[2,"height","23px","border","1px solid #e6e6e6","background-color","#f9f9f9","text-align","right",3,"id"],[2,"height","23px","border","1px solid #e6e6e6","width","100px","text-align","right"],["type","number",2,"width","6rem","text-align","right",3,"id","ngModel","disabled","ngModelChange","keydown.enter","keydown.Tab","blur"],[2,"height","23px","border","1px solid #e6e6e6","text-align","right",3,"id"],[2,"height","23px","border","1px solid #e6e6e6","width","10%"],["type","text","autocomplete","off","placeholder","Press Enter to select",2,"width","100%",3,"id","disabled","ngModel","ngModelChange","keydown.enter","keyup","keypress"],[2,"width","100%",3,"id","ngModel","disabled","keydown.enter","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"table")(3,"tr",2)(4,"th",3),e._uU(5,"S.No."),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Description"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Account"),e.qZA(),e.YNc(10,Ae,2,0,"th",4),e.YNc(11,fe,2,0,"th",5),e.TgZ(12,"th"),e._uU(13,"Type"),e.qZA(),e.TgZ(14,"th"),e._uU(15," Unit"),e.qZA(),e.TgZ(16,"th",6),e._uU(17," Quantity"),e.qZA(),e.TgZ(18,"th",7),e._uU(19," P.Rate"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Dis%"),e.qZA(),e.TgZ(22,"th"),e._uU(23,"Dis Amt"),e.qZA(),e.TgZ(24,"th"),e._uU(25,"Net Rate"),e.qZA(),e.TgZ(26,"th",8),e._uU(27," Amt"),e.qZA(),e.TgZ(28,"th"),e._uU(29,"VAT"),e.qZA(),e.TgZ(30,"th"),e._uU(31,"Net Amt"),e.qZA()(),e.YNc(32,ye,47,67,"tbody",9),e.qZA()()(),e.TgZ(33,"generic-popup-grid",10,11),e.NdJ("onItemDoubleClick",function(r){return i.dblClickAccountName(r)}),e.qZA(),e.TgZ(35,"generic-popup-grid",10,12),e.NdJ("onItemDoubleClick",function(r){return i.dblClickSubLedger(r)}),e.qZA()),2&t&&(e.xp6(10),e.Q6J("ngIf",1==i.masterService.userSetting.EnableSubLedger),e.xp6(1),e.Q6J("ngIf",1==i.masterService.userSetting.EnableItemWiseCostCenter),e.xp6(21),e.Q6J("ngForOf",i._trnMainService.TrnMainObj.AdditionProdList),e.xp6(1),e.Q6J("popupsettings",i.genericGridAccountSetting),e.xp6(2),e.Q6J("popupsettings",i.genericGridSubLedgerAccountSetting))},dependencies:[m.sg,m.O5,f.YN,f.Kr,f.Fj,f.wV,f.EJ,f.JJ,f.qQ,f.Fd,f.On,E.Zl,pe.F,ne.g,Me.u],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], option[_ngcontent-%COMP%]{height:23px;vertical-align:middle;font-size:13px;color:#000;border-bottom:1px solid #ddd}textarea[_ngcontent-%COMP%]{font-size:13px;border:1px solid #cbcbcb;border-radius:3px;color:#000}.plainBackGround[_ngcontent-%COMP%]{border:2px solid #e6e6e6;margin-bottom:5px;padding:10px}label[_ngcontent-%COMP%]{height:28px;font-weight:400;width:90px;margin:2px;vertical-align:middle;font-size:13px;padding-top:4px}input[_ngcontent-%COMP%]{padding-left:4px}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[_ngcontent-%COMP%]:disabled, select[_ngcontent-%COMP%]:disabled, textarea[_ngcontent-%COMP%]:disabled{cursor:not-allowed!important;color:#000!important;background-color:#ebebe4!important}button[_ngcontent-%COMP%]:disabled{cursor:not-allowed!important}.btn-add-focus[_ngcontent-%COMP%]:focus{transform:scale(1.2);-webkit-transform:scale(1.2);-ms-transform:scale(1.2);-moz-transform:scale(1.2);-o-transform:scale(1.2)}tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:700}.tableBorder[_ngcontent-%COMP%]{border:1px solid;border-color:#dcdcdc}.show[_ngcontent-%COMP%]{overflow:visible;height:auto}.alert-danger[_ngcontent-%COMP%]{background-color:none!important;border-color:none!important;color:#a94442}.tab[_ngcontent-%COMP%]{overflow:hidden;border:1px solid #ccc;background-color:#f1f1f1}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s;font-size:17px}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#ddd}.tab[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#ccc}.tabcontent[_ngcontent-%COMP%]{display:none;padding:6px 12px;border:1px solid #ccc;border-top:none}.custom-asset-dropdown[_ngcontent-%COMP%]    {line-height:13px;font-size:14px}  .custom-asset-dropdown .multiselect-dropdown .dropdown-btn{padding:2px 11px}.sourceBatchRate[_ngcontent-%COMP%]{height:23px;border:1px solid #b4b4b4;background-color:#f9f9f9;width:9%;.batchRateInput{width: 100%; text-align: right}}.sourceBarCode[_ngcontent-%COMP%]{height:23px;border:1px solid #b4b4b4;width:6%;.barCodeInput{width: 100%;}}","table[_ngcontent-%COMP%] {\n    width: 100%;\n    border-collapse: collapse;\n  }\n\n  th[_ngcontent-%COMP%], td[_ngcontent-%COMP%] {\n    padding: 8px;\n  }\n\n  th[_ngcontent-%COMP%] {\n    text-align: left;\n    background: #eee;\n    position: sticky;\n    top: 0px;\n  }\n\n  .wrapper[_ngcontent-%COMP%] {\n    border: 1px solid #ddd;\n    width: 100%;\n    overflow-x: hidden;\n    overflow-y: auto;\n  }\n\n  .col1[_ngcontent-%COMP%] {\n    position: absolute;\n    width: 10em;\n    left: 0em;\n    top: auto;\n  }\n\n  .col2[_ngcontent-%COMP%] {\n    position: absolute;\n    width: 5em;\n    left: 10em;\n    top: auto;\n  }\n\n  .modal-footer[_ngcontent-%COMP%] {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%] {\n    cursor: pointer;\n    position: absolute;\n    top: 10px;\n    right: 10px;\n  }\n\n  .modal-backdrop[_ngcontent-%COMP%] {\n    display: none;\n  }",".modal-content[_ngcontent-%COMP%] {\n    padding: 1px;\n    margin: 0px;\n    float: right;\n  }\n\n  tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover {\n    background-color: #f3f5f4;\n    cursor: pointer;\n  }\n\n  tr[_ngcontent-%COMP%] {\n    font-size: 13px;\n  }\n\n  .selected-row[_ngcontent-%COMP%] {\n    background-color: #7ed0ff;\n  }\n\n  tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%] {\n    line-height: 30px !important;\n    padding: 3px;\n  }\n\n  thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%] {\n    line-height: 5px !important;\n  }\n\n  tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child {\n    text-align: left !important;\n    padding: 0px 0px 0px 11px !important;\n  }\n\n  .modal-content[_ngcontent-%COMP%] {\n    box-shadow: -10px 0px 10px 1px #aaaaaa;\n  }\n\n  .modal-content-main-area[_ngcontent-%COMP%] {\n    max-height: 100%;\n    height: 94%;\n    overflow: auto;\n    overflow-x: hidden;\n  }\n\n  .modal-content-summary-area[_ngcontent-%COMP%] {\n    max-height: 20%;\n    height: 20%;\n    overflow: auto;\n    overflow-x: hidden;\n  }\n\n  .ellipsis[_ngcontent-%COMP%] {\n    white-space: nowrap;\n  }\n\n  .close[_ngcontent-%COMP%] {\n    margin: -9px 0px -9px 0px;\n  }\n\n  .highlighted[_ngcontent-%COMP%] {\n    background-color: #7ed0ff;\n  }\n\n  .bgforlessstockitem[_ngcontent-%COMP%] {\n    background-color: #ffc107d2;\n  }"]}),a})();const Ie=["genericGridAccount"];function we(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"tr",13)(1,"td",14),e._uU(2),e.qZA(),e.TgZ(3,"td",15)(4,"input",16),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.ITEMDESC=n)}),e.qZA()(),e.TgZ(5,"td",17)(6,"input",16),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.MANUFACTURER=n)}),e.qZA()(),e.TgZ(7,"td",18)(8,"input",16),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.ITEMTYPE=n)}),e.qZA()(),e.TgZ(9,"td",19)(10,"input",20),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.ALTUNIT=n)}),e.qZA()(),e.TgZ(11,"td",21)(12,"input",22),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.ALTERNATEQUANTIY=n)}),e.qZA()(),e.TgZ(13,"td",18),e._UZ(14,"input",23),e.ALo(15,"twoDigitNumber"),e.qZA(),e.TgZ(16,"td",19)(17,"input",24),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.INDDISCOUNTRATE=n)}),e.qZA()(),e.TgZ(18,"td",18),e._UZ(19,"input",25),e.ALo(20,"twoDigitNumber"),e.qZA(),e.TgZ(21,"td",26),e._UZ(22,"input",27),e.qZA(),e.TgZ(23,"td",28),e._uU(24),e.ALo(25,"twoDigitNumber"),e.qZA(),e.TgZ(26,"td",28),e._uU(27),e.ALo(28,"twoDigitNumber"),e.qZA(),e.TgZ(29,"td",28),e._uU(30),e.ALo(31,"twoDigitNumber"),e.qZA()()}if(2&a){const t=c.$implicit,i=c.index,n=e.oxw();e.xp6(1),e.MGl("id","sno",i,""),e.xp6(1),e.hij(" ",i+1," "),e.xp6(2),e.MGl("id","mixeddesc",i,""),e.Q6J("ngModel",t.ITEMDESC),e.xp6(2),e.MGl("id","account",i,""),e.Q6J("ngModel",t.MANUFACTURER),e.xp6(2),e.MGl("id","type",i,""),e.Q6J("ngModel",t.ITEMTYPE),e.xp6(2),e.MGl("id","mixedunit",i,""),e.Q6J("ngModel",t.ALTUNIT),e.xp6(2),e.MGl("id","mixedquantity",i,""),e.Q6J("ngModel",t.ALTERNATEQUANTIY),e.xp6(2),e.MGl("id","mixedrate",i,""),e.Q6J("ngModel",n.applyPipeInRate?e.lcZ(15,28,t.ALTRATE):t.ALTRATE),e.xp6(3),e.MGl("id","mixeddiscount",i,""),e.Q6J("ngModel",t.INDDISCOUNTRATE),e.xp6(2),e.MGl("id","mixeddiscountAmt",i,""),e.Q6J("ngModel",e.lcZ(20,30,n._trnMainService.nullToZeroConverter(t.INDDISCOUNT))),e.xp6(2),e.MGl("id","mixedmrp",i,""),e.xp6(1),e.Q6J("ngModel",t.CRATE)("disabled",1==n._trnMainService.disableAllFieldinPurchase)("readonly",!0),e.xp6(1),e.MGl("id","mixedamntId",i,""),e.xp6(1),e.hij(" ",e.lcZ(25,32,n._trnMainService.nullToZeroConverter(t.AMOUNT))," "),e.xp6(2),e.MGl("id","mixedvatvalue",i,""),e.xp6(1),e.hij(" ",e.lcZ(28,34,n._trnMainService.nullToZeroConverter(t.VAT))," "),e.xp6(2),e.MGl("id","mixednetamount",i,""),e.xp6(1),e.hij(" ",e.lcZ(31,36,n._trnMainService.nullToZeroConverter(t.NETAMOUNT))," ")}}function Ne(a,c){1&a&&(e.TgZ(0,"div",29),e._UZ(1,"voucher-total-area"),e.qZA())}let De=(()=>{class a{constructor(t,i,n,r,o){this.masterService=t,this._trnMainService=i,this.alertService=n,this.validationService=r,this.arouter=o,this.showStockedQuantityOnly=0,this.activerowIndex=0,this.genericGridAccountSetting=new E.im,this.activeurlpath=o.snapshot.url[0].path}ngOnInit(){}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(j.P),e.Y36(y.p),e.Y36(G.c),e.Y36(ce.R),e.Y36(N.gz))},a.\u0275cmp=e.Xpm({type:a,selectors:[["preview-bill"]],viewQuery:function(t,i){if(1&t&&e.Gf(Ie,5),2&t){let n;e.iGM(n=e.CRH())&&(i.genericGridAccount=n.first)}},decls:34,vars:2,consts:[[2,"margin-right","15px"],[1,"wrapper"],[1,"table"],[2,"border-bottom","2px solid #e6e6e6","height","25px","background","#9ccae4","width","100%"],["scope","col",2,"width","2%"],["scope","col",2,"width","9%","text-align","center"],["scope","col",2,"width","10%","text-align","center"],["scope","col",2,"width","5%","text-align","center"],["scope","col",2,"width","3%","text-align","center"],["scope","col",2,"width","4%","text-align","center"],[2,"background-color","aliceblue","overflow-y","scroll"],["style","height: 28px;",4,"ngFor","ngForOf"],["class","sticky-bottom",4,"ngIf"],[2,"height","28px"],[2,"border","1px solid #e6e6e6","width","2%",3,"id"],[1,"CellWithComment",2,"height","23px","border","1px solid #e6e6e6","width","9%"],["type","text","autocomplete","off","readonly","",2,"width","100%",3,"id","ngModel","ngModelChange"],[2,"height","23px","border","1px solid #e6e6e6","width","10%"],[2,"height","23px","border","1px solid #e6e6e6","width","5%"],[2,"height","23px","border","1px solid #e6e6e6","width","3%"],["readonly","",2,"width","100%",3,"id","ngModel","ngModelChange"],[2,"height","23px","border","1px solid #e6e6e6","width","4%"],["type","number","readonly","",2,"width","100%","text-align","right",3,"id","ngModel","ngModelChange"],["type","number","readonly","",2,"width","100%","text-align","right",3,"id","ngModel"],["type","number","decimalPlacesRestriction","2","min","0","max","100","readonly","",2,"width","100%","text-align","right",3,"id","ngModel","ngModelChange"],["type","number","decimalPlacesRestriction","2","step","0.01","readonly","",2,"width","98%","text-align","right",3,"id","ngModel"],[2,"height","23px","border","1px solid #e6e6e6","width","5%",3,"id"],["type","text","readonly","",2,"width","98%","text-align","right",3,"ngModel","disabled","readonly"],[2,"height","23px","border","1px solid #e6e6e6","width","5%","text-align","right",3,"id"],[1,"sticky-bottom"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"table",2)(3,"thead")(4,"tr",3)(5,"th",4),e._uU(6,"Sn."),e.qZA(),e.TgZ(7,"th",5),e._uU(8,"Description"),e.qZA(),e.TgZ(9,"th",6),e._uU(10,"Account"),e.qZA(),e.TgZ(11,"th",7),e._uU(12,"Type"),e.qZA(),e.TgZ(13,"th",8),e._uU(14,"Unit"),e.qZA(),e.TgZ(15,"th",9),e._uU(16,"Quantity"),e.qZA(),e.TgZ(17,"th",7),e._uU(18,"P.Rate"),e.qZA(),e.TgZ(19,"th",8),e._uU(20,"Dis%"),e.qZA(),e.TgZ(21,"th",7),e._uU(22,"Dis Amt"),e.qZA(),e.TgZ(23,"th",7),e._uU(24,"Net Rate"),e.qZA(),e.TgZ(25,"th",7),e._uU(26,"Amt"),e.qZA(),e.TgZ(27,"th",7),e._uU(28,"VAT"),e.qZA(),e.TgZ(29,"th",7),e._uU(30,"Net Amt"),e.qZA()()(),e.TgZ(31,"tbody",10),e.YNc(32,we,32,38,"tr",11),e.qZA()()(),e.YNc(33,Ne,2,0,"div",12),e.qZA()),2&t&&(e.xp6(32),e.Q6J("ngForOf",i._trnMainService.mergedProductList),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName))},dependencies:[m.sg,m.O5,f.Fj,f.wV,f.JJ,f.qQ,f.Fd,f.On,pe.F,q.u,ne.g],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], option[_ngcontent-%COMP%]{height:23px;vertical-align:middle;font-size:13px;color:#000;border-bottom:1px solid #ddd}textarea[_ngcontent-%COMP%]{font-size:13px;border:1px solid #cbcbcb;border-radius:3px;color:#000}.plainBackGround[_ngcontent-%COMP%]{border:2px solid #e6e6e6;margin-bottom:5px;padding:10px}label[_ngcontent-%COMP%]{height:28px;font-weight:400;width:90px;margin:2px;vertical-align:middle;font-size:13px;padding-top:4px}input[_ngcontent-%COMP%]{padding-left:4px}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[_ngcontent-%COMP%]:disabled, select[_ngcontent-%COMP%]:disabled, textarea[_ngcontent-%COMP%]:disabled{cursor:not-allowed!important;color:#000!important;background-color:#ebebe4!important}button[_ngcontent-%COMP%]:disabled{cursor:not-allowed!important}.btn-add-focus[_ngcontent-%COMP%]:focus{transform:scale(1.2);-webkit-transform:scale(1.2);-ms-transform:scale(1.2);-moz-transform:scale(1.2);-o-transform:scale(1.2)}tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:700}.tableBorder[_ngcontent-%COMP%]{border:1px solid;border-color:#dcdcdc}.show[_ngcontent-%COMP%]{overflow:visible;height:auto}.alert-danger[_ngcontent-%COMP%]{background-color:none!important;border-color:none!important;color:#a94442}.tab[_ngcontent-%COMP%]{overflow:hidden;border:1px solid #ccc;background-color:#f1f1f1}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s;font-size:17px}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#ddd}.tab[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#ccc}.tabcontent[_ngcontent-%COMP%]{display:none;padding:6px 12px;border:1px solid #ccc;border-top:none}.custom-asset-dropdown[_ngcontent-%COMP%]    {line-height:13px;font-size:14px}  .custom-asset-dropdown .multiselect-dropdown .dropdown-btn{padding:2px 11px}.sourceBatchRate[_ngcontent-%COMP%]{height:23px;border:1px solid #b4b4b4;background-color:#f9f9f9;width:9%;.batchRateInput{width: 100%; text-align: right}}.sourceBarCode[_ngcontent-%COMP%]{height:23px;border:1px solid #b4b4b4;width:6%;.barCodeInput{width: 100%;}}","table[_ngcontent-%COMP%] {\n      width: 100%;\n      border-collapse: collapse;\n    }\n  \n    th[_ngcontent-%COMP%], td[_ngcontent-%COMP%] {\n      padding: 8px;\n    }\n  \n    th[_ngcontent-%COMP%] {\n      text-align: left;\n      background: #eee;\n      position: sticky;\n      top: 0px;\n    }\n  \n    .wrapper[_ngcontent-%COMP%] {\n      border: 1px solid #ddd;\n      width: 100%;\n      overflow-x: hidden;\n      overflow-y: auto;\n    }\n  \n    .col1[_ngcontent-%COMP%] {\n      position: absolute;\n      width: 10em;\n      left: 0em;\n      top: auto;\n    }\n  \n    .col2[_ngcontent-%COMP%] {\n      position: absolute;\n      width: 5em;\n      left: 10em;\n      top: auto;\n    }\n  \n    .modal-footer[_ngcontent-%COMP%] {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n  \n    .modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%] {\n      cursor: pointer;\n      position: absolute;\n      top: 10px;\n      right: 10px;\n    }\n  \n    .modal-backdrop[_ngcontent-%COMP%] {\n      display: none;\n    }",".modal-content[_ngcontent-%COMP%] {\n      padding: 1px;\n      margin: 0px;\n      float: right;\n    }\n  \n    tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover {\n      background-color: #f3f5f4;\n      cursor: pointer;\n    }\n  \n    tr[_ngcontent-%COMP%] {\n      font-size: 13px;\n    }\n  \n    .selected-row[_ngcontent-%COMP%] {\n      background-color: #7ed0ff;\n    }\n  \n    tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%] {\n      line-height: 30px !important;\n      padding: 3px;\n    }\n  \n    thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%] {\n      line-height: 5px !important;\n    }\n  \n    tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child {\n      text-align: left !important;\n      padding: 0px 0px 0px 11px !important;\n    }\n  \n    .modal-content[_ngcontent-%COMP%] {\n      box-shadow: -10px 0px 10px 1px #aaaaaa;\n    }\n  \n    .modal-content-main-area[_ngcontent-%COMP%] {\n      max-height: 100%;\n      height: 94%;\n      overflow: auto;\n      overflow-x: hidden;\n    }\n  \n    .modal-content-summary-area[_ngcontent-%COMP%] {\n      max-height: 20%;\n      height: 20%;\n      overflow: auto;\n      overflow-x: hidden;\n    }\n  \n    .ellipsis[_ngcontent-%COMP%] {\n      white-space: nowrap;\n    }\n  \n    .close[_ngcontent-%COMP%] {\n      margin: -9px 0px -9px 0px;\n    }\n  \n    .highlighted[_ngcontent-%COMP%] {\n      background-color: #7ed0ff;\n    }\n  \n    .bgforlessstockitem[_ngcontent-%COMP%] {\n      background-color: #ffc107d2;\n    }"]}),a})();function Re(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"ul",11)(1,"li",12)(2,"a",13),e._uU(3,"Trading Purchase"),e.qZA()(),e.TgZ(4,"li",12)(5,"a",14),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.focusOnDescription())}),e._uU(6,"Others Purchase"),e.qZA()(),e.TgZ(7,"li",12)(8,"a",15),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onPreviewBillClick())}),e._uU(9,"Preview Bill"),e.qZA()()()}}function Ze(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"ul",11)(1,"li",12)(2,"a",16),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.focusOnDescription())}),e._uU(3,"Others Purchase"),e.qZA()()()}}let ge=(()=>{class a{constructor(t,i,n,r){this.masterService=t,this._trnMainService=i,this.loadService=n,this.alertService=r,this.TrnMainObj={}}ngOnInit(){}onClickPoReferenceProduct(t){t&&(this._trnMainService.purchaseOrderQty=t.ALTERNATEQTY,this._trnMainService.purchaseOrderRate=t.RATE,this._trnMainService.produstWiseOrderUnit=t.BASEUNIT)}focusOnDescription(){setTimeout(()=>{document.getElementById("mixeddesc0")?.focus()},0)}onPreviewBillClick(){this._trnMainService.TrnMainObj.AdditionProdList?.length>1&&this._trnMainService.removeInvalidRowsFromAdditionalprod(),this._trnMainService.TrnMainObj.ProdList?.length>1&&this.removeInvalidRowsFromprod(),this._trnMainService.mergedProductList=this._trnMainService.conCatTradingAndNonTradingProdList()}removeInvalidRowsFromprod(){this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(t=>null!=t.MCODE&&""!=t.MCODE)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(j.P),e.Y36(y.p),e.Y36(F.V),e.Y36(G.c))},a.\u0275cmp=e.Xpm({type:a,selectors:[["purchase-type"]],decls:21,vars:4,consts:[[1,"row",2,"margin-top","3px"],[1,"col-12"],[1,"tabbable"],["class","nav nav-tabs","style","background: #17a2b8;height:24px;",4,"ngIf"],[1,"tab-content","mr5"],["id","tradingpurchase",2,"height","49vh",3,"ngClass"],[2,"display","inline-block","width","100%"],[1,"clearfix"],[3,"onClickItemSelectPopUp"],["id","otherpurchase",2,"height","49vh",3,"ngClass"],["id","previewbill",1,"tab-pane",2,"height","49vh"],[1,"nav","nav-tabs",2,"background","#17a2b8","height","24px"],[1,"nav-item"],["id","production1","href","#tradingpurchase","data-toggle","tab","role","tab",1,"nav-link","active",2,"font-size","14px"],["id","otherpurchase1","href","#otherpurchase","data-toggle","tab","role","tab",1,"nav-link",2,"font-size","14px",3,"click"],["id","previewbill1","href","#previewbill","data-toggle","tab","role","tab",1,"nav-link",2,"font-size","14px",3,"click"],["id","otherpurchase1","href","#otherpurchase","data-toggle","tab","role","tab",1,"nav-link","active",2,"font-size","14px",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,Re,10,0,"ul",3),e.YNc(4,Ze,4,0,"ul",3),e.TgZ(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"div")(10,"productentry",8),e.NdJ("onClickItemSelectPopUp",function(r){return i.onClickPoReferenceProduct(r)}),e.qZA()()()()(),e.TgZ(11,"div",9)(12,"div",6)(13,"div",7)(14,"div"),e._UZ(15,"mixed-purchase"),e.qZA()()()(),e.TgZ(16,"div",10)(17,"div",6)(18,"div",7)(19,"div"),e._UZ(20,"preview-bill"),e.qZA()()()()()()()()),2&t&&(e.xp6(3),e.Q6J("ngIf","MIXED"==i._trnMainService.TrnMainObj.INVOICETYPE),e.xp6(1),e.Q6J("ngIf","NONTRADING"==i._trnMainService.TrnMainObj.INVOICETYPE),e.xp6(2),e.Q6J("ngClass","MIXED"==i._trnMainService.TrnMainObj.INVOICETYPE?"tab-pane active":"tab-pane"),e.xp6(5),e.Q6J("ngClass","NONTRADING"==i._trnMainService.TrnMainObj.INVOICETYPE?"tab-pane active":"tab-pane"))},dependencies:[m.mk,m.O5,Te.x,Oe,De],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], option[_ngcontent-%COMP%]{height:23px;vertical-align:middle;font-size:13px;color:#000;border-bottom:1px solid #ddd}textarea[_ngcontent-%COMP%]{font-size:13px;border:1px solid #cbcbcb;border-radius:3px;color:#000}.plainBackGround[_ngcontent-%COMP%]{border:2px solid #e6e6e6;margin-bottom:5px;padding:10px}label[_ngcontent-%COMP%]{height:28px;font-weight:400;width:90px;margin:2px;vertical-align:middle;font-size:13px;padding-top:4px}input[_ngcontent-%COMP%]{padding-left:4px}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[_ngcontent-%COMP%]:disabled, select[_ngcontent-%COMP%]:disabled, textarea[_ngcontent-%COMP%]:disabled{cursor:not-allowed!important;color:#000!important;background-color:#ebebe4!important}button[_ngcontent-%COMP%]:disabled{cursor:not-allowed!important}.btn-add-focus[_ngcontent-%COMP%]:focus{transform:scale(1.2);-webkit-transform:scale(1.2);-ms-transform:scale(1.2);-moz-transform:scale(1.2);-o-transform:scale(1.2)}tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:700}.tableBorder[_ngcontent-%COMP%]{border:1px solid;border-color:#dcdcdc}.show[_ngcontent-%COMP%]{overflow:visible;height:auto}.alert-danger[_ngcontent-%COMP%]{background-color:none!important;border-color:none!important;color:#a94442}.tab[_ngcontent-%COMP%]{overflow:hidden;border:1px solid #ccc;background-color:#f1f1f1}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s;font-size:17px}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#ddd}.tab[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#ccc}.tabcontent[_ngcontent-%COMP%]{display:none;padding:6px 12px;border:1px solid #ccc;border-top:none}.custom-asset-dropdown[_ngcontent-%COMP%]    {line-height:13px;font-size:14px}  .custom-asset-dropdown .multiselect-dropdown .dropdown-btn{padding:2px 11px}.sourceBatchRate[_ngcontent-%COMP%]{height:23px;border:1px solid #b4b4b4;background-color:#f9f9f9;width:9%;.batchRateInput{width: 100%; text-align: right}}.sourceBarCode[_ngcontent-%COMP%]{height:23px;border:1px solid #b4b4b4;width:6%;.barCodeInput{width: 100%;}}"]}),a})();var _e=h(32635);const Le=["number"];function Ue(a,c){1&a&&e.GkF(0)}const je=function(a,c){return{index:a,label:c}};function Ge(a,c){if(1&a&&(e.ynx(0),e.TgZ(1,"div",3),e.YNc(2,Ue,1,0,"ng-container",4),e.qZA(),e.BQk()),2&a){const t=c.$implicit,i=c.index,n=e.oxw();e.xp6(2),e.Q6J("ngTemplateOutlet",n.getInputType(t.inputType))("ngTemplateOutletContext",e.WLB(2,je,i,t))}}function ke(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"span",5),e._uU(1),e.qZA(),e.TgZ(2,"input",6),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).label,s=e.oxw();return e.KtG(s._trnMainService.TrnMainObj[o.field]=n)}),e.qZA()}if(2&a){const t=c.label,i=e.oxw();e.xp6(1),e.Oqu(t.title),e.xp6(1),e.Q6J("disabled",!0)("ngModel",i._trnMainService.TrnMainObj[t.field])}}let Fe=(()=>{class a{constructor(t){this._trnMainService=t,this.TrnMainObj={}}ngOnInit(){this.prepareFooterList()}prepareFooterList(){this.genericList=[{title:"Total Quantity",inputType:"number",field:"TOTALSQTY"},{title:"Gross Amount",inputType:"number",field:"GROSSAMNT"},{title:"Taxable Amount",inputType:"number",field:"TAXABLE"},{title:"Non-Taxable Amount",inputType:"number",field:"NONTAXABLE"},{title:"VAT Amount",inputType:"number",field:"VATAMNT"},{title:"Net Value",inputType:"number",field:"NETAMNT"}]}getInputType(t){if("number"===t)return this.numberTemplate}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(y.p))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-voucher-total-assets"]],viewQuery:function(t,i){if(1&t&&e.Gf(Le,5),2&t){let n;e.iGM(n=e.CRH())&&(i.numberTemplate=n.first)}},decls:4,vars:1,consts:[[1,"footer","flex-end"],[4,"ngFor","ngForOf"],["number",""],[1,"row","w-25"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"col-md-6"],["type","number",3,"disabled","ngModel","ngModelChange"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Ge,3,5,"ng-container",1),e.qZA(),e.YNc(2,ke,3,3,"ng-template",null,2,e.W1O)),2&t&&(e.xp6(1),e.Q6J("ngForOf",i.genericList))},dependencies:[m.sg,m.tP,f.Fj,f.wV,f.JJ,f.On],styles:[".footer[_ngcontent-%COMP%]{margin-right:1px;margin-bottom:2.8%;clear:both;padding-top:4px!important;border-top:1px solid #eaeaea;border-left:1px solid #eaeaea;border-right:1px solid #eaeaea;background-color:#e9ebf5}.flex-end[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end}.w-25[_ngcontent-%COMP%]{width:25%}span[_ngcontent-%COMP%]{font-size:14px}"]}),a})();var z=h(41544);const He=["genericHOSalesInvoiceGridTI"],qe=["genericsGridSAPPI"],Ve=["fileUploadPopup"];function Qe(a,c){if(1&a&&(e.ynx(0),e._uU(1),e.BQk()),2&a){const t=e.oxw(2);e.xp6(1),e.hij(" [FIXED ASSET - ",t._trnMainService.TrnMainObj.Mode,"] ")}}function Be(a,c){if(1&a&&e._uU(0),2&a){const t=e.oxw(2);e.hij(" [",t._trnMainService.TrnMainObj.Mode,"] ")}}function Ye(a,c){if(1&a&&(e.ynx(0),e.TgZ(1,"div",18)(2,"span")(3,"b"),e._uU(4,"PO Qty:"),e.qZA(),e._uU(5),e.qZA()(),e.TgZ(6,"div",23)(7,"span")(8,"b"),e._uU(9,"Rate:"),e.qZA(),e._uU(10),e.ALo(11,"currency"),e.qZA()(),e.BQk()),2&a){const t=e.oxw(2);e.xp6(5),e.AsE("\xa0",t._trnMainService.purchaseOrderQty," \xa0 ",t._trnMainService.produstWiseOrderUnit," "),e.xp6(5),e.hij("\xa0",e.Dn7(11,3,t._trnMainService.purchaseOrderRate,"INR","Rs. ")," ")}}function Ke(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"div",12),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",13)(5,"label",14),e._uU(6),e.YNc(7,Qe,2,1,"ng-container",15),e.YNc(8,Be,1,1,"ng-template",null,16,e.W1O),e.qZA(),e.TgZ(10,"div"),e._UZ(11,"voucher-sidebar-billdetail"),e.qZA()(),e.TgZ(12,"div",17),e.YNc(13,Ye,12,7,"ng-container",7),e.qZA(),e.TgZ(14,"div",18)(15,"voucher-master-action",19),e.NdJ("onLoadFromHoTaxInvoiceClickEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showSupplierSalesInvoiceFromHOPopup(n))})("onLoadFromSAPFTPClickEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showSAP_PO(n))})("onFileUploadPopupEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showPurchaseInvoicePopup(n))}),e.qZA(),e.TgZ(16,"generic-popup-grid",20,21),e.NdJ("onItemDoubleClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onHoSalesInvoiceSelect(n))}),e.qZA(),e.TgZ(18,"generic-popup-grid",20,22),e.NdJ("onItemDoubleClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onSAPPurchaseInvoiceSelect(n))}),e.qZA()()()()}if(2&a){const t=e.MAs(9),i=e.oxw();e.xp6(6),e.hij("",i._trnMainService.pageHeading," "),e.xp6(1),e.Q6J("ngIf","asset-purchase-invoice"===i._trnMainService.activeurlpath)("ngIfElse",t),e.xp6(6),e.Q6J("ngIf",0!=i.userSetting.PODELIVERYMODE&&i._trnMainService.TrnMainObj.REFORDBILL),e.xp6(3),e.Q6J("popupsettings",i.gridHoSalesInvoicePopupSettings),e.xp6(2),e.Q6J("popupsettings",i.gridSAPPIPopupSettings)}}function Je(a,c){1&a&&(e.TgZ(0,"div",29),e._UZ(1,"discounts-insert"),e.qZA())}function We(a,c){if(1&a&&(e.TgZ(0,"div",27),e.YNc(1,Je,2,0,"div",28),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",1==t.masterService.userSetting.GblBarcodeWiseBilling)}}function Xe(a,c){if(1&a&&(e.TgZ(0,"div",24)(1,"div",25),e._UZ(2,"trnmain-purchase-entry",26),e.qZA(),e.YNc(3,We,2,1,"div",5),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("hidden",!t.masterService.ShowMore),e.xp6(2),e.Q6J("ngIf","MIXED"!==t._trnMainService.TrnMainObj.INVOICETYPE&&"NONTRADING"!==t._trnMainService.TrnMainObj.INVOICETYPE)}}function $e(a,c){1&a&&(e.TgZ(0,"div",27)(1,"div",29),e._UZ(2,"purchase-type"),e.qZA()())}function ze(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"generic-product-entry",32),e.NdJ("ShowGenericGridEvent",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.showGenericGrid(n))})("showNonItemGenericGrid",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.showNonItemGenericGrid(n))}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("GenericProductEntrySetting",t.genericProductEntrySetting)}}function et(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"productentryLite",33),e.NdJ("onClickItemSelectPopUp",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onClickPoReferenceProduct(n))}),e.qZA()}}function tt(a,c){if(1&a&&(e.TgZ(0,"div",27)(1,"div",29),e.YNc(2,ze,1,1,"generic-product-entry",30),e.YNc(3,et,1,0,"productentryLite",31),e.qZA()()),2&a){const t=e.oxw();e.xp6(2),e.Q6J("ngIf","pro"==t._trnMainService.AppMode),e.xp6(1),e.Q6J("ngIf","lite"==t._trnMainService.AppMode)}}function it(a,c){1&a&&(e.ynx(0),e._UZ(1,"voucher-total-area"),e.BQk())}function nt(a,c){1&a&&e._UZ(0,"app-voucher-total-assets")}function rt(a,c){if(1&a&&(e.TgZ(0,"div",34),e.YNc(1,it,2,0,"ng-container",15),e.YNc(2,nt,1,0,"ng-template",null,35,e.W1O),e.qZA()),2&a){const t=e.MAs(3),i=e.oxw();e.xp6(1),e.Q6J("ngIf","add-purchase-invoice"==i._trnMainService.activeurlpath)("ngIfElse",t)}}function ot(a,c){if(1&a&&(e.TgZ(0,"tbody",44)(1,"tr",45)(2,"td",46),e._uU(3),e.qZA(),e.TgZ(4,"td",47),e._uU(5),e.qZA(),e.TgZ(6,"td",48),e._uU(7),e.qZA(),e.TgZ(8,"td",48),e._uU(9),e.qZA(),e.TgZ(10,"td",49),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"td",49),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"td",48),e._uU(17),e.qZA(),e.TgZ(18,"td",50),e._uU(19),e.qZA(),e.TgZ(20,"td",51),e._uU(21),e.ALo(22,"twoDigitNumber"),e.qZA(),e.TgZ(23,"td",50),e._uU(24),e.ALo(25,"twoDigitNumber"),e.qZA(),e.TgZ(26,"td",50),e._uU(27),e.ALo(28,"twoDigitNumber"),e.qZA(),e.TgZ(29,"td",50),e._uU(30),e.qZA(),e.TgZ(31,"td",50),e._uU(32),e.qZA(),e.TgZ(33,"td",50),e._uU(34),e.qZA(),e.TgZ(35,"td",50),e._uU(36),e.ALo(37,"twoDigitNumber"),e.qZA(),e.TgZ(38,"td",50),e._uU(39),e.ALo(40,"twoDigitNumber"),e.qZA(),e.TgZ(41,"td",50),e._uU(42),e.ALo(43,"twoDigitNumber"),e.qZA(),e.TgZ(44,"td",50),e._uU(45),e.ALo(46,"twoDigitNumber"),e.qZA(),e._UZ(47,"td",50),e.TgZ(48,"td",50),e._uU(49),e.ALo(50,"twoDigitNumber"),e.qZA(),e.TgZ(51,"td",49),e._uU(52),e.qZA()()()),2&a){const t=c.$implicit,i=c.index,n=e.oxw(2);e.xp6(2),e.MGl("id","sno",i,""),e.xp6(1),e.Oqu(i+1),e.xp6(2),e.hij(" ",t.MENUCODE," "),e.xp6(2),e.hij(" ",t.ITEMDESC," "),e.xp6(2),e.hij(" ",t.BATCH," "),e.xp6(2),e.hij("",e.xi3(12,21,t.MFGDATE,"dd-MM-yyyy")," "),e.xp6(3),e.hij("",e.xi3(15,24,t.EXPDATE,"dd-MM-yyyy")," "),e.xp6(3),e.hij(" ",n._trnMainService.TrnMainObj.TOTALQTY," "),e.xp6(2),e.hij(" ",t.ALTUNIT," "),e.xp6(2),e.hij(" ",e.lcZ(22,27,t.MRP),""),e.xp6(3),e.hij(" ",e.lcZ(25,29,t.ALTRATE2)," "),e.xp6(3),e.hij(" ",e.lcZ(28,31,t.ALTRATE)," "),e.xp6(3),e.hij(" ",t.INDDISCOUNTRATE," "),e.xp6(2),e.hij("",t.INDDISCOUNT," "),e.xp6(2),e.hij(" ",t.GSTRATE_ONLYFORSHOWING,""),e.xp6(2),e.hij(" ",e.lcZ(37,33,n._trnMainService.nullToZeroConverter(t.VAT)),""),e.xp6(3),e.hij(" ",e.lcZ(40,35,n._trnMainService.nullToZeroConverter(t.PrimaryDiscount)),""),e.xp6(3),e.hij(" ",e.lcZ(43,37,n._trnMainService.nullToZeroConverter(t.SecondaryDiscount)),""),e.xp6(3),e.hij(" ",e.lcZ(46,39,n._trnMainService.nullToZeroConverter(t.LiquiditionDiscount)),""),e.xp6(4),e.hij(" ",e.lcZ(50,41,n._trnMainService.nullToZeroConverter(t.NETAMOUNT)),""),e.xp6(3),e.hij("",t.REMARKS," ")}}function at(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"div",36)(2,"div")(3,"div")(4,"div")(5,"div",37)(6,"div",38)(7,"h3"),e._uU(8,"Sales Invoice"),e.qZA()(),e.TgZ(9,"div",38)(10,"h3"),e._uU(11),e.qZA()(),e.TgZ(12,"div",38)(13,"button",39),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.saveTaxInvoice())}),e._uU(14,"Save"),e.qZA(),e.TgZ(15,"button",39),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.popupClose())}),e._uU(16,"Cancel"),e.qZA()()(),e.TgZ(17,"div")(18,"div",40)(19,"table",41)(20,"tr",42)(21,"th"),e._uU(22,"S.No."),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Code"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Description"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"BatchNo "),e.qZA(),e.TgZ(29,"th"),e._uU(30),e.qZA(),e.TgZ(31,"th"),e._uU(32),e.qZA(),e.TgZ(33,"th"),e._uU(34,"Qty"),e.qZA(),e.TgZ(35,"th"),e._uU(36),e.qZA(),e.TgZ(37,"th"),e._uU(38,"MRP"),e.qZA(),e.TgZ(39,"th"),e._uU(40,"Cost Price"),e.qZA(),e.TgZ(41,"th"),e._uU(42,"Selling Price"),e.qZA(),e.TgZ(43,"th"),e._uU(44,"Disc %"),e.qZA(),e.TgZ(45,"th"),e._uU(46),e.qZA(),e.TgZ(47,"th"),e._uU(48),e.qZA(),e.TgZ(49,"th"),e._uU(50),e.qZA(),e.TgZ(51,"th"),e._uU(52,"P Dis."),e.qZA(),e.TgZ(53,"th"),e._uU(54,"S Dis."),e.qZA(),e.TgZ(55,"th"),e._uU(56,"L Dis."),e.qZA(),e.TgZ(57,"th"),e._uU(58,"OS Dis."),e.qZA(),e.TgZ(59,"th"),e._uU(60),e.qZA(),e.TgZ(61,"th"),e._uU(62,"Remarks"),e.qZA()(),e.YNc(63,ot,53,43,"tbody",43),e.qZA()()()()()()()()}if(2&a){const t=e.oxw();e.xp6(11),e.hij(" Ship To:-",t._trnMainService.TrnMainObj.AdditionalObj.SHIPNAMEVIEW," "),e.xp6(19),e.hij("",2==t.appType?"MFG Date":"Mfg Dt"," "),e.xp6(2),e.hij("",2==t.appType?"EXP Date":"Exp Dt"," "),e.xp6(4),e.Oqu(2==t.appType?"UOM":"Packing"),e.xp6(10),e.Oqu(2==t.appType?"Disc Amount":"Disc Amnt"),e.xp6(2),e.Oqu(2==t.appType?"VAT%":"GST%"),e.xp6(2),e.Oqu(2==t.appType?"VAT Amount":"GST TaxAmt"),e.xp6(10),e.Oqu(2==t.appType?"Net Amount":"Net Amnt"),e.xp6(3),e.Q6J("ngForOf",t._trnMainService.TrnMainObj.ProdList)}}function st(a,c){if(1&a&&(e.TgZ(0,"tr")(1,"td",73),e._uU(2),e.qZA(),e.TgZ(3,"td",74),e._uU(4),e.qZA(),e.TgZ(5,"td",75),e._uU(6),e.qZA()()),2&a){const t=c.$implicit,i=c.index;e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.ItemName),e.xp6(2),e.Oqu(t.Barcode)}}function ct(a,c){if(1&a&&(e.TgZ(0,"div",66)(1,"table",67)(2,"thead")(3,"tr",68)(4,"th",69),e._uU(5,"S.n"),e.qZA(),e.TgZ(6,"th",70),e._uU(7,"Item Name"),e.qZA(),e.TgZ(8,"th",71),e._uU(9,"Barcode"),e.qZA()()(),e.TgZ(10,"tbody"),e.YNc(11,st,7,3,"tr",72),e.qZA()()()),2&a){const t=e.oxw(2);e.xp6(11),e.Q6J("ngForOf",t.duplicateBarcodeList)}}function dt(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"div",52)(2,"div",53)(3,"div",54)(4,"h5",55),e._uU(5,"Duplicate Barcode List"),e.qZA(),e.TgZ(6,"button",56),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.closeGroupModal())}),e.TgZ(7,"span",57),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",58)(10,"div",59),e.YNc(11,ct,12,1,"div",60),e.qZA(),e.TgZ(12,"div",61)(13,"div",62)(14,"span",63)(15,"strong"),e._uU(16,"Note:"),e.qZA(),e._uU(17," Please recheck entry in excel and reupload the file by clicking on allow duplicate button for duplicate entry."),e.qZA()(),e.TgZ(18,"div",64)(19,"button",65),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.allowDuplicate())}),e._uU(20,"Allow Duplicate"),e.qZA()()()()()()()}if(2&a){const t=e.oxw();e.xp6(11),e.Q6J("ngIf",t.duplicateBarcodeList&&t.duplicateBarcodeList.length>0)}}function lt(a,c){if(1&a&&(e.TgZ(0,"tr")(1,"td",73),e._uU(2),e.qZA(),e.TgZ(3,"td",73),e._uU(4),e.qZA(),e.TgZ(5,"td",74),e._uU(6),e.qZA(),e.TgZ(7,"td",79),e._uU(8),e.qZA(),e.TgZ(9,"td",79),e._uU(10),e.qZA(),e.TgZ(11,"td",79),e._uU(12),e.qZA(),e.TgZ(13,"td",79),e._uU(14),e.qZA(),e.TgZ(15,"td",79),e._uU(16),e.qZA(),e.TgZ(17,"td",79),e._uU(18),e.qZA()()),2&a){const t=c.$implicit,i=c.index;e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.ItemCode),e.xp6(2),e.Oqu(t.ItemName),e.xp6(2),e.Oqu(t.Barcode),e.xp6(2),e.Oqu(t.BaseUnit),e.xp6(2),e.Oqu(t.OldMRP),e.xp6(2),e.Oqu(t.NewMRP),e.xp6(2),e.Oqu(t.OldPrate),e.xp6(2),e.Oqu(t.NewPrate)}}function ht(a,c){if(1&a&&(e.TgZ(0,"div",66)(1,"table",67)(2,"thead")(3,"tr",68)(4,"th",69),e._uU(5,"S.N"),e.qZA(),e.TgZ(6,"th",69),e._uU(7,"Item Code"),e.qZA(),e.TgZ(8,"th",70),e._uU(9,"Item Name"),e.qZA(),e.TgZ(10,"th",71),e._uU(11,"Barcode"),e.qZA(),e.TgZ(12,"th",71),e._uU(13,"Unit"),e.qZA(),e.TgZ(14,"th",71),e._uU(15,"Old MRP"),e.qZA(),e.TgZ(16,"th",71),e._uU(17,"New MRP"),e.qZA(),e.TgZ(18,"th",71),e._uU(19,"Old Prate"),e.qZA(),e.TgZ(20,"th",71),e._uU(21,"New Prate"),e.qZA()()(),e.TgZ(22,"tbody"),e.YNc(23,lt,19,9,"tr",72),e.qZA()()()),2&a){const t=e.oxw(2);e.xp6(23),e.Q6J("ngForOf",t.updatedDetailsList)}}function ut(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",76)(2,"div",77)(3,"div",54)(4,"h5",55),e._uU(5,"Updated Details"),e.qZA(),e.TgZ(6,"button",56),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.showUpdatedDetails=!1)}),e.TgZ(7,"span",57),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",58)(10,"div",59),e.YNc(11,ht,24,1,"div",60),e.qZA(),e.TgZ(12,"div",78)(13,"div",64)(14,"button",65),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.showUpdatedDetails=!1)}),e._uU(15,"OK"),e.qZA()()()()()(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(11),e.Q6J("ngIf",t.updatedDetailsList&&(null==t.updatedDetailsList?null:t.updatedDetailsList.length)>0)}}let ve=(()=>{class a{constructor(t,i,n,r,o,s,u,T,C,x,O,w,M){this.masterService=t,this._trnMainService=i,this.dialog=n,this.alertService=r,this.loadingSerive=o,this.authservice=s,this.router=u,this.route=T,this.genericProductEntryService=C,this.itemKeyEventService=x,this.quantityChangeEventService=O,this.entryValidateService=w,this.productHelperService=M,this.hideShow=!1,this.fileUploadPopupSettings=new I.s,this.gridHoSalesInvoicePopupSettings=new E.im,this.gridSAPPIPopupSettings=new E.im,this.disableView=!1,this.prefix={},this.activatedRoute={},this.userProfile={},this.showDuplicateBarcodeList=!1,this.duplicateBarcodeList=[],this.showUpdatedDetails=!1,this.userProfile=s.getUserProfile(),this.userSetting=this.authservice.getSetting(),this.appType=this.masterService.appType,this._trnMainService.urlpath=this.route.snapshot.url[0].path,this._trnMainService.initialFormLoad(3),this._trnMainService.TrnMainObj.CNDN_MODE="asset-purchase-invoice"===this._trnMainService.urlpath?5:0,t.Currencies=[],t.getCurrencies(),this.gridHoSalesInvoicePopupSettings={title:"Sales Invoices From Supplier",apiEndpoints:"/getAllHOTaxInvoicePagedList",defaultFilterIndex:0,columns:[{key:"CHALANNO",title:"Bill No",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"Date",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"Amount",hidden:!1,noSearch:!1}]},this.gridSAPPIPopupSettings={title:"Purchase Invoice From SAP",apiEndpoints:"/getAllSAPPurchaseInvoicePagedList",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"VOUCHER NO.",hidden:!1,noSearch:!1},{key:"PLANTDESC",title:"PLANT",hidden:!1,noSearch:!1},{key:"INVDATE",title:"INVOICE DATE",hidden:!1,noSearch:!1}]},this.route.queryParams.subscribe(A=>{"DRILL"!=A.mode&&(A.voucher&&(this.getSalesInvoiceFromSupplier(A.voucher,A.fromcompanyid,!0),this._trnMainService.fromNotification=A.fromNotification),A.status&&1==A.status&&(this._trnMainService.showPerformaApproveReject=!1))})}ngOnInit(){this.route.queryParams.subscribe(t=>{if("DRILL"==t.mode){let i=t.voucher,n=[];n=i.split("-"),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(i,n[1],n[2]).subscribe(r=>{"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.VoucherType=3,this._trnMainService.pageHeading="Purchase Invoice",this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.Mode="VIEW",this._trnMainService.TrnMainObj.TRNDATE=r.result.TRNDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.TRN_DATE=r.result.TRN_DATE.toString().substring(0,10),null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}),this._trnMainService.TrnMainObj.ProdList.forEach(o=>o.rowMode="VIEW"),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.conCatTradingAndNonTradingProdList())},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}else this.masterService.refreshTransactionList(),this._trnMainService.TrnMainObj.TRNMODE="credit",this.masterService.getPurchaseAcList().subscribe(n=>{this._trnMainService.PurchaseAcList.push(n)},n=>{this.masterService.resolveError(n,"trnmain-purchase-getPurchaseList")},()=>{0==this._trnMainService.AppSettings.MultiplePurchaseAccount&&(this._trnMainService.TrnMainObj.RETTO=this._trnMainService.AppSettings.PurchaseAc)}),this.masterService.getCashList().subscribe(n=>{this._trnMainService.CashList=n},n=>{this.masterService.resolveError(n,"trnmain-purchase-getCashList")}),this.fileUploadMethod("check")}),this.setProductEntryTable()}isAssetPurchaseInvoiceRoute(){return!!(this.router.url.includes("asset-purchase-invoice")||this.router.url.includes("add-purchase-invoice")&&0==this.userSetting.EnableServiceCharge)}fileUploadMethod(t){this.fileUploadPopupSettings=Object.assign(new I.s,{title:"Purchase Invoice",sampleFileUrl:`/downloadSampleExcelforMasterMigration?importName=${this._trnMainService.TrnMainObj.VoucherPrefix}`,departmentWiseVariant:!0,uploadDepartmentWiseVariant:!0,uploadEndpoints:`/importFileForTransaction/${this._trnMainService.TrnMainObj.VoucherPrefix}`,uploadEndpointsForVariant:`/excelImportPI/${t}`,allowMultiple:!1,acceptFormat:".xlsx",filename:"Purchase Invoice Sample"})}setProductEntryTable(){console.log("opagemenu",this._trnMainService.activeurlpath);let t="add-purchase-invoice"===this._trnMainService.activeurlpath?this._trnMainService.TrnMainObj.ProdList:this._trnMainService.TrnMainObj.AssetsProdList,i=this._trnMainService.activeurlpath;this.genericProductEntrySetting=new Y.Vn(this._trnMainService);var n=[{field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{width:"40px"}},{field:"MENUCODE",header:"Code",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"},onHover:r=>{this.genericProductEntryService.onHoverCode(r)},displayOnHoverCode:!0,disablePipe:(r,o)=>this.getColumnDisablePipe("disableAltQty",r,o)},{field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{width:"400px"},disablePipe:(r,o)=>this.getColumnDisablePipe("add-purchase-invoice"===i?"disableItemDesc":"disableAssetItemDesc",r,o),focusTo:"add-purchase-invoice"==i?"ALTUNIT":"REMARKS"},{field:"REMARKS",header:"Description",hidden:this.hideForAssesemanagement("PI"),isActiveColumnHeader:!0,inputType:"inputText",headerNgStyle:{width:"250px"},columnNgStyle:{width:"100%"},focusTo:"ACNAME",onEnter:(r,o,s,u)=>{this.entryValidateService.RemarksEnterCommand(r,o,s,u)},disablePipe:(r,o)=>this.getColumnDisablePipe("disableAssetItemDesc",r,o)},{field:"ACNAME",header:"Account",hidden:this.hideForAssesemanagement("PI"),inputType:"popup",placeholder:"Press ENTER to Select",isActiveColumnHeader:!0,headerNgStyle:{width:"250px"},disablePipe:(r,o)=>this.getColumnDisablePipe("disableAssetItemDesc",r,o)},{field:"SL_ACNAME",header:"Sub-Ledger",hidden:this.hideForAssesemanagement("PI"),isActiveColumnHeader:!0,inputType:"popup",placeholder:"Press ENTER to Select",headerNgStyle:{width:"250px"},focusTo:"ALTQTY_IN",disablePipe:(r,o)=>this.getColumnDisablePipe("disableSubLedger",r,o)},{field:"BATCH",header:"Batch",hidden:this.hide()||this.hideForAssesemanagement("assetPI"),isActiveColumnHeader:!0,inputType:"batch",headerNgStyle:{width:"80px"},disablePipe:(r,o)=>this.getColumnDisablePipe("add-purchase-invoice"===i?"disableBatch":"disableAssetItemDesc",r,o),onEnter:(r,o,s,u)=>{this.genericProductEntryService.BatchEnter(r,o,s,u)},onKeyPress:(r,o)=>{this.genericProductEntryService.onKeyDownBatch(r,o)}},{field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"add-purchase-invoice"==this._trnMainService.activeurlpath?"unitsOption":"",headerNgStyle:{width:"80px"},focusTo:"add-purchase-invoice"==this._trnMainService.activeurlpath?"ALTERNATEQUANTIY":"ALTQTY_IN",disablePipe:(r,o)=>this.getColumnDisablePipe("disableAltUnit",r,o),onEnter:(r,o,s,u)=>this.entryValidateService.AlternateUnitEnterEventClick(r,o,s,u)},{field:"add-purchase-invoice"==this._trnMainService.activeurlpath?"ALTERNATEQUANTIY":"ALTQTY_IN",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"ALTRATE",onChange:(r,o,s)=>this.QuantityChangeEvent_default(r,o,s),onEnter:(r,o,s,u)=>this.quantityChangeEventService.AlternateQuantityEventClick(o),onKeyPress:(r,o,s,u)=>this.quantityChangeEventService.quantityKeyPress(r,o,s,u),applyTwoDigitPipe:!1,disablePipe:(r,o)=>this.getColumnDisablePipe("add-purchase-invoice"===i?"disableAltQty":"disableAssetItemDesc",r,o),decimalPlacesRestriction:"3"},{field:"ALTRATE",header:"P.Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onEnter:(r,o,s)=>"asset-purchase-invoice"===i?this.entryValidateService.mrpEnterAssetPI(r,o,s):this.mrpEnterEvent(r,o,s),onChange:(r,o,s,u)=>"asset-purchase-invoice"===i?this.entryValidateService.mrpEnterAssetPI(u,s,o):this.entryValidateService.MRPChangeEvent(r,o,s,u),focusTo:"add-purchase-invoice"==this._trnMainService.activeurlpath?"INDDISCOUNTRATE":"DISRATE",disablePipe:(r,o)=>this.getColumnDisablePipe("add-purchase-invoice"===i?"disableRateandDiscount":"disableAssetItemDesc",r,o)},{field:"GROSSAMNT",header:"Amnt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"ECSAMOUNT",header:"ECS",hidden:!(1==this.userSetting.ENABLE_ECS||3==this.userSetting.ENABLE_ECS),inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},focusTo:"INDDISCOUNTRATE",onEnter:(r,o,s,u)=>this._trnMainService.ReCalculateBillWithNormal(),columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(r,o)=>this.getColumnDisablePipe("disableECSAmount",r,o),applyTwoDigitPipe:!0},{field:"INDDISCOUNTRATE",header:"Dis%",hidden:"add-purchase-invoice"!=i,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(r,o)=>this.getColumnDisablePipe("disableDiscountRate",r,o),applyTwoDigitPipe:!1,onEnter:(r,o,s)=>{this.genericProductEntryService.discRateEnterClicked(r,o,s),this.genericProductEntryService.IndDiscountRateChangeEvent(r,s,o)},onChange:(r,o,s)=>this.genericProductEntryService.IndDiscountRateChangeEvent(r,o,s),onModelChange:(r,o,s)=>this.genericProductEntryService.IndDiscountModelRateChange(r,o,s),decimalPlacesRestriction:"2",isReadOnly:(r,o)=>this.genericProductEntryService.isReadOnly(r,o)},{field:"DISRATE",header:"Dis%",hidden:"asset-purchase-invoice"!=i,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(r,o)=>this.getColumnDisablePipe("disableAssetItemDesc",r,o),applyTwoDigitPipe:!1,onEnter:(r,o,s)=>{this.genericProductEntryService.disRateEnter(r,o,s)},onChange:(r,o,s,u)=>this.genericProductEntryService.disRateChange(u,o,s),decimalPlacesRestriction:"2"},{field:"INDDISCOUNT",header:"Dis Amt",hidden:"add-purchase-invoice"!=i,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(r,o)=>this.getColumnDisablePipe("disableDiscountAmount",r,o),applyTwoDigitPipe:!0,onEnter:(r,o,s)=>{this.genericProductEntryService.discEnterClicked(r,o,s)},onChange:(r,o,s,u)=>this.genericProductEntryService.IndDiscountAmountChangeEvent(r,o,s,u),decimalPlacesRestriction:"2",isReadOnly:(r,o)=>this.genericProductEntryService.isReadOnly(r,o)},{field:"DISCOUNT",header:"Dis Amt",hidden:"asset-purchase-invoice"!=i,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(r,o)=>this.getColumnDisablePipe("disableAssetItemDesc",r,o),applyTwoDigitPipe:!0,onEnter:(r,o,s)=>{this.genericProductEntryService.disAmountChange(r,o,s)},onChange:(r,o,s,u)=>this.genericProductEntryService.disAmountChange(u,o,s),decimalPlacesRestriction:"2",focusTo:"UsefulLife"},{field:"DISCOUNT",header:"Total Disc",hidden:this.hideForAssesemanagement("assetPI"),isActiveColumnHeader:!0,headerNgStyle:{width:"70px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onHover:r=>{this.genericProductEntryService.onHover(r)},displayOnHover:!0},{field:"VAT",header:"VAT",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"CRATE",header:"Net Rate",hidden:this.hideForAssesemanagement("assetPI"),isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"MFGDATE",header:"Mfg Date",hidden:this.hideForAssesemanagement("assetPI"),inputType:"date",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right","font-size":"11px"},focusTo:"EXPDATE",applyTwoDigitPipe:!1,onEnter:(r,o,s)=>{this.genericProductEntryService.MFGDateEnterEvent(r,o,s)},onModelChange:(r,o,s,u)=>this.productHelperService.CalculateExpiryDate(u.MFGDATE,s,u),disablePipe:(r,o)=>this.getColumnDisablePipe("disableMfgDate",r,o)},{field:"EXPDATE",header:"Exp Date",hidden:this.hideForAssesemanagement("assetPI"),inputType:"date",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right","font-size":"11px"},applyTwoDigitPipe:!1,focusTo:"ITEMDESC",onEnter:(r,o,s)=>{this.genericProductEntryService.expDateEnterEvent(r,o,s)},disablePipe:(r,o)=>this.getColumnDisablePipe("disableExpDate",r,o)},{field:"ISVAT",header:"Is Vatable",hidden:this.isAssetPurchaseInvoiceRoute(),inputType:"checkBox",isActiveColumnHeader:!0,headerNgStyle:{width:"60px","text-align":"center"},columnNgStyle:{width:"28%","text-align":"right","font-size":"11px","margin-left":"22px"},applyTwoDigitPipe:!1,onClicked:(r,o,s,u)=>this.genericProductEntryService.isVatableInRow(r,o,s,u)},{field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(r,o)=>this.getColumnDisablePipe("disableRowDelete",r,o)}];this.genericProductEntrySetting.columns=n,this.genericProductEntrySetting.height="100%",this.genericProductEntrySetting.prodlist=t,this.genericProductEntrySetting.voucherType=b.Km.Purchase,this.genericProductEntrySetting.setRowItemFromSelectedItem=r=>this.SetRowItemFromSelectedItem(r),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(r,o=new Function)=>this.SetRowItemRate(r,o)}hide(){return 1==this._trnMainService.userSetting.EnableBatch&&0===this._trnMainService.userSetting.EnableProperExpTracking}hideForAssesemanagement(t){return"asset-purchase-invoice"===this._trnMainService.activeurlpath&&"assetPI"===t||"add-purchase-invoice"===this._trnMainService.activeurlpath&&"PI"===t}SetRowItemRate(t,i){i()}SetRowItemFromSelectedItem(t){let i=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];this._trnMainService.prepareItem(i,t),this._trnMainService.assignPrateaAsRATE(i,t)}SetAllUnitsOfItem(){this._trnMainService.getAllUnitsOfItem(this.genericProductEntryService.activerowIndex)}QuantityChangeEvent_default(t,i,n){this.quantityChangeEventService.QuantityChangeEvent(n)}getColumnDisablePipe(t,i,n){return t}mrpEnterEvent(t,i,n){this.entryValidateService.mrpEnterEvent(t,i,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}showGenericGrid(t){"asset-purchase-invoice"==this._trnMainService.activeurlpath?this.itemKeyEventService.ItemKeyEventForAsset(t.index,()=>{this.itemPopupSetting()}):this.itemKeyEventService.ItemkeyEvent(t.index,t.event,()=>(this.get_showStockedQuantityOnly(),p.K.done),i=>(this.setItemPopupUrl(i),p.K.default),()=>p.K.default,()=>p.K.default,()=>p.K.default)}setItemPopupUrl(t){return this.genericProductEntryService.gridPopupSettings={title:"PRODUCTS",apiEndpoints:`/getMenuitemWithStockPagedList/${t}/all/NO/${this._trnMainService.userProfile.userWarehouse}`,defaultFilterIndex:this._trnMainService.userSetting.DefaultFilterIndex?this._trnMainService.userSetting.DefaultFilterIndex:0,columns:[{key:"MENUCODE",title:"ITEM CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"DESCRIPTION",hidden:!1,noSearch:!1},{key:"GroupName",title:"GROUP NAME",hidden:!1,noSearch:!0},{key:"PSTOCK",title:"P-QTY",hidden:!0,noSearch:!0},{key:"ISSUEQTY",title:"ISSUE QTY",hidden:!0,noSearch:!0},{key:"CRATE",title:"NETRATE",hidden:!0,noSearch:!0},{key:"RATE",title:"S-RATE",hidden:!0,noSearch:!0},{key:"BASEUNIT",title:"UNIT",hidden:!0,noSearch:!0},{key:"STOCK",title:"STOCK",hidden:!1,noSearch:!0,alignment:"right"},{key:"REALQTY_IN",title:"Req.Order Qty",hidden:!0,noSearch:!0},{key:"REALQTY",title:"Sales-Qty",hidden:!0,noSearch:!0},{key:"POSTOCK",title:"PO QTY",hidden:!0,noSearch:!0,alignment:"right"},{key:"POSTOCK",title:"QT QTY",hidden:!0,noSearch:!0,alignment:"right"},{key:"OPSTOCK",title:"SO QTY",hidden:!0,noSearch:!0,alignment:"right"},{key:"RATE",title:"PORATE",hidden:!0,noSearch:!0,alignment:"right",pipe:!0},{key:"RATE",title:"SO RATE",hidden:!0,noSearch:!0,alignment:"right",pipe:!0},{key:"BARCODE",title:"BARCODE",hidden:!0,noSearch:!0},{key:"MRP",title:"MRP",hidden:!0,noSearch:!0,alignment:"right",pipe:!0}]},this.genericProductEntryService.gridPopupSettings}get_showStockedQuantityOnly(){return this.genericProductEntryService.showStockedQuantityOnly=0,this._trnMainService.TrnMainObj.VoucherType===b.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===b.Km.SalesOrder||this._trnMainService.TrnMainObj.VoucherType===b.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===b.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===b.Km.StockIssue||this._trnMainService.TrnMainObj.VoucherType===b.Km.Repack||this._trnMainService.TrnMainObj.VoucherType===b.Km.Quotation?(this.genericProductEntryService.showStockedQuantityOnly=1,this.genericProductEntryService.loadBarCodeWiseProduct=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BARCODE??""):this.genericProductEntryService.showStockedQuantityOnly=0,this.genericProductEntryService.showStockedQuantityOnly}itemKeyEvent_CheckRefBill(){{this.genericProductEntryService.showStockedQuantityOnly=0;let i,t="";null!=this._trnMainService.TrnMainObj.VoucherPrefix&&(t=this._trnMainService.TrnMainObj.VoucherPrefix);let n="";return n=this._trnMainService.TrnMainObj.MWAREHOUSE?this._trnMainService.TrnMainObj.MWAREHOUSE:this._trnMainService.userProfile.userWarehouse,i=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BC,(0==this._trnMainService.userSetting.GblBarcodeWiseBilling||null==i||void 0===i||""==i)&&(i="A"),this.genericProductEntryService.gridPopupSettings.apiEndpoints=`/getMenuitemWithStockPagedList/${this.genericProductEntryService.showStockedQuantityOnly}/${i}/all/${t}/${n}`,this._trnMainService.itemselectevent=!0,this.genericProductEntryService.genericGrid.show(this._trnMainService.TrnMainObj.REFBILL),!1}}itemKeyEvent_CheckFlatDiscount(){if(this._trnMainService.TrnMainObj.VoucherType===b.Km.Purchase&&(this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT)>0||this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.DCRATE)>0))return this.alertService.info("Flat Discount is already given could not add new product"),!0}showPurchaseInvoicePopup(){null!=this._trnMainService.TrnMainObj.PARAC&&""!=this._trnMainService.TrnMainObj.PARAC?this.fileUploadPopup.show():this.alertService.warning("Please select the supplier...")}onClickPoReferenceProduct(t){t&&(this._trnMainService.purchaseOrderQty=t.ALTERNATEQTY,this._trnMainService.purchaseOrderRate=t.RATE,this._trnMainService.produstWiseOrderUnit=t.BASEUNIT)}fileUploadSuccess(t){if(console.log("upresult",t),"ok"==t.status){"Duplicate Barcode found in excel file! Do you want to continue?"==t.message||"Duplicate Barcode found in system! Do you want to continue?"==t.message?(this.duplicateBarcodeList=t.result,confirm(t.message)&&(this.closeFileUploaderPopup(),this.showDuplicateBarcodeList=!0)):this._trnMainService.TrnMainObj.ProdList=t.result,"Price List"==t.message&&(this.showUpdatedDetails=!0,this.updatedDetailsList=t.result2,this.fileUploadMethod("check")),this._trnMainService.TrnMainObj.tag="FROMEXCEL";for(let i in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.setAltunitDropDownForView(i),this._trnMainService.TrnMainObj.ProdList[i].REALRATE=this._trnMainService.TrnMainObj.ProdList[i].ALTRATE/this._trnMainService.TrnMainObj.ProdList[i].ALTCONFACTOR,this._trnMainService.TrnMainObj.ProdList[i].RATE=this._trnMainService.TrnMainObj.ProdList[i].ALTRATE/this._trnMainService.TrnMainObj.ProdList[i].ALTCONFACTOR,this._trnMainService.TrnMainObj.ProdList[i].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[i].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[i].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[i].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[i].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[i].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[i].OtherDiscount=this._trnMainService.TrnMainObj.ProdList[i].INDODAMT;this._trnMainService.prePareVariantDescription(),this._trnMainService.ReCalculateBillWithNormal(),this.loadingSerive.hide()}else this.loadingSerive.hide(),this.alertService.error(t.result.error)}closeGroupModal(){this.showDuplicateBarcodeList=!1}closeFileUploaderPopup(){this.fileUploadPopup.hide()}showSupplierSalesInvoiceFromHOPopup(){this.genericHOSalesInvoiceGridTI.show()}onHoSalesInvoiceSelect(t){this.getSalesInvoiceFromSupplier(t.VCHRNO,t.FROMCOMPANY),this.markAsRead(t)}markAsRead(t){this.redirectToBestRoute(t),!t.ISSEEN&&this.masterService.markAsRead(t.ID).subscribe(i=>{},i=>{})}redirectToBestRoute(t){}getSalesInvoiceFromSupplier(t,i,n=!1){this.loadingSerive.show("Getting Data. Please Wait..."),this.masterService.loadSalesInvoiceFromSupplierHO(t,i).subscribe(r=>{if(this.loadingSerive.hide(),"ok"==r.status){if(this._trnMainService.TrnMainObj=r.result,this._trnMainService.disableAllFieldinPurchase=!0,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;const o=h(67816);this._trnMainService.TrnMainObj.guid=o(),this._trnMainService.TrnMainObj.VoucherType=3,this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.VoucherAbbName="PI",this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.REFBILL=t,this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="",this._trnMainService.TrnMainObj.DIVISION=this.userProfile.userDivision,this._trnMainService.TrnMainObj.PhiscalID=this.userProfile.CompanyInfo.PhiscalID,n&&(this._trnMainService.TrnMainObj.INVOICETYPE="FROMNOTIFICATION");for(let s in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[s].inputMode=!1,this._trnMainService.TrnMainObj.ProdList[s].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[s].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[s].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[s].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[s].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[s].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[s].VARIANTDESCA=this._trnMainService.getVariantDescriptionFromList(this._trnMainService.TrnMainObj.ProdList[s]);this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate()}},r=>{this.loadingSerive.hide()})}showSAPPurchaseInvoice(){this.genericsGridSAPPI.show()}onSAPPurchaseInvoiceSelect(t){this.disableView=!0,this.loadSAPPurchaseInvoice(t.VCHRNO)}loadSAPPurchaseInvoice(t){this.loadingSerive.show("Getting Data. Please Wait..."),this.masterService.loadSAPPurchaseInvoiceDetail(t).subscribe(i=>{if(this.loadingSerive.hide(),"ok"==i.status){if(this._trnMainService.TrnMainObj=i.result,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherType=3,this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.VoucherAbbName="PI",this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.REFBILL=t,this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="",this._trnMainService.TrnMainObj.tag="FTP";for(let n in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[n].inputMode=!1,this._trnMainService.setAltunitDropDownForView(n),this._trnMainService.AssignSellingPriceAndDiscounts(this._trnMainService.TrnMainObj.ProdList[n].PClist,n),this._trnMainService.TrnMainObj.ProdList[n].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[n].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[n].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[n].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[n].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[n].EXPDATE.toString().substring(0,10);this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate()}else this.loadingSerive.hide(),this.alertService.error(i.result._body)},i=>{this.loadingSerive.hide()})}saveTaxInvoice(){this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.tag="shipto",this.alertService.show(),this.masterService.saveTransaction(this._trnMainService.TrnMainObj.Mode,this._trnMainService.TrnMainObj).subscribe(t=>{"ok"==t.status&&(this.alertService.hide(),this.popupClose())},t=>{this.alertService.error(t)})}showNonItemGenericGrid(t){console.log("k event aaucha",t),this.genericProductEntryService.NonProductPopupSelectEvent(()=>this.popUpSetting(t))}popUpSetting(t){this.genericProductEntryService.gridPopupSettings="Account"===t.col.header?{title:"Accounts",apiEndpoints:"/getNonTradingAccountpagedlist/fixed-assets",defaultFilterIndex:1,columns:[{key:"ACID",title:"AC CODE",hidden:!1,noSearch:!1},{key:"ACNAME",title:"A/C NAME",hidden:!1,noSearch:!1}]}:{title:"Sub Ledger Accounts",apiEndpoints:"/getTDSAccountPagedListWithSubLedger",defaultFilterIndex:1,columns:[{key:"SL_ACID",title:"AC CODE",hidden:!1,noSearch:!1},{key:"SL_ACNAME",title:"A/C NAME",hidden:!1,noSearch:!1}]}}itemPopupSetting(){this.genericProductEntryService.gridPopupSettings={title:"Product List",apiEndpoints:"/getAssetsMenuitemPagedList",defaultFilterIndex:1,columns:[{key:"MENUCODE",title:"ITEM CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"DESCRIPTION",hidden:!1,noSearch:!1}]}}popupClose(){this._trnMainService.initialFormLoad(3)}allowDuplicate(){this.showDuplicateBarcodeList=!1,this.fileUploadPopup.show(),this.fileUploadMethod("uncheck"),this.duplicateBarcodeList=[]}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(j.P),e.Y36(y.p),e.Y36(ee.uw),e.Y36(G.c),e.Y36(F.V),e.Y36(H.e),e.Y36(N.F0),e.Y36(N.gz),e.Y36(R.w),e.Y36(p.X),e.Y36(Z.s),e.Y36(D.C),e.Y36(K.h))},a.\u0275cmp=e.Xpm({type:a,selectors:[["addpurchaseinvoice"]],viewQuery:function(t,i){if(1&t&&(e.Gf(He,5),e.Gf(qe,5),e.Gf(Ve,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.genericHOSalesInvoiceGridTI=n.first),e.iGM(n=e.CRH())&&(i.genericsGridSAPPI=n.first),e.iGM(n=e.CRH())&&(i.fileUploadPopup=n.first)}},features:[e._Bn([y.p,D.C,p.X,R.w,Z.s,K.h])],decls:13,vars:9,consts:[[1,"sectionWrapper"],[1,"topWrapper"],["class","sticky-top","style","padding-bottom: 1px;",4,"ngIf"],["class","main-container",4,"ngIf"],[1,"midTableWrapper"],["class","row row-margin",4,"ngIf"],["class","footer-wrapper",4,"ngIf"],[4,"ngIf"],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],[1,"sticky-top",2,"padding-bottom","1px"],[1,"row","clearfix"],[1,"col-md-1","pd0"],[1,"col-md-3","pd0"],[1,"heading"],[4,"ngIf","ngIfElse"],["purchaseInvoice",""],[1,"col-md-3","row","header-details"],[1,"col-md-5","pd0"],[3,"onLoadFromHoTaxInvoiceClickEmit","onLoadFromSAPFTPClickEmit","onFileUploadPopupEmit"],[3,"popupsettings","onItemDoubleClick"],["genericHOSalesInvoiceGridTI",""],["genericsGridSAPPI",""],[1,"col-md-6","pd0"],[1,"main-container"],[3,"hidden"],["viewDisable","disableView"],[1,"row","row-margin"],["class","col-md-12 pd5",4,"ngIf"],[1,"col-md-12","pd5"],[3,"GenericProductEntrySetting","ShowGenericGridEvent","showNonItemGenericGrid",4,"ngIf"],[3,"onClickItemSelectPopUp",4,"ngIf"],[3,"GenericProductEntrySetting","ShowGenericGridEvent","showNonItemGenericGrid"],[3,"onClickItemSelectPopUp"],[1,"footer-wrapper"],["assetTotal",""],[1,"modal-style"],[2,"padding","0px","background","#c0c0c0"],[1,"col-md-3"],[1,"btn","btn-info",3,"click"],[2,"background-color","#FFFFFF","height","450px","overflow-x","scroll","width","100%"],[1,"table",2,"margin-bottom","5px","font-size","12.5px","width","2000px","overflow","scroll"],[2,"border-bottom","2px solid #E6E6E6","border-top","2px solid #E6E6E6","height","30px","background","silver","color","black"],["style","border: 1px",4,"ngFor","ngForOf"],[2,"border","1px"],[2,"border","1px solid #e6e6e6","max-height","25px"],[2,"border","1px solid #e6e6e6","width","20px",3,"id"],[2,"height","23px","border","1px solid #e6e6e6","width","80px"],[2,"border","1px solid #e6e6e6","width","300px","background-color","#f9f9f9"],[2,"height","23px","border","1px solid #e6e6e6","width","150px"],[2,"height","23px","border","1px solid #e6e6e6","width","100px"],[2,"height","23px","border","1px solid #e6e6e6","width","100px","background-color","#f9f9f9"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","20px","margin-right","8rem","width","70%"],[1,"modal-content","modal-content-main-area",2,"width","75%","height","85%"],[1,"modal-header",2,"padding","0px","background","#c0c0c0"],[1,"modal-title",2,"padding-left","5px"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group","row",2,"margin","0.5rem","overflow-y","scroll"],["class","row","style","width: 100%; height: 360px",4,"ngIf"],[1,"modal-footer",2,"position","absolute","bottom","0","background","white"],[1,"col-9"],[2,"font-size","12px"],[1,"col"],["type","submit",1,"btn","btn-sm","btn-info",2,"font-size","12px","margin-right","20px","float","right",3,"click"],[1,"row",2,"width","100%","height","360px"],[1,"table","table-sm","table-striped"],[2,"position","sticky","top","0","line-height","1rem","background","white"],["scope","col",2,"width","7%"],["scope","col",2,"width","50%"],["scope","col",2,"width","15%","text-align","right"],[4,"ngFor","ngForOf"],[2,"width","7%","text-align","center"],[2,"width","50%","text-align","center"],[2,"width","50%","text-align","right"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","20px","margin-right","8rem","width","82%"],[1,"modal-content","modal-content-main-area",2,"width","100%","height","85%"],[1,"modal-footer",2,"position","absolute","bottom","0","right","0","background","white"],[2,"width","15%","text-align","right"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Ke,20,6,"div",2),e.YNc(3,Xe,4,2,"div",3),e.qZA(),e.TgZ(4,"div",4),e.YNc(5,$e,3,0,"div",5),e.YNc(6,tt,4,2,"div",5),e.qZA(),e.YNc(7,rt,4,2,"div",6),e.qZA(),e.YNc(8,at,64,9,"div",7),e.TgZ(9,"file-uploader-popup",8,9),e.NdJ("onUploaded",function(r){return i.fileUploadSuccess(r)}),e.qZA(),e.YNc(11,dt,21,1,"div",7),e.YNc(12,ut,16,1,"ng-container",7)),2&t&&(e.xp6(2),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(2),e.Q6J("ngIf",("MIXED"===i._trnMainService.TrnMainObj.INVOICETYPE||"NONTRADING"===i._trnMainService.TrnMainObj.INVOICETYPE)&&"add-purchase-invoice"===i._trnMainService.activeurlpath),e.xp6(1),e.Q6J("ngIf","add-purchase-invoice"===i._trnMainService.activeurlpath&&"MIXED"!==i._trnMainService.TrnMainObj.INVOICETYPE&&"NONTRADING"!==i._trnMainService.TrnMainObj.INVOICETYPE||"asset-purchase-invoice"===i._trnMainService.activeurlpath),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName&&"MIXED"!==i._trnMainService.TrnMainObj.INVOICETYPE),e.xp6(1),e.Q6J("ngIf",i._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("popupsettings",i.fileUploadPopupSettings),e.xp6(2),e.Q6J("ngIf",i.showDuplicateBarcodeList),e.xp6(1),e.Q6J("ngIf",i.showUpdatedDetails))},dependencies:[J.v,W.q,X.i,q.u,$.d,I.U,m.sg,m.O5,E.Zl,ie.o,ge,_e.j,Fe,z.Z,m.H9,m.uU,ne.g],styles:[".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center;vertical-align:middle}.heading[_ngcontent-%COMP%]{white-space:nowrap;margin-left:-33px;margin-bottom:8px;margin-top:-3px;font-family:Segoe UI Light;font-weight:700;font-size:20px;padding-left:4%;width:192px}.header-details[_ngcontent-%COMP%]{padding-top:.8vh;font-size:15px;font-style:italic;padding-left:0;padding-right:0}.modal-style[_ngcontent-%COMP%]{display:block;left:10px;padding:0;top:101px;width:99%}"]}),a})();const pt=["fileUploadPopup"];function gt(a,c){1&a&&(e.TgZ(0,"div",18),e._UZ(1,"discounts-insert"),e.qZA())}function _t(a,c){if(1&a&&(e.TgZ(0,"div",16),e.YNc(1,gt,2,0,"div",17),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",1==t.masterService.userSetting.GblBarcodeWiseBilling)}}function vt(a,c){1&a&&(e.TgZ(0,"div",16)(1,"div",18),e._UZ(2,"purchase-type"),e.qZA()())}function St(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"generic-product-entry",21),e.NdJ("ShowGenericGridEvent",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.showGenericGrid(n))}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("GenericProductEntrySetting",t.genericProductEntrySetting)}}function Tt(a,c){1&a&&e._UZ(0,"productentryLite")}function mt(a,c){if(1&a&&(e.TgZ(0,"div",16)(1,"div",18),e.YNc(2,St,1,1,"generic-product-entry",19),e.YNc(3,Tt,1,0,"productentryLite",20),e.qZA()()),2&a){const t=e.oxw();e.xp6(2),e.Q6J("ngIf","pro"==t._trnMainService.AppMode),e.xp6(1),e.Q6J("ngIf","lite"==t._trnMainService.AppMode)}}function Mt(a,c){1&a&&(e.TgZ(0,"div",22),e._UZ(1,"voucher-total-area"),e.qZA())}let Pt=(()=>{class a{constructor(t,i,n,r,o,s,u,T,C,x){this.masterService=t,this._trnMainService=i,this.authService=n,this.loadingSerive=r,this.alertService=o,this.route=s,this.genericProductEntryService=u,this.itemKeyEventService=T,this.quantityChangeEventService=C,this.entryValidateService=x,this.prefix={},this.printCopyCaption="",this.checkstatus=!0,this.fileUploadPopupSettings=new I.s,this._trnMainService.initialFormLoad(16),this._trnMainService.pageHeading="DEBIT NOTE (PURCHASE RETURN)",this.userSetting=this.authService.getSetting()}ngOnInit(){this.route.queryParams.subscribe(t=>{if("DRILL"==t.mode){let i=t.voucher,n=[];n=i.split("-"),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(i,n[1],n[2]).subscribe(r=>{"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.VoucherType=16,this._trnMainService.pageHeading="Debit Note",this._trnMainService.TrnMainObj.VoucherPrefix="DN",this._trnMainService.TrnMainObj.Mode="VIEW",null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}),this._trnMainService.TrnMainObj.ProdList.forEach(o=>o.rowMode="VIEW"),this._trnMainService.ReCalculateBillWithNormal())},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}}),this.fileUploadPopupSettings=Object.assign(new I.s,{title:"Purchase Return",sampleFileUrl:`/downloadSampleExcelforMasterMigration?importName=${this._trnMainService.TrnMainObj.VoucherPrefix}`,uploadEndpoints:`/importFileForTransaction/${this._trnMainService.TrnMainObj.VoucherPrefix}`,allowMultiple:!1,acceptFormat:".xlsx",filename:"Purchase Return Sample"}),this.setProductEntryTable()}setProductEntryTable(){var t=this._trnMainService.TrnMainObj.ProdList;this.genericProductEntrySetting=new Y.Vn(this._trnMainService),this.genericProductEntrySetting.columns=[{field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{width:"40px"}},{field:"MENUCODE",header:"Code",hidden:!0,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"}},{field:"BC",header:"Barcode",hidden:!1,inputType:"barcodeInputText",isActiveColumnHeader:!0,headerNgStyle:{width:"10%"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableBarcodeField",n,r),focusTo:"ITEMDESC"},{field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{width:"400px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableItemDesc",n,r),focusTo:"ALTUNIT"},{field:"BATCH",header:"Batch",hidden:!1,isActiveColumnHeader:!0,inputType:"batch",headerNgStyle:{width:"80px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableBatch",n,r),onEnter:(n,r,o,s)=>{this.genericProductEntryService.BatchEnter(n,r,o,s)},onKeyPress:(n,r)=>{this.genericProductEntryService.onKeyDownBatch(n,r)}},{field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"unitsOption",headerNgStyle:{width:"80px"},focusTo:"ALTERNATEQUANTIY",disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltUnit",n,r),onEnter:(n,r,o,s)=>this.entryValidateService.AlternateUnitEnterEventClick(n,r,o,s)},{field:"ALTERNATEQUANTIY",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"ALTRATE",onChange:(n,r,o)=>this.QuantityChangeEvent_default(n,r,o),onEnter:(n,r,o,s)=>this.quantityChangeEventService.AlternateQuantityEventClick(r),onKeyPress:(n,r,o,s)=>this.quantityChangeEventService.quantityKeyPress(n,r,o,s),applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r),decimalPlacesRestriction:"3"},{field:"ALTRATE",header:"P.Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onEnter:(n,r,o)=>this.mrpEnterEvent(n,r,o),onChange:(n,r,o,s)=>this.entryValidateService.MRPChangeEvent(n,r,o,s),focusTo:1==this.userSetting.ENABLE_ECS||3==this.userSetting.ENABLE_ECS?"ECSAMOUNT":"INDDISCOUNTRATE",disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltRate",n,r)},{field:"GROSSAMNT",header:"Amnt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"ECSAMOUNT",header:"ECS",hidden:!(1==this.userSetting.ENABLE_ECS||3==this.userSetting.ENABLE_ECS),inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},focusTo:"INDDISCOUNTRATE",disablePipe:(n,r)=>this.getColumnDisablePipe("disableECSAmount",n,r),onEnter:(n,r,o,s)=>this._trnMainService.ReCalculateBillWithNormal(),onChange:(n,r,o)=>this._trnMainService.ReCalculateBillWithNormal(),columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"INDDISCOUNTRATE",header:"Dis%",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountRate",n,r),applyTwoDigitPipe:!1,onEnter:(n,r,o)=>{this.genericProductEntryService.discRateEnterClicked(n,r,o),this.genericProductEntryService.IndDiscountRateChangeEvent(n,o,r)},onChange:(n,r,o)=>this.genericProductEntryService.IndDiscountRateChangeEvent(n,r,o),onModelChange:(n,r,o)=>this.genericProductEntryService.IndDiscountModelRateChange(n,r,o),focusTo:"INDDISCOUNT",decimalPlacesRestriction:"2"},{field:"INDDISCOUNT",header:"Dis Amt",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountAmount",n,r),applyTwoDigitPipe:!0,onEnter:(n,r,o)=>{this.genericProductEntryService.discEnterClicked(n,r,o)},onChange:(n,r,o,s)=>this.genericProductEntryService.IndDiscountAmountChangeEvent(n,r,o,s),focusTo:"ITEMDESC",decimalPlacesRestriction:"2"},{field:"DISCOUNT",header:"Total Disc",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"70px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onHover:n=>{this.genericProductEntryService.onHover(n)},displayOnHover:!0},{field:"VAT",header:"VAT",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"CRATE",header:"Net Rate",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"MFGDATE",header:"Mfg Date",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"6%"},columnNgStyle:{width:"100%","text-align":"right","font-size":"11px"},applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableMfgDate",n,r)},{field:"EXPDATE",header:"Exp Date",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"6%"},columnNgStyle:{width:"100%","text-align":"right","font-size":"11px"},applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableExpDate",n,r)},{field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"}}],this.genericProductEntrySetting.height="100%",this.genericProductEntrySetting.prodlist=t,this.genericProductEntrySetting.voucherType=b.Km.Purchase,this.genericProductEntrySetting.setRowItemFromSelectedItem=n=>this.SetRowItemFromSelectedItem(n),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(n,r=new Function)=>this.SetRowItemRate(n,r)}SetRowItemRate(t,i){i()}mrpEnterEvent(t,i,n){this.entryValidateService.mrpEnterEvent(t,i,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}SetRowItemFromSelectedItem(t){let i=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];this._trnMainService.prepareItem(i,t),this._trnMainService.assignPrateaAsRATE(i,t)}SetAllUnitsOfItem(){this._trnMainService.getAllUnitsOfItem(this.genericProductEntryService.activerowIndex)}getColumnDisablePipe(t,i,n){return t}QuantityChangeEvent_default(t,i,n){this.quantityChangeEventService.QuantityChangeEvent(n)}showGenericGrid(t){this.itemKeyEventService.ItemkeyEvent(t.index,t.event,()=>p.K.done,i=>p.K.default,()=>p.K.default,()=>p.K.default,()=>p.K.default)}itemKeyEvent_CheckRefBill(){{this.genericProductEntryService.showStockedQuantityOnly=0;let i,t="";null!=this._trnMainService.TrnMainObj.VoucherPrefix&&(t=this._trnMainService.TrnMainObj.VoucherPrefix);let n="";return n=this._trnMainService.TrnMainObj.MWAREHOUSE?this._trnMainService.TrnMainObj.MWAREHOUSE:this._trnMainService.userProfile.userWarehouse,i=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BC,(0==this._trnMainService.userSetting.GblBarcodeWiseBilling||null==i||void 0===i||""==i)&&(i="A"),this.genericProductEntryService.gridPopupSettings.apiEndpoints=`/getMenuitemWithStockPagedList/${this.genericProductEntryService.showStockedQuantityOnly}/${i}/all/${t}/${n}`,this._trnMainService.itemselectevent=!0,this.genericProductEntryService.genericGrid.show(this._trnMainService.TrnMainObj.REFBILL),!1}}printIt(){clearInterval(this.myTimer);try{let t,i;t=document.getElementById("InvoiceNewPrint").innerHTML,i=window.open("","_blank","top=0,left=0,height=1000px,width=1500px"),i.document.write(`\n          <html>\n              <head>                  \n                  <style>\n                      .InvoiceHeader{\n                text-align:center;\n                font-weight:bold\n            }\n            p\n            {\n                height:5px;\n            }\n            table{\n                margin:5px\n            }\n            .summaryTable{\n                float: right;\n                border: none;\n            }\n\n            .summaryTable  td{\n                text-align:right;\n                border:none;\n            }\n\n            .itemtable{\n                border: 1px solid black;\n                border-collapse: collapse;\n            }\n            .itemtable th{                \n                height:30px;\n                font-weight:bold;\n            }\n            .itemtable th, td {               \n                border: 1px solid black;\n                padding:2px;\n\n            }\n                  </style>\n              </head>\n              <body onload="window.print();window.close()">${t}\n              </body>\n          </html>`),i.document.close()}catch{}}showPurchaseInvoicePopup(t){null!=this._trnMainService.TrnMainObj.BILLTOADD&&""!=this._trnMainService.TrnMainObj.BILLTOADD?this.fileUploadPopup.show():this.alertService.warning("Please select the supplier...")}fileUploadSuccess(t){if("ok"==t.status){if(this._trnMainService.TrnMainObj.ProdList=t.result,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherType=16,this._trnMainService.TrnMainObj.VoucherPrefix="DN",this._trnMainService.TrnMainObj.VoucherAbbName="DN",this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="";for(let i of this._trnMainService.TrnMainObj.ProdList)i.MFGDATE=null==i.MFGDATE?"":i.MFGDATE.toString().substring(0,10),i.EXPDATE=null==i.EXPDATE?"":i.EXPDATE.toString().substring(0,10),i.REALRATE=i.ALTRATE/i.ALTCONFACTOR,i.RATE=i.ALTRATE/i.ALTCONFACTOR;console.log("prodlist",this._trnMainService.TrnMainObj.ProdList),this._trnMainService.ReCalculateBillWithNormal()}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(j.P),e.Y36(y.p),e.Y36(H.e),e.Y36(F.V),e.Y36(G.c),e.Y36(N.gz),e.Y36(R.w),e.Y36(p.X),e.Y36(Z.s),e.Y36(D.C))},a.\u0275cmp=e.Xpm({type:a,selectors:[["debitnote-itembase"]],viewQuery:function(t,i){if(1&t&&e.Gf(pt,5),2&t){let n;e.iGM(n=e.CRH())&&(i.fileUploadPopup=n.first)}},features:[e._Bn([y.p,D.C,p.X,R.w,Z.s])],decls:23,vars:8,consts:[[1,"sectionWrapper"],[1,"topWrapper"],[1,"sticky-top",2,"padding-bottom","1px"],[1,"row","clearfix",2,"margin-right","0"],[1,"col-md-2","pd0"],[1,"col-md-3","pd0"],[2,"white-space","nowrap","margin-left","-144px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-7"],[3,"onFileUploadPopupEmit"],[1,"main-container"],[3,"hidden"],["class","row row-margin",4,"ngIf"],[1,"midTableWrapper"],["class","footer-wrapper",4,"ngIf"],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],[1,"row","row-margin"],["class","col-md-12 pd5",4,"ngIf"],[1,"col-md-12","pd5"],[3,"GenericProductEntrySetting","ShowGenericGridEvent",4,"ngIf"],[4,"ngIf"],[3,"GenericProductEntrySetting","ShowGenericGridEvent"],[1,"footer-wrapper"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"voucher-master-toggler"),e.qZA(),e.TgZ(6,"div",5)(7,"label",6),e._uU(8),e.qZA(),e.TgZ(9,"div"),e._UZ(10,"voucher-sidebar-billdetail"),e.qZA()(),e.TgZ(11,"div",7)(12,"voucher-master-action",8),e.NdJ("onFileUploadPopupEmit",function(r){return i.showPurchaseInvoicePopup(r)}),e.qZA()()()(),e.TgZ(13,"div",9)(14,"div",10),e._UZ(15,"trnmain-purchase-entry"),e.qZA(),e.YNc(16,_t,2,1,"div",11),e.qZA()(),e.TgZ(17,"div",12),e.YNc(18,vt,3,0,"div",11),e.YNc(19,mt,4,2,"div",11),e.qZA(),e.YNc(20,Mt,2,0,"div",13),e.qZA(),e.TgZ(21,"file-uploader-popup",14,15),e.NdJ("onUploaded",function(r){return i.fileUploadSuccess(r)}),e.qZA()),2&t&&(e.xp6(8),e.AsE("",i._trnMainService.pageHeading," [",i._trnMainService.TrnMainObj.Mode,"]"),e.xp6(6),e.Q6J("hidden",!i.masterService.ShowMore),e.xp6(2),e.Q6J("ngIf","MIXED"!==i._trnMainService.TrnMainObj.INVOICETYPE&&"NONTRADING"!==i._trnMainService.TrnMainObj.INVOICETYPE),e.xp6(2),e.Q6J("ngIf","MIXED"===i._trnMainService.TrnMainObj.INVOICETYPE||"NONTRADING"===i._trnMainService.TrnMainObj.INVOICETYPE),e.xp6(1),e.Q6J("ngIf","MIXED"!==i._trnMainService.TrnMainObj.INVOICETYPE&&"NONTRADING"!==i._trnMainService.TrnMainObj.INVOICETYPE),e.xp6(1),e.Q6J("ngIf","MIXED"!==i._trnMainService.TrnMainObj.INVOICETYPE),e.xp6(1),e.Q6J("popupsettings",i.fileUploadPopupSettings))},dependencies:[J.v,W.q,X.i,q.u,$.d,I.U,m.O5,ie.o,ge,_e.j,z.Z],encapsulation:2}),a})();const bt=["#genericHOSalesInvoiceGridTI"],At=["genericsGridSAPPI"],ft=["fileUploadPopup"];function Ct(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12)(2,"div",13),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",14)(5,"label",15),e._uU(6),e.qZA(),e.TgZ(7,"div"),e._UZ(8,"voucher-sidebar-billdetail"),e.qZA()(),e.TgZ(9,"div",16)(10,"voucher-master-action",17),e.NdJ("onLoadFromHoTaxInvoiceClickEmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.PopupForExcelUploadPO())})("onLoadFromSAPFTPClickEmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.showSAPPurchaseInvoice())})("onFileUploadPopupEmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.showPopupPO())}),e.qZA()()()()}if(2&a){const t=e.oxw();e.xp6(6),e.AsE("",t._trnMainService.pageHeading," [",t._trnMainService.TrnMainObj.Mode,"]")}}function Et(a,c){1&a&&(e.TgZ(0,"div"),e._UZ(1,"trnmain-purchase-entry",21),e.qZA())}function xt(a,c){1&a&&(e.TgZ(0,"div",6),e._UZ(1,"discounts-insert"),e.qZA())}function yt(a,c){if(1&a&&(e.TgZ(0,"div",18),e.YNc(1,Et,2,0,"div",19),e.TgZ(2,"div",5),e.YNc(3,xt,2,0,"div",20),e.qZA()()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.masterService.ShowMore),e.xp6(2),e.Q6J("ngIf",1==t.masterService.userSetting.GblBarcodeWiseBilling)}}function Ot(a,c){1&a&&(e.TgZ(0,"div",22),e._UZ(1,"voucher-total-area"),e.qZA())}let It=(()=>{class a{constructor(t,i,n,r,o,s,u,T,C,x,O){this.masterService=t,this._trnMainService=i,this.dialog=n,this.alertService=r,this.loadingSerive=o,this.authservice=s,this.route=u,this.genericProductEntryService=T,this.itemKeyEventService=C,this.quantityChangeEventService=x,this.entryValidateService=O,this.hideShow=!1,this.gridHoSalesInvoicePopupSettings=new E.im,this.gridSAPPIPopupSettings=new E.im,this.disableView=!1,this.prefix={},this.userProfile={},this.fileUploadPopupSettings=new I.s,this.userSetting=this.authservice.getSetting(),this.appType=this.masterService.appType,this._trnMainService.initialFormLoad(19),t.Currencies=[],t.getCurrencies(),this.userProfile=s.getUserProfile()}ngOnInit(){this.route.queryParams.subscribe(t=>{if("DRILL"==t.mode){let i=t.voucher,n=[];n=i.split("-"),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(i,n[1],n[2]).subscribe(r=>{"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.VoucherType=19,this._trnMainService.pageHeading="Purchase Order",this._trnMainService.TrnMainObj.VoucherPrefix="PO",this._trnMainService.TrnMainObj.Mode="VIEW",null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}))},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}else this.masterService.refreshTransactionList()}),this.fileUploadPopupSettings=Object.assign(new I.s,{title:"Import Purchase Order",sampleFileUrl:`/downloadSampleExcelforMasterMigration?importName=${this._trnMainService.TrnMainObj.VoucherPrefix}`,uploadEndpoints:`/importFileForTransaction/${this._trnMainService.TrnMainObj.VoucherPrefix}`,allowMultiple:!1,acceptFormat:".xlsx",filename:"Purchase Order Sample"}),this.setProductEntryTable()}showGenericGrid(t){this.itemKeyEventService.ItemkeyEvent(t.index,t.event,()=>p.K.default,i=>p.K.default,()=>p.K.default,()=>p.K.default,()=>p.K.default)}PopupForExcelUploadPO(){this.genericHOSalesInvoiceGridTI.show()}showPopupPO(){null!=this._trnMainService.TrnMainObj.PARAC&&""!=this._trnMainService.TrnMainObj.PARAC?null!=this._trnMainService.TrnMainObj.REFBILL&&""!=this._trnMainService.TrnMainObj.REFBILL?this.fileUploadPopup.show():this.alertService.warning("Please enter the Ref No..."):this.alertService.warning("Please select the supplier...")}showSAP_PO(){this.genericsGridSAPPI.show()}showPurchaseInvoicePopup(){null!=this._trnMainService.TrnMainObj.FCurrency&&""!=this._trnMainService.TrnMainObj.FCurrency?null!=this._trnMainService.TrnMainObj.BILLTO&&""!=this._trnMainService.TrnMainObj.BILLTO?this.fileUploadPopup.show():this.alertService.warning("Please select the supplier..."):this.alertService.warning("Please select the Currency...")}showSAPPurchaseInvoice(){this.genericsGridSAPPI.show()}setProductEntryTable(){var t=this._trnMainService.TrnMainObj.ProdList;this.genericProductEntrySetting=new Y.Vn(this._trnMainService),this.genericProductEntrySetting.columns=[{field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"40px"}},{field:"MENUCODE",header:"Code",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r)},{field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"400px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableItemDesc",n,r),focusTo:"ALTUNIT"},{field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"unitsOption",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},focusTo:"ALTERNATEQUANTIY",disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltUnit",n,r),onEnter:(n,r,o,s)=>this.entryValidateService.AlternateUnitEnterEventClick(n,r,o,s)},{field:"ALTERNATEQUANTIY",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"ALTRATE",onChange:(n,r,o)=>this.QuantityChangeEvent_default(n,r,o),applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r),decimalPlacesRestriction:"3"},{field:"ALTRATE",header:"Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onEnter:(n,r,o)=>this.mrpEnterEvent(n,r,o),onChange:(n,r,o,s)=>this.entryValidateService.MRPChangeEvent(n,r,o,s),focusTo:"INDDISCOUNTRATE",disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r)},{field:"MRP",header:"MRP",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"AMOUNT",header:"Amnt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"INDDISCOUNTRATE",header:"Dis%",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountRate",n,r),applyTwoDigitPipe:!1,onEnter:(n,r,o)=>{this.genericProductEntryService.discRateEnterClicked(n,r,o)},onChange:(n,r,o)=>this.genericProductEntryService.IndDiscountRateChangeEvent(n,r,o),onModelChange:(n,r,o)=>this.genericProductEntryService.IndDiscountModelRateChange(n,r,o),decimalPlacesRestriction:"2"},{field:"INDDISCOUNT",header:"Dis Amt",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountAmount",n,r),applyTwoDigitPipe:!0,onEnter:(n,r,o)=>{this.genericProductEntryService.discEnterClicked(n,r,o)},onChange:(n,r,o,s)=>this.genericProductEntryService.IndDiscountAmountChangeEvent(n,r,o,s),focusTo:"REMARKS",decimalPlacesRestriction:"2"},{field:"VAT",header:"VAT",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"REMARKS",header:"Remarks",hidden:!1,isActiveColumnHeader:!0,inputType:"inputText",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"40px"},onEnter:(n,r,o,s)=>{this.entryValidateService.RemarksEnterCommand(n,r,o,s)}},{field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"}}],this.genericProductEntrySetting.height="100%",this.genericProductEntrySetting.prodlist=t,this.genericProductEntrySetting.voucherType=b.Km.Purchase,this.genericProductEntrySetting.setRowItemFromSelectedItem=n=>this.SetRowItemFromSelectedItem(n),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(n,r=new Function)=>this.SetRowItemRate(n,r)}SetRowItemFromSelectedItem(t){let i=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];this._trnMainService.prepareItem(i,t),this._trnMainService.assignPrateaAsRATE(i,t)}SetAllUnitsOfItem(){this._trnMainService.getAllUnitsOfItem(this.genericProductEntryService.activerowIndex)}QuantityChangeEvent_default(t,i,n){this.quantityChangeEventService.QuantityChangeEvent(n)}SetRowItemRate(t,i){i()}getColumnDisablePipe(t,i,n){return t}mrpEnterEvent(t,i,n){this.entryValidateService.mrpEnterEvent(t,i,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}fileUploadSuccess(t){if("ok"==t.status){if(console.log("checkvalue",t),this._trnMainService.TrnMainObj.ProdList=t.result,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherPrefix="PO",this._trnMainService.TrnMainObj.VoucherAbbName="PO",this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="";for(let i in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[i].isPurchaseOrder=!0,this._trnMainService.TrnMainObj.ProdList[i].ALTERNATEUNIT=this._trnMainService.TrnMainObj.ProdList[i].BASEUNIT,this._trnMainService.setAltunitDropDownForView(i),this._trnMainService.TrnMainObj.ProdList[i].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[i].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[i].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[i].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[i].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[i].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[i].REALRATE=this._trnMainService.TrnMainObj.ProdList[i].ALTRATE/this._trnMainService.TrnMainObj.ProdList[i].ALTCONFACTOR,this._trnMainService.TrnMainObj.ProdList[i].RATE=this._trnMainService.TrnMainObj.ProdList[i].ALTRATE/this._trnMainService.TrnMainObj.ProdList[i].ALTCONFACTOR;this._trnMainService.ReCalculateBillWithNormal()}else this.loadingSerive.show("Error"+t.error)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(j.P),e.Y36(y.p),e.Y36(ee.uw),e.Y36(G.c),e.Y36(F.V),e.Y36(H.e),e.Y36(N.gz),e.Y36(R.w),e.Y36(p.X),e.Y36(Z.s),e.Y36(D.C))},a.\u0275cmp=e.Xpm({type:a,selectors:[["addpurchaseorder"]],viewQuery:function(t,i){if(1&t&&(e.Gf(bt,5),e.Gf(At,5),e.Gf(ft,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.genericHOSalesInvoiceGridTI=n.first),e.iGM(n=e.CRH())&&(i.genericsGridSAPPI=n.first),e.iGM(n=e.CRH())&&(i.fileUploadPopup=n.first)}},features:[e._Bn([y.p,D.C,p.X,R.w,Z.s])],decls:11,vars:5,consts:[[1,"sectionWrapper"],[1,"topWrapper"],["class","sticky-top",4,"ngIf"],["class","main-container",4,"ngIf"],[1,"midTableWrapper"],[1,"row","row-margin"],[1,"col-md-12","pd5"],[3,"GenericProductEntrySetting","ShowGenericGridEvent"],["class","footer-wrapper",4,"ngIf"],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-2","pd0"],[1,"col-md-3","pd0"],[2,"white-space","nowrap","margin-left","-145px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-7"],[3,"onLoadFromHoTaxInvoiceClickEmit","onLoadFromSAPFTPClickEmit","onFileUploadPopupEmit"],[1,"main-container"],[4,"ngIf"],["class","col-md-12 pd5",4,"ngIf"],["viewDisable","disableView"],[1,"footer-wrapper"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Ct,11,2,"div",2),e.YNc(3,yt,4,2,"div",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"generic-product-entry",7),e.NdJ("ShowGenericGridEvent",function(r){return i.showGenericGrid(r)}),e.qZA()()()(),e.YNc(8,Ot,2,0,"div",8),e.qZA(),e.TgZ(9,"file-uploader-popup",9,10),e.NdJ("onUploaded",function(r){return i.fileUploadSuccess(r)}),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(4),e.Q6J("GenericProductEntrySetting",i.genericProductEntrySetting),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("popupsettings",i.fileUploadPopupSettings))},dependencies:[J.v,W.q,X.i,q.u,$.d,I.U,m.O5,ie.o,z.Z],styles:[".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n    text-align: center;\n    vertical-align: middle;\n  }"]}),a})();var k=h(82661);const wt=["genericHOSalesInvoiceGridTI"],Nt=["genericsGridSAPPI"],Dt=["fileUploadPopup"];function Rt(a,c){if(1&a&&(e.ynx(0),e.TgZ(1,"div",18)(2,"span")(3,"b"),e._uU(4,"Quantity:"),e.qZA(),e._uU(5),e.qZA()(),e._UZ(6,"div",14),e.TgZ(7,"div",23)(8,"span")(9,"b"),e._uU(10,"Rate:"),e.qZA(),e._uU(11),e.ALo(12,"currency"),e.qZA()(),e.BQk()),2&a){const t=e.oxw(2);e.xp6(5),e.AsE("\xa0",t._trnMainService.purchaseOrderQty," \xa0 ",t._trnMainService.produstWiseOrderUnit," "),e.xp6(6),e.hij("\xa0",e.Dn7(12,3,t._trnMainService.purchaseOrderRate,"INR","Rs. ")," ")}}function Zt(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",13)(2,"div",14),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",15)(5,"label",16),e._uU(6),e.qZA(),e.TgZ(7,"div"),e._UZ(8,"voucher-sidebar-billdetail"),e.qZA()(),e.TgZ(9,"div",17),e.YNc(10,Rt,13,7,"ng-container",9),e.qZA(),e.TgZ(11,"div",18)(12,"voucher-master-action",19),e.NdJ("onLoadFromHoTaxInvoiceClickEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showSupplierSalesInvoiceFromHOPopup(n))})("onLoadFromSAPFTPClickEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showSAPPurchaseInvoice(n))})("onFileUploadPopupEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showPurchaseInvoicePopup(n))}),e.qZA(),e.TgZ(13,"generic-popup-grid",20,21),e.NdJ("onItemDoubleClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onHoSalesInvoiceSelect(n))}),e.qZA(),e.TgZ(15,"generic-popup-grid",20,22),e.NdJ("onItemDoubleClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onSAPPurchaseInvoiceSelect(n))}),e.qZA()()()()}if(2&a){const t=e.oxw();e.xp6(6),e.AsE("",t._trnMainService.pageHeading," [",t._trnMainService.TrnMainObj.Mode,"] "),e.xp6(4),e.Q6J("ngIf",0!=t.userSetting.IMPORTPOBILLMODE&&t._trnMainService.TrnMainObj.REFORDBILL),e.xp6(3),e.Q6J("popupsettings",t.gridHoSalesInvoicePopupSettings),e.xp6(2),e.Q6J("popupsettings",t.gridSAPPIPopupSettings)}}function Lt(a,c){1&a&&(e.TgZ(0,"div",6),e._UZ(1,"discounts-insert"),e.qZA())}function Ut(a,c){if(1&a&&(e.TgZ(0,"div",24)(1,"div",25),e._UZ(2,"trnmain-purchase-entry",26),e.qZA(),e.TgZ(3,"div",5),e.YNc(4,Lt,2,0,"div",27),e.qZA()()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("hidden",!t.masterService.ShowMore),e.xp6(3),e.Q6J("ngIf",1==t.masterService.userSetting.GblBarcodeWiseBilling)}}function jt(a,c){1&a&&(e.TgZ(0,"div",28),e._UZ(1,"voucher-total-area"),e.qZA())}function Gt(a,c){if(1&a&&(e.TgZ(0,"tbody",37)(1,"tr",38)(2,"td",39),e._uU(3),e.qZA(),e.TgZ(4,"td",40),e._uU(5),e.qZA(),e.TgZ(6,"td",41),e._uU(7),e.qZA(),e.TgZ(8,"td",41),e._uU(9),e.qZA(),e.TgZ(10,"td",42),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"td",42),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"td",41),e._uU(17),e.qZA(),e.TgZ(18,"td",43),e._uU(19),e.qZA(),e.TgZ(20,"td",44),e._uU(21),e.ALo(22,"twoDigitNumber"),e.qZA(),e.TgZ(23,"td",43),e._uU(24),e.ALo(25,"twoDigitNumber"),e.qZA(),e.TgZ(26,"td",43),e._uU(27),e.ALo(28,"twoDigitNumber"),e.qZA(),e.TgZ(29,"td",43),e._uU(30),e.qZA(),e.TgZ(31,"td",43),e._uU(32),e.qZA(),e.TgZ(33,"td",43),e._uU(34),e.qZA(),e.TgZ(35,"td",43),e._uU(36),e.ALo(37,"twoDigitNumber"),e.qZA(),e.TgZ(38,"td",43),e._uU(39),e.ALo(40,"twoDigitNumber"),e.qZA(),e.TgZ(41,"td",43),e._uU(42),e.ALo(43,"twoDigitNumber"),e.qZA(),e.TgZ(44,"td",43),e._uU(45),e.ALo(46,"twoDigitNumber"),e.qZA(),e._UZ(47,"td",43),e.TgZ(48,"td",43),e._uU(49),e.ALo(50,"twoDigitNumber"),e.qZA(),e.TgZ(51,"td",42),e._uU(52),e.qZA()()()),2&a){const t=c.$implicit,i=c.index,n=e.oxw(2);e.xp6(2),e.MGl("id","sno",i,""),e.xp6(1),e.Oqu(i+1),e.xp6(2),e.hij(" ",t.MENUCODE," "),e.xp6(2),e.hij(" ",t.ITEMDESC," "),e.xp6(2),e.hij(" ",t.BATCH," "),e.xp6(2),e.hij("",e.xi3(12,21,t.MFGDATE,"dd-MM-yyyy")," "),e.xp6(3),e.hij("",e.xi3(15,24,t.EXPDATE,"dd-MM-yyyy")," "),e.xp6(3),e.hij(" ",n._trnMainService.TrnMainObj.TOTALQTY," "),e.xp6(2),e.hij(" ",t.ALTUNIT," "),e.xp6(2),e.hij(" ",e.lcZ(22,27,t.MRP),""),e.xp6(3),e.hij(" ",e.lcZ(25,29,t.ALTRATE2)," "),e.xp6(3),e.hij(" ",e.lcZ(28,31,t.ALTRATE)," "),e.xp6(3),e.hij(" ",t.INDDISCOUNTRATE," "),e.xp6(2),e.hij("",t.INDDISCOUNT," "),e.xp6(2),e.hij(" ",t.GSTRATE_ONLYFORSHOWING,""),e.xp6(2),e.hij(" ",e.lcZ(37,33,n._trnMainService.nullToZeroConverter(t.VAT)),""),e.xp6(3),e.hij(" ",e.lcZ(40,35,n._trnMainService.nullToZeroConverter(t.PrimaryDiscount)),""),e.xp6(3),e.hij(" ",e.lcZ(43,37,n._trnMainService.nullToZeroConverter(t.SecondaryDiscount)),""),e.xp6(3),e.hij(" ",e.lcZ(46,39,n._trnMainService.nullToZeroConverter(t.LiquiditionDiscount)),""),e.xp6(4),e.hij(" ",e.lcZ(50,41,n._trnMainService.nullToZeroConverter(t.NETAMOUNT)),""),e.xp6(3),e.hij("",t.REMARKS," ")}}function kt(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"div",29)(2,"div")(3,"div")(4,"div")(5,"div",30)(6,"div",31)(7,"h3"),e._uU(8,"Sales Invoice"),e.qZA()(),e.TgZ(9,"div",31)(10,"h3"),e._uU(11),e.qZA()(),e.TgZ(12,"div",31)(13,"button",32),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.saveTaxInvoice())}),e._uU(14,"Save"),e.qZA(),e.TgZ(15,"button",32),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.popupClose())}),e._uU(16,"Cancel"),e.qZA()()(),e.TgZ(17,"div")(18,"div",33)(19,"table",34)(20,"tr",35)(21,"th"),e._uU(22,"S.No."),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Code"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Description"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"BatchNo "),e.qZA(),e.TgZ(29,"th"),e._uU(30),e.qZA(),e.TgZ(31,"th"),e._uU(32),e.qZA(),e.TgZ(33,"th"),e._uU(34,"Qty"),e.qZA(),e.TgZ(35,"th"),e._uU(36),e.qZA(),e.TgZ(37,"th"),e._uU(38,"MRP"),e.qZA(),e.TgZ(39,"th"),e._uU(40,"Cost Price"),e.qZA(),e.TgZ(41,"th"),e._uU(42,"Selling Price"),e.qZA(),e.TgZ(43,"th"),e._uU(44,"Disc %"),e.qZA(),e.TgZ(45,"th"),e._uU(46),e.qZA(),e.TgZ(47,"th"),e._uU(48),e.qZA(),e.TgZ(49,"th"),e._uU(50),e.qZA(),e.TgZ(51,"th"),e._uU(52,"P Dis."),e.qZA(),e.TgZ(53,"th"),e._uU(54,"S Dis."),e.qZA(),e.TgZ(55,"th"),e._uU(56,"L Dis."),e.qZA(),e.TgZ(57,"th"),e._uU(58,"OS Dis."),e.qZA(),e.TgZ(59,"th"),e._uU(60),e.qZA(),e.TgZ(61,"th"),e._uU(62,"Remarks"),e.qZA()(),e.YNc(63,Gt,53,43,"tbody",36),e.qZA()()()()()()()()}if(2&a){const t=e.oxw();e.xp6(11),e.hij(" Ship To:-",t._trnMainService.TrnMainObj.AdditionalObj.SHIPNAMEVIEW," "),e.xp6(19),e.hij("",2==t.appType?"MFG Date":"Mfg Dt"," "),e.xp6(2),e.hij("",2==t.appType?"EXP Date":"Exp Dt"," "),e.xp6(4),e.Oqu(2==t.appType?"UOM":"Packing"),e.xp6(10),e.Oqu(2==t.appType?"Disc Amount":"Disc Amnt"),e.xp6(2),e.Oqu(2==t.appType?"VAT%":"GST%"),e.xp6(2),e.Oqu(2==t.appType?"VAT Amount":"GST TaxAmt"),e.xp6(10),e.Oqu(2==t.appType?"Net Amount":"Net Amnt"),e.xp6(3),e.Q6J("ngForOf",t._trnMainService.TrnMainObj.ProdList)}}let Ft=(()=>{class a{constructor(t,i,n,r,o,s,u,T,C,x,O,w){this.masterService=t,this._trnMainService=i,this.dialog=n,this.alertService=r,this.loadingSerive=o,this.authservice=s,this.route=u,this.router=T,this.genericProductEntryService=C,this.itemKeyEventService=x,this.quantityChangeEventService=O,this.entryValidateService=w,this.hideShow=!1,this.fileUploadPopupSettings=new I.s,this.gridHoSalesInvoicePopupSettings=new E.im,this.gridSAPPIPopupSettings=new E.im,this.disableView=!1,this.prefix={},this.activatedRoute={},this.userProfile={},this.userSetting=this.authservice.getSetting(),this.appType=this.masterService.appType,this._trnMainService.initialFormLoad(3),this._trnMainService.urlpath=this.route.snapshot.url[0].path,this._trnMainService.TrnMainObj.CNDN_MODE=10,this._trnMainService.pageHeading="IMPORT PURCHASE INVOICE",this._trnMainService.TrnMainObj.AdditionalObj.tag="IMPORT_PURCHASE",t.Currencies=[],t.getCurrencies().subscribe(M=>{t.Currencies=M}),this.userProfile=s.getUserProfile(),this.gridHoSalesInvoicePopupSettings={title:"Sales Invoices From Supplier",apiEndpoints:"/getAllHOTaxInvoicePagedList",defaultFilterIndex:0,columns:[{key:"CHALANNO",title:"Bill No",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"Date",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"Amount",hidden:!1,noSearch:!1}]},this.gridSAPPIPopupSettings={title:"Purchase Invoice From SAP",apiEndpoints:"/getAllSAPPurchaseInvoicePagedList",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"VOUCHER NO.",hidden:!1,noSearch:!1},{key:"PLANTDESC",title:"PLANT",hidden:!1,noSearch:!1},{key:"INVDATE",title:"INVOICE DATE",hidden:!1,noSearch:!1}]},this.route.queryParams.subscribe(M=>{"DRILL"!=M.mode&&(M.voucher&&(this.getSalesInvoiceFromSupplier(M.voucher,M.fromcompanyid),this._trnMainService.fromNotification=M.fromNotification),M.status&&1==M.status&&(this._trnMainService.showPerformaApproveReject=!1))})}ngOnInit(){this.route.queryParams.subscribe(t=>{if("DRILL"==t.mode){let i=t.voucher,n=[];n=i.split("-"),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(i,n[1],n[2]).subscribe(r=>{"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.VoucherType=3,this._trnMainService.pageHeading="IMPORT PURCHASE INVOICE",this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.Mode="VIEW",null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}),this._trnMainService.TrnMainObj.ProdList.forEach(o=>o.rowMode="VIEW"),this._trnMainService.ReCalculateBillWithNormal())},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}else console.log(this._trnMainService.TrnMainObj),console.log(this._trnMainService.TrnMainObj.Mode),this.masterService.refreshTransactionList(),this._trnMainService.TrnMainObj.TRNMODE="importadvance",this.masterService.getPurchaseAcList().subscribe(i=>{this._trnMainService.PurchaseAcList.push(i)},i=>{this.masterService.resolveError(i,"trnmain-purchase-getPurchaseList")},()=>{0==this._trnMainService.AppSettings.MultiplePurchaseAccount&&(this._trnMainService.TrnMainObj.RETTO=this._trnMainService.AppSettings.PurchaseAc)}),this.masterService.getCashList().subscribe(i=>{this._trnMainService.CashList=i},i=>{this.masterService.resolveError(i,"trnmain-purchase-getCashList")}),this.fileUploadPopupSettings=Object.assign(new I.s,{title:"Import Purchase Invoice",sampleFileUrl:`/downloadSampleExcelforMasterMigration?importName=${this._trnMainService.TrnMainObj.VoucherPrefix}`,uploadEndpoints:`/importFileForTransaction/${this._trnMainService.TrnMainObj.VoucherPrefix}`,allowMultiple:!1,acceptFormat:".xlsx"})}),this.setProductEntryTable()}setProductEntryTable(){var t=this._trnMainService.TrnMainObj.ProdList;this.genericProductEntrySetting=new Y.Vn(this._trnMainService),this.genericProductEntrySetting.columns=[{field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{width:"40px"}},{field:"MENUCODE",header:"Code",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r)},{field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{width:"400px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableItemDesc",n,r),focusTo:"ALTUNIT"},{field:"BATCH",header:"Batch",hidden:!1,isActiveColumnHeader:!0,inputType:"batch",headerNgStyle:{width:"80px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableBatch",n,r),onEnter:(n,r,o,s)=>{this.genericProductEntryService.BatchEnter(n,r,o,s)},onKeyPress:(n,r)=>{this.genericProductEntryService.onKeyDownBatch(n,r)}},{field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"unitsOption",headerNgStyle:{width:"80px"},focusTo:"ALTERNATEQUANTIY",disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltUnit",n,r),onEnter:(n,r,o,s)=>this.entryValidateService.AlternateUnitEnterEventClick(n,r,o,s)},{field:"ALTERNATEQUANTIY",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"INVRATE",onChange:(n,r,o)=>this.QuantityChangeEvent_default(n,r,o),applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r),decimalPlacesRestriction:"3"},{field:"INVRATE",header:"FC P.Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyThreeDigitPipe:!0,disablePipe:(n,r)=>this.getColumnDisablePipe("disableFCrate",n,r),onEnter:(n,r,o)=>this.entryValidateService.calculateFCRATEChangeEvent(r),onChange:(n,r,o,s)=>this.entryValidateService.calculateFCRATEChangeEvent(o),focusTo:"INDDISCOUNTRATE"},{field:"ALTRATE",header:"P.Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onEnter:(n,r,o)=>this.mrpEnterEvent(n,r,o),onChange:(n,r,o,s)=>this.entryValidateService.MRPChangeEvent(n,r,o,s),focusTo:"INDDISCOUNTRATE",disablePipe:(n,r)=>this.getColumnDisablePipe("disableRateandDiscount",n,r)},{field:"AMOUNT",header:"Amount",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"INDDISCOUNTRATE",header:"Dis%",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountRate",n,r),applyTwoDigitPipe:!1,onEnter:(n,r,o)=>{this.genericProductEntryService.discRateEnterClicked(n,r,o),this.genericProductEntryService.IndDiscountRateChangeEvent(n,o,r)},onChange:(n,r,o)=>this.genericProductEntryService.IndDiscountRateChangeEvent(n,r,o),onModelChange:(n,r,o)=>this.genericProductEntryService.IndDiscountModelRateChange(n,r,o),decimalPlacesRestriction:"2"},{field:"INDDISCOUNT",header:"Dis Amt",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountAmount",n,r),applyTwoDigitPipe:!0,onEnter:(n,r,o)=>{this.genericProductEntryService.discEnterClicked(n,r,o)},onChange:(n,r,o,s)=>this.genericProductEntryService.IndDiscountAmountChangeEvent(n,r,o,s),focusTo:"ITEMDESC",decimalPlacesRestriction:"2"},{field:"DISCOUNT",header:"Total Disc",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"70px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onHover:n=>{this.genericProductEntryService.onHover(n)},displayOnHover:!0},{field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"MFGDATE",header:"Mfg Date",hidden:!1,inputType:"date",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right","font-size":"11px"},applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableMfgDate",n,r)},{field:"EXPDATE",header:"Exp Date",hidden:!1,inputType:"date",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right","font-size":"11px"},applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableExpDate",n,r)},{field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableRowDelete",n,r)}],this.genericProductEntrySetting.height="100%",this.genericProductEntrySetting.prodlist=t,this.genericProductEntrySetting.voucherType=b.Km.Purchase,this.genericProductEntrySetting.setRowItemFromSelectedItem=n=>this.SetRowItemFromSelectedItem(n),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(n,r=new Function)=>this.SetRowItemRate(n,r)}QuantityChangeEvent_default(t,i,n){this.quantityChangeEventService.QuantityChangeEvent(n)}getColumnDisablePipe(t,i,n){return t}mrpEnterEvent(t,i,n){this.entryValidateService.mrpEnterEvent(t,i,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}SetRowItemFromSelectedItem(t){let i=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];this._trnMainService.prepareItem(i,t),this._trnMainService.assignPrateaAsRATE(i,t)}SetAllUnitsOfItem(){this._trnMainService.getAllUnitsOfItem(this.genericProductEntryService.activerowIndex)}SetRowItemRate(t,i){i()}showGenericGrid(t){this.itemKeyEventService.ItemkeyEvent(t.index,t.event,()=>p.K.done,i=>p.K.default,()=>p.K.default,()=>p.K.default,()=>p.K.default)}showPurchaseInvoicePopup(){null!=this._trnMainService.TrnMainObj.PARAC&&""!=this._trnMainService.TrnMainObj.PARAC?null!=this._trnMainService.TrnMainObj.FCurrency&&""!=this._trnMainService.TrnMainObj.FCurrency?this.fileUploadPopup.show():this.alertService.warning("Please select the Currency..."):this.alertService.warning("Please select the supplier...")}fileUploadSuccess(t){if("ok"==t.status){if(this._trnMainService.TrnMainObj.ProdList=t.result,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherType=3,this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.VoucherAbbName="PI",this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="";for(let i in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.setAltunitDropDownForView(i),this._trnMainService.TrnMainObj.ProdList[i].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[i].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[i].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[i].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[i].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[i].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[i].ALTRATE=this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[i].INVRATE)*this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.EXRATE),this._trnMainService.TrnMainObj.ProdList[i].REALRATE=this._trnMainService.TrnMainObj.ProdList[i].ALTRATE/this._trnMainService.TrnMainObj.ProdList[i].ALTCONFACTOR,this._trnMainService.TrnMainObj.ProdList[i].RATE=this._trnMainService.TrnMainObj.ProdList[i].ALTRATE/this._trnMainService.TrnMainObj.ProdList[i].ALTCONFACTOR;console.log("\xcfmport",t),this._trnMainService.prePareVariantDescription(),this._trnMainService.ReCalculateBillWithNormal()}else this.loadingSerive.show("Error"+t.error)}showSupplierSalesInvoiceFromHOPopup(){this.genericHOSalesInvoiceGridTI.show()}onHoSalesInvoiceSelect(t){this.getSalesInvoiceFromSupplier(t.VCHRNO,t.FROMCOMPANY),this.markAsRead(t)}markAsRead(t){this.redirectToBestRoute(t),!t.ISSEEN&&this.masterService.markAsRead(t.ID).subscribe(i=>{},i=>{})}redirectToBestRoute(t){}getSalesInvoiceFromSupplier(t,i){this.loadingSerive.show("Getting Data. Please Wait..."),this.masterService.loadSalesInvoiceFromSupplierHO(t,i).subscribe(n=>{if(this.loadingSerive.hide(),"ok"==n.status){if(this._trnMainService.TrnMainObj=n.result,this._trnMainService.disableAllFieldinPurchase=!0,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherType=3,this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.VoucherAbbName="PI",this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.REFBILL=t,this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="";for(let r in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[r].inputMode=!1,this._trnMainService.TrnMainObj.ProdList[r].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[r].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[r].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[r].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[r].EXPDATE.toString().substring(0,10);this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate()}},n=>{this.loadingSerive.hide()})}showSAPPurchaseInvoice(){this.genericsGridSAPPI.show()}onSAPPurchaseInvoiceSelect(t){this.disableView=!0,console.log("call for loading data"),this.loadSAPPurchaseInvoice(t.VCHRNO)}loadSAPPurchaseInvoice(t){this.loadingSerive.show("Getting Data. Please Wait..."),this.masterService.loadSAPPurchaseInvoiceDetail(t).subscribe(i=>{if(this.loadingSerive.hide(),"ok"==i.status){if(this._trnMainService.TrnMainObj=i.result,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherType=3,this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.VoucherAbbName="PI",this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.REFBILL=t,this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="",this._trnMainService.TrnMainObj.tag="FTP";for(let n in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[n].inputMode=!1,this._trnMainService.setAltunitDropDownForView(n),this._trnMainService.AssignSellingPriceAndDiscounts(this._trnMainService.TrnMainObj.ProdList[n].PClist,n),this._trnMainService.TrnMainObj.ProdList[n].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[n].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[n].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[n].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[n].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[n].EXPDATE.toString().substring(0,10);this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate()}else this.loadingSerive.hide(),this.alertService.error(i.result._body)},i=>{this.loadingSerive.hide()})}saveTaxInvoice(){this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.tag="shipto",this.alertService.show(),this.masterService.saveTransaction(this._trnMainService.TrnMainObj.Mode,this._trnMainService.TrnMainObj).subscribe(t=>{"ok"==t.status&&(this.alertService.hide(),this.popupClose())},t=>{this.alertService.error(t)})}popupClose(){this._trnMainService.initialFormLoad(3)}onClickPoReferenceProduct(t){t&&(this._trnMainService.purchaseOrderQty=t.ALTERNATEQTY,this._trnMainService.purchaseOrderRate=t.RATE,this._trnMainService.produstWiseOrderUnit=t.BASEUNIT)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(j.P),e.Y36(y.p),e.Y36(ee.uw),e.Y36(G.c),e.Y36(F.V),e.Y36(H.e),e.Y36(N.gz),e.Y36(N.F0),e.Y36(R.w),e.Y36(p.X),e.Y36(Z.s),e.Y36(D.C))},a.\u0275cmp=e.Xpm({type:a,selectors:[["purchase-import"]],viewQuery:function(t,i){if(1&t&&(e.Gf(wt,5),e.Gf(Nt,5),e.Gf(Dt,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.genericHOSalesInvoiceGridTI=n.first),e.iGM(n=e.CRH())&&(i.genericsGridSAPPI=n.first),e.iGM(n=e.CRH())&&(i.fileUploadPopup=n.first)}},features:[e._Bn([y.p,D.C,p.X,R.w,Z.s])],decls:12,vars:6,consts:[[1,"sectionWrapper"],[1,"topWrapper"],["class","sticky-top",4,"ngIf"],["class","main-container",4,"ngIf"],[1,"midTableWrapper"],[1,"row","row-margin"],[1,"col-md-12","pd5"],[3,"GenericProductEntrySetting","ShowGenericGridEvent"],["class","footer-wrapper",4,"ngIf"],[4,"ngIf"],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-1","pd0"],[1,"col-md-3","pd0"],[2,"white-space","nowrap","margin-left","-33px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-3","row",2,"padding-top","0.8vh","font-size","15px","font-style","italic"],[1,"col-md-5","pd0"],[3,"onLoadFromHoTaxInvoiceClickEmit","onLoadFromSAPFTPClickEmit","onFileUploadPopupEmit"],[3,"popupsettings","onItemDoubleClick"],["genericHOSalesInvoiceGridTI",""],["genericsGridSAPPI",""],[1,"col-md-6","pd0"],[1,"main-container"],[3,"hidden"],["viewDisable","disableView"],["class","col-md-12 pd5",4,"ngIf"],[1,"footer-wrapper"],[2,"display","block","padding","0px","left","10px","padding","0px","top","101px","width","99%"],[2,"padding","0px","background","#c0c0c0"],[1,"col-md-3"],[1,"btn","btn-info",3,"click"],[2,"background-color","#FFFFFF","height","450px","overflow-x","scroll","width","100%"],[1,"table",2,"margin-bottom","5px","font-size","12.5px","width","2000px","overflow","scroll"],[2,"border-bottom","2px solid #E6E6E6","border-top","2px solid #E6E6E6","height","30px","background","silver","color","black"],["style","border: 1px",4,"ngFor","ngForOf"],[2,"border","1px"],[2,"border","1px solid #e6e6e6","max-height","25px"],[2,"border","1px solid #e6e6e6","width","20px",3,"id"],[2,"height","23px","border","1px solid #e6e6e6","width","80px"],[2,"border","1px solid #e6e6e6","width","300px","background-color","#f9f9f9"],[2,"height","23px","border","1px solid #e6e6e6","width","150px"],[2,"height","23px","border","1px solid #e6e6e6","width","100px"],[2,"height","23px","border","1px solid #e6e6e6","width","100px","background-color","#f9f9f9"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Zt,17,5,"div",2),e.YNc(3,Ut,5,2,"div",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"generic-product-entry",7),e.NdJ("ShowGenericGridEvent",function(r){return i.showGenericGrid(r)}),e.qZA()()()(),e.YNc(8,jt,2,0,"div",8),e.qZA(),e.YNc(9,kt,64,9,"div",9),e.TgZ(10,"file-uploader-popup",10,11),e.NdJ("onUploaded",function(r){return i.fileUploadSuccess(r)}),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(4),e.Q6J("GenericProductEntrySetting",i.genericProductEntrySetting),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",i._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("popupsettings",i.fileUploadPopupSettings))},dependencies:[J.v,W.q,X.i,q.u,$.d,I.U,m.sg,m.O5,E.Zl,ie.o,z.Z,m.H9,m.uU,ne.g],styles:[".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n      text-align: center;\n      vertical-align: middle;\n    }"]}),a})();var oe=h(71800),de=h(65674);const Ht=["exampleModal2"],qt=["genericHOSalesInvoiceGridTI"],Vt=["genericsGridSAPPI"],Qt=["fileUploadPopup"];function Bt(a,c){if(1&a&&(e.ynx(0),e.TgZ(1,"div",33)(2,"span")(3,"b"),e._uU(4,"PO Qty:"),e.qZA(),e._uU(5),e.qZA()(),e.TgZ(6,"div",38)(7,"span")(8,"b"),e._uU(9,"Rate:"),e.qZA(),e._uU(10),e.ALo(11,"currency"),e.qZA()(),e.BQk()),2&a){const t=e.oxw(2);e.xp6(5),e.AsE("\xa0",t._trnMainService.purchaseOrderQty," \xa0 ",t._trnMainService.produstWiseOrderUnit," "),e.xp6(5),e.hij("\xa0",e.Dn7(11,3,t._trnMainService.purchaseOrderRate,"INR","Rs. ")," ")}}function Yt(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",27)(1,"div",28)(2,"div",29),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",30)(5,"label",31),e._uU(6),e.qZA(),e.TgZ(7,"div"),e._UZ(8,"voucher-sidebar-billdetail"),e.qZA()(),e.TgZ(9,"div",32),e.YNc(10,Bt,12,7,"ng-container",9),e.qZA(),e.TgZ(11,"div",33)(12,"voucher-master-action",34),e.NdJ("onLoadFromHoTaxInvoiceClickEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showSupplierSalesInvoiceFromHOPopup(n))})("onLoadFromSAPFTPClickEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showSAPPurchaseInvoice(n))})("onFileUploadPopupEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showPurchaseInvoicePopup(n))}),e.qZA(),e.TgZ(13,"generic-popup-grid",35,36),e.NdJ("onItemDoubleClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onHoSalesInvoiceSelect(n))}),e.qZA(),e.TgZ(15,"generic-popup-grid",35,37),e.NdJ("onItemDoubleClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onSAPPurchaseInvoiceSelect(n))}),e.qZA()()()()}if(2&a){const t=e.oxw();e.xp6(6),e.AsE("",t._trnMainService.pageHeading," [",t._trnMainService.TrnMainObj.Mode,"] "),e.xp6(4),e.Q6J("ngIf",0!=t.userSetting.PODELIVERYMODE&&t._trnMainService.TrnMainObj.REFORDBILL),e.xp6(3),e.Q6J("popupsettings",t.gridHoSalesInvoicePopupSettings),e.xp6(2),e.Q6J("popupsettings",t.gridSAPPIPopupSettings)}}function Kt(a,c){1&a&&(e.TgZ(0,"div",6),e._UZ(1,"discounts-insert"),e.qZA())}function Jt(a,c){if(1&a&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"trnmain-purchase-entry",41),e.qZA(),e.TgZ(3,"div",5),e.YNc(4,Kt,2,0,"div",42),e.qZA()()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("hidden",!t.masterService.ShowMore),e.xp6(3),e.Q6J("ngIf",1==t.masterService.userSetting.GblBarcodeWiseBilling)}}function Wt(a,c){1&a&&(e.TgZ(0,"div",43),e._UZ(1,"voucher-total-area"),e.qZA())}function Xt(a,c){if(1&a&&(e.TgZ(0,"tbody",52)(1,"tr",53)(2,"td",54),e._uU(3),e.qZA(),e.TgZ(4,"td",55),e._uU(5),e.qZA(),e.TgZ(6,"td",56),e._uU(7),e.qZA(),e.TgZ(8,"td",56),e._uU(9),e.qZA(),e.TgZ(10,"td",57),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"td",57),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"td",56),e._uU(17),e.qZA(),e.TgZ(18,"td",58),e._uU(19),e.qZA(),e.TgZ(20,"td",59),e._uU(21),e.ALo(22,"twoDigitNumber"),e.qZA(),e.TgZ(23,"td",58),e._uU(24),e.ALo(25,"twoDigitNumber"),e.qZA(),e.TgZ(26,"td",58),e._uU(27),e.ALo(28,"twoDigitNumber"),e.qZA(),e.TgZ(29,"td",58),e._uU(30),e.qZA(),e.TgZ(31,"td",58),e._uU(32),e.qZA(),e.TgZ(33,"td",58),e._uU(34),e.qZA(),e.TgZ(35,"td",58),e._uU(36),e.ALo(37,"twoDigitNumber"),e.qZA(),e.TgZ(38,"td",58),e._uU(39),e.ALo(40,"twoDigitNumber"),e.qZA(),e.TgZ(41,"td",58),e._uU(42),e.ALo(43,"twoDigitNumber"),e.qZA(),e.TgZ(44,"td",58),e._uU(45),e.ALo(46,"twoDigitNumber"),e.qZA(),e._UZ(47,"td",58),e.TgZ(48,"td",58),e._uU(49),e.ALo(50,"twoDigitNumber"),e.qZA(),e.TgZ(51,"td",57),e._uU(52),e.qZA()()()),2&a){const t=c.$implicit,i=c.index,n=e.oxw(2);e.xp6(2),e.MGl("id","sno",i,""),e.xp6(1),e.Oqu(i+1),e.xp6(2),e.hij(" ",t.MENUCODE," "),e.xp6(2),e.hij(" ",t.ITEMDESC," "),e.xp6(2),e.hij(" ",t.BATCH," "),e.xp6(2),e.hij("",e.xi3(12,21,t.MFGDATE,"dd-MM-yyyy")," "),e.xp6(3),e.hij("",e.xi3(15,24,t.EXPDATE,"dd-MM-yyyy")," "),e.xp6(3),e.hij(" ",n._trnMainService.TrnMainObj.TOTALQTY," "),e.xp6(2),e.hij(" ",t.ALTUNIT," "),e.xp6(2),e.hij(" ",e.lcZ(22,27,t.MRP),""),e.xp6(3),e.hij(" ",e.lcZ(25,29,t.ALTRATE2)," "),e.xp6(3),e.hij(" ",e.lcZ(28,31,t.ALTRATE)," "),e.xp6(3),e.hij(" ",t.INDDISCOUNTRATE," "),e.xp6(2),e.hij("",t.INDDISCOUNT," "),e.xp6(2),e.hij(" ",t.GSTRATE_ONLYFORSHOWING,""),e.xp6(2),e.hij(" ",e.lcZ(37,33,n._trnMainService.nullToZeroConverter(t.VAT)),""),e.xp6(3),e.hij(" ",e.lcZ(40,35,n._trnMainService.nullToZeroConverter(t.PrimaryDiscount)),""),e.xp6(3),e.hij(" ",e.lcZ(43,37,n._trnMainService.nullToZeroConverter(t.SecondaryDiscount)),""),e.xp6(3),e.hij(" ",e.lcZ(46,39,n._trnMainService.nullToZeroConverter(t.LiquiditionDiscount)),""),e.xp6(4),e.hij(" ",e.lcZ(50,41,n._trnMainService.nullToZeroConverter(t.NETAMOUNT)),""),e.xp6(3),e.hij("",t.REMARKS," ")}}function $t(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"div",44)(2,"div")(3,"div")(4,"div")(5,"div",45)(6,"div",46)(7,"h3"),e._uU(8,"Sales Invoice"),e.qZA()(),e.TgZ(9,"div",46)(10,"h3"),e._uU(11),e.qZA()(),e.TgZ(12,"div",46)(13,"button",47),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.saveTaxInvoice())}),e._uU(14,"Save"),e.qZA(),e.TgZ(15,"button",47),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.popupClose())}),e._uU(16,"Cancel"),e.qZA()()(),e.TgZ(17,"div")(18,"div",48)(19,"table",49)(20,"tr",50)(21,"th"),e._uU(22,"S.No."),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Code"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Description"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"BatchNo "),e.qZA(),e.TgZ(29,"th"),e._uU(30),e.qZA(),e.TgZ(31,"th"),e._uU(32),e.qZA(),e.TgZ(33,"th"),e._uU(34,"Qty"),e.qZA(),e.TgZ(35,"th"),e._uU(36),e.qZA(),e.TgZ(37,"th"),e._uU(38,"MRP"),e.qZA(),e.TgZ(39,"th"),e._uU(40,"Cost Price"),e.qZA(),e.TgZ(41,"th"),e._uU(42,"Selling Price"),e.qZA(),e.TgZ(43,"th"),e._uU(44,"Disc %"),e.qZA(),e.TgZ(45,"th"),e._uU(46),e.qZA(),e.TgZ(47,"th"),e._uU(48),e.qZA(),e.TgZ(49,"th"),e._uU(50),e.qZA(),e.TgZ(51,"th"),e._uU(52,"P Dis."),e.qZA(),e.TgZ(53,"th"),e._uU(54,"S Dis."),e.qZA(),e.TgZ(55,"th"),e._uU(56,"L Dis."),e.qZA(),e.TgZ(57,"th"),e._uU(58,"OS Dis."),e.qZA(),e.TgZ(59,"th"),e._uU(60),e.qZA(),e.TgZ(61,"th"),e._uU(62,"Remarks"),e.qZA()(),e.YNc(63,Xt,53,43,"tbody",51),e.qZA()()()()()()()()}if(2&a){const t=e.oxw();e.xp6(11),e.hij(" Ship To:-",t._trnMainService.TrnMainObj.AdditionalObj.SHIPNAMEVIEW," "),e.xp6(19),e.hij("",2==t.appType?"MFG Date":"Mfg Dt"," "),e.xp6(2),e.hij("",2==t.appType?"EXP Date":"Exp Dt"," "),e.xp6(4),e.Oqu(2==t.appType?"UOM":"Packing"),e.xp6(10),e.Oqu(2==t.appType?"Disc Amount":"Disc Amnt"),e.xp6(2),e.Oqu(2==t.appType?"VAT%":"GST%"),e.xp6(2),e.Oqu(2==t.appType?"VAT Amount":"GST TaxAmt"),e.xp6(10),e.Oqu(2==t.appType?"Net Amount":"Net Amnt"),e.xp6(3),e.Q6J("ngForOf",t._trnMainService.TrnMainObj.ProdList)}}function zt(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr")(2,"td")(3,"input",60),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.header=n)})("change",function(){const r=e.CHM(t).$implicit;return e.KtG(r.dirty=1)}),e.qZA()(),e.TgZ(4,"td")(5,"input",61),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.hidden=n)})("change",function(n){const o=e.CHM(t).$implicit,s=e.oxw();return o.hidden=!!n.target.checked,o.dirty=1,e.KtG(s.onHiddenChange(o))}),e.qZA()(),e.TgZ(6,"td")(7,"input",60),e.NdJ("ngModelChange",function(n){const o=e.CHM(t).$implicit;return e.KtG(o.headerNgStyle.width=n)})("change",function(){const r=e.CHM(t).$implicit;return e.KtG(r.dirty=1)}),e.qZA()()(),e.BQk()}if(2&a){const t=c.$implicit;e.xp6(3),e.s9C("placeholder",t.header),e.Q6J("ngModel",t.header),e.xp6(2),e.Q6J("ngModel",t.hidden)("checked",1==t.hidden),e.xp6(2),e.s9C("placeholder",t.headerNgStyle.width),e.Q6J("ngModel",t.headerNgStyle.width)}}const ti=["genericHOSalesInvoiceGridTI"],ii=["genericsGridSAPPI"];function ni(a,c){if(1&a&&(e.TgZ(0,"div",9)(1,"div",10)(2,"div",11),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",12)(5,"label",13),e._uU(6),e.qZA(),e.TgZ(7,"div"),e._UZ(8,"voucher-sidebar-billdetail"),e.qZA()(),e.TgZ(9,"div",14),e._UZ(10,"voucher-master-action"),e.qZA()()()),2&a){const t=e.oxw();e.xp6(6),e.AsE("",t._trnMainService.pageHeading,"[",t._trnMainService.TrnMainObj.Mode,"] ")}}function ri(a,c){1&a&&(e.TgZ(0,"div"),e._UZ(1,"trnmain-purchase-entry",17),e.qZA())}function oi(a,c){if(1&a&&(e.TgZ(0,"div",15),e.YNc(1,ri,2,0,"div",16),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.masterService.ShowMore)}}function ai(a,c){1&a&&(e.TgZ(0,"div",18),e._UZ(1,"voucher-total-area"),e.qZA())}const ci=["genericHOSalesInvoiceGridTI"],di=["genericsGridSAPPI"],li=["fileUploadPopup"];function hi(a,c){if(1&a&&(e.ynx(0),e.TgZ(1,"div",16)(2,"span")(3,"b"),e._uU(4,"PO Qty:"),e.qZA(),e._uU(5),e.qZA()(),e.TgZ(6,"div",21)(7,"span")(8,"b"),e._uU(9,"Rate:"),e.qZA(),e._uU(10),e.ALo(11,"currency"),e.qZA()(),e.BQk()),2&a){const t=e.oxw(2);e.xp6(5),e.AsE("\xa0",t._trnMainService.purchaseOrderQty," \xa0 ",t._trnMainService.produstWiseOrderUnit," "),e.xp6(5),e.hij("\xa0",e.Dn7(11,3,t._trnMainService.purchaseOrderRate,"INR","Rs. ")," ")}}function ui(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",9)(1,"div",10)(2,"div",11),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",12)(5,"label",13),e._uU(6),e.qZA(),e.TgZ(7,"div"),e._UZ(8,"voucher-sidebar-billdetail"),e.qZA()(),e.TgZ(9,"div",14),e.YNc(10,hi,12,7,"ng-container",15),e.qZA(),e.TgZ(11,"div",16)(12,"voucher-master-action",17),e.NdJ("onLoadFromHoTaxInvoiceClickEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showSupplierSalesInvoiceFromHOPopup(n))})("onLoadFromSAPFTPClickEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showSAPPurchaseInvoice(n))})("onFileUploadPopupEmit",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.showPurchaseInvoicePopup(n))}),e.qZA(),e.TgZ(13,"generic-popup-grid",18,19),e.NdJ("onItemDoubleClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onHoSalesInvoiceSelect(n))}),e.qZA(),e.TgZ(15,"generic-popup-grid",18,20),e.NdJ("onItemDoubleClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onSAPPurchaseInvoiceSelect(n))}),e.qZA()()()()}if(2&a){const t=e.oxw();e.xp6(6),e.AsE("",t._trnMainService.pageHeading," [",t._trnMainService.TrnMainObj.Mode,"] "),e.xp6(4),e.Q6J("ngIf",0!=t.userSetting.PODELIVERYMODE&&t._trnMainService.TrnMainObj.REFORDBILL),e.xp6(3),e.Q6J("popupsettings",t.gridHoSalesInvoicePopupSettings),e.xp6(2),e.Q6J("popupsettings",t.gridSAPPIPopupSettings)}}function pi(a,c){if(1&a&&(e.TgZ(0,"div",22)(1,"div",23),e._UZ(2,"trnmain-purchase-entry",24),e.qZA()()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("hidden",!t.masterService.ShowMore)}}const vi=N.Bz.forChild([{path:"",component:Se,children:[{path:"add-purchase-invoice",component:ve,canActivate:[k.C]},{path:"asset-purchase-invoice",component:ve,canActivate:[k.C]},{path:"add-debitnote-itembase",component:Pt,canActivate:[k.C]},{path:"add-purchase-order",component:It,canActivate:[k.C]},{path:"purchase-import",component:Ft,canActivate:[k.C]},{path:"goods-received-note",component:(()=>{class a{constructor(t,i,n,r,o,s,u,T,C,x,O,w,M,A){this.masterService=t,this._trnMainService=i,this.dialog=n,this.alertService=r,this.loadingSerive=o,this.authservice=s,this.route=u,this.genericProductEntryService=T,this.itemKeyEventService=C,this.quantityChangeEventService=x,this.entryValidateService=O,this.productHelperService=w,this.modalService=M,this.masterService2=A,this.hideShow=!1,this.fileUploadPopupSettings=new I.s,this.gridHoSalesInvoicePopupSettings=new E.im,this.gridSAPPIPopupSettings=new E.im,this.disableView=!1,this.prefix={},this.activatedRoute={},this.userProfile={},this.userProfile=s.getUserProfile(),this.userSetting=this.authservice.getSetting(),this.appType=this.masterService.appType,this._trnMainService.urlpath=this.route.snapshot.url[0].path,this._trnMainService.initialFormLoad(31),t.Currencies=[],t.getCurrencies(),this.gridHoSalesInvoicePopupSettings={title:"Sales Invoices From Supplier",apiEndpoints:"/getAllHOTaxInvoicePagedList",defaultFilterIndex:0,columns:[{key:"CHALANNO",title:"Bill No",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"Date",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"Amount",hidden:!1,noSearch:!1}]},this.gridSAPPIPopupSettings={title:"Purchase Invoice From SAP",apiEndpoints:"/getAllSAPPurchaseInvoicePagedList",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"VOUCHER NO.",hidden:!1,noSearch:!1},{key:"PLANTDESC",title:"PLANT",hidden:!1,noSearch:!1},{key:"INVDATE",title:"INVOICE DATE",hidden:!1,noSearch:!1}]},this.route.queryParams.subscribe(S=>{"DRILL"!=S.mode&&(S.voucher&&(this.getSalesInvoiceFromSupplier(S.voucher,S.fromcompanyid),this._trnMainService.fromNotification=S.fromNotification),S.status&&1==S.status&&(this._trnMainService.showPerformaApproveReject=!1))})}ngOnInit(){this.route.queryParams.subscribe(t=>{if("DRILL"==t.mode){let i=t.voucher,n=[];n=i.split("-"),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(i,n[1],n[2]).subscribe(r=>{"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.VoucherType=31,this._trnMainService.pageHeading="Goods Received Note",this._trnMainService.TrnMainObj.VoucherPrefix="GR",this._trnMainService.TrnMainObj.Mode="VIEW",null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}),this._trnMainService.TrnMainObj.ProdList.forEach(o=>o.rowMode="VIEW"),this._trnMainService.ReCalculateBillWithNormal())},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}else this.masterService.refreshTransactionList(),this._trnMainService.TrnMainObj.TRNMODE="credit",this.masterService.getPurchaseAcList().subscribe(i=>{this._trnMainService.PurchaseAcList.push(i)},i=>{this.masterService.resolveError(i,"trnmain-purchase-getPurchaseList")},()=>{0==this._trnMainService.AppSettings.MultiplePurchaseAccount&&(this._trnMainService.TrnMainObj.RETTO=this._trnMainService.AppSettings.PurchaseAc)}),this.masterService.getCashList().subscribe(i=>{this._trnMainService.CashList=i},i=>{this.masterService.resolveError(i,"trnmain-purchase-getCashList")}),this.fileUploadPopupSettings=Object.assign(new I.s,{title:"Import Purchase Invoice",sampleFileUrl:`/downloadSampleFile/${this._trnMainService.TrnMainObj.VoucherPrefix}`,uploadEndpoints:`/importFileForTransaction/${this._trnMainService.TrnMainObj.VoucherPrefix}`,allowMultiple:!1,acceptFormat:".xlsx"})}),this.setProductEntryTable()}onShowHide(){console.log("show hide",document.getElementById("exampleModal2"))}showModal(){this.childModal.show()}setProductEntryTable(){var t=this._trnMainService.TrnMainObj.ProdList;this.genericProductEntrySetting=new Y.Vn(this._trnMainService);const i={field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{width:"40px"}},n={field:"MENUCODE",header:"Code",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"},disablePipe:(d,l)=>this.getColumnDisablePipe("disableAltQty",d,l)},r={field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{width:"25%"},disablePipe:(d,l)=>this.getColumnDisablePipe("disableItemDesc",d,l),focusTo:"ALTUNIT"},o={field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"unitsOption",headerNgStyle:{width:"80px"},focusTo:"ALTERNATEQUANTIY",disablePipe:(d,l)=>this.getColumnDisablePipe("disableAltUnit",d,l),onEnter:(d,l,v,Q)=>this.entryValidateService.AlternateUnitEnterEventClick(d,l,v,Q)},s={field:"ALTERNATEQUANTIY",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"ALTRATE",onChange:(d,l,v)=>this.QuantityChangeEvent_default(d,l,v),applyTwoDigitPipe:!1,disablePipe:(d,l)=>this.getColumnDisablePipe("disableAltQty",d,l),decimalPlacesRestriction:"3"},u={field:"ALTRATE",header:"P.Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onEnter:(d,l,v)=>this.mrpEnterEvent(d,l,v),onChange:(d,l,v,Q)=>this.entryValidateService.MRPChangeEvent(d,l,v,Q),focusTo:"INDDISCOUNTRATE",disablePipe:(d,l)=>this.getColumnDisablePipe("disableRateandDiscount",d,l)},T={field:"ECSAMOUNT",header:"ECS",hidden:!(1==this.userSetting.ENABLE_ECS||3==this.userSetting.ENABLE_ECS),isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},C={field:"INDDISCOUNT",header:"Ind. Dis Amt",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(d,l)=>this.getColumnDisablePipe("disableDiscountAmount",d,l),applyTwoDigitPipe:!0,onEnter:(d,l,v)=>{this.genericProductEntryService.discEnterClicked(d,l,v)},onChange:(d,l,v,Q)=>this.genericProductEntryService.IndDiscountAmountChangeEvent(d,l,v,Q),focusTo:"ITEMDESC",decimalPlacesRestriction:"2"},x={field:"INDDISCOUNTRATE",header:"Ind. Dis%",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(d,l)=>this.getColumnDisablePipe("disableDiscountRate",d,l),applyTwoDigitPipe:!1,onEnter:(d,l,v)=>{this.genericProductEntryService.discRateEnterClicked(d,l,v),this.genericProductEntryService.IndDiscountRateChangeEvent(d,v,l)},onChange:(d,l,v)=>this.genericProductEntryService.IndDiscountRateChangeEvent(d,l,v),onModelChange:(d,l,v)=>this.genericProductEntryService.IndDiscountModelRateChange(d,l,v),focusTo:"INDDISCOUNT",decimalPlacesRestriction:"2"},O={field:"DISCOUNT",header:"Total Disc",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"70px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onHover:d=>{this.genericProductEntryService.onHover(d)},displayOnHover:!0},w={field:"AMOUNT",header:"Amnt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},M={field:"VAT",header:"VAT",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},A={field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},S={field:"CRATE",header:"Net Rate",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},V={field:"MFGDATE",header:"Mfg Date",hidden:!!this.userSetting.IsBBSM,inputType:"date",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right","font-size":"11px"},applyTwoDigitPipe:!1,disablePipe:(d,l)=>this.getColumnDisablePipe("disableMfgDate",d,l),onModelChange:(d,l,v,Q)=>this.productHelperService.CalculateExpiryDate(Q.MFGDATE,v,Q)},ae={field:"EXPDATE",header:"Exp Date",hidden:!!this.userSetting.IsBBSM,inputType:"date",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right","font-size":"11px"},applyTwoDigitPipe:!1,disablePipe:(d,l)=>this.getColumnDisablePipe("disableExpDate",d,l)},re={field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"}},le=[];this.userSetting.IsBBSM?le.push(i,n,r,o,{field:"OrderQty",header:"Order Qty",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{width:"100px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"",onChange:(d,l,v)=>this.QuantityChangeEvent_default(d,l,v),applyTwoDigitPipe:!1,disablePipe:(d,l)=>this.getColumnDisablePipe("disableAltQty",d,l)},{field:"ChalanQty",header:"Chalan Qty",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{width:"100px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"",onChange:(d,l,v)=>this.QuantityChangeEvent_default(d,l,v),applyTwoDigitPipe:!1,disablePipe:(d,l)=>this.getColumnDisablePipe("disableAltQty",d,l)},{field:"QuantityDifference",header:"Difference",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{width:"100px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"",onChange:(d,l,v)=>this.QuantityChangeEvent_default(d,l,v),applyTwoDigitPipe:!1,disablePipe:(d,l)=>this.getColumnDisablePipe("disableAltQty",d,l),colorPipe:(d,l,v)=>this.getColColor(d,l,v)},{field:"ALTERNATEQUANTIY",header:"Approved Qty",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{width:"100px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"",onChange:(d,l,v)=>this.QuantityChangeEvent_default(d,l,v),applyTwoDigitPipe:!1,disablePipe:(d,l)=>this.getColumnDisablePipe("disableRateandDiscount",d,l)},{field:"SellingPrice",header:"Last S.P",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"100px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"",onChange:(d,l,v)=>this.QuantityChangeEvent_default(d,l,v),applyTwoDigitPipe:!1,disablePipe:(d,l)=>this.getColumnDisablePipe("disableRateandDiscount",d,l)},{field:"SELLRATEBEFORETAX",header:"NEW S.P",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"100px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"",onChange:(d,l,v)=>this.QuantityChangeEvent_default(d,l,v),applyTwoDigitPipe:!1,disablePipe:(d,l)=>this.getColumnDisablePipe("disableRateandDiscount",d,l)},u,T,x,C,w,M,A,S,V,ae,re):le.push(i,n,r,o,s,u,T,x,C,O,w,M,A,S,{field:"MRP",header:"MRP",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},V,ae,re),this.genericProductEntrySetting.columns=le,console.log("check",this.genericProductEntrySetting.columns),this.genericProductEntrySetting.height="300px",this.genericProductEntrySetting.prodlist=t,this.genericProductEntrySetting.voucherType=b.Km.Purchase,this.genericProductEntrySetting.setRowItemFromSelectedItem=d=>this.SetRowItemFromSelectedItem(d),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(d,l=new Function)=>this.SetRowItemRate(d,l)}getColColor(t,i,n){if(i.MCODE){if(i.OrderQty==i.ChalanQty)return"green";if(0==i.ChalanQty)return"purple";if(i.OrderQty<i.ChalanQty)return"red";if(i.OrderQty>i.ChalanQty)return"yellow"}}getColumnDisablePipe(t,i,n){return t}SetRowItemRate(t,i){i()}SetAllUnitsOfItem(){this._trnMainService.getAllUnitsOfItem(this.genericProductEntryService.activerowIndex)}SetRowItemFromSelectedItem(t){let i=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];this._trnMainService.prepareItem(i,t),this._trnMainService.assignPrateaAsRATE(i,t)}mrpEnterEvent(t,i,n){this.entryValidateService.mrpEnterEvent(t,i,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}showGenericGrid(t){this.itemKeyEventService.ItemkeyEvent(t.index,t.event,()=>p.K.done,i=>p.K.default,()=>p.K.default,()=>p.K.done,()=>p.K.default)}itemKeyEvent_CheckRefBill(){{this.genericProductEntryService.showStockedQuantityOnly=0;let i,t="";null!=this._trnMainService.TrnMainObj.VoucherPrefix&&(t=this._trnMainService.TrnMainObj.VoucherPrefix);let n="";return n=this._trnMainService.TrnMainObj.MWAREHOUSE?this._trnMainService.TrnMainObj.MWAREHOUSE:this._trnMainService.userProfile.userWarehouse,i=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BC,(0==this._trnMainService.userSetting.GblBarcodeWiseBilling||null==i||void 0===i||""==i)&&(i="A"),this.genericProductEntryService.gridPopupSettings.apiEndpoints=`/getMenuitemWithStockPagedList/${this.genericProductEntryService.showStockedQuantityOnly}/${i}/all/${t}/${n}`,this._trnMainService.itemselectevent=!0,this.genericProductEntryService.genericGrid.show(this._trnMainService.TrnMainObj.REFBILL),!1}}showPurchaseInvoicePopup(){null!=this._trnMainService.TrnMainObj.PARAC&&""!=this._trnMainService.TrnMainObj.PARAC?this.fileUploadPopup.show():this.alertService.warning("Please select the supplier...")}onClickPoReferenceProduct(t){t&&(this._trnMainService.purchaseOrderQty=t.ALTERNATEQTY,this._trnMainService.purchaseOrderRate=t.RATE)}QuantityChangeEvent_default(t,i,n){this.quantityChangeEventService.QuantityChangeEvent(n)}fileUploadSuccess(t){if("ok"==t.status){this._trnMainService.TrnMainObj.ProdList=t.result,this._trnMainService.TrnMainObj.tag="FROMEXCEL";for(let i in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.setAltunitDropDownForView(i),this._trnMainService.TrnMainObj.ProdList[i].PRATE=this._trnMainService.TrnMainObj.ProdList[i].REALRATE=this._trnMainService.TrnMainObj.ProdList[i].ALTRATE=this._trnMainService.TrnMainObj.ProdList[i].RATE=this._trnMainService.TrnMainObj.ProdList[i].REALRATE,this._trnMainService.TrnMainObj.ProdList[i].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[i].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[i].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[i].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[i].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[i].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[i].OtherDiscount=this._trnMainService.TrnMainObj.ProdList[i].INDODAMT;this._trnMainService.ReCalculateBillWithNormal(),this.loadingSerive.hide()}else this.loadingSerive.hide(),this.alertService.error(t.result._body)}showSupplierSalesInvoiceFromHOPopup(){this.genericHOSalesInvoiceGridTI.show()}onHoSalesInvoiceSelect(t){this.getSalesInvoiceFromSupplier(t.VCHRNO,t.FROMCOMPANY),this.markAsRead(t)}markAsRead(t){this.redirectToBestRoute(t),!t.ISSEEN&&this.masterService.markAsRead(t.ID).subscribe(i=>{},i=>{})}redirectToBestRoute(t){}getSalesInvoiceFromSupplier(t,i){this.loadingSerive.show("Getting Data. Please Wait..."),this.masterService.loadSalesInvoiceFromSupplierHO(t,i).subscribe(n=>{if(this.loadingSerive.hide(),"ok"==n.status){if(this._trnMainService.TrnMainObj=n.result,this._trnMainService.disableAllFieldinPurchase=!0,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherType=3,this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.VoucherAbbName="PI",this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.REFBILL=t,this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="",this._trnMainService.TrnMainObj.DIVISION=this.userProfile.CompanyInfo.INITIAL;for(let r in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[r].inputMode=!1,this._trnMainService.TrnMainObj.ProdList[r].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[r].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[r].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[r].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[r].EXPDATE.toString().substring(0,10);this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate()}},n=>{this.loadingSerive.hide()})}showSAPPurchaseInvoice(){this.genericsGridSAPPI.show()}onSAPPurchaseInvoiceSelect(t){this.disableView=!0,this.loadSAPPurchaseInvoice(t.VCHRNO)}loadSAPPurchaseInvoice(t){this.loadingSerive.show("Getting Data. Please Wait..."),this.masterService.loadSAPPurchaseInvoiceDetail(t).subscribe(i=>{if(this.loadingSerive.hide(),"ok"==i.status){if(this._trnMainService.TrnMainObj=i.result,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherType=3,this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.VoucherAbbName="PI",this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.REFBILL=t,this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="",this._trnMainService.TrnMainObj.tag="FTP";for(let n in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[n].inputMode=!1,this._trnMainService.setAltunitDropDownForView(n),this._trnMainService.AssignSellingPriceAndDiscounts(this._trnMainService.TrnMainObj.ProdList[n].PClist,n),this._trnMainService.TrnMainObj.ProdList[n].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[n].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[n].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[n].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[n].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[n].EXPDATE.toString().substring(0,10);this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate()}else this.loadingSerive.hide(),this.alertService.error(i.result._body)},i=>{this.loadingSerive.hide()})}saveTaxInvoice(){this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.tag="shipto",this.alertService.show(),this.masterService.saveTransaction(this._trnMainService.TrnMainObj.Mode,this._trnMainService.TrnMainObj).subscribe(t=>{"ok"==t.status&&(this.alertService.hide(),this.popupClose())},t=>{this.alertService.error(t)})}popupClose(){this._trnMainService.initialFormLoad(3)}onHideModalSetting(){this.childModal.hide()}onSaveModalSetting(){console.log("Sved data",this.genericProductEntrySetting.columns),this.childModal.hide()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(j.P),e.Y36(y.p),e.Y36(ee.uw),e.Y36(G.c),e.Y36(F.V),e.Y36(H.e),e.Y36(N.gz),e.Y36(R.w),e.Y36(p.X),e.Y36(Z.s),e.Y36(D.C),e.Y36(K.h),e.Y36(oe.tT),e.Y36(de.mD))},a.\u0275cmp=e.Xpm({type:a,selectors:[["goods-received-note"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Ht,5),e.Gf(qt,5),e.Gf(Vt,5),e.Gf(Qt,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.childModal=n.first),e.iGM(n=e.CRH())&&(i.genericHOSalesInvoiceGridTI=n.first),e.iGM(n=e.CRH())&&(i.genericsGridSAPPI=n.first),e.iGM(n=e.CRH())&&(i.fileUploadPopup=n.first)}},features:[e._Bn([y.p,D.C,p.X,K.h,R.w,Z.s])],decls:37,vars:6,consts:[[1,"sectionWrapper"],[1,"topWrapper"],["class","sticky-top",4,"ngIf"],["class","main-container",4,"ngIf"],[1,"midTableWrapper"],[1,"row","row-margin"],[1,"col-md-12","pd5"],[3,"GenericProductEntrySetting","ShowGenericGridEvent","onClickItemSelectPopUp"],["class","footer-wrapper",4,"ngIf"],[4,"ngIf"],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","exampleModal2Label","aria-hidden","true",1,"modal","fade",2,"height","100vh"],["exampleModal2","bs-modal"],["rzHandles","all","role","document",1,"modal-dialog","modal-lg",2,"top","2%","left","19%"],["block",""],[1,"modal-content"],[1,"modal-header"],["id","exampleModal2Label",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"hide-show-model-title"],[1,"modal-body",2,"overflow","auto","height","500px"],[1,"table"],[1,"thead-dark"],[2,"height","30vh"],[4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary",3,"click"],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-1","pd0"],[1,"col-md-3","pd0"],[2,"white-space","nowrap","margin-left","-33px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-3","row",2,"padding-top","0.8vh","font-size","15px","font-style","italic","padding-left","0px","padding-right","0px"],[1,"col-md-5","pd0"],[3,"onLoadFromHoTaxInvoiceClickEmit","onLoadFromSAPFTPClickEmit","onFileUploadPopupEmit"],[3,"popupsettings","onItemDoubleClick"],["genericHOSalesInvoiceGridTI",""],["genericsGridSAPPI",""],[1,"col-md-6","pd0"],[1,"main-container"],[3,"hidden"],["viewDisable","disableView"],["class","col-md-12 pd5",4,"ngIf"],[1,"footer-wrapper"],[2,"display","block","padding","0px","left","10px","padding","0px","top","101px","width","99%"],[2,"padding","0px","background","#c0c0c0"],[1,"col-md-3"],[1,"btn","btn-info",3,"click"],[2,"background-color","#FFFFFF","height","450px","overflow-x","scroll","width","100%"],[1,"table",2,"margin-bottom","5px","font-size","12.5px","width","2000px","overflow","scroll"],[2,"border-bottom","2px solid #E6E6E6","border-top","2px solid #E6E6E6","height","30px","background","silver","color","black"],["style","border: 1px",4,"ngFor","ngForOf"],[2,"border","1px"],[2,"border","1px solid #e6e6e6","max-height","25px"],[2,"border","1px solid #e6e6e6","width","20px",3,"id"],[2,"height","23px","border","1px solid #e6e6e6","width","80px"],[2,"border","1px solid #e6e6e6","width","300px","background-color","#f9f9f9"],[2,"height","23px","border","1px solid #e6e6e6","width","150px"],[2,"height","23px","border","1px solid #e6e6e6","width","100px"],[2,"height","23px","border","1px solid #e6e6e6","width","100px","background-color","#f9f9f9"],["type","text",2,"width","90%","border","1px solid #ddd",3,"ngModel","placeholder","ngModelChange","change"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Yt,17,5,"div",2),e.YNc(3,Jt,5,2,"div",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"generic-product-entry",7),e.NdJ("ShowGenericGridEvent",function(r){return i.showGenericGrid(r)})("onClickItemSelectPopUp",function(r){return i.onClickPoReferenceProduct(r)}),e.qZA()()()(),e.YNc(8,Wt,2,0,"div",8),e.qZA(),e.YNc(9,$t,64,9,"div",9),e.TgZ(10,"div",10,11)(12,"div",12,13)(14,"div",14)(15,"div",15)(16,"h5",16),e._uU(17," Column format Configuration "),e.qZA(),e.TgZ(18,"button",17),e.NdJ("click",function(){return i.childModal.hide()}),e.TgZ(19,"span",18),e._uU(20,"\xd7"),e.qZA()()(),e.TgZ(21,"div",19)(22,"div",20)(23,"table",21)(24,"thead",22)(25,"tr")(26,"th"),e._uU(27,"Column Title"),e.qZA(),e.TgZ(28,"th"),e._uU(29,"Hidden"),e.qZA(),e.TgZ(30,"th"),e._uU(31,"Width"),e.qZA()()(),e.TgZ(32,"tbody",23),e.YNc(33,zt,8,6,"ng-container",24),e.qZA()()(),e.TgZ(34,"div",25)(35,"button",26),e.NdJ("click",function(){return i.onHideModalSetting()}),e._uU(36," OK "),e.qZA()()()()()()),2&t&&(e.xp6(2),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(4),e.Q6J("GenericProductEntrySetting",i.genericProductEntrySetting),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",i._trnMainService.TrnMainObj.hasShipName),e.xp6(24),e.Q6J("ngForOf",i.genericProductEntrySetting.columns))},dependencies:[J.v,W.q,X.i,q.u,$.d,m.sg,m.O5,f.Fj,f.Wl,f.JJ,f.On,E.Zl,ie.o,z.Z,oe.oB,m.H9,m.uU,ne.g],styles:[".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n      text-align: center;\n      vertical-align: middle;\n    }\n    .dotted-menu[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%] {\n    height: 6px;\n    width: 6px;\n    background-color: #209e91;\n    border-radius: 50%;\n    display: inline-block;\n    margin-right: 3px;\n  }\n  .dotted-menu[_ngcontent-%COMP%] {\n    margin-left: 7px;\n  }"]}),a})(),canActivate:[k.C]},{path:"purchase-import-order",component:(()=>{class a{constructor(t,i,n,r,o,s,u,T,C,x,O){this.masterService=t,this._trnMainService=i,this.dialog=n,this.alertService=r,this.loadingSerive=o,this.authservice=s,this.route=u,this.genericProductEntryService=T,this.itemKeyEventService=C,this.quantityChangeEventService=x,this.entryValidateService=O,this.hideShow=!1,this.gridHoSalesInvoicePopupSettings=new E.im,this.gridSAPPIPopupSettings=new E.im,this.disableView=!1,this.prefix={},this.userProfile={},this.userSetting=this.authservice.getSetting(),this.appType=this.masterService.appType,this._trnMainService.initialFormLoad(19),this._trnMainService.urlpath=this.route.snapshot.url[0].path,this._trnMainService.TrnMainObj.CNDN_MODE=10,this._trnMainService.pageHeading="IMPORT PURCHASE ORDER",this._trnMainService.TrnMainObj.AdditionalObj.tag="IMPORT_PURCHASE_ORDER",t.Currencies=[],t.getCurrencies().subscribe(w=>{t.Currencies=w}),this.userProfile=s.getUserProfile()}ngOnInit(){this.route.queryParams.subscribe(t=>{if("DRILL"==t.mode){let i=t.voucher,n=[];n=i.split("-"),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(i,n[1],n[2]).subscribe(r=>{"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.VoucherType=19,this._trnMainService.TrnMainObj.CNDN_MODE=10,this._trnMainService.pageHeading="IMPORT PURCHASE ORDER",this._trnMainService.TrnMainObj.AdditionalObj.tag="IMPORT_PURCHASE_ORDER",this._trnMainService.TrnMainObj.VoucherPrefix="PO",this._trnMainService.TrnMainObj.Mode="VIEW",null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}),this._trnMainService.TrnMainObj.ProdList.forEach(o=>o.rowMode="VIEW"),this._trnMainService.ReCalculateBillWithNormal())},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}else this.masterService.refreshTransactionList()}),this.setProductEntryTable()}setProductEntryTable(){var t=this._trnMainService.TrnMainObj.ProdList;this.genericProductEntrySetting=new Y.Vn(this._trnMainService),this.genericProductEntrySetting.columns=[{field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"40px"}},{field:"MENUCODE",header:"Code",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"70px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r)},{field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"250px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableItemDesc",n,r),focusTo:"ALTUNIT"},{field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"unitsOption",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"70px"},focusTo:"ALTERNATEQUANTIY",disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltUnit",n,r),onEnter:(n,r,o,s)=>this.entryValidateService.AlternateUnitEnterEventClick(n,r,o,s)},{field:"ALTERNATEQUANTIY",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"INVRATE",onChange:(n,r,o)=>this.QuantityChangeEvent_default(n,r,o),applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r)},{field:"INVRATE",header:"FC P.Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onEnter:(n,r,o)=>this.entryValidateService.calculateFCRATEChangeEvent(r),onChange:(n,r,o,s)=>this.entryValidateService.calculateFCRATEChangeEvent(o),focusTo:"INDDISCOUNTRATE",disablePipe:(n,r)=>this.getColumnDisablePipe("disableFCrate",n,r)},{field:"ALTRATE",header:"P.Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,disablePipe:(n,r)=>this.getColumnDisablePipe("disableRateandDiscount",n,r)},{field:"AMOUNT",header:"Amnt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"INDDISCOUNTRATE",header:"Dis%",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountRate",n,r),applyTwoDigitPipe:!1,onEnter:(n,r,o)=>{this.genericProductEntryService.discRateEnterClicked(n,r,o),this.genericProductEntryService.IndDiscountRateChangeEvent(n,o,r)},onChange:(n,r,o)=>this.genericProductEntryService.IndDiscountRateChangeEvent(n,r,o),focusTo:"INDDISCOUNT",decimalPlacesRestriction:"2"},{field:"INDDISCOUNT",header:"Dis Amt",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountAmount",n,r),applyTwoDigitPipe:!0,onEnter:(n,r,o)=>{this.genericProductEntryService.discEnterClicked(n,r,o)},onChange:(n,r,o,s)=>this.genericProductEntryService.IndDiscountAmountChangeEvent(n,r,o,s),focusTo:"ITEMDESC",decimalPlacesRestriction:"2"},{field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"}}],this.genericProductEntrySetting.height="100%",this.genericProductEntrySetting.prodlist=t,this.genericProductEntrySetting.voucherType=b.Km.Purchase,this.genericProductEntrySetting.setRowItemFromSelectedItem=n=>this.SetRowItemFromSelectedItem(n),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(n,r=new Function)=>this.SetRowItemRate(n,r)}showGenericGrid(t){this.itemKeyEventService.ItemkeyEvent(t.index,t.event,()=>p.K.default,i=>p.K.default,()=>p.K.default,()=>p.K.default,()=>p.K.default)}mrpEnterEvent(t,i,n){this.entryValidateService.mrpEnterEvent(t,i,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}SetRowItemFromSelectedItem(t){let i=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];this._trnMainService.prepareItem(i,t),this._trnMainService.assignPrateaAsRATE(i,t)}SetAllUnitsOfItem(){this._trnMainService.getAllUnitsOfItem(this.genericProductEntryService.activerowIndex)}QuantityChangeEvent_default(t,i,n){this.quantityChangeEventService.QuantityChangeEvent(n)}SetRowItemRate(t,i){i()}getColumnDisablePipe(t,i,n){return t}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(j.P),e.Y36(y.p),e.Y36(ee.uw),e.Y36(G.c),e.Y36(F.V),e.Y36(H.e),e.Y36(N.gz),e.Y36(R.w),e.Y36(p.X),e.Y36(Z.s),e.Y36(D.C))},a.\u0275cmp=e.Xpm({type:a,selectors:[["purchase-import-order"]],viewQuery:function(t,i){if(1&t&&(e.Gf(ti,5),e.Gf(ii,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.genericHOSalesInvoiceGridTI=n.first),e.iGM(n=e.CRH())&&(i.genericsGridSAPPI=n.first)}},features:[e._Bn([y.p,D.C,p.X,R.w,Z.s])],decls:9,vars:4,consts:[[1,"sectionWrapper"],[1,"topWrapper"],["class","sticky-top",4,"ngIf"],["class","main-container",4,"ngIf"],[1,"midTableWrapper"],[1,"row","row-margin"],[1,"col-md-12","pd5"],[3,"GenericProductEntrySetting","ShowGenericGridEvent"],["class","footer-wrapper",4,"ngIf"],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-2","pd0"],[1,"col-md-3","pd0"],[2,"white-space","nowrap","margin-left","-145px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-7"],[1,"main-container"],[4,"ngIf"],["viewDisable","disableView"],[1,"footer-wrapper"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,ni,11,2,"div",2),e.YNc(3,oi,2,1,"div",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"generic-product-entry",7),e.NdJ("ShowGenericGridEvent",function(r){return i.showGenericGrid(r)}),e.qZA()()()(),e.YNc(8,ai,2,0,"div",8),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(4),e.Q6J("GenericProductEntrySetting",i.genericProductEntrySetting),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName))},dependencies:[J.v,W.q,X.i,q.u,$.d,m.O5,z.Z],styles:[".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n      text-align: center;\n      vertical-align: middle;\n    }"]}),a})(),canActivate:[k.C]},{path:"goods-received-note-import",component:(()=>{class a{constructor(t,i,n,r,o,s,u,T,C,x,O,w,M,A){this.masterService=t,this._trnMainService=i,this.dialog=n,this.alertService=r,this.loadingSerive=o,this.authservice=s,this.route=u,this.genericProductEntryService=T,this.itemKeyEventService=C,this.quantityChangeEventService=x,this.entryValidateService=O,this.productHelperService=w,this.modalService=M,this.masterService2=A,this.hideShow=!1,this.fileUploadPopupSettings=new I.s,this.gridHoSalesInvoicePopupSettings=new E.im,this.gridSAPPIPopupSettings=new E.im,this.disableView=!1,this.prefix={},this.activatedRoute={},this.userProfile={},this.userProfile=s.getUserProfile(),this.userSetting=this.authservice.getSetting(),this.appType=this.masterService.appType,this._trnMainService.urlpath=this.route.snapshot.url[0].path,this._trnMainService.initialFormLoad(31),this._trnMainService.TrnMainObj.CNDN_MODE=10,this._trnMainService.pageHeading="GRN - IMPORT",this._trnMainService.TrnMainObj.AdditionalObj.tag="GOODS_RECEIVED_NOTE_IMPORT",t.Currencies=[],t.getCurrencies().subscribe(S=>{t.Currencies=S}),this.route.queryParams.subscribe(S=>{"DRILL"!=S.mode&&(S.voucher&&(this.getSalesInvoiceFromSupplier(S.voucher,S.fromcompanyid),this._trnMainService.fromNotification=S.fromNotification),S.status&&1==S.status&&(this._trnMainService.showPerformaApproveReject=!1))})}ngOnInit(){this.route.queryParams.subscribe(t=>{if("DRILL"==t.mode){let i=t.voucher,n=[];n=i.split("-"),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(i,n[1],n[2]).subscribe(r=>{"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.VoucherType=31,this._trnMainService.pageHeading="Goods Received Note - Import",this._trnMainService.TrnMainObj.VoucherPrefix="GR",this._trnMainService.TrnMainObj.Mode="VIEW",null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}),this._trnMainService.TrnMainObj.ProdList.forEach(o=>o.rowMode="VIEW"),this._trnMainService.ReCalculateBillWithNormal())},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}else this.masterService.refreshTransactionList(),this._trnMainService.TrnMainObj.TRNMODE="credit",this.masterService.getPurchaseAcList().subscribe(i=>{this._trnMainService.PurchaseAcList.push(i)},i=>{this.masterService.resolveError(i,"trnmain-purchase-getPurchaseList")},()=>{0==this._trnMainService.AppSettings.MultiplePurchaseAccount&&(this._trnMainService.TrnMainObj.RETTO=this._trnMainService.AppSettings.PurchaseAc)}),this.masterService.getCashList().subscribe(i=>{this._trnMainService.CashList=i},i=>{this.masterService.resolveError(i,"trnmain-purchase-getCashList")}),this.fileUploadPopupSettings=Object.assign(new I.s,{title:"Import Purchase Invoice",sampleFileUrl:`/downloadSampleFile/${this._trnMainService.TrnMainObj.VoucherPrefix}`,uploadEndpoints:`/importFileForTransaction/${this._trnMainService.TrnMainObj.VoucherPrefix}`,allowMultiple:!1,acceptFormat:".xlsx"})}),this.setProductEntryTable()}onShowHide(){console.log("show hide",document.getElementById("exampleModal2"))}showModal(){}setProductEntryTable(){var t=this._trnMainService.TrnMainObj.ProdList;this.genericProductEntrySetting=new Y.Vn(this._trnMainService);const re=[];re.push({field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{width:"40px"}},{field:"MENUCODE",header:"Code",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"},disablePipe:(g,_)=>this.getColumnDisablePipe("disableAltQty",g,_)},{field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{width:"25%"},disablePipe:(g,_)=>this.getColumnDisablePipe("disableItemDesc",g,_),focusTo:"ALTUNIT"},{field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"unitsOption",headerNgStyle:{width:"80px"},focusTo:"ALTERNATEQUANTIY",disablePipe:(g,_)=>this.getColumnDisablePipe("disableAltUnit",g,_),onEnter:(g,_,P,U)=>this.entryValidateService.AlternateUnitEnterEventClick(g,_,P,U)},{field:"ALTERNATEQUANTIY",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:0==this.userSetting.IMPORTPOBILLMODE?"INVRATE":"INDDISCOUNTRATE",applyTwoDigitPipe:!1,onChange:(g,_,P)=>this.QuantityChangeEvent_default(g,_,P),disablePipe:(g,_)=>this.getColumnDisablePipe("disableAltQty",g,_)},{field:"INVRATE",header:"FC P.Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyThreeDigitPipe:!0,disablePipe:(g,_)=>this.getColumnDisablePipe("disableFCrate",g,_),onEnter:(g,_,P)=>this.entryValidateService.calculateFCRATEChangeEvent(_),onChange:(g,_,P,U)=>this.entryValidateService.calculateFCRATEChangeEvent(P),focusTo:"INDDISCOUNTRATE"},{field:"ALTRATE",header:"P.Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onEnter:(g,_,P)=>this.mrpEnterEvent(g,_,P),onChange:(g,_,P,U)=>this.entryValidateService.MRPChangeEvent(g,_,P,U),focusTo:"INDDISCOUNTRATE",disablePipe:(g,_)=>this.getColumnDisablePipe("disableRateandDiscount",g,_)},{field:"ECSAMOUNT",header:"ECS",hidden:!(1==this.userSetting.ENABLE_ECS||3==this.userSetting.ENABLE_ECS),isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"INDDISCOUNTRATE",header:"Ind. Dis%",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(g,_)=>this.getColumnDisablePipe("disableDiscountRate",g,_),applyTwoDigitPipe:!1,onEnter:(g,_,P)=>{this.genericProductEntryService.discRateEnterClicked(g,_,P),this.genericProductEntryService.IndDiscountRateChangeEvent(g,P,_)},onChange:(g,_,P)=>this.genericProductEntryService.IndDiscountRateChangeEvent(g,_,P),onModelChange:(g,_,P)=>this.genericProductEntryService.IndDiscountModelRateChange(g,_,P),focusTo:"INDDISCOUNT",decimalPlacesRestriction:"2"},{field:"INDDISCOUNT",header:"Ind. Dis Amt",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(g,_)=>this.getColumnDisablePipe("disableDiscountAmount",g,_),applyTwoDigitPipe:!0,onEnter:(g,_,P)=>{this.genericProductEntryService.discEnterClicked(g,_,P)},onChange:(g,_,P,U)=>this.genericProductEntryService.IndDiscountAmountChangeEvent(g,_,P,U),focusTo:"ITEMDESC",decimalPlacesRestriction:"2"},{field:"DISCOUNT",header:"Total Disc",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"70px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onHover:g=>{this.genericProductEntryService.onHover(g)},displayOnHover:!0},{field:"AMOUNT",header:"Amnt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"CRATE",header:"Net Rate",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"MFGDATE",header:"Mfg Date",hidden:!!this.userSetting.IsBBSM,inputType:"date",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right","font-size":"11px"},applyTwoDigitPipe:!1,disablePipe:(g,_)=>this.getColumnDisablePipe("disableMfgDate",g,_),onModelChange:(g,_,P,U)=>this.productHelperService.CalculateExpiryDate(U.MFGDATE,P,U)},{field:"EXPDATE",header:"Exp Date",hidden:!!this.userSetting.IsBBSM,inputType:"date",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right","font-size":"11px"},applyTwoDigitPipe:!1,disablePipe:(g,_)=>this.getColumnDisablePipe("disableExpDate",g,_)},{field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"}}),this.genericProductEntrySetting.columns=re,console.log("check",this.genericProductEntrySetting.columns),this.genericProductEntrySetting.height="300px",this.genericProductEntrySetting.prodlist=t,this.genericProductEntrySetting.voucherType=b.Km.Purchase,this.genericProductEntrySetting.setRowItemFromSelectedItem=g=>this.SetRowItemFromSelectedItem(g),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(g,_=new Function)=>this.SetRowItemRate(g,_)}getColColor(t,i,n){if(i.MCODE){if(i.OrderQty==i.ChalanQty)return"green";if(0==i.ChalanQty)return"purple";if(i.OrderQty<i.ChalanQty)return"red";if(i.OrderQty>i.ChalanQty)return"yellow"}}getColumnDisablePipe(t,i,n){return t}SetRowItemRate(t,i){i()}SetAllUnitsOfItem(){this._trnMainService.getAllUnitsOfItem(this.genericProductEntryService.activerowIndex)}SetRowItemFromSelectedItem(t){let i=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];this._trnMainService.prepareItem(i,t),this._trnMainService.assignPrateaAsRATE(i,t)}mrpEnterEvent(t,i,n){this.entryValidateService.mrpEnterEvent(t,i,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}showGenericGrid(t){this.itemKeyEventService.ItemkeyEvent(t.index,t.event,()=>p.K.done,i=>p.K.default,()=>p.K.default,()=>p.K.done,()=>p.K.default)}itemKeyEvent_CheckRefBill(){{this.genericProductEntryService.showStockedQuantityOnly=0;let i,t="";null!=this._trnMainService.TrnMainObj.VoucherPrefix&&(t=this._trnMainService.TrnMainObj.VoucherPrefix);let n="";return n=this._trnMainService.TrnMainObj.MWAREHOUSE?this._trnMainService.TrnMainObj.MWAREHOUSE:this._trnMainService.userProfile.userWarehouse,i=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex].BC,(0==this._trnMainService.userSetting.GblBarcodeWiseBilling||null==i||void 0===i||""==i)&&(i="A"),this.genericProductEntryService.gridPopupSettings.apiEndpoints=`/getMenuitemWithStockPagedList/${this.genericProductEntryService.showStockedQuantityOnly}/${i}/all/${t}/${n}`,this._trnMainService.itemselectevent=!0,this.genericProductEntryService.genericGrid.show(this._trnMainService.TrnMainObj.REFBILL),!1}}showPurchaseInvoicePopup(){null!=this._trnMainService.TrnMainObj.PARAC&&""!=this._trnMainService.TrnMainObj.PARAC?this.fileUploadPopup.show():this.alertService.warning("Please select the supplier...")}onClickPoReferenceProduct(t){t&&(this._trnMainService.purchaseOrderQty=t.ALTERNATEQTY,this._trnMainService.purchaseOrderRate=t.RATE)}QuantityChangeEvent_default(t,i,n){this.quantityChangeEventService.QuantityChangeEvent(n)}fileUploadSuccess(t){if("ok"==t.status){this._trnMainService.TrnMainObj.ProdList=t.result,this._trnMainService.TrnMainObj.tag="FROMEXCEL";for(let i in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.setAltunitDropDownForView(i),this._trnMainService.TrnMainObj.ProdList[i].PRATE=this._trnMainService.TrnMainObj.ProdList[i].REALRATE=this._trnMainService.TrnMainObj.ProdList[i].ALTRATE=this._trnMainService.TrnMainObj.ProdList[i].RATE=this._trnMainService.TrnMainObj.ProdList[i].REALRATE,this._trnMainService.TrnMainObj.ProdList[i].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[i].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[i].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[i].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[i].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[i].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[i].OtherDiscount=this._trnMainService.TrnMainObj.ProdList[i].INDODAMT;this._trnMainService.ReCalculateBillWithNormal(),this.loadingSerive.hide()}else this.loadingSerive.hide(),this.alertService.error(t.result._body)}showSupplierSalesInvoiceFromHOPopup(){this.genericHOSalesInvoiceGridTI.show()}redirectToBestRoute(t){}getSalesInvoiceFromSupplier(t,i){this.loadingSerive.show("Getting Data. Please Wait..."),this.masterService.loadSalesInvoiceFromSupplierHO(t,i).subscribe(n=>{if(this.loadingSerive.hide(),"ok"==n.status){if(this._trnMainService.TrnMainObj=n.result,this._trnMainService.disableAllFieldinPurchase=!0,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherType=3,this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.VoucherAbbName="PI",this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.REFBILL=t,this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="",this._trnMainService.TrnMainObj.DIVISION=this.userProfile.CompanyInfo.INITIAL;for(let r in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[r].inputMode=!1,this._trnMainService.TrnMainObj.ProdList[r].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[r].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[r].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[r].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[r].EXPDATE.toString().substring(0,10);this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate()}},n=>{this.loadingSerive.hide()})}showSAPPurchaseInvoice(){this.genericsGridSAPPI.show()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(j.P),e.Y36(y.p),e.Y36(ee.uw),e.Y36(G.c),e.Y36(F.V),e.Y36(H.e),e.Y36(N.gz),e.Y36(R.w),e.Y36(p.X),e.Y36(Z.s),e.Y36(D.C),e.Y36(K.h),e.Y36(oe.tT),e.Y36(de.mD))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-goods-received-note-import"]],viewQuery:function(t,i){if(1&t&&(e.Gf(ci,5),e.Gf(di,5),e.Gf(li,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.genericHOSalesInvoiceGridTI=n.first),e.iGM(n=e.CRH())&&(i.genericsGridSAPPI=n.first),e.iGM(n=e.CRH())&&(i.fileUploadPopup=n.first)}},features:[e._Bn([y.p,D.C,p.X,K.h,R.w,Z.s])],decls:10,vars:3,consts:[[1,"sectionWrapper"],[1,"topWrapper"],["class","sticky-top",4,"ngIf"],["class","main-container",4,"ngIf"],[1,"midTableWrapper"],[1,"row","row-margin"],[1,"col-md-12","pd5"],[3,"GenericProductEntrySetting","ShowGenericGridEvent","onClickItemSelectPopUp"],[1,"footer-wrapper"],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-1","pd0"],[1,"col-md-3","pd0"],[2,"white-space","nowrap","margin-left","-33px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-3","row",2,"padding-top","0.8vh","font-size","15px","font-style","italic","padding-left","0px","padding-right","0px"],[4,"ngIf"],[1,"col-md-5","pd0"],[3,"onLoadFromHoTaxInvoiceClickEmit","onLoadFromSAPFTPClickEmit","onFileUploadPopupEmit"],[3,"popupsettings","onItemDoubleClick"],["genericHOSalesInvoiceGridTI",""],["genericsGridSAPPI",""],[1,"col-md-6","pd0"],[1,"main-container"],[3,"hidden"],["viewDisable","disableView"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,ui,17,5,"div",2),e.YNc(3,pi,3,1,"div",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"generic-product-entry",7),e.NdJ("ShowGenericGridEvent",function(r){return i.showGenericGrid(r)})("onClickItemSelectPopUp",function(r){return i.onClickPoReferenceProduct(r)}),e.qZA()()()(),e.TgZ(8,"div",8),e._UZ(9,"voucher-total-area"),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",!i._trnMainService.TrnMainObj.hasShipName),e.xp6(4),e.Q6J("GenericProductEntrySetting",i.genericProductEntrySetting))},dependencies:[J.v,W.q,X.i,q.u,$.d,m.O5,E.Zl,z.Z,m.H9],styles:[".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n      text-align: center;\n      vertical-align: middle;\n    }\n    .dotted-menu[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%] {\n    height: 6px;\n    width: 6px;\n    background-color: #209e91;\n    border-radius: 50%;\n    display: inline-block;\n    margin-right: 3px;\n  }\n  .dotted-menu[_ngcontent-%COMP%] {\n    margin-left: 7px;\n  }"]}),a})(),canActivate:[k.C]}]}]);var Si=h(34579),Ti=(h(86351),h(16137),h(35732),h(71180));let mi=(()=>{class a{constructor(t,i,n,r){this.http=t,this.activatedRoute=i,this.authService=n,this.state=r}get apiUrl(){let t=this.state.getGlobalSetting("apiUrl"),i="";return!!t&&t.length>0&&(i=t[0]),i}getPoList(t,i){return"advanceFilterObj"in t&&t.advanceFilterObj.find(o=>"STATUS"==o.filterOptionKey),this.http.post(`${this.apiUrl}/getPoList?currentPage=${i}&maxResultCount=10`,t)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(he.eN),e.LFG(N.gz),e.LFG(H.e),e.LFG(Ti.q))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac}),a})();var Mi=h(60694),Pi=h(7782),bi=h(33612),Ai=h(32404),fi=h(56209);let Ci=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({providers:[k.C,y.p,mi,ce.R,Mi.T,Pi.y,K.h,bi.i,Ai.i,de.mD],imports:[vi,Si.h,B.m,fi.u,oe.zk.forRoot()]}),a})()}}]);