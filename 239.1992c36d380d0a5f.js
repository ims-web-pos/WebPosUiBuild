"use strict";(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[239],{70239:(Za,re,_)=>{_.r(re),_.d(re,{SalesModule:()=>xa});var _e=_(34579),u=_(28698),f=_(87584),l=_(42326),q=_(92340),J=_(60716),j=_(94534),S=_(68328),w=_(91772),Z=_(11192),k=_(40216),e=_(64537),I=_(53074),L=_(7976),D=_(67311),y=_(14970),P=_(67297),ae=_(24029);const ue=["genericGridSO"],Me=["genericPerformaInvoiceGridSO"],pe=["genericCancelSales"],Te=["popupCustomerCreation"],Se=["genericGridMemberShip"],ve=["fileUploadPopup"],me=["genericGridsalesMan"],ge=["discountPopup"],be=["genericReverseInvoiceGridSO"],fe=["genericGridSalesManRoute"],Ce=["genericGridCustomerListBySalesmanAndRoute"];function Oe(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div")(1,"voucher-sidebar-billdetail",29),e.NdJ("onMemberIDSearch",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.onClickMemberIDSearch(n))})("onMemberReferIDSearch",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.onClickMemberReferIDSearch(n))})("onClickSlider",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n.calculateMemberPointsForView())}),e.qZA()()}}function Ae(a,o){if(1&a&&(e.ynx(0),e.TgZ(1,"div",30)(2,"span")(3,"b"),e._uU(4,"SO Qty:"),e.qZA(),e._uU(5),e.qZA()(),e.TgZ(6,"div",23)(7,"span")(8,"b"),e._uU(9,"Rate:"),e.qZA(),e._uU(10),e.ALo(11,"currency"),e.qZA()(),e.BQk()),2&a){const i=e.oxw(2);e.xp6(5),e.hij("\xa0",i._trnMainService.purchaseOrderQty," \xa0"),e.xp6(5),e.hij("\xa0",e.Dn7(11,2,i._trnMainService.purchaseOrderRate,"INR","Rs. ")," ")}}function Ee(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",17)(1,"div",18)(2,"div",19),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",19)(5,"label",20),e._uU(6),e.qZA(),e.YNc(7,Oe,2,0,"div",21),e.qZA(),e.TgZ(8,"div",22),e.YNc(9,Ae,12,6,"ng-container",21),e.qZA(),e.TgZ(10,"div",23)(11,"voucher-master-action",24),e.NdJ("onLoadFromSOClickEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showLoadFromSOPopup(n))})("onLoadFromPerformaInvoiceClickEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showApprovedPreformaInvoicePopup(n))})("onLoadCancelSalesEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showSalesDayWise(n))})("onClickSalesMan",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onClickNewSalesman(n))})("onLoadFromReverseEntryEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showReverseVoucherInvoicePopup(n))})("onclickOnResetPopupEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onclickOnResetPopupEmit(n))})("onSaveSelfBilling",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onclickOnResetPopupEmit(n))})("deliveryChalanEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.deliveryChalanEmit(n))})("onFileUploadPopupEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showSalesInvoicePopup(n))}),e.qZA(),e.TgZ(12,"generic-popup-grid",9,25),e.NdJ("onItemDoubleClick",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onSalesOrderSelect(n))}),e.qZA(),e.TgZ(14,"generic-popup-grid",9,26),e.NdJ("onItemDoubleClick",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onPerformaInvoiceSelect(n))}),e.qZA(),e.TgZ(16,"generic-popup-grid",9,27),e.NdJ("onItemDoubleClick",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onSalesCancelSelect(n))}),e.qZA(),e.TgZ(18,"generic-popup-grid",9,28),e.NdJ("onItemDoubleClick",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onReverseEntrySelect(n))}),e.qZA()()()()}if(2&a){const i=e.oxw();e.xp6(6),e.AsE("",i._trnMainService.pageHeading," [",i._trnMainService.TrnMainObj.Mode,"]"),e.xp6(1),e.Q6J("ngIf","lite"!=i.AppMode),e.xp6(2),e.Q6J("ngIf",0!=i.userSetting.ENABLE_SOINTI&&i._trnMainService.TrnMainObj.REFORDBILL),e.xp6(2),e.Q6J("buttonShow",!1),e.xp6(1),e.Q6J("popupsettings",i.gridPopupSettings),e.xp6(2),e.Q6J("popupsettings",i.gridPerformaInvoicePopupSettings),e.xp6(2),e.Q6J("popupsettings",i.gridcancelSalesPopupSettings),e.xp6(2),e.Q6J("popupsettings",i.gridReverseEntryPopupSettings)}}function Ie(a,o){1&a&&(e.TgZ(0,"div",6),e._UZ(1,"discounts-insert"),e.qZA())}function Pe(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",31)(1,"div",32)(2,"trnmain-parameters-master",33),e.NdJ("onDblClickSOLoadInTI",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onDblClickSOLoadInTI(n))}),e.qZA()(),e.TgZ(3,"div",5),e.YNc(4,Ie,2,0,"div",34),e.qZA()()}if(2&a){const i=e.oxw();e.xp6(1),e.Q6J("hidden",!i.masterService.ShowMore),e.xp6(3),e.Q6J("ngIf",1==i.masterService.userSetting.GblBarcodeWiseBilling)}}function Ne(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"productentry",35),e.NdJ("onClickItemSelectPopUp",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onClickPoReferenceProduct(n))}),e.qZA()}}function Le(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"productentryLite",35),e.NdJ("onClickItemSelectPopUp",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onClickPoReferenceProduct(n))}),e.qZA()}}function De(a,o){1&a&&(e.TgZ(0,"div",36),e._UZ(1,"voucher-total-area"),e.qZA())}function ye(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"app-quantity-change-popup",37),e.NdJ("showProdListChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showProdListInTIfromDC=n)})("showChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showQuantityChangePopup=n)}),e.qZA()}if(2&a){const i=e.oxw();e.Q6J("showProdList",i.showProdListInTIfromDC)("show",i.showQuantityChangePopup)}}let Q=(()=>{class a{constructor(i,t,n,r,s,c,h,d,v,A,O,M){this.masterService=i,this._trnMainService=t,this.route=n,this.alertService=r,this.loadingSerive=s,this.authservice=c,this.changeDetection=h,this.genericProductEntryService=d,this.itemKeyEventService=v,this.quantityChangeEventService=A,this.entryValidateService=O,this.salesService=M,this.showQuantityChangePopup=!1,this.showProdListInTIfromDC=!1,this.hideShow=!1,this.gridPopupSettingsForMember=new u.im,this.fileUploadPopupSettings=new k.s,this.gridPopupSettingsalesMan=new u.im,this.gridReverseEntryPopupSettings=new u.im,this.salesManList=[],this.routerMasterList=[],this.userProfile={},this.RouteList=[],this.CustomerList=[],this.applyReferValue=!1,this.gridPopupSettings=new u.im,this.gridPerformaInvoicePopupSettings=new u.im,this.gridcancelSalesPopupSettings=new u.im,this.gridPopupSettingsForSalesManRoute=new u.im,this.gridPopupSettingsForCustomerListBySalesmanAndRoute=new u.im,this.userProfile=c.getUserProfile(),this.userSetting=this.authservice.getSetting(),this.AppMode=q.N.appMode,"canceladdsientry"===this.route.snapshot.url[0].path?this._trnMainService.initialFormLoad(61):"add-sales-invoice"===this.route.snapshot.url[0].path?(this._trnMainService.initialFormLoad(14),this.getSalesManList()):"add-sales-invoice-wholesale"==this.route.snapshot.url[0].path?(this._trnMainService.initialFormLoad(14),this._trnMainService.TrnMainObj.SUBMENU="wholeSale",this._trnMainService.TrnMainObj.INVOICETYPE="wholeSale"):"self-billing"==this.route.snapshot.url[0].path?(this._trnMainService.initialFormLoad(14),this._trnMainService.TrnMainObj.SUBMENU="selfBilling",this._trnMainService.TrnMainObj.INVOICETYPE="selfBilling",this.setLoginDivisionName()):"abbreviated-sales-invoice"==this.route.snapshot.url[0].path&&this._trnMainService.initialFormLoad(1),this.userSetting.EnableUserWiseCreditSalesRights&&!this._trnMainService.checkUserRightsForCreditSales()&&(this._trnMainService.TrnMainObj.TRNMODE="cash"),this.userProfile.CASH_AC&&this.userProfile.CASH_AC_NAME&&"cash"==this._trnMainService.TrnMainObj.TRNMODE&&(this._trnMainService.TrnMainObj.TRNACName=this.userProfile.CASH_AC_NAME,this._trnMainService.TrnMainObj.TRNAC=this.userProfile.CASH_AC),this.masterService.getSalesmanList().subscribe(g=>{this.salesManList.push(g)}),this.gridPopupSettings={title:"Sales Vouchers",apiEndpoints:"/getTrnMainPagedList/SO/tag",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"Voucher No.",hidden:!1,noSearch:!1},{key:"DIVISION",title:"Division",hidden:!1,noSearch:!1},{key:"TRNAC",title:"Trn. A/c",hidden:!1,noSearch:!1},{key:"PhiscalId",title:"Fiscal Year",hidden:!1,noSearch:!1}]};let m=null;"add-sales-invoice-wholesale"==this._trnMainService.activeurlpath&&(m="wholesale"),this.gridPerformaInvoicePopupSettings={title:"Approved Proforma Vouchers",apiEndpoints:`/getApprovedHOPerformaInvoicePagedList/${m}`,defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"Voucher No.",hidden:!1,noSearch:!1},{key:"BILLTO",title:"Customer Name",hidden:!1,noSearch:!1},{key:"REFORDBILL",title:"Ref.Bill No.",hidden:!1,noSearch:!1},{key:"BILLTOTEL",title:"VAT NO.",hidden:!1,noSearch:!1}]},this.gridcancelSalesPopupSettings={title:"Sales Invoice ",apiEndpoints:"/getTrnMainDateWisePagedList/TI",defaultFilterIndex:0,columns:[{key:"CHALANNO",title:"BILL NO",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"DATE",hidden:!1,noSearch:!1},{key:"TRNMODE",title:"TYPE",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"AMOUNT",hidden:!1,noSearch:!1}]},this.gridReverseEntryPopupSettings={title:"Reverse Entry VoucherList",apiEndpoints:"/getReverseEntryPagedList",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"Voucher No.",hidden:!1,noSearch:!1},{key:"DIVISION",title:"Division",hidden:!1,noSearch:!1},{key:"TRNAC",title:"Trn. A/c",hidden:!1,noSearch:!1},{key:"PhiscalId",title:"Fiscal Year",hidden:!1,noSearch:!1}]},this.route.queryParams.subscribe(g=>{"DRILL"!=g.mode&&("FROMSI"==g.mode?(this.masterService.TempTrnMainObj.VCHRNO=this._trnMainService.TrnMainObj.VCHRNO,this.masterService.TempTrnMainObj.VoucherPrefix=this._trnMainService.TrnMainObj.VoucherPrefix,this.masterService.TempTrnMainObj.VoucherType=l.Km.TaxInvoice,this._trnMainService.TrnMainObj=this.masterService.TempTrnMainObj,this.masterService.getCustomerIDFromCProfile(g.ID).subscribe(N=>{N.length>0&&(this._trnMainService.TrnMainObj.RECEIVEBY=N[0].CUSTID),this._trnMainService.TrnMainObj.PARAC=g.ID})):g.voucher&&this.getSelectedPerformaInvoice(g.voucher))})}updown(i){"F10"==i.code&&this.calculateMemberPointsForView()}ngAfterContentChecked(){this.changeDetection.detectChanges()}getMemberShipList(){this.gridPopupSettingsForMember=this.masterService.getGenericGridPopUpSettings("MemberList")}onclickOnResetPopupEmit(i){console.log("event"),this.setLoginDivisionName()}getSalesManList(){this.gridPopupSettingsalesMan=this.masterService.getGenericGridPopUpSettings("SalesManList")}setLoginDivisionName(){this.masterService.getloginDivisionName().subscribe(i=>{console.log("get login divison ",i),"ok"==i.status&&(i.result?(this._trnMainService.TrnMainObj.BILLTO=i.result.ACNAME,this._trnMainService.TrnMainObj.TRNAC=i.result.ACID,this._trnMainService.TrnMainObj.PARAC=i.result.ACID,this._trnMainService.TrnMainObj.VATNO=i.result.VATNO,this._trnMainService.TrnMainObj.BILLTOTEL=i.result.VATNO,this._trnMainService.TrnMainObj.BILLTOADD=i.result.ADDRESS,this._trnMainService.TrnMainObj.TRNACName=i.result.ACNAME,this._trnMainService.TrnMainObj.MWAREHOUSE=this._trnMainService.userProfile.userWarehouse,this._trnMainService.TrnMainObj.TRNMODE="credit","self-billing"==this._trnMainService.activeurlpath&&(this._trnMainService.TrnMainObj.RECEIVEBY=i.result.CUSTID)):this.alertService.warning("Please set default account for the current division."))},i=>{this.alertService.warning("Please set default account for the current division")})}onSalesManSelect(i){this._trnMainService.TrnMainObj.SALESMANID=i.SALESMANID,this._trnMainService.TrnMainObj.SALESMAN=i.NAME,this._trnMainService.salesmanID=i.SALESMANID,this._trnMainService.salesmanName=i.NAME,this.getSalesManRouteList(),this.genericGridSalesManRoute.show()}onRouteSelect(i){this._trnMainService.doubleClick=!0,this._trnMainService.TrnMainObj.SALESMANID=i.SALESMANID,this._trnMainService.TrnMainObj.ROUTE=i.RouteCode,this._trnMainService.routeCode=this._trnMainService.TrnMainObj.ROUTE,this._trnMainService.getCustomerListRouteAndSalesmanWise(this._trnMainService.TrnMainObj.SALESMANID,this._trnMainService.TrnMainObj.ROUTE),this.getCustomerList(),this.genericGridCustomerListBySalesmanAndRoute.show()}onCustomerSelected(i){this._trnMainService.customerDoubleClick=!0,this._trnMainService.billunitevent=!0,this._trnMainService.TrnMainObj.BILLTO=i.ACNAME,this._trnMainService.TrnMainObj.TRNAC=i.ACID,this._trnMainService.TrnMainObj.PARAC=i.ACID,this._trnMainService.TrnMainObj.BILLTOTEL=i.VATNO,this._trnMainService.TrnMainObj.BILLTOADD=i.ADDRESS,this._trnMainService.TrnMainObj.BILLTOMOB=i.MOBILE,this._trnMainService.TrnMainObj.TRNACName=i.ACNAME,this._trnMainService.TrnMainObj.TRNMODE=null==i.PMODE||""===i.PMODE?"credit":i.PMODE}getSalesManRouteList(){this.gridPopupSettingsForSalesManRoute=this.masterService.getGenericGridSettintForSalemanRoute(this._trnMainService.TrnMainObj.SALESMANID)}getCustomerList(){this.gridPopupSettingsForCustomerListBySalesmanAndRoute=this.masterService.getGridSettingForCustomerBySalesmanRoute(this._trnMainService.TrnMainObj.SALESMANID,this._trnMainService.TrnMainObj.ROUTE),this.gridPopupSettingsForCustomerListBySalesmanAndRoute={title:"Customers",apiEndpoints:`/getPagedCustomerListBySalesmanAndRoute/${this._trnMainService.TrnMainObj.SALESMANID}/${this._trnMainService.TrnMainObj.ROUTE}`,defaultFilterIndex:this.userSetting.FilterIndexForCustomer,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ACCODE",title:"CODE",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"EMAIL",title:"EMAIL",hidden:!1,noSearch:!1}]}}ngAfterViewInit(){1===this.userSetting.ENABLE_SALESMAN_ROUTE&&(this.getSalesManList(),this.genericGridsalesMan.show())}onClickNewSalesman(){1===this.userSetting.ENABLE_SALESMAN_ROUTE&&(this.getSalesManList(),this.genericGridsalesMan.show())}ngOnInit(){this.route.queryParams.subscribe(i=>{if(console.log("PARAM",i),"DRILL"==i.mode){let t=i.voucher,n=[];n=t.split("-"),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(t,n[1],n[2]).subscribe(r=>{"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.Mode="VIEW",t.startsWith("TI")?(console.log("TI",t),this._trnMainService.TrnMainObj.VoucherType=14,this._trnMainService.pageHeading="SALES TAX INVOICE",this._trnMainService.TrnMainObj.VoucherPrefix="TI"):t.startsWith("SI")&&(console.log("SI",t),this._trnMainService.TrnMainObj.VoucherType=1,this._trnMainService.pageHeading="Abbreviated tax Invoice",this._trnMainService.TrnMainObj.VoucherPrefix="SI"),this._trnMainService.TrnMainObj.TRNDATE=r.result.TRNDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.TRN_DATE=r.result.TRN_DATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList.forEach(s=>{0==s.ALTERNATEQUANTIY&&(s.ALTERNATEQUANTIY=s.AltQty),s.rowMode="VIEW"}),null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}),this._trnMainService.ReCalculateBillWithNormal())},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}}),this.setFileUploadHelper(),this.setProductEntryTable()}setFileUploadHelper(){this.fileUploadPopupSettings=Object.assign(new k.s,{title:"Sales Invoice",sampleFileUrl:`/downloadSampleExcelforMasterMigration?importName=${this._trnMainService.TrnMainObj.VoucherPrefix}`,uploadEndpoints:`/importFileForTransaction/${this._trnMainService.TrnMainObj.VoucherPrefix}`,allowMultiple:!1,acceptFormat:".xlsx",filename:"Sales Invoice Sample"})}setProductEntryTable(){var i=this._trnMainService.TrnMainObj.ProdList;this.genericProductEntrySetting=new J.Vn(this._trnMainService),this.genericProductEntrySetting.columns=[{field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{width:"40px"}},{field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{width:"350px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableItemDesc",n,r),focusTo:"ALTUNIT"},{field:"BATCH",header:"Batch",hidden:!1,isActiveColumnHeader:!0,inputType:"batch",headerNgStyle:{width:"80px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableBatch",n,r),onEnter:(n,r,s,c)=>{this.genericProductEntryService.BatchEnter(n,r,s,c)},onKeyPress:(n,r)=>{this.genericProductEntryService.onKeyDownBatch(n,r)}},{field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"unitsOption",headerNgStyle:{width:"80px"},focusTo:"ALTERNATEQUANTIY",disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltUnit",n,r),onEnter:(n,r,s,c)=>this.entryValidateService.AlternateUnitEnterEventClick(n,r,s,c)},{field:"ALTERNATEQUANTIY",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},onChange:(n,r,s)=>this.QuantityChangeEvent_default(n,r,s),applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r)},{field:"ALTRATE",header:"Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onEnter:(n,r,s)=>this.mrpEnterEvent(n,r,s),onChange:(n,r,s,c)=>this.entryValidateService.MRPChangeEvent(n,r,s,c),focusTo:"ITEMDESC",disablePipe:(n,r)=>this.getColumnDisablePipe("disableRateandDiscount",n,r)},{field:"AMOUNT",header:"Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"DISCOUNT",header:"Total Disc",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"70px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onHover:n=>{this.genericProductEntryService.onHover(n)},displayOnHover:!0},{field:"VAT",header:"VAT",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"70px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"EXPDATE",header:"Exp Date",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right","font-size":"11px"},applyTwoDigitPipe:!1},{field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"}}],this.genericProductEntrySetting.height="100%",this.genericProductEntrySetting.prodlist=i,this.genericProductEntrySetting.voucherType=l.Km.PerformaSalesInvoice,this.genericProductEntrySetting.setRowItemFromSelectedItem=n=>this.SetRowItemFromSelectedItem(n),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(n,r=new Function)=>this.SetRowItemRate(n,r)}showGenericGrid(i){this.itemKeyEventService.ItemkeyEvent(i.index,i.event,()=>S.K.default,t=>S.K.default,()=>S.K.default,()=>S.K.default,()=>S.K.default)}getColumnDisablePipe(i,t,n){return i}SetRowItemFromSelectedItem(i){let t=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];this._trnMainService.prepareItem(t,i),this._trnMainService.assignPrateaAsRATE(t,i)}SetAllUnitsOfItem(){this._trnMainService.getAllUnitsOfItem(this.genericProductEntryService.activerowIndex)}mrpEnterEvent(i,t,n){this.entryValidateService.mrpEnterEvent(i,t,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}QuantityChangeEvent_default(i,t,n){this.quantityChangeEventService.QuantityChangeEvent(n)}SetRowItemRate(i,t){t()}getSalesmanRoute(i){}showLoadFromSOPopup(i){this.genericGridSO.show()}showApprovedPreformaInvoicePopup(i){this.genericPerformaInvoiceGridSO.show()}showSalesDayWise(i){this.genericCancelSales.show()}onPerformaInvoiceSelect(i){this.getSelectedPerformaInvoice(i.VCHRNO)}oncancelSalesSelect(i){}onMemberSelect(i){console.log("k aaucha eta scheme name ko lagi",i.SCHEMEID,i),this.applyReferValue?(this._trnMainService.TrnMainObj.REFERMEMBERNAME=i.FNAME,this._trnMainService.TrnMainObj.REFERMEMBERNO=i.MEMID,this._trnMainService.TrnMainObj.SCHEMENAME=i.SCHEMEID):(this._trnMainService.TrnMainObj.MEMBERNO=i.MEMID,this._trnMainService.TrnMainObj.MEMBERNAME=i.FNAME,this._trnMainService.TrnMainObj.SCHEMENAME=i.SCHEMEID)}onClickMemberReferIDSearch(i){this.applyReferValue=!0,this.getMemberShipList(),this.genericGridMemberShip.show()}getSelectedPerformaInvoice(i){this.loadingSerive.show("Getting data, Please wait..."),this.masterService.loadHoPerformaInvoice(i).subscribe(t=>{if(this.loadingSerive.hide(),"ok"===t.status){this._trnMainService.callPipe=!this._trnMainService.callPipe,this._trnMainService.TrnMainObj=JSON.parse(t.result),this._trnMainService.TrnMainObj.Mode="NEW";for(let n in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[n].inputMode=!1,this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ProdList[n].RATEDISCOUNT)>0&&1==this.userSetting.EnableDiscountInAltUnit&&(this._trnMainService.TrnMainObj.ProdList[n].UNITDISCOUNTRATE=100*this._trnMainService.TrnMainObj.ProdList[n].RATEDISCOUNT/(this._trnMainService.TrnMainObj.ProdList[n].ALTERNATEQUANTIY*this._trnMainService.TrnMainObj.ProdList[n].RATE*this._trnMainService.TrnMainObj.ProdList[n].ALTCONFACTOR));1==this.userSetting.enableAdditionalFlatDiscountsInSales&&(this._trnMainService.TrnMainObj.FLATDCAMNT=this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT?this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT:0),this._trnMainService.TrnMainObj.TRNACName=this._trnMainService.TrnMainObj.BILLTO,this._trnMainService.TrnMainObj.RECURREFBILL=this._trnMainService.TrnMainObj.REFBILL,this._trnMainService.TrnMainObj.REFBILL=i,this._trnMainService.TrnMainObj.PhiscalID=this.userProfile.PhiscalYearInfo.PhiscalID,this._trnMainService.TrnMainObj.VoucherPrefix="TI",this._trnMainService.TrnMainObj.VoucherType=14,this._trnMainService.pageHeading="SALES TAX INVOICE",this._trnMainService.TrnMainObj.TRNMODE="credit",this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),this._trnMainService.vatFreeBill(),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.disableOnPerFormaSelect=!0,null==this._trnMainService.TrnMainObj.PARAC&&(this._trnMainService.TrnMainObj.TRNMODE="cash",this.userProfile.CASH_AC&&this.userProfile.CASH_AC_NAME?(this._trnMainService.TrnMainObj.TRNAC=this.userProfile.CASH_AC,this._trnMainService.TrnMainObj.TRNACName=this.userProfile.CASH_AC_NAME,this._trnMainService.disableAccountInputField=!0):this.masterService.userSetting.CASHINHAND_AC?(this._trnMainService.TrnMainObj.TRNAC=this.masterService.userSetting.CASHINHAND_AC,this._trnMainService.TrnMainObj.TRNACName="CASH IN HAND A/C"):(alert("'Default Cash' on database not found. Please Contact to Administrator for this!"),this._trnMainService.TrnMainObj.TRNACName="error..."))}},t=>{this.loadingSerive.hide()})}onSalesOrderSelect(i){this.masterService.loadSalesInvoiceFromSalesOrder(i.VCHRNO).subscribe(t=>{if("ok"===t.status){if(this._trnMainService.TrnMainObj=JSON.parse(t.result),this._trnMainService.TrnMainObj.Mode="NEW",!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||void 0===this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.REFBILL=i.VCHRNO,this._trnMainService.TrnMainObj.VoucherType=14,this._trnMainService.TrnMainObj.VoucherPrefix="TI",this._trnMainService.TrnMainObj.TransporterEway={},this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate();for(let r in this._trnMainService.TrnMainObj.ProdList){this._trnMainService.setAltunitDropDownForView(r),this._trnMainService.AssignSellingPriceAndDiscounts(this._trnMainService.TrnMainObj.ProdList[r].PClist,r);let s=this._trnMainService.TrnMainObj.ProdList[r].ALTUNITObj;this._trnMainService.RealQuantitySet(r,null==s?1:s.CONFACTOR),this._trnMainService.TrnMainObj.ProdList[r].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[r].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[r].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[r].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[r].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].inputMode=!0,this._trnMainService.TrnMainObj.ProdList[r].VCHRNO=this._trnMainService.TrnMainObj.VCHRNO;let h=0;this._trnMainService.TrnMainObj.ProdList[r].inputMode=!0,h=this._trnMainService.TrnMainObj.ProdList[r].PRATE}var n=this._trnMainService.TrnMainObj.ProdList.filter(r=>r.SELECTEDITEM.STOCK<=0);this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(r=>r.SELECTEDITEM.STOCK>0),this._trnMainService.ReCalculateBillWithNormal(),null!=n&&n.length>0&&this.alertService.error("Some Of the item have been excluded because of unavailable Stock")}},t=>{})}onItemDoubleClick(i){this._trnMainService.TrnMainObj.REFORDBILL=i.VCHRNO,this._trnMainService.loadSODataToSales(i.VCHRNO)}onSalesCancelSelect(i){this.loadTaxInvoiceForCancel(i.VCHRNO,i.DIVISION,i.PhiscalId)}onClickMemberIDSearch(i){this.getMemberShipList(),this.genericGridMemberShip.show()}loadTaxInvoiceForCancel(i,t,n){this.loadingSerive.show("Getting data, Please wait..."),this.masterService.LoadTransaction(i,t,n).subscribe(r=>{if(this.loadingSerive.hide(),"ok"===r.status){this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.REFBILL=i,this._trnMainService.TrnMainObj.VoucherType=61,this._trnMainService.pageHeading="SALES TAX INVOICE [CANCEL]",this._trnMainService.TrnMainObj.VoucherPrefix="SC",this._trnMainService.TrnMainObj.Mode="VIEW",this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate();for(let s in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.setAltunitDropDownForViewStock(s),this._trnMainService.getPricingOfItem(s,"",!0),this._trnMainService.TrnMainObj.ProdList[s].inputMode=!1}},r=>{this.loadingSerive.hide()})}getRouteListSalesmanWise(i){this.masterService.getRouteListBasedUponSalesman(i).subscribe(t=>{this.RouteList=t})}onClickCreateCustomer(){}onClickCustomerHide(){}DisplayCustomerProfile(i){!1===i&&this.popupCustomerCreation.show()}calculateMemberPointsForView(){this.removeInvalidRowsFromprod(),this._trnMainService.TrnMainObj.ProdList.length&&this.masterService.postMemberPointCalculation(this._trnMainService.TrnMainObj).subscribe(i=>{"ok"==i.status&&(this._trnMainService.TrnMainObj.EARNPOINS=i.result.pointsGained,this._trnMainService.TrnMainObj.TOTMEMPOINTS=i.result2)})}onClickPoReferenceProduct(i){i&&(this._trnMainService.purchaseOrderQty=i.ALTERNATEQTY,this._trnMainService.purchaseOrderRate=i.RATE)}removeInvalidRowsFromprod(){this._trnMainService.TrnMainObj.ProdList.length>1&&(this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(i=>null!=i.MCODE&&""!=i.MCODE))}showReverseVoucherInvoicePopup(i){this.genericReverseInvoiceGridSO.show()}onReverseEntrySelect(i){this.getReverseInvoice(i.VCHRNO)}getReverseInvoice(i){this.loadingSerive.show("Getting data, Please wait..."),this.masterService.loadReverseInvoice(i).subscribe(t=>{if(this.loadingSerive.hide(),"ok"===t.status){this._trnMainService.TrnMainObj=JSON.parse(t.result),this._trnMainService.TrnMainObj.Mode="NEW";for(let n=0;n<this._trnMainService.TrnMainObj.ProdList.length;n++)this._trnMainService.TrnMainObj.ProdList[n].inputMode=!1;console.log("firstparac5"),this._trnMainService.TrnMainObj.PARAC=this._trnMainService.TrnMainObj.TRNAC,this._trnMainService.TrnMainObj.TRNACName=this._trnMainService.TrnMainObj.BILLTO,this._trnMainService.TrnMainObj.REFBILL=i,this._trnMainService.TrnMainObj.VoucherPrefix="TI",this._trnMainService.TrnMainObj.VoucherType=14,this._trnMainService.pageHeading="SALES TAX INVOICE",this._trnMainService.TrnMainObj.TRNMODE="credit",this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.disableOnPerFormaSelect=!0}},t=>{this.loadingSerive.hide()})}onDblClickSOLoadInTI(i){this._trnMainService.TrnMainObj.ViewList=[],this._trnMainService.loadDataForSalesInoviceFromSO(this._trnMainService.TrnMainObj.REFORDBILL,this._trnMainService.TrnMainObj.DIVISION,this._trnMainService.TrnMainObj.PhiscalID,"SOINTI")}deliveryChalanEmit(i){this.showProdListInTIfromDC=!0,this._trnMainService.getDeliveryChalanProdDetails(i)}showSalesInvoicePopup(){null!=this._trnMainService.TrnMainObj.PARAC&&""!=this._trnMainService.TrnMainObj.PARAC?this.fileUploadPopup.show():this.alertService.warning("Please select the Account...")}fileUploadSuccess(i){if("ok"==i.status){this._trnMainService.TrnMainObj.ProdList=i.result,this._trnMainService.TrnMainObj.tag="FROMEXCEL";for(let t in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.setAltunitDropDownForView(t),this._trnMainService.TrnMainObj.ProdList[t].REALRATE=this._trnMainService.TrnMainObj.ProdList[t].ALTRATE/this._trnMainService.TrnMainObj.ProdList[t].ALTCONFACTOR,this._trnMainService.TrnMainObj.ProdList[t].RATE=this._trnMainService.TrnMainObj.ProdList[t].ALTRATE/this._trnMainService.TrnMainObj.ProdList[t].ALTCONFACTOR,this._trnMainService.TrnMainObj.ProdList[t].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[t].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[t].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[t].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[t].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[t].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[t].OtherDiscount=this._trnMainService.TrnMainObj.ProdList[t].INDODAMT;this._trnMainService.prePareVariantDescription(),this._trnMainService.ReCalculateBillWithNormal(),this.loadingSerive.hide()}else this.loadingSerive.hide(),this.alertService.error(i.result.error)}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(I.P),e.Y36(f.p),e.Y36(L.gz),e.Y36(D.c),e.Y36(y.V),e.Y36(P.e),e.Y36(e.sBO),e.Y36(j.w),e.Y36(S.X),e.Y36(w.s),e.Y36(Z.C),e.Y36(ae.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-sales-invoice"]],viewQuery:function(i,t){if(1&i&&(e.Gf(ue,5),e.Gf(Me,5),e.Gf(pe,5),e.Gf(Te,5),e.Gf(Se,5),e.Gf(ve,5),e.Gf(me,5),e.Gf(ge,5),e.Gf(be,5),e.Gf(fe,5),e.Gf(Ce,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.genericGridSO=n.first),e.iGM(n=e.CRH())&&(t.genericPerformaInvoiceGridSO=n.first),e.iGM(n=e.CRH())&&(t.genericCancelSales=n.first),e.iGM(n=e.CRH())&&(t.popupCustomerCreation=n.first),e.iGM(n=e.CRH())&&(t.genericGridMemberShip=n.first),e.iGM(n=e.CRH())&&(t.fileUploadPopup=n.first),e.iGM(n=e.CRH())&&(t.genericGridsalesMan=n.first),e.iGM(n=e.CRH())&&(t.discountPopup=n.first),e.iGM(n=e.CRH())&&(t.genericReverseInvoiceGridSO=n.first),e.iGM(n=e.CRH())&&(t.genericGridSalesManRoute=n.first),e.iGM(n=e.CRH())&&(t.genericGridCustomerListBySalesmanAndRoute=n.first)}},hostBindings:function(i,t){1&i&&e.NdJ("keydown",function(r){return t.updown(r)},!1,e.evT)},features:[e._Bn([f.p,Z.C,S.X,j.w,w.s])],decls:21,vars:11,consts:[[1,"sectionWrapper"],[1,"topWrapper"],["class","sticky-top","style","padding-bottom: 1px;",4,"ngIf"],["class","main-container",4,"ngIf"],[1,"midTableWrapper"],[1,"row","row-margin"],[1,"col-md-12","pd5"],[3,"onClickItemSelectPopUp",4,"ngIf"],["class","footer-wrapper",4,"ngIf"],[3,"popupsettings","onItemDoubleClick"],["genericGridMemberShip",""],["genericGridsalesMan",""],["genericGridSalesManRoute",""],["genericGridCustomerListBySalesmanAndRoute",""],[3,"showProdList","show","showProdListChange","showChange",4,"ngIf"],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],[1,"sticky-top",2,"padding-bottom","1px"],[1,"row","clearfix"],[1,"col-md-2","pd0"],[2,"white-space","nowrap","margin-left","-145px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[4,"ngIf"],[1,"col-md-1","row",2,"padding-top","0.8vh","font-size","15px","font-style","italic","padding-left","0px","padding-right","0px"],[1,"col-md-7","pd0"],[3,"buttonShow","onLoadFromSOClickEmit","onLoadFromPerformaInvoiceClickEmit","onLoadCancelSalesEmit","onClickSalesMan","onLoadFromReverseEntryEmit","onclickOnResetPopupEmit","onSaveSelfBilling","deliveryChalanEmit","onFileUploadPopupEmit"],["genericGridSO",""],["genericPerformaInvoiceGridSO",""],["genericCancelSales",""],["genericReverseInvoiceGridSO",""],[3,"onMemberIDSearch","onMemberReferIDSearch","onClickSlider"],[1,"col-md-5","pd0"],[1,"main-container"],[3,"hidden"],["viewDisable","disableView",3,"onDblClickSOLoadInTI"],["class","col-md-12 pd5",4,"ngIf"],[3,"onClickItemSelectPopUp"],[1,"footer-wrapper"],[3,"showProdList","show","showProdListChange","showChange"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Ee,20,9,"div",2),e.YNc(3,Pe,5,2,"div",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6),e.YNc(7,Ne,1,0,"productentry",7),e.YNc(8,Le,1,0,"productentryLite",7),e.qZA()()(),e.YNc(9,De,2,0,"div",8),e.qZA(),e.TgZ(10,"generic-popup-grid",9,10),e.NdJ("onItemDoubleClick",function(r){return t.onMemberSelect(r)}),e.qZA(),e.TgZ(12,"generic-popup-grid",9,11),e.NdJ("onItemDoubleClick",function(r){return t.onSalesManSelect(r)}),e.qZA(),e.TgZ(14,"generic-popup-grid",9,12),e.NdJ("onItemDoubleClick",function(r){return t.onRouteSelect(r)}),e.qZA(),e.TgZ(16,"generic-popup-grid",9,13),e.NdJ("onItemDoubleClick",function(r){return t.onCustomerSelected(r)}),e.qZA(),e.YNc(18,ye,1,2,"app-quantity-change-popup",14),e.TgZ(19,"file-uploader-popup",15,16),e.NdJ("onUploaded",function(r){return t.fileUploadSuccess(r)}),e.qZA()),2&i&&(e.xp6(2),e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName),e.xp6(4),e.Q6J("ngIf","pro"==t._trnMainService.AppMode),e.xp6(1),e.Q6J("ngIf","lite"==t._trnMainService.AppMode),e.xp6(1),e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("popupsettings",t.gridPopupSettingsForMember),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsalesMan),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForSalesManRoute),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForCustomerListBySalesmanAndRoute),e.xp6(2),e.Q6J("ngIf",t.showQuantityChangePopup||t.showProdListInTIfromDC),e.xp6(1),e.Q6J("popupsettings",t.fileUploadPopupSettings))},styles:[".GRNPopUp[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.GRNPopUp[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#123456!important;color:#fff}.modal-dialog.modal-md[_ngcontent-%COMP%], .modal-dialog.modal-sm[_ngcontent-%COMP%]{top:45%;margin-top:0}.card[_ngcontent-%COMP%]{height:15rem;border:2px solid slategray}.confirmation-container[_ngcontent-%COMP%]{position:fixed!important;transform:translate(-50px,-50px);background:#ffffff;z-index:99999;width:55%;top:33%;left:26%}",".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n    text-align: left;\n    vertical-align: middle;\n  }\n\n  .card[_ngcontent-%COMP%] {\n    height: 30rem;\n    border: 2px solid slategray;\n  }"]}),a})();var E=_(82661),T=_(88692),V=_(53704),Re=_(23815),W=_.n(Re),Y=_(19102),p=_(20092),oe=_(91605),xe=_(65705),z=_(54536),je=_(30334),ie=_(48063),we=_(471),Ze=_(90253),Fe=_(9267),ke=_(23470),Ue=_(63213);const Ve=["genericGridCustomer"],Be=["genericGridRefBill"],Ge=["genericGridSalesMan"],He=["genericGridForTaxCancel"],qe=["newgenericGridForTaxCancel"],Je=["newgenericGridForSalesReturn"],Qe=["newgenericGridForDeliveryChalanReturn"],Ye=["genericGridCustomerListBySalesmanAndRoute"],Ke=["genericGridAccount"],We=["CreateCustomerProfile"],ze=["CreateQuickParty"],Xe=["genericGridSalesOrder"],$e=["LoadSalesOrder"],ei=["genericGridJobCardNO"],ii=["genericGridVehicleNo"],ti=["addDiscount"],ni=["focusInputUnit"],ri=["focusSalesman"],ai=["focusInputFormat"],oi=["FocusCustomer"],si=["genericGridWarehouse"];function li(a,o){if(1&a&&(e.TgZ(0,"div",38)(1,"label",10),e._uU(2),e.qZA(),e.TgZ(3,"td",39),e._uU(4),e.qZA()()),2&a){const i=e.oxw();e.xp6(2),e.Oqu(i.billLabel),e.xp6(2),e.hij(" ",i._trnMainService.TrnMainObj.VCHRNO," ")}}function ci(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Inv Date"),e.qZA(),e.TgZ(3,"td",40)(4,"input",41),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.TRN_DATE=n)})("change",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.changeInvDate(n.target.value,"AD"))}),e.qZA()(),e.TgZ(5,"td",42)(6,"nepali-date-picker",43),e.NdJ("change",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.changeInvDate(n.detail.value,"BS"))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.BS_DATE=n)}),e.qZA()()()}if(2&a){const i=e.oxw(2);e.xp6(4),e.s9C("max",i.currDate),e.Q6J("ngModel",i._trnMainService.TrnMainObj.TRN_DATE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||("add-sales-invoice"==i.activeurlpath||1==i._trnMainService.TrnMainObj.VoucherType||"add-sales-invoice-wholesale"==i.activeurlpath||"add-creditnote-itembase"==i.activeurlpath)&&0==i._trnMainService.userProfile.CompanyInfo.AllowBackDateSalesEntry||"self-billing"==i.activeurlpath||"add-membership-sales-invoice"==i.activeurlpath||83==i._trnMainService.TrnMainObj.VoucherType||21==i._trnMainService.TrnMainObj.VoucherType)("min","add-creditnote-itembase"==i.activeurlpath&&1==i._trnMainService.userProfile.CompanyInfo.AllowBackDateSalesEntry?null==i._trnMainService?null:i._trnMainService.TrnMainObj.DateLimitForCreditNote:""),e.xp6(2),e.Q6J("id","InvnepaliDateFrom")("label","From")("disable",i._trnMainService.disableNepaliDate||"self-billing"==i.activeurlpath||73==i._trnMainService.TrnMainObj.VoucherType||("add-sales-invoice"==i.activeurlpath||1==i._trnMainService.TrnMainObj.VoucherType||"add-sales-invoice-wholesale"==i.activeurlpath||"add-creditnote-itembase"==i.activeurlpath)&&0==i._trnMainService.userProfile.CompanyInfo.AllowBackDateSalesEntry||"add-membership-sales-invoice"==i.activeurlpath||83==i._trnMainService.TrnMainObj.VoucherType||21==i._trnMainService.TrnMainObj.VoucherType)("ngModel",i._trnMainService.TrnMainObj.BS_DATE)}}function di(a,o){if(1&a&&(e.ynx(0),e.YNc(1,ci,7,8,"div",3),e.BQk()),2&a){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",14==i._trnMainService.TrnMainObj.VoucherType||1==i._trnMainService.TrnMainObj.VoucherType||15==i._trnMainService.TrnMainObj.VoucherType||57==i._trnMainService.TrnMainObj.VoucherType||41==i._trnMainService.TrnMainObj.VoucherType||73==i._trnMainService.TrnMainObj.VoucherType||83==i._trnMainService.TrnMainObj.VoucherType||86==i._trnMainService.TrnMainObj.VoucherType||21==i._trnMainService.TrnMainObj.VoucherType||46==i._trnMainService.TrnMainObj.VoucherType)}}function hi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Inv Date"),e.qZA(),e.TgZ(3,"td",40)(4,"input",41),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.TRN_DATE=n)})("change",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.changeInvDate(n.target.value,"AD"))}),e.qZA()(),e.TgZ(5,"td",42)(6,"nepali-date-picker",43),e.NdJ("change",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.changeInvDate(n.detail.value,"BS"))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.BS_DATE=n)}),e.qZA()()()}if(2&a){const i=e.oxw(2);e.xp6(4),e.s9C("max",i.currDate),e.Q6J("ngModel",i._trnMainService.TrnMainObj.TRN_DATE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||"add-sales-invoice"==i.activeurlpath||"self-billing"==i.activeurlpath||"add-sales-invoice-wholesale"==i.activeurlpath||"add-creditnote-itembase"==i.activeurlpath||"add-membership-sales-invoice"==i.activeurlpath||1==i._trnMainService.TrnMainObj.VoucherType)("min","add-creditnote-itembase"==i.activeurlpath&&1==i._trnMainService.userProfile.CompanyInfo.AllowBackDateSalesEntry?null==i._trnMainService?null:i._trnMainService.TrnMainObj.DateLimitForCreditNote:""),e.xp6(2),e.Q6J("id","InvnepaliDateFrom")("label","From")("disable",i._trnMainService.disableNepaliDate||"self-billing"==i.activeurlpath||73==i._trnMainService.TrnMainObj.VoucherType||"add-sales-invoice-wholesale"==i.activeurlpath||"add-creditnote-itembase"==i.activeurlpath||"add-sales-invoice"==i.activeurlpath||"add-membership-sales-invoice"==i.activeurlpath||1==i._trnMainService.TrnMainObj.VoucherType)("ngModel",i._trnMainService.TrnMainObj.BS_DATE)}}function _i(a,o){if(1&a&&(e.ynx(0),e.YNc(1,hi,7,8,"div",3),e.BQk()),2&a){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",14==i._trnMainService.TrnMainObj.VoucherType||1==i._trnMainService.TrnMainObj.VoucherType||15==i._trnMainService.TrnMainObj.VoucherType||57==i._trnMainService.TrnMainObj.VoucherType||41==i._trnMainService.TrnMainObj.VoucherType||73==i._trnMainService.TrnMainObj.VoucherType)}}function ui(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Entry Date"),e.qZA(),e.TgZ(3,"td",40)(4,"input",41),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.TRNDATE=n)})("change",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.changeEntryDate(n.target.value,"AD"))}),e.qZA()(),e.TgZ(5,"td",42)(6,"nepali-date-picker",44),e.NdJ("change",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.changeEntryDate(n.detail.value,"BS"))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.BSDATE=n)}),e.qZA()()()}if(2&a){const i=e.oxw();e.xp6(4),e.s9C("max",i.currDate),e.Q6J("ngModel",i._trnMainService.TrnMainObj.TRNDATE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||("add-sales-invoice"==i.activeurlpath||1==i._trnMainService.TrnMainObj.VoucherType||"add-sales-invoice-wholesale"==i.activeurlpath||"add-creditnote-itembase"==i.activeurlpath)&&0==i._trnMainService.userProfile.CompanyInfo.AllowBackDateSalesEntry||"self-billing"==i.activeurlpath||"add-membership-sales-invoice"==i.activeurlpath||83==i._trnMainService.TrnMainObj.VoucherType||21==i._trnMainService.TrnMainObj.VoucherType)("min","add-creditnote-itembase"==i.activeurlpath&&1==i._trnMainService.userProfile.CompanyInfo.AllowBackDateSalesEntry?null==i._trnMainService?null:i._trnMainService.TrnMainObj.DateLimitForCreditNote:""),e.xp6(2),e.Q6J("id","EntrynepaliDateFrom")("label","From")("disable",i._trnMainService.disableNepaliDate||"self-billing"==i.activeurlpath||("add-sales-invoice"==i.activeurlpath||1==i._trnMainService.TrnMainObj.VoucherType||"add-sales-invoice-wholesale"==i.activeurlpath||"add-creditnote-itembase"==i.activeurlpath)&&0==i._trnMainService.userProfile.CompanyInfo.AllowBackDateSalesEntry||"add-membership-sales-invoice"==i.activeurlpath||83==i._trnMainService.TrnMainObj.VoucherType||21==i._trnMainService.TrnMainObj.VoucherType||73==i._trnMainService.TrnMainObj.VoucherType)("ngModel",i._trnMainService.TrnMainObj.BSDATE)}}function Mi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Ref Bill No."),e.qZA(),e.TgZ(3,"input",45),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.REFBILL=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.RefBillEnterCommand(n))})("keydown.tab",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.RefBillEnterCommand(n))})("keydown",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.preventInput(n))}),e.qZA()()}if(2&a){const i=e.oxw();e.xp6(3),e.Q6J("disabled",i.RefBillFieldDisabled())("ngModel",i._trnMainService.TrnMainObj.REFBILL)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode)}}function pi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"input",48),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.REFBILL=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.RefBillEnterCommand(n))})("keydown.tab",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.RefBillEnterCommand(n))}),e.qZA()}if(2&a){const i=e.oxw(2);e.Q6J("disabled",i.RefBillFieldDisabled()||"VIEW"==i._trnMainService.TrnMainObj.Mode)("ngModel",i._trnMainService.TrnMainObj.REFBILL)("readonly",i.disableRefBill())}}function Ti(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"input",49),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.REFBILL=n)}),e.qZA()}if(2&a){const i=e.oxw(2);e.Q6J("ngModel",i._trnMainService.TrnMainObj.REFBILL)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode)}}function Si(a,o){if(1&a&&(e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Ref Bill No."),e.qZA(),e.YNc(3,pi,1,3,"input",46),e.YNc(4,Ti,1,2,"input",47),e.qZA()),2&a){const i=e.oxw();e.xp6(3),e.Q6J("ngIf",0==i.userSetting.ENABLEMANUALSALESRETURN),e.xp6(1),e.Q6J("ngIf",1==i.userSetting.ENABLEMANUALSALESRETURN)}}function vi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",52)(1,"input",53),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.DOFULLRETURN=n)})("change",function(n){e.CHM(i);const r=e.oxw(2);return r._trnMainService.TrnMainObj.DOFULLRETURN=n.target.checked?1:0,e.KtG(r.DoFulReturnClick(r._trnMainService.TrnMainObj.DOFULLRETURN))}),e.qZA(),e.TgZ(2,"label",54),e._uU(3,"Do Full Return"),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(1),e.Q6J("ngModel",i._trnMainService.TrnMainObj.DOFULLRETURN)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||0==i._trnMainService.TrnMainObj.DOFULLRETURN)}}function mi(a,o){if(1&a&&(e.TgZ(0,"div",50),e.YNc(1,vi,4,2,"div",51),e.qZA()),2&a){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",0==i.userSetting.ENABLEMANUALSALESRETURN)}}function gi(a,o){1&a&&e._UZ(0,"div",38)}function bi(a,o){1&a&&e.GkF(0)}function fi(a,o){1&a&&(e.TgZ(0,"label",10),e._uU(1,"Refno."),e.qZA())}function Ci(a,o){1&a&&(e.TgZ(0,"label",10),e._uU(1,"CouponNo."),e.qZA())}function Oi(a,o){if(1&a&&(e.TgZ(0,"option",64),e._uU(1),e.qZA()),2&a){const i=o.$implicit;e.s9C("value",null==i?null:i.series),e.xp6(1),e.Oqu(null==i?null:i.series)}}function Ai(a,o){if(1&a&&(e.ynx(0),e.YNc(1,Oi,2,2,"option",63),e.BQk()),2&a){const i=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",i.chalanSeries)}}function Ei(a,o){1&a&&(e.TgZ(0,"option",65),e._uU(1,"Chalan series not found!"),e.qZA())}function Ii(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"select",61),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.CHALANNOPREFIX=n)}),e.YNc(1,Ai,2,1,"ng-container",4),e.YNc(2,Ei,2,0,"option",62),e.qZA()}if(2&a){const i=e.oxw(2);e.Q6J("ngModel",i._trnMainService.TrnMainObj.CHALANNOPREFIX)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||1==i._trnMainService.disableAllFieldinPurchase),e.xp6(1),e.Q6J("ngIf",i.chalanSeries&&i.chalanSeries.length>0),e.xp6(1),e.Q6J("ngIf",i.chalanSeries&&0===i.chalanSeries.length)}}function Pi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38),e.YNc(1,bi,1,0,"ng-container",55),e.YNc(2,fi,2,0,"ng-template",null,56,e.W1O),e.YNc(4,Ci,2,0,"ng-template",null,57,e.W1O),e.TgZ(6,"td",58),e.YNc(7,Ii,3,4,"select",59),e.TgZ(8,"input",60),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.REFBILL=n)})("focus",function(n){return n.target.select()})("keydown.tab",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.masterService.focusAnyControl(1==n.userSetting.GblEnableMixedTenderMode&&0==n.userSetting.ENABLE_SOINTI?"customerselectid":"soNoId"))})("keydown.enter",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.enterClickOnRefno(n.event))})("change",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.enterClickOnRefno(n.event))}),e.qZA()()()}if(2&a){const i=e.MAs(3),t=e.MAs(5),n=e.oxw();e.xp6(1),e.Q6J("ngIf",1==n.userSetting.EnablePetrolPumpFeatures&&83==n._trnMainService.TrnMainObj.VoucherType)("ngIfThen",t)("ngIfElse",i),e.xp6(6),e.Q6J("ngIf",1==n.userSetting.PrefixForRefNoInVEntry),e.xp6(1),e.Q6J("ngClass",1==n.userSetting.PrefixForRefNoInVEntry?"prefixYes":"prefixNo")("ngModel",n._trnMainService.TrnMainObj.REFBILL)("disabled","VIEW"==n._trnMainService.TrnMainObj.Mode||"EDIT"==n._trnMainService.TrnMainObj.Mode&&1==n.userSetting.EnablePetrolPumpFeatures&&83==n._trnMainService.TrnMainObj.VoucherType)}}function Ni(a,o){if(1&a&&(e.TgZ(0,"option",64),e._uU(1),e.qZA()),2&a){const i=o.$implicit;e.s9C("value",i.ID),e.xp6(1),e.hij(" ",i.PAYMENTTERMS||"No Payment Term"," ")}}function Li(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"span",70),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n.onClickAdd())}),e.TgZ(1,"p"),e._uU(2,"+"),e.qZA()()}}function Di(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Payment Terms"),e.qZA(),e.TgZ(3,"div",66)(4,"select",67),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.PAYMENTTERMS=n)})("change",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onPaymentChange(n))}),e.TgZ(5,"option",68),e._uU(6,"Select a Payment Term"),e.qZA(),e.YNc(7,Ni,2,2,"option",63),e.qZA(),e.YNc(8,Li,3,0,"span",69),e.qZA()()}if(2&a){const i=e.oxw();e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.AdditionalObj.PAYMENTTERMS)("disabled","VIEW"===i._trnMainService.TrnMainObj.Mode),e.xp6(3),e.Q6J("ngForOf",i.payment),e.xp6(1),e.Q6J("ngIf","VIEW"!=i._trnMainService.TrnMainObj.Mode)}}function yi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Ref Bill No."),e.qZA(),e.TgZ(3,"input",71),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.REFBILL=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.RefBillEnterCommand(n))})("keydown.tab",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.RefBillEnterCommand(n))}),e.qZA()()}if(2&a){const i=e.oxw();e.xp6(3),e.Q6J("disabled",i.RefBillFieldDisabled()||"VIEW"==i._trnMainService.TrnMainObj.Mode||"EDIT"==i._trnMainService.TrnMainObj.Mode&&21==i._trnMainService.TrnMainObj.VoucherType)("ngModel",i._trnMainService.TrnMainObj.REFBILL)}}function Ri(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",50)(1,"div",72)(2,"input",73),e.NdJ("change",function(n){e.CHM(i);const r=e.oxw();return r._trnMainService.TrnMainObj.DOFULLRETURN=n.target.checked?1:0,e.KtG(r._trnMainService.callPipe=!r._trnMainService.callPipe)})("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.DOFULLRETURN=n)})("click",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.DoFulReturnClick(n.target.checked))}),e.qZA(),e.TgZ(3,"label",54),e._uU(4,"Do Full Return"),e.qZA()()()}if(2&a){const i=e.oxw();e.xp6(2),e.Q6J("ngModel",i._trnMainService.TrnMainObj.DOFULLRETURN)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||"EDIT"==i._trnMainService.TrnMainObj.Mode)}}function xi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"PP No./Date:"),e.qZA(),e.TgZ(3,"input",74),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.PRAGYAPANPATRA=n)}),e.qZA(),e.TgZ(4,"input",75),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.PPDATE=n)}),e.qZA()()}if(2&a){const i=e.oxw();e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.PRAGYAPANPATRA)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||1==i._trnMainService.disableAllFieldinPurchase),e.xp6(1),e.Q6J("ngModel",i._trnMainService.TrnMainObj.PPDATE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode)}}function ji(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Job Card No."),e.qZA(),e.TgZ(3,"td",58)(4,"input",76),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.JOBCARDNO=n)})("Keydown.Enter",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.JobCardNoEnter())})("focus",function(n){return n.target.select()}),e.qZA()()()}if(2&a){const i=e.oxw();e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.AdditionalObj.JOBCARDNO)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode)}}function wi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Bill Format"),e.qZA(),e.TgZ(3,"select",77),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.BILLFORMATS=n)}),e.TgZ(4,"option",78),e._uU(5,"Full Bill"),e.qZA(),e.TgZ(6,"option",79),e._uU(7,"Half Bill"),e.qZA()()()}if(2&a){const i=e.oxw();e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.AdditionalObj.BILLFORMATS)("disabled",i.UnitandFormatDisabled())}}function Zi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div")(1,"td")(2,"input",83),e.NdJ("change",function(n){e.CHM(i);const r=e.oxw(2);return r._trnMainService.TrnMainObj.LOADFULLFROMQT=n.target.checked?1:0,e.KtG(r.onChangeSOLoad(n))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.LOADFULLFROMQT=n)})("keydown.delete",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n.removeReferenceNumber())}),e.qZA(),e.TgZ(3,"label",84),e._uU(4,"Load Full SO Detail"),e.qZA()()()}if(2&a){const i=e.oxw(2);e.xp6(2),e.Q6J("ngModel",i._trnMainService.TrnMainObj.LOADFULLFROMQT)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||i._trnMainService.TrnMainObj.REFORDBILL)}}function Fi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",80)(1,"label",10),e._uU(2,"SO NO"),e.qZA(),e.TgZ(3,"td",81)(4,"input",82),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.REFORDBILL=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.SalesOrderEnter(n))})("keydown.Tab",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.masterService.focusAnyControl(1==n.userSetting.GblEnableMixedTenderMode?"customerselectid":"paymentTerms"))})("keydown.delete",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.salesOrderDelete())}),e.qZA()(),e.YNc(5,Zi,5,2,"div",4),e.qZA()}if(2&a){const i=e.oxw();e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.REFORDBILL)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode),e.xp6(1),e.Q6J("ngIf",!("14"==i._trnMainService.TrnMainObj.VoucherType&&1==i.userSetting.ENABLE_SOINDCHALAN))}}function ki(a,o){if(1&a&&(e.TgZ(0,"option",64),e._uU(1),e.qZA()),2&a){const i=o.$implicit;e.Q6J("value",i.MODEVALUE),e.xp6(1),e.Oqu(i.PAYMENTMODENAME)}}function Ui(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"select",94),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r._trnMainService.TrnMainObj.TRNMODE=n)})("change",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r.paymentTermsChange(n))}),e.YNc(1,ki,2,2,"option",63),e.qZA()}if(2&a){const i=e.oxw(3);e.Q6J("ngModel",i._trnMainService.TrnMainObj.TRNMODE)("disabled",i.disablePaymentTermsField()),e.xp6(1),e.Q6J("ngForOf",i.paymentList)}}function Vi(a,o){if(1&a&&(e.TgZ(0,"option",64),e._uU(1),e.qZA()),2&a){const i=o.$implicit;e.Q6J("value",i.NAME),e.xp6(1),e.Oqu(i.NAME)}}function Bi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"select",95),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.PAYMENTTERMS=n)})("change",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r.onExportSalesPaymentChange(n))}),e._UZ(1,"option",65),e.YNc(2,Vi,2,2,"option",63),e.qZA()}if(2&a){const i=e.oxw(3);e.Q6J("ngModel",i._trnMainService.TrnMainObj.AdditionalObj.PAYMENTTERMS)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode),e.xp6(2),e.Q6J("ngForOf",i.ExportPayment)}}function Gi(a,o){if(1&a&&(e.TgZ(0,"div",38)(1,"label",10),e._uU(2),e.qZA(),e.YNc(3,Ui,2,3,"select",92),e.YNc(4,Bi,3,3,"select",93),e.qZA()),2&a){const i=e.oxw(2);e.xp6(2),e.Oqu(i.paymentModeLabel),e.xp6(1),e.Q6J("ngIf","export-sales-invoice"!=i.activeurlpath),e.xp6(1),e.Q6J("ngIf","export-sales-invoice"===i.activeurlpath)}}function Hi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Account"),e.qZA(),e.TgZ(3,"input",96),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.TRNACName=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.AccountEnterCommand(n))}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("disabled",i.disableAccountSelection()||i._trnMainService.disableAccountInputField)("ngModel",i._trnMainService.TrnMainObj.TRNACName)}}function qi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"input",99),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r._trnMainService.TrnMainObj.MWAREHOUSE=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r.WarehouseEnterCommand(n))}),e.ALo(1,"disableField"),e.qZA()}if(2&a){const i=e.oxw(3);e.Q6J("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||e.lcZ(1,3,"disableWareHouse")||1==(null==i._trnMainService.disableMaster?null:i._trnMainService.disableMaster.Warehouse)||1==i._trnMainService.disableAllFieldinPurchase||0==i.userSetting.ENABLEMANUALSALESRETURN&&15==i._trnMainService.TrnMainObj.VoucherType||21==i._trnMainService.TrnMainObj.VoucherType)("ngModel",i._trnMainService.TrnMainObj.MWAREHOUSE)("readonly",!0)}}function Ji(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"input",100),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r._trnMainService.TrnMainObj.MWAREHOUSE=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r.WarehouseEnterForUnsalableCommand(n))}),e.ALo(1,"disableField"),e.qZA()}if(2&a){const i=e.oxw(3);e.Q6J("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||e.lcZ(1,2,"disableWareHouse")||1==(null==i._trnMainService.disableMaster?null:i._trnMainService.disableMaster.Warehouse)||1==i._trnMainService.disableAllFieldinPurchase||0==i.userSetting.ENABLEMANUALSALESRETURN)("ngModel",i._trnMainService.TrnMainObj.MWAREHOUSE)}}function Qi(a,o){if(1&a&&(e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Warehouse"),e.qZA(),e.YNc(3,qi,2,5,"input",97),e.YNc(4,Ji,2,4,"input",98),e.qZA()),2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngIf","self-billing"!=i.activeurlpath),e.xp6(1),e.Q6J("ngIf","self-billing"==i.activeurlpath)}}function Yi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",101)(1,"label",10),e._uU(2,"Salesman"),e.qZA(),e.TgZ(3,"input",102),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.SALESMAN=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.salesManEnterCommand(n))})("keydown.delete",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n.deleteSalesman())}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.SALESMAN)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode)}}function Ki(a,o){if(1&a&&(e.TgZ(0,"option",64),e._uU(1),e.qZA()),2&a){const i=o.$implicit;e.s9C("value",i.CCID),e.xp6(1),e.hij(" ",i.COSTCENTERNAME,"")}}function Wi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Cost Center"),e.qZA(),e.TgZ(3,"select",103),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.COSTCENTER=n)})("keydown.tab",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n.focusToRemarks())}),e._UZ(4,"option",65),e.YNc(5,Ki,2,2,"option",63),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.COSTCENTER)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||0==i.userSetting.ENABLEMANUALSALESRETURN&&15==i._trnMainService.TrnMainObj.VoucherType||i._trnMainService.disableCostCenterForCargo||1==i.userSetting.enableCostCenter&&1==i.userSetting.EnableCostCenterWiseAccounting&&"add-creditnote-itembase"==i.activeurlpath&&0==i.userSetting.ENABLEMANUALSALESRETURN||21==i._trnMainService.TrnMainObj.VoucherType),e.xp6(2),e.Q6J("ngForOf",i.costlists)}}function zi(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"A/C B/L"),e.qZA(),e.TgZ(3,"input",104),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.BALANCEAMOUNT=n)}),e.qZA(),e.TgZ(4,"label",105)(5,"b"),e._uU(6),e.qZA()()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.BALANCEAMOUNT),e.xp6(3),e.Oqu(i._trnMainService.TrnMainObj.LIMITINDICATOR)}}function Xi(a,o){if(1&a&&(e.TgZ(0,"option",64),e._uU(1),e.qZA()),2&a){const i=o.$implicit;e.s9C("value",i.CURNAME),e.xp6(1),e.hij(" ",i.CURNAME," ")}}function $i(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",106)(1,"label",106),e._uU(2,"Currency :"),e.qZA(),e.TgZ(3,"select",107),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.FCurrency=n)})("change",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.onCurrenyChange(n.target.value))})("keydown.Tab",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.focusToExcRate(n))})("keydown.Enter",function(n){e.CHM(i);const r=e.oxw(2);return n.preventDefault(),e.KtG(r.focusToExcRate(n))}),e.YNc(4,Xi,2,2,"option",63),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.FCurrency)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode),e.xp6(1),e.Q6J("ngForOf",i.masterService.Currencies)}}function et(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",106)(1,"label",108),e._uU(2,"EX Rate :"),e.qZA(),e.TgZ(3,"input",109),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.EXRATE=n)}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.EXRATE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode)}}function it(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",110)(1,"label",10),e._uU(2,"Transportation Mode:"),e.qZA(),e.TgZ(3,"select",111),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.TRANSPORTATIONMODE=n)}),e.TgZ(4,"option",112),e._uU(5,"Air"),e.qZA(),e.TgZ(6,"option",113),e._uU(7,"Road"),e.qZA(),e.TgZ(8,"option",114),e._uU(9,"Ship"),e.qZA()()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.AdditionalObj.TRANSPORTATIONMODE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode)}}function tt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Billing Mode"),e.qZA(),e.TgZ(3,"select",115),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.BILLMODE=n)}),e.TgZ(4,"option",116),e._uU(5,"New Registration"),e.qZA(),e.TgZ(6,"option",117),e._uU(7,"Renewable"),e.qZA()()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.BILLMODE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode)}}function nt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Bill Format"),e.qZA(),e.TgZ(3,"select",118),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.BILLFORMATS=n)}),e.TgZ(4,"option",78),e._uU(5,"Full Bill"),e.qZA(),e.TgZ(6,"option",79),e._uU(7,"Half Bill"),e.qZA()()()}if(2&a){const i=e.oxw(3);e.xp6(3),e.Q6J("disabled",i.UnitandFormatDisabled())("ngModel",i._trnMainService.TrnMainObj.AdditionalObj.BILLFORMATS)}}function rt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Unit"),e.qZA(),e.TgZ(3,"select",119,120),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.BILLUNITS=n)})("keydown.tab",function(){e.CHM(i);const n=e.oxw(3);return e.KtG(n.UniEnterCommand())})("keydown.enter",function(){e.CHM(i);const n=e.oxw(3);return e.KtG(n.UniEnterCommand())}),e.TgZ(5,"option",121),e._uU(6,"Case"),e.qZA(),e.TgZ(7,"option",122),e._uU(8,"Each"),e.qZA()()()}if(2&a){const i=e.oxw(3);e.xp6(3),e.Q6J("disabled",i.UnitandFormatDisabled())("ngModel",i._trnMainService.TrnMainObj.AdditionalObj.BILLUNITS)}}function at(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Bill Format"),e.qZA(),e.TgZ(3,"select",77),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.BILLFORMATS=n)}),e.TgZ(4,"option",78),e._uU(5,"Full Bill"),e.qZA(),e.TgZ(6,"option",79),e._uU(7,"Half Bill"),e.qZA()()()}if(2&a){const i=e.oxw(3);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.AdditionalObj.BILLFORMATS)("disabled",i.UnitandFormatDisabled())}}function ot(a,o){if(1&a&&(e.TgZ(0,"option",128),e._uU(1),e.qZA()),2&a){const i=o.$implicit;e.Q6J("ngValue",i.CURNAME),e.xp6(1),e.hij("",i.CURNAME," ")}}function st(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",124),e._uU(2,"Currency"),e.qZA(),e.TgZ(3,"select",125),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(4);return e.KtG(r._trnMainService.TrnMainObj.FCurrency=n)})("change",function(){e.CHM(i);const n=e.oxw(4);return e.KtG(n.CurrencyChange())}),e.YNc(4,ot,2,2,"option",126),e.qZA(),e.TgZ(5,"label",124),e._uU(6,"Exchange Rate"),e.qZA(),e.TgZ(7,"input",127),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(4);return e.KtG(r._trnMainService.TrnMainObj.EXRATE=n)}),e.qZA()()}if(2&a){const i=e.oxw(4);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.FCurrency),e.xp6(1),e.Q6J("ngForOf",i.masterService.Currencies),e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.EXRATE)}}function lt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Barcode"),e.qZA(),e.TgZ(3,"input",123),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r._trnMainService.BarcodeFromScan=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r._trnMainService.barcodeEnterCommand(n))}),e.qZA(),e.YNc(4,st,8,3,"div",3),e.qZA()}if(2&a){const i=e.oxw(3);e.xp6(3),e.Q6J("ngModel",i._trnMainService.BarcodeFromScan),e.xp6(1),e.Q6J("ngIf",1==i._trnMainService.AppSettings.ENABLEMULTICURRENCY)}}function ct(a,o){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,nt,8,2,"div",3),e.YNc(2,rt,9,2,"div",3),e.YNc(3,at,8,2,"div",3),e.YNc(4,lt,5,2,"div",3),e.qZA()),2&a){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(57==i._trnMainService.TrnMainObj.VoucherType||61==i._trnMainService.TrnMainObj.VoucherType||64==i._trnMainService.TrnMainObj.VoucherType)&&1==i.userSetting.EnableBillFormatInBilling),e.xp6(1),e.Q6J("ngIf",(57==i._trnMainService.TrnMainObj.VoucherType||61==i._trnMainService.TrnMainObj.VoucherType||64==i._trnMainService.TrnMainObj.VoucherType)&&1==i.userSetting.EnableBillFormatInBilling),e.xp6(1),e.Q6J("ngIf",1==i.userSetting.ENABLEMULTISPRINTFORMAT&&(15==i._trnMainService.TrnMainObj.VoucherType||41==i._trnMainService.TrnMainObj.VoucherType)),e.xp6(1),e.Q6J("ngIf",14==i._trnMainService.TrnMainObj.VoucherType&&"retailer"==i._trnMainService.userProfile.CompanyInfo.ORG_TYPE)}}function dt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",8),e.YNc(1,Gi,5,3,"div",3),e.TgZ(2,"div",85)(3,"label",10),e._uU(4,"Card No/Cheque:"),e.qZA(),e.TgZ(5,"td",66)(6,"input",86),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.CHEQUENO=n)}),e.qZA(),e.TgZ(7,"input",87),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.CHEQUEDATE=n)})("change",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.getEnglishDate())}),e.qZA()()(),e.YNc(8,Hi,4,2,"div",3),e.YNc(9,Qi,5,2,"div",3),e.YNc(10,Yi,4,2,"div",88),e.YNc(11,Wi,6,3,"div",3),e.YNc(12,zi,7,2,"div",3),e.TgZ(13,"div",89),e.YNc(14,$i,5,3,"div",90),e.YNc(15,et,4,2,"div",90),e.qZA(),e.YNc(16,it,10,2,"div",91),e.YNc(17,tt,8,2,"div",3),e.YNc(18,ct,5,4,"div",4),e.qZA()}if(2&a){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.showPaymentTerms()),e.xp6(1),e.Q6J("hidden",15==i._trnMainService.TrnMainObj.VoucherType||41==i._trnMainService.TrnMainObj.VoucherType||43==i._trnMainService.TrnMainObj.VoucherType||14==i._trnMainService.TrnMainObj.VoucherType||1==i._trnMainService.TrnMainObj.VoucherType||57==i._trnMainService.TrnMainObj.VoucherType||83==i._trnMainService.TrnMainObj.VoucherType||86==i._trnMainService.TrnMainObj.VoucherType||64==i._trnMainService.TrnMainObj.VoucherType||73==i._trnMainService.TrnMainObj.VoucherType||21==i._trnMainService.TrnMainObj.VoucherType||46==i._trnMainService.TrnMainObj.VoucherType),e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.CHEQUENO)("disabled","cheque"!=i._trnMainService.TrnMainObj.TRNMODE&&"creditcard"!=i._trnMainService.TrnMainObj.TRNMODE),e.xp6(1),e.Q6J("ngModel",i._trnMainService.TrnMainObj.CHEQUEDATE)("disabled","cheque"!=i._trnMainService.TrnMainObj.TRNMODE),e.xp6(1),e.Q6J("ngIf",i.hideAccount()),e.xp6(1),e.Q6J("ngIf",(14==i._trnMainService.TrnMainObj.VoucherType||15==i._trnMainService.TrnMainObj.VoucherType||43==i._trnMainService.TrnMainObj.VoucherType||1==i._trnMainService.TrnMainObj.VoucherType||57==i._trnMainService.TrnMainObj.VoucherType||46==i._trnMainService.TrnMainObj.VoucherType||83==i._trnMainService.TrnMainObj.VoucherType||86==i._trnMainService.TrnMainObj.VoucherType||64==i._trnMainService.TrnMainObj.VoucherType||41==i._trnMainService.TrnMainObj.VoucherType||73==i._trnMainService.TrnMainObj.VoucherType||21==i._trnMainService.TrnMainObj.VoucherType)&&"lite"!=i.AppMode),e.xp6(1),e.Q6J("ngIf",i.hideSalesman()&&"lite"!=i.AppMode),e.xp6(1),e.Q6J("ngIf",i.hideCostCentre()&&"lite"!=i.AppMode),e.xp6(1),e.Q6J("ngIf","add-sales-invoice"==i.activeurlpath&&"credit"==i._trnMainService.TrnMainObj.TRNMODE&&"lite"!=i.AppMode&&0==i.userSetting.GblEnableMixedTenderMode),e.xp6(2),e.Q6J("ngIf","export-sales-invoice"==i.activeurlpath),e.xp6(1),e.Q6J("ngIf","export-sales-invoice"==i.activeurlpath),e.xp6(1),e.Q6J("ngIf","export-sales-invoice"==i.activeurlpath),e.xp6(1),e.Q6J("ngIf","add-membership-sales-invoice"==i.activeurlpath),e.xp6(1),e.Q6J("ngIf",1==i.masterService.ShowMore)}}function ht(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"span",129),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.onAddNewCustomer())}),e.TgZ(1,"p"),e._uU(2,"+"),e.qZA()()}}function _t(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Member ID"),e.qZA(),e.TgZ(3,"input",130),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.MEMBERNO=n)}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.MEMBERNO)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||1==i._trnMainService.disableAllFieldinPurchase)}}function ut(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Account"),e.qZA(),e.TgZ(3,"input",133),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.TRNACName=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.AccountEnterCommand(n))}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("disabled",i.disableAccountSelection())("ngModel",i._trnMainService.TrnMainObj.TRNACName)}}function Mt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Country"),e.qZA(),e.TgZ(3,"input",134),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.COUNTRY=n)}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.COUNTRY)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode)}}function pt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Mobile No."),e.qZA(),e.TgZ(3,"input",130),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.BILLTOMOB=n)}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.BILLTOMOB)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||1==i._trnMainService.disableAllFieldinPurchase)}}function Tt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"VATNO"),e.qZA(),e.TgZ(3,"input",130),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.BILLTOTEL=n)}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.BILLTOTEL)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||1==i._trnMainService.disableAllFieldinPurchase)}}function St(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",9)(1,"label",10),e._uU(2,"Vehicle No"),e.qZA(),e.TgZ(3,"input",135),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.VEHICLENO=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.onVehicleNoEnter(n))})("keyup",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.onVehicleNoEnter(n))}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("disabled","VIEW"===i._trnMainService.TrnMainObj.Mode)("ngModel",i._trnMainService.TrnMainObj.AdditionalObj.VEHICLENO)}}function vt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"span",140),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(3);return e.KtG(n.onClickAddDiscounts())}),e.TgZ(1,"p"),e._uU(2,"+"),e.qZA(),e.TgZ(3,"span",141),e._uU(4,"Add Additional Discount"),e.qZA()()}}function mt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"div",136)(2,"label",106),e._uU(3,"Flat Dis(%)"),e.qZA(),e.TgZ(4,"input",137),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.DCRATE=n)})("keydown.Enter",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.applyFlatDiscount(n))})("keydown.Tab",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.applyFlatDiscount(n))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return r._trnMainService.callPipe=!r._trnMainService.callPipe,e.KtG(r.validateFlatDiscount(n))})("focusout",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.applyFlatDiscount(n))}),e.qZA()(),e.TgZ(5,"div",136)(6,"label",108),e._uU(7,"Flat Dis(Rs)"),e.qZA(),e.TgZ(8,"input",138),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.FLATDCAMNT=n)})("focusout",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.applyFlatDiscount(n))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return r._trnMainService.callPipe=!r._trnMainService.callPipe,e.KtG(r.validateFlatDiscountAmount(n))})("keydown.Enter",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.applyFlatDiscount(n))})("change",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.applyFlatDiscount(n))}),e.qZA(),e.YNc(9,vt,5,0,"span",139),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.DCRATE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||i.showDiscountAddButton()||1==(null==i._trnMainService.disableMaster?null:i._trnMainService.disableMaster.FlatDisPer)||i._trnMainService.nullToZeroConverter(i._trnMainService.TrnMainObj.FLATDCAMNT)>0||i._trnMainService.disableOnPerFormaSelect||i.disableFlatDisField()),e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.FLATDCAMNT)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||i.showDiscountAddButton()||1==(null==i._trnMainService.disableMaster?null:i._trnMainService.disableMaster.FlatDisRs)||i._trnMainService.nullToZeroConverter(i._trnMainService.TrnMainObj.DCRATE)>0||i._trnMainService.disableOnPerFormaSelect||i.disableFlatDisField()),e.xp6(1),e.Q6J("ngIf",i.showDiscountAddButton())}}function gt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",142),e._uU(2,"Load Wholesale Rate"),e.qZA(),e.TgZ(3,"input",143),e.NdJ("change",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.LoadWholeSaleRate=n.target.checked?1:0)})("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.LoadWholeSaleRate=n)}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.AdditionalObj.LoadWholeSaleRate)("disabled",i.disableWholeSaleRateOption())}}function bt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div"),e.YNc(1,_t,4,2,"div",3),e.YNc(2,ut,4,2,"div",3),e.TgZ(3,"div",38)(4,"label",10),e._uU(5,"Address"),e.qZA(),e.TgZ(6,"input",130),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.BILLTOADD=n)}),e.qZA()(),e.YNc(7,Mt,4,2,"div",3),e.YNc(8,pt,4,2,"div",3),e.YNc(9,Tt,4,2,"div",3),e.YNc(10,St,4,2,"div",131),e.TgZ(11,"div",38)(12,"label",10),e._uU(13,"Remarks"),e.qZA(),e.TgZ(14,"textarea",132),e.NdJ("keydown.Tab",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.focusToBarcode(n))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.REMARKS=n)}),e.qZA()(),e.YNc(15,mt,10,5,"div",3),e.YNc(16,gt,4,2,"div",3),e.qZA()}if(2&a){const i=e.oxw();e.xp6(1),e.Q6J("ngIf","add-membership-sales-invoice"===i.activeurlpath),e.xp6(1),e.Q6J("ngIf","export-sales-invoice"===i.activeurlpath),e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.BILLTOADD)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||1==i._trnMainService.disableAllFieldinPurchase),e.xp6(1),e.Q6J("ngIf","export-sales-invoice"==i.activeurlpath),e.xp6(1),e.Q6J("ngIf","add-membership-sales-invoice"===i.activeurlpath),e.xp6(1),e.Q6J("ngIf","export-sales-invoice"!=i.activeurlpath),e.xp6(1),e.Q6J("ngIf",("add-sales-invoice"==i.activeurlpath||"abbreviated-sales-invoice"==i.activeurlpath)&&1==i.userSetting.EnableVehicleMappingForCustomer),e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.REMARKS)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode),e.xp6(1),e.Q6J("ngIf",i.hideFlatDiscount()),e.xp6(1),e.Q6J("ngIf",i.showWholesaleRateOption())}}function ft(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"div",136)(2,"label",106),e._uU(3,"Flat Dis(%)"),e.qZA(),e.TgZ(4,"input",145),e.NdJ("focusout",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n._trnMainService.clearFlatPercentageAndAmount())})("keydown.Enter",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n._trnMainService.onApplyClicked())})("keydown.Tab",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n._trnMainService.onApplyClicked())})("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.DCRATE=n)}),e.qZA()(),e.TgZ(5,"div",136)(6,"label",146),e._uU(7,"Flat Dis(Rs)"),e.qZA(),e.TgZ(8,"input",147),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.FLATDCAMNT=n)})("focusout",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n._trnMainService.clearFlatPercentageAndAmount())})("keydown.Enter",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n._trnMainService.onApplyClicked())})("keydown.Tab",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n._trnMainService.onApplyClicked())}),e.qZA()()()}if(2&a){const i=e.oxw(2);e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.DCRATE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||1==i._trnMainService.disableMaster.FlatDisPer||i._trnMainService.nullToZeroConverter(i._trnMainService.TrnMainObj.FLATDCAMNT)>0||0==i.userSetting.ENABLEMANUALSALESRETURN),e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.FLATDCAMNT)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||1==i._trnMainService.disableMaster.FlatDisRs||i._trnMainService.nullToZeroConverter(i._trnMainService.TrnMainObj.DCRATE)>0||0==i.userSetting.ENABLEMANUALSALESRETURN)}}function Ct(a,o){if(1&a&&(e.TgZ(0,"div",38)(1,"label",10),e._uU(2),e.qZA(),e.TgZ(3,"select",148)(4,"option",149),e._uU(5,"Credit"),e.qZA(),e.TgZ(6,"option",150),e._uU(7,"Cash"),e.qZA(),e.TgZ(8,"option",151),e._uU(9,"Credit Card"),e.qZA(),e.TgZ(10,"option",152),e._uU(11,"Cheque Deposite"),e.qZA(),e.TgZ(12,"option",153),e._uU(13,"Mixed"),e.qZA()()()),2&a){const i=e.oxw(2);e.xp6(2),e.Oqu(i.paymentModeLabel),e.xp6(1),e.Q6J("ngModel",i._trnMainService.TrnMainObj.TRNMODE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||"self-billing"==i._trnMainService.activeurlpath)}}function Ot(a,o){if(1&a&&(e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Account"),e.qZA(),e._UZ(3,"input",154),e.qZA()),2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode)("ngModel",i._trnMainService.TrnMainObj.TRNACName)}}function At(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",144)(1,"div",38)(2,"label",10),e._uU(3,"Remarks"),e.qZA(),e.TgZ(4,"textarea",132),e.NdJ("keydown.Tab",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.focusToBarcode(n))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.TrnMainObj.REMARKS=n)}),e.qZA()(),e.YNc(5,ft,9,4,"div",3),e.YNc(6,Ct,14,3,"div",3),e.YNc(7,Ot,4,2,"div",3),e.qZA()}if(2&a){const i=e.oxw();e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.REMARKS)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode),e.xp6(1),e.Q6J("ngIf",i.hideFlatDiscountinLite()),e.xp6(1),e.Q6J("ngIf",1==i.userSetting.GblEnableMixedTenderMode&&"VIEW"==i._trnMainService.TrnMainObj.Mode),e.xp6(1),e.Q6J("ngIf",1==i.userSetting.GblEnableMixedTenderMode&&"VIEW"==i._trnMainService.TrnMainObj.Mode&&"mixed"!=i._trnMainService.TrnMainObj.TRNMODE)}}function Et(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"span",140),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(3);return e.KtG(n.onClickAddDiscounts())}),e.TgZ(1,"p"),e._uU(2,"+"),e.qZA(),e.TgZ(3,"span",162),e._uU(4,"Add Additional Discount"),e.qZA()()}}function It(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",101)(1,"label",10),e._uU(2,"Salesman"),e.qZA(),e.TgZ(3,"input",163),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r._trnMainService.TrnMainObj.SALESMAN=n)})("keydown.enter",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r.salesManEnterCommand(n))})("keydown.delete",function(){e.CHM(i);const n=e.oxw(3);return e.KtG(n.deleteSalesman())}),e.qZA()()}if(2&a){const i=e.oxw(3);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.SALESMAN)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode)}}function Pt(a,o){if(1&a&&(e.TgZ(0,"option",64),e._uU(1),e.qZA()),2&a){const i=o.$implicit;e.s9C("value",i.ID),e.xp6(1),e.Oqu(i.Description)}}function Nt(a,o){if(1&a&&(e.TgZ(0,"option",64),e._uU(1),e.qZA()),2&a){const i=o.$implicit;e.s9C("value",i.ID),e.xp6(1),e.Oqu(i.STATUS)}}function Lt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",38)(1,"label",10),e._uU(2,"Decline Remarks"),e.qZA(),e.TgZ(3,"select",164),e.NdJ("keydown.Tab",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r.focusToBarcode(n))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw(3);return e.KtG(r._trnMainService.TrnMainObj.AdditionalObj.CFORM=n)})("change",function(){e.CHM(i);const n=e.oxw(3);return e.KtG(n.loadDeclineRemarks())}),e.YNc(4,Nt,2,2,"option",63),e.qZA(),e.TgZ(5,"span",70),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(3);return e.KtG(n.onClickAddRemarks())}),e.TgZ(6,"p"),e._uU(7,"+"),e.qZA()()()}if(2&a){const i=e.oxw(3);e.xp6(3),e.Q6J("ngModel",i._trnMainService.TrnMainObj.AdditionalObj.CFORM)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||"NEW"==i._trnMainService.TrnMainObj.Mode),e.xp6(1),e.Q6J("ngForOf",i.remarksList)}}function Dt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div")(1,"div",38)(2,"div",156)(3,"div",38)(4,"label",157),e._uU(5,"Flat Dis(%)"),e.qZA(),e.TgZ(6,"input",158),e.NdJ("change",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.applyFlatDiscount(n))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return r._trnMainService.callPipe=!r._trnMainService.callPipe,e.KtG(r.validateFlatDiscount(n))})("keydown.Enter",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.applyFlatDiscount(n))})("keydown.Tab",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.applyFlatDiscount(n))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.DCRATE=n)}),e.qZA()(),e.TgZ(7,"div",38)(8,"label",157),e._uU(9,"Flat Dis(Rs)"),e.qZA(),e.TgZ(10,"input",159),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.FLATDCAMNT=n)})("change",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.applyFlatDiscount(n))})("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return r._trnMainService.callPipe=!r._trnMainService.callPipe,e.KtG(r.validateFlatDiscountAmount(n))})("keydown.Enter",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.applyFlatDiscount(n))}),e.qZA()()(),e.TgZ(11,"div",160),e.YNc(12,Et,5,0,"span",139),e.qZA()(),e.YNc(13,It,4,2,"div",88),e.TgZ(14,"div",101)(15,"label",10),e._uU(16,"Status"),e.qZA(),e.TgZ(17,"select",161),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r._trnMainService.TrnMainObj.INVOICETYPE=n)}),e._UZ(18,"option",65),e.YNc(19,Pt,2,2,"option",63),e.qZA()(),e.YNc(20,Lt,8,3,"div",3),e.qZA()}if(2&a){const i=e.oxw(2);e.xp6(6),e.Q6J("ngModel",i._trnMainService.TrnMainObj.DCRATE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||i.showDiscountAddButton()||1==(null==i.disableMaster?null:i.disableMaster.FlatDisPer)||null==i._trnMainService.TrnMainObj.ProdList[0].MCODE||i._trnMainService.nullToZeroConverter(i._trnMainService.TrnMainObj.FLATDCAMNT)>0),e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.FLATDCAMNT)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||i.showDiscountAddButton()||1==(null==i._trnMainService.disableMaster?null:i._trnMainService.disableMaster.FlatDisRs)||i._trnMainService.nullToZeroConverter(i._trnMainService.TrnMainObj.DCRATE)>0||null==i._trnMainService.TrnMainObj.ProdList[0].MCODE),e.xp6(2),e.Q6J("ngIf",i.showDiscountAddButton()),e.xp6(1),e.Q6J("ngIf",i.hideSalesman()),e.xp6(4),e.Q6J("ngModel",i._trnMainService.TrnMainObj.INVOICETYPE)("disabled","VIEW"==i._trnMainService.TrnMainObj.Mode||"NEW"==i._trnMainService.TrnMainObj.Mode),e.xp6(2),e.Q6J("ngForOf",i.quotationStatusList),e.xp6(1),e.Q6J("ngIf",1==i._trnMainService.TrnMainObj.INVOICETYPE)}}function yt(a,o){if(1&a&&(e.TgZ(0,"div",155),e.YNc(1,Dt,21,10,"div",4),e.qZA()),2&a){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",1==i.masterService.ShowMore)}}function Rt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",165)(1,"div",166)(2,"div",167)(3,"div",168)(4,"h5",169),e._uU(5,"Discount authorization"),e.qZA(),e.TgZ(6,"button",170),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.closeModal())}),e.TgZ(7,"span",171),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",172)(10,"div",173)(11,"div",174)(12,"div",38)(13,"label",175),e._uU(14,"User Name:"),e.qZA(),e.TgZ(15,"div",176)(16,"input",177),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.disLimitAuthObj.username=n)}),e.qZA()()()(),e.TgZ(17,"div",174)(18,"div",38)(19,"label",175),e._uU(20,"Password:"),e.qZA(),e.TgZ(21,"div",176)(22,"input",178),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.disLimitAuthObj.password=n)}),e.qZA()()()()(),e.TgZ(23,"div",173)(24,"div",174)(25,"div",38)(26,"label",175),e._uU(27,"Discount Percent:"),e.qZA(),e.TgZ(28,"input",179),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.disLimitAuthObj.discountRate=n)}),e.qZA()()(),e.TgZ(29,"div",174)(30,"div",38)(31,"label",175),e._uU(32,"Discount Amount:"),e.qZA(),e.TgZ(33,"input",179),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.disLimitAuthObj.discountAmt=n)}),e.qZA()()()(),e.TgZ(34,"div",180)(35,"fieldset",181)(36,"legend",182),e._uU(37,"Discount authorization remarks:"),e.qZA(),e.TgZ(38,"textarea",183),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._trnMainService.disLimitAuthObj.remarks=n)}),e.qZA()()()(),e.TgZ(39,"div",184)(40,"button",185),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.discountAuthConfirm())}),e._uU(41,"Confirm"),e.qZA()()()()()}if(2&a){const i=e.oxw();e.xp6(16),e.Q6J("ngModel",i._trnMainService.disLimitAuthObj.username),e.xp6(6),e.Q6J("ngModel",i._trnMainService.disLimitAuthObj.password),e.xp6(6),e.Q6J("disabled",i._trnMainService.nullToZeroConverter(i._trnMainService.disLimitAuthObj.discountAmt)>0||1==i.userSetting.enableAdditionalFlatDiscountsInSales)("ngModel",i._trnMainService.disLimitAuthObj.discountRate),e.xp6(5),e.Q6J("disabled",i._trnMainService.nullToZeroConverter(i._trnMainService.disLimitAuthObj.discountRate)>0||1==i.userSetting.enableAdditionalFlatDiscountsInSales)("ngModel",i._trnMainService.disLimitAuthObj.discountAmt),e.xp6(5),e.Q6J("ngModel",i._trnMainService.disLimitAuthObj.remarks)}}function xt(a,o){1&a&&(e.TgZ(0,"p",191),e._uU(1,"Do you want to apply flat discount before or after the individual discount ?"),e.qZA())}function jt(a,o){1&a&&(e.TgZ(0,"p",191),e._uU(1,"How do you want to apply flat discount?"),e.qZA())}function wt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"button",190),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return n._trnMainService.beforeDiscFlat(),e.KtG(n._trnMainService.showFlatDiscOption=!1)}),e._uU(1,"BEFORE "),e.qZA()}}function Zt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"button",190),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return n._trnMainService.onApplyClicked(),e.KtG(n._trnMainService.showFlatDiscOption=!1)}),e._uU(1,"OVERWRITE"),e.qZA()}}function Ft(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",165)(1,"div",186)(2,"div",187)(3,"div",168)(4,"h6",169),e._uU(5,"Confirmation"),e.qZA(),e.TgZ(6,"button",170),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.closeFlatDiscOption())}),e.TgZ(7,"span",171),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",172),e.YNc(10,xt,2,0,"p",188),e.YNc(11,jt,2,0,"p",188),e.qZA(),e.TgZ(12,"div",184),e.YNc(13,wt,2,0,"button",189),e.TgZ(14,"button",190),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return n._trnMainService.afterDiscFlat(),e.KtG(n._trnMainService.showFlatDiscOption=!1)}),e._uU(15,"AFTER"),e.qZA(),e.YNc(16,Zt,2,0,"button",189),e.TgZ(17,"button",190),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return n._trnMainService.onRevertClicked(),e.KtG(n._trnMainService.showFlatDiscOption=!1)}),e._uU(18,"REVERT"),e.qZA()()()()()}if(2&a){const i=e.oxw();e.xp6(10),e.Q6J("ngIf",1==i.userSetting.EnableFDiscountBeforeIDiscount&&i.showBeforeOverwrite()),e.xp6(1),e.Q6J("ngIf",1!=i.userSetting.EnableFDiscountBeforeIDiscount||!i.showBeforeOverwrite()),e.xp6(2),e.Q6J("ngIf",1==i.userSetting.EnableFDiscountBeforeIDiscount&&i.showBeforeOverwrite()),e.xp6(3),e.Q6J("ngIf",i.showBeforeOverwrite())}}function kt(a,o){1&a&&(e.TgZ(0,"p",191),e._uU(1,"Do you want to apply flat discount before or after the individual discount ?"),e.qZA())}function Ut(a,o){1&a&&(e.TgZ(0,"p",191),e._uU(1,"How do you want to apply flat discount?"),e.qZA())}function Vt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"button",190),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return n.flatDiscountType="before",e.KtG(n.onAddNewDiscounts())}),e._uU(1,"BEFORE "),e.qZA()}}function Bt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"button",190),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return n.flatDiscountType="overwrite",e.KtG(n.onAddNewDiscounts())}),e._uU(1,"OVERWRITE"),e.qZA()}}function Gt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",165)(1,"div",186)(2,"div",187)(3,"div",168)(4,"h6",169),e._uU(5,"Confirmation"),e.qZA(),e.TgZ(6,"button",170),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.closeAdditionalFlatDiscOption())}),e.TgZ(7,"span",171),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",172),e.YNc(10,kt,2,0,"p",188),e.YNc(11,Ut,2,0,"p",188),e.qZA(),e.TgZ(12,"div",184),e.YNc(13,Vt,2,0,"button",189),e.TgZ(14,"button",190),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return n.flatDiscountType="after",e.KtG(n.onAddNewDiscounts())}),e._uU(15,"AFTER"),e.qZA(),e.YNc(16,Bt,2,0,"button",189),e.qZA()()()()}if(2&a){const i=e.oxw();e.xp6(10),e.Q6J("ngIf",1==i.userSetting.EnableFDiscountBeforeIDiscount&&i.showBeforeOverwrite()),e.xp6(1),e.Q6J("ngIf",1!=i.userSetting.EnableFDiscountBeforeIDiscount||!i.showBeforeOverwrite()),e.xp6(2),e.Q6J("ngIf",1==i.userSetting.EnableFDiscountBeforeIDiscount&&i.showBeforeOverwrite()),e.xp6(3),e.Q6J("ngIf",i.showBeforeOverwrite())}}function Ht(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div")(1,"div",192)(2,"div",193)(3,"div",168)(4,"h5",169),e._uU(5,"Add/Edit Payment Terms"),e.qZA(),e.TgZ(6,"button",170),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.closePaymentTermModal())}),e.TgZ(7,"span",171),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"form",194),e.NdJ("ngSubmit",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.onPaymentSubmit())}),e.TgZ(10,"div",172)(11,"div",195)(12,"label",196),e._uU(13,"Payment Term Name:"),e.qZA(),e.TgZ(14,"div",197),e._UZ(15,"input",198),e.qZA()()(),e.TgZ(16,"div",184)(17,"button",199),e._uU(18,"Save"),e.qZA()()()()()()}if(2&a){const i=e.oxw();e.xp6(9),e.Q6J("formGroup",i.paymentTermForm)}}function qt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div")(1,"div",192)(2,"div",193)(3,"div",168)(4,"h5",169),e._uU(5,"Add New Remarks"),e.qZA(),e.TgZ(6,"button",170),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.closeDeclineTermModal())}),e.TgZ(7,"span",171),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"form",194),e.NdJ("ngSubmit",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.onRemarkSubmit())}),e.TgZ(10,"div",172)(11,"div",195)(12,"label",196),e._uU(13,"Decline Remarks:"),e.qZA(),e.TgZ(14,"div",197),e._UZ(15,"input",200),e.qZA()()(),e.TgZ(16,"div",184)(17,"button",199),e._uU(18,"Save"),e.qZA()()()()()()}if(2&a){const i=e.oxw();e.xp6(9),e.Q6J("formGroup",i.declineTermForm)}}const Jt=function(){return{height:"155px"}};let U=(()=>{class a{constructor(i,t,n,r,s,c,h,d,v,A){this.masterService=i,this._trnMainService=t,this.arouter=n,this._authService=r,this.dialog=s,this._alertService=c,this.loader=h,this._paymentTermsService=d,this.fb=v,this.productHelper=A,this.gridPopupSettingsForTaxCancel=new u.im,this.newgridPopupSettingsForTaxCancel=new Y.sG,this.newgridPopupSettingsForSalesReturn=new u.im,this.newgridPopupSettingsForDeliveryChalanReturn=new u.im,this.gridPopupSettingsForCustomer=new Y.sG,this.gridPopupSettingsForRefBill=new u.im,this.gridPopupSettingsForSalesMan=new u.im,this.gridPopupSettingsForCustomerListBySalesmanAndRoute=new Y.sG,this.onDblClickSOLoadInTI=new e.vpe,this.enterClickOnRefnoEventEmit=new e.vpe,this.genericGridAccountSetting=new u.im,this.genericGridSalesOrderSetting=new u.im,this.genericGridJobCardNoSetting=new u.im,this.gridPopupSettingsForVehicleNo=new Y.sG,this.billLabel="Bill No",this.salesTransactionAccountList=[],this.ShowTransactionMode=!1,this.doubleClick=!1,this.salesManList=[],this.showBalance=!1,this.dateMiti=[],this.paymentModeLabel="Payment Terms",this.disableOnCreditSelect=!1,this.customerLabel="Customer",this.ExportPayment=[],this.addNewPayment=!1,this.addNewDeclineRemark=!1,this.selectedPaymentTerm="",this.quotationStatusList=[],this.remarksList=[],this.disablePaymentTerms=!1,this.showAdditionalFlatDiscountPopUp=!1,this.flatDiscountType="",this.grossAmount=this._trnMainService.TrnMainObj.GROSSAMNT,this.showDiscountPopup=!1,this.totalIndividualDiscount=0,this.paymentList=[],this.isSO=!1,this.Disable_CashCreditMode_RefLoaded=!1,this.gridPopupSettingsForWarehouse=new u.im,this.showCustomerProfile=new e.vpe,this.appType=this.masterService.appType,this.userProfile=this._authService.getUserProfile(),this.userSetting=r.getSetting(),this.AppMode=q.N.appMode,"lite"==this.AppMode&&(this.disableForLite=!0),"self-billing"===this.arouter.snapshot.url[0].path&&(this._trnMainService.TrnMainObj.MWAREHOUSE=this.userProfile.userWarehouse),"export-sales-invoice"===this.arouter.snapshot.url[0].path&&this.masterService.getExportPayment().subscribe(m=>{this.ExportPayment=m.result}),this._trnMainService.TrnMainObj.CHALANNOPREFIX="",this.masterService.getAllCostCenter().subscribe(m=>{m&&(this.costlists=m,this.valueforCostCenterWiseAccounting(this.costlists))},m=>{this.costlists=[]}),(this._trnMainService.TrnMainObj.VoucherType==l.Km.SalesOrder||this._trnMainService.TrnMainObj.VoucherType==l.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===l.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===l.Km.Quotation||this._trnMainService.TrnMainObj.VoucherType===l.Km.DeliveryChalan||this._trnMainService.TrnMainObj.VoucherType===l.Km.DeliveryReturn||this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.CreditNote)&&(this.ShowTransactionMode=!0),this.gridPopupSettingsForRefBill=this.masterService.getGenericGridPopUpSettings("REFBILLOFSALESRETURN"),this.loadCompanyInfo(),this.activeurlpath=n.snapshot.url[0].path;var O=this.masterService.PhiscalObj.BeginDate;if(O=O.substring(0,10),this.date2=O,this.userProfile.CompanyInfo.ActualFY==this.masterService.PhiscalObj.PhiscalID)this.date1=(new Date).toJSON().split("T")[0];else{var M=this.masterService.PhiscalObj.EndDate;M=M.substring(0,10),this.date1=M}this.getPaymentTerms(),this.getDeclineStatusRemarks()}removeReferenceNumber(){this._trnMainService.TrnMainObj.REFORDBILL=null}getPaymentModes(){let i="WITHOUTEPAYMENT";this._trnMainService.TrnMainObj.VoucherType==l.Km.CreditNote&&(i="FORCN"),this.masterService.getPaymentModeList(i).subscribe(t=>{t&&t.result&&t.result.length>0&&(this.paymentList=t.result)})}ngOnInit(){this.getPaymentModes();const i=new Date;this.currDate=(0,T.p6)(i,"yyyy-MM-dd","en-US"),this.currDateBS=this.masterService.toBSDate(this.currDate),this.subscription=this.productHelper.deliveryChalanToTrnMainSubject$.subscribe(t=>{this._trnMainService.TrnMainObj.BILLTO=t.ACNAME,this._trnMainService.TrnMainObj.BILLTOADD=t.ADDRESS,this._trnMainService.TrnMainObj.RECEIVEBY=t.ACID,this._trnMainService.TrnMainObj.PARAC=t.ACID,this._trnMainService.TrnMainObj.BILLTOTEL=t.VATNO}),this._trnMainService.TrnMainObj.VoucherType===l.Km.Sales&&(this._trnMainService.TrnMainObj.TRNMODE="cash",this._trnMainService.disableNepaliDate=0==this._trnMainService.userProfile.CompanyInfo.AllowBackDateSalesEntry),this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice&&("add-sales-invoice"==this.activeurlpath||"self-billing"==this.activeurlpath)&&("add-sales-invoice"==this.activeurlpath?("cash"==this._trnMainService.TrnMainObj.TRNMODE&&this._trnMainService.setCashProperty(),this._trnMainService.disableNepaliDate=0==this._trnMainService.userProfile.CompanyInfo.AllowBackDateSalesEntry):"self-billing"==this.activeurlpath&&(this._trnMainService.disableNepaliDate=!0)),this._trnMainService.TrnMainObj.VoucherType===l.Km.Quotation&&(this.billLabel="Quotation No"),"add-membership-sales-invoice"===this.activeurlpath&&(this.customerLabel="Member"),this._trnMainService.TrnMainObj.VoucherType===l.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType===l.Km.SalesReturn?(this.userSetting.EnableUserWiseCreditSalesRights&&!this._trnMainService.checkUserRightsForCreditSales()?this._trnMainService.TrnMainObj.TRNMODE="cash":(this._trnMainService.TrnMainObj.TRNMODE="credit",console.log("disableMastermode bhaw"),this._trnMainService.DisableMasterMode(!0)),console.log("get1")):(console.log("get2"),this._trnMainService.DisableMasterMode(!1)),this.getChalanSeries(),this.getDateMiti(),1==this.doubleClick&&this.getSalesManListCustomerWise(this.customerId),this.setDefaultValues(),(this._trnMainService.TrnMainObj.VoucherType===l.Km.SalesReturn||this._trnMainService.TrnMainObj.VoucherType===l.Km.CreditNote)&&(this.paymentModeLabel="Return Mode",this._trnMainService.DOFULLRETURN=this._trnMainService.TrnMainObj.DOFULLRETURN=1),0!==this.userSetting.ENABLE_SOINTI&&(this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice||0!==this.userSetting.ENABLE_SOINABB&&this._trnMainService.TrnMainObj.VoucherType===l.Km.Sales||0!==this.userSetting.ENABLE_SOINDCHALAN&&this._trnMainService.TrnMainObj.VoucherType===l.Km.DeliveryChalan||0!==this.userSetting.PERFOMASOBILLMODE&&this._trnMainService.TrnMainObj.VoucherType===l.Km.PerformaSalesInvoice)&&null==this._trnMainService.TrnMainObj.LOADFULLFROMQT&&(this._trnMainService.TrnMainObj.LOADFULLFROMQT=1),this.paymentTermForm=this.fb.group({paymentName:["",[p.kI.required]],GUID:[""],ID:[""]}),this.declineTermForm=this.fb.group({remarkName:["",[p.kI.required]],GUID:[""]}),this._trnMainService.TrnMainObj.VoucherType===l.Km.Quotation&&this.getQuotationStatus()}getQuotationStatus(){this._paymentTermsService.getQuotationStatus().subscribe(i=>{this.quotationStatusList=i})}onPaymentChange(i){const t=i.target.value,n=this.payment.find(r=>r.ID.toString()===t);this._trnMainService.TrnMainObj.AdditionalObj.PAYMENTTERMS=t,this.selectedPaymentTerm=n.PAYMENTTERMS,this.paymentTermForm.patchValue({paymentName:n.PAYMENTTERMS,ID:n.ID})}onExportSalesPaymentChange(i){const t=this.paymentList.find(n=>n.PAYMENTMODENAME.trim().toLowerCase()===i.target.value.toLowerCase());this._trnMainService.TrnMainObj.TRNMODE=t?t.MODEVALUE:null,this._trnMainService.TrnMainObj.TRNAC=null,this._trnMainService.TrnMainObj.TRNACName=null}getDateMiti(){this.masterService.getDateMiti(this.userProfile.PhiscalYearInfo.PhiscalID).subscribe(i=>{this.dateMiti=i&&"ok"===i.status&&i.result&&i.result?i.result:[]},i=>{this.dateMiti=[]})}getChalanSeries(){this.masterService.getAllChalanSeries(this._trnMainService.TrnMainObj.VoucherPrefix?this._trnMainService.TrnMainObj.VoucherPrefix:"").subscribe(t=>{t&&"ok"===t.status&&t.result?(this.chalanSeries=t.result?t.result:[],this._trnMainService.TrnMainObj.CHALANNOPREFIX=""):this.chalanSeries=[]},t=>{this.chalanSeries=[]})}getNepaliDate(){if(""!==this._trnMainService.TrnMainObj.TRNDATE&&null!==this._trnMainService.TrnMainObj.TRNDATE){const i=`${this._trnMainService.TrnMainObj.TRNDATE}`,t=W().find(this.dateMiti,["AD",i]);this._trnMainService.TrnMainObj.BSDATE=t&&t.MITI}}getEnglishDate(){if(""!==this._trnMainService.TrnMainObj.BSDATE&&null!==this._trnMainService.TrnMainObj.BSDATE){const i=`${this._trnMainService.TrnMainObj.BSDATE}`,t=W().find(this.dateMiti,["MITI",i]);this._trnMainService.TrnMainObj.TRNDATE=t&&t.AD}}getNepali_Date(){if(""!==this._trnMainService.TrnMainObj.TRN_DATE&&null!==this._trnMainService.TrnMainObj.TRN_DATE){const i=`${this._trnMainService.TrnMainObj.TRN_DATE}`,t=W().find(this.dateMiti,["AD",i]);this._trnMainService.TrnMainObj.BS_DATE=t&&t.MITI}}getEnglish_Date(i){if(console.log("rrr",i),""!==this._trnMainService.TrnMainObj.BS_DATE&&null!==this._trnMainService.TrnMainObj.BS_DATE){const t=`${this._trnMainService.TrnMainObj.BS_DATE}`,n=W().find(this.dateMiti,["MITI",t]);this._trnMainService.TrnMainObj.TRN_DATE=n&&n.AD}}disableAccountSelection(){return!!("VIEW"==this._trnMainService.TrnMainObj.Mode||(1==this._trnMainService.disableMaster.Account||14===this._trnMainService.TrnMainObj.VoucherType&&0!==this.userSetting.ENABLE_SOINTI&&this._trnMainService.TrnMainObj.REFORDBILL&&"credit"==this._trnMainService.TrnMainObj.TRNMODE)&&15===this._trnMainService.TrnMainObj.VoucherType&&"lite"!=this.AppMode||14===this._trnMainService.TrnMainObj.VoucherType&&"self-billing"==this.activeurlpath||"add-sales-invoice"==this.activeurlpath&&"credit"==this._trnMainService.TrnMainObj.TRNMODE&&"lite"!=this.AppMode&&0==this.userSetting.GblEnableMixedTenderMode&&"VIEW"==this._trnMainService.TrnMainObj.Mode)||"cash"==this._trnMainService.TrnMainObj.TRNMODE&&(this._trnMainService.TrnMainObj.VoucherType===l.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice)}hideFlatDiscount(){return!(14==this._trnMainService.TrnMainObj.VoucherType&&"self-billing"===this.activeurlpath||"add-membership-sales-invoice"==this.activeurlpath||"lite"==this.AppMode&&"add-creditnote-itembase"!=this.activeurlpath||64==this._trnMainService.TrnMainObj.VoucherType||this._trnMainService.TrnMainObj.VoucherType===l.Km.DeliveryChalan||this._trnMainService.TrnMainObj.VoucherType===l.Km.DeliveryReturn)}hideFlatDiscountinLite(){return(14!=this._trnMainService.TrnMainObj.VoucherType||"self-billing"!==this.activeurlpath)&&"add-membership-sales-invoice"!=this.activeurlpath&&64!=this._trnMainService.TrnMainObj.VoucherType}hideSalesman(){return 0!=this.userSetting.enablesalesman&&(this._trnMainService.TrnMainObj.VoucherType==l.Km.Quotation&&0!=this.userSetting.enablesalesman||"add-membership-sales-invoice"!=this.activeurlpath&&(14==this._trnMainService.TrnMainObj.VoucherType&&"export-sales-invoice"!=this.activeurlpath||43==this._trnMainService.TrnMainObj.VoucherType||1==this._trnMainService.TrnMainObj.VoucherType||this._trnMainService.TrnMainObj.VoucherType==l.Km.PerformaSalesInvoice||void 0))}hideAccount(){if(14==this._trnMainService.TrnMainObj.VoucherType&&"export-sales-invoice"!=this.activeurlpath&&0==this.userSetting.GblEnableMixedTenderMode&&"self-billing"!==this.activeurlpath||15==this._trnMainService.TrnMainObj.VoucherType||43==this._trnMainService.TrnMainObj.VoucherType||41==this._trnMainService.TrnMainObj.VoucherType||1==this._trnMainService.TrnMainObj.VoucherType&&0==this.userSetting.GblEnableMixedTenderMode||"add-sales-invoice"==this.activeurlpath&&"B2B"==this.userSetting.CompanyType&&1==this.userSetting.GblEnableMixedTenderMode||"self-billing"==this.activeurlpath)return!0}hideCostCentre(){return"add-membership-sales-invoice"!=this.activeurlpath&&this._trnMainService.TrnMainObj.VoucherType!==l.Km.ReverseDeliveryChalan&&(0!=this.userSetting.enableCostCenter||void 0)}changeInvDate(i,t){"AD"==t?(i>this.currDate&&(i=this.currDate,this._trnMainService.TrnMainObj.TRN_DATE=this.currDate),this._trnMainService.TrnMainObj.BS_DATE=this.masterService.toBSDate(i)):"BS"==t&&(this.formatDate(i)>this.formatDate(this.currDateBS)&&(this._trnMainService.TrnMainObj.BS_DATE=this.currDateBS,i=this.currDateBS),this._trnMainService.TrnMainObj.TRN_DATE=this.masterService.toADDate(i))}changeEntryDate(i,t){"AD"==t?(i>this.currDate&&(i=this.currDate,this._trnMainService.TrnMainObj.TRNDATE=this.currDate),this._trnMainService.TrnMainObj.BSDATE=this.masterService.toBSDate(i)):"BS"==t&&(this.formatDate(i)>this.formatDate(this.currDateBS)&&(this._trnMainService.TrnMainObj.BSDATE=this.currDateBS,i=this.currDateBS),this._trnMainService.TrnMainObj.TRNDATE=this.masterService.toADDate(i))}formatDate(i){return i.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$2-$1")}customerEnterCommand(i){i.preventDefault(),document.getElementById("customerselectid").blur(),this._trnMainService.customerEvent=!0,this.showPartyMasterPopup=!1,this.showCustomerProfilePopup=!0,"add-sales-invoice"===this.activeurlpath||"add-sales-invoice-wholesale"===this.activeurlpath||"self-billing"===this.activeurlpath||"export-sales-invoice"===this.activeurlpath||"abbreviated-sales-invoice"===this.activeurlpath?(this.getCustomerLists(),this.genericGridCustomer.show()):"add-membership-sales-invoice"===this.activeurlpath?(this.getMembershipList(),this.genericGridCustomer.show()):"quotation"===this.activeurlpath?(this.getCustomerLists("2"),this.genericGridCustomer.show()):(this.getCustomerLists(),this.genericGridCustomer.show()),this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice&&1!=this._trnMainService.saveButton&&this.focusInputFormat.nativeElement.focus(),(this._trnMainService.TrnMainObj.VoucherType==l.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.Quotation)&&this.masterService.focusAnyControl("unit")}onVehicleNoEnter(i){document.getElementById("vehiclenoid").blur(),this.getVehicleNoList(),this.genericGridVehicleNo.show()}getVehicleNoList(){let i=this._trnMainService.TrnMainObj.PARAC;i||(i=this._trnMainService.TrnMainObj.MEMBERNO),i||(i="tag"),this.gridPopupSettingsForVehicleNo={title:"Vehicle No List",apiEndpoints:`/getAllCustomerVehiclesList/${i}`,defaultFilterIndex:0,useDefinefilterValue:this._trnMainService.TrnMainObj.BILLTO,columns:[{key:"VEHICLENO",title:"VEHICLE NO",hidden:!1,noSearch:!1},{key:"ACNAME",title:"CUSTOMER",hidden:!1,noSearch:!1}]}}onVehicleNoSelected(i){("add-sales-invoice"==this.activeurlpath||"abbreviated-sales-invoice"==this.activeurlpath)&&1==this.userSetting.EnableVehicleMappingForCustomer&&(this._trnMainService.TrnMainObj.AdditionalObj.VEHICLENO=i.VEHICLENO,this._trnMainService.TrnMainObj.BILLTO=i.ACNAME,this._trnMainService.TrnMainObj.BILLTOADD=i.ADDRESS,this._trnMainService.TrnMainObj.BILLTOTEL=i.VATNO,this._trnMainService.TrnMainObj.BILLTOMOB=i.MOBILENO,this._trnMainService.TrnMainObj.CREDITLIMIT=i.CRLIMIT,null==i.ACID?this._trnMainService.TrnMainObj.MEMBERNO=i.CUSTID:this._trnMainService.TrnMainObj.PARAC=i.ACID,document.getElementById("remarksid").focus())}setDefaultValues(){"retailer"==this._trnMainService.userProfile.CompanyInfo.ORG_TYPE&&(this._trnMainService.TrnMainObj.INVOICETYPE="retailinvoice")}ngAfterViewInit(){this._trnMainService.TrnMainObj.VoucherType==l.Km.CreditNote||this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoiceCancel?document.getElementById("refbill").focus():this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice?1==this.userSetting.PrefixForRefNoInVEntry?document.getElementById("refno").focus():document.getElementById("refnoInput").focus():this._trnMainService.TrnMainObj.VoucherType==l.Km.Quotation?document.getElementById("refnoInput").focus():this._trnMainService.TrnMainObj.VoucherType==l.Km.DeliveryReturn||(this._trnMainService.TrnMainObj.VoucherType==l.Km.Sales?setTimeout(()=>{1==this.userSetting.GblEnableMixedTenderMode?document.getElementById("itemDesc0").focus():document.getElementById("paymentTerms").focus()},200):document.getElementById("customerselectid").focus())}customerFieldChange(){this._trnMainService.TrnMainObj.PARAC=null,this._trnMainService.TrnMainObj.TRNAC=null,this._trnMainService.TrnMainObj.BILLTOADD=null,this._trnMainService.TrnMainObj.AdditionalObj.TRNTYPE=null,this._trnMainService.TrnMainObj.TRNMODE="credit",this._trnMainService.TrnMainObj.PARTY_ORG_TYPE=null,this._trnMainService.TrnMainObj.CREDITDAYS=0,this._trnMainService.TrnMainObj.AdditionalObj.VEHICLENO=null}UniEnterCommand(){this.masterService.focusAnyControl("menucode0"),this.masterService.ShowMore=!1}onCustomerSelected(i){if(1==this.userSetting.EnableContractPrice&&(this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.SalesOrder)&&this._trnMainService.TrnMainObj.PARAC&&this._trnMainService.TrnMainObj.ProdList.find(t=>t.MCODE)&&i.ACID!=this._trnMainService.TrnMainObj.PARAC&&i.CUSTID!=this._trnMainService.TrnMainObj.PARAC){if(!confirm("Are you sure you want to change customer? This will empty product selection grid."))return;this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow()}this._trnMainService.TrnMainObj.MEMBERNO=i.CUSTID,this._trnMainService.TrnMainObj.MEMBERNAME=i.CUSTNAME,this._trnMainService.TrnMainObj.SCHEMENAME=i.SCHEMEID,this._trnMainService.TrnMainObj.PARAC=i.ACID,this._trnMainService.TrnMainObj.RECEIVEBY=i.CUSTID,this._trnMainService.TrnMainObj.VoucherType==l.Km.PerformaSalesInvoice&&(this._trnMainService.TrnMainObj.TRNAC=i.ACID),this._trnMainService.TrnMainObj.CREDITLIMIT=i.CRLIMIT,this._trnMainService.TrnMainObj.SCHEMENAME=i.SCHEMENAME,this._trnMainService.TrnMainObj.SALESMAN=i.SALESMAN,this._trnMainService.TrnMainObj.SALESMANID=i.SALESMANID,this._trnMainService.CUSEMAIL=i.ACID?i.ACID:i.CUSTID,this._trnMainService.TrnMainObj.AdditionalObj.MOBILE=i.MOBILENO,(14==this._trnMainService.TrnMainObj.VoucherType||this._trnMainService.TrnMainObj.VoucherType==l.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.SalesOrder)&&(this._trnMainService.TrnMainObj.PRICEMODE=i.PRICEMODE?i.PRICEMODE:1),(this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.Sales)&&this._trnMainService.getCustomerwiseCreditLimit(this._trnMainService.TrnMainObj.PARAC,this._trnMainService.TrnMainObj.TRN_DATE),"B2C"==this.userSetting.CompanyType&&(14==this._trnMainService.TrnMainObj.VoucherType||1==this._trnMainService.TrnMainObj.VoucherType)&&"cash"==this._trnMainService.TrnMainObj.TRNMODE&&(this._trnMainService.TrnMainObj.BILLTOMOB=i.MOBILE,this._trnMainService.TrnMainObj.SCHEMENAME=i.SCHEMENAME,this._trnMainService.vatFreeBill(),null!=this._trnMainService.TrnMainObj.ProdList[0].MENUCODE&&this._trnMainService.ReCalculateBillWithNormal(),this.focusAfterCustomerSelect()),this._trnMainService.TrnMainObj.BILLTOMOB="add-membership-sales-invoice"===this.activeurlpath?i.MOBILENO:this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.Sales||this._trnMainService.TrnMainObj.VoucherType==l.Km.CreditNote?i.MOBILE:i.PHONE,"creditcard"==this._trnMainService.TrnMainObj.TRNMODE&&(this._trnMainService.TrnMainObj.BILLTOMOB=i.MOBILE),this._trnMainService.TrnMainObj.BILLTO=i.ACNAME,this._trnMainService.TrnMainObj.BILLTOTEL=i.VATNO,this._trnMainService.TrnMainObj.BILLTOADD=i.ADDRESS,this._trnMainService.TrnMainObj.AdditionalObj.TRNTYPE=null==i.PSTYPE?null:i.PSTYPE.toLowerCase(),this._trnMainService.TrnMainObj.PARTY_ORG_TYPE=i.ORG_TYPE,this._trnMainService.TrnMainObj.CREDITDAYS=i.CRPERIOD,this._trnMainService.TrnMainObj.CUS_FIX_DISCOUNT_PER=i.CUS_FIX_DISCOUNT_PER,this._trnMainService.TrnMainObj.CUS_Remote_Discount=i.CUS_Remote_Discount,this._trnMainService.TrnMainObj.CUS_Remote_Discount=i.CUS_Remote_Discount,(this._trnMainService.TrnMainObj.VoucherType==l.Km.Quotation||this._trnMainService.TrnMainObj.VoucherType===l.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===l.Km.DeliveryChalan||this._trnMainService.TrnMainObj.VoucherType===l.Km.DeliveryReturn)&&(this._trnMainService.TrnMainObj.TRNAC=i.ACID),this._trnMainService.vatFreeBill(),null!=this._trnMainService.TrnMainObj.ProdList[0].MENUCODE&&this._trnMainService.ReCalculateBillWithNormal(),this.focusAfterCustomerSelect()}focusAfterCustomerSelect(){"add-sales-invoice"!=this.activeurlpath&&"abbreviated-sales-invoice"!=this.activeurlpath||1!=this.userSetting.EnableVehicleMappingForCustomer?document.getElementById("remarksid").focus():document.getElementById("vehiclenoid").focus()}getSalesManListCustomerWise(i){this.masterService.getSalesmanBasedUponCustomer(i).subscribe(t=>{this.salesManList=t})}salesManChange(){}RefBillEnterCommand(i){if(document.getElementById("refbill").blur(),this._trnMainService.customerEvent=!0,61===this._trnMainService.TrnMainObj.VoucherType)document.getElementById("refbill").blur(),this.newRefBill(),this.newgenericGridForTaxCancel.show();else if(15===this._trnMainService.TrnMainObj.VoucherType){if(1==this.userSetting.ENABLEMANUALSALESRETURN)return;"add-creditnote-itembase-approval"===this.activeurlpath?(this.genericGridSettingForSalesReturn("/getTrnMainPagedListForSalesReturnApproval"),this.newgenericGridForSalesReturn.show()):(this.genericGridSettingForSalesReturn("/getSalesListForSalesReturn"),this.newgenericGridForSalesReturn.show())}else 21===this._trnMainService.TrnMainObj.VoucherType?(this.genericGridSettingForDeliveryChalanReturn("/getDeliveryVoucherPagedList"),this.newgenericGridForDeliveryChalanReturn.show()):this.genericGridRefBill.show()}onRefBillSelected(i){let t;console.log("reachhere"),"delivery-chalan-return"==this.activeurlpath&&1==this._trnMainService.TrnMainObj.DOFULLRETURN&&(t="FullReturn"),this.masterService.checkDuplicateReverseEntry(i.VCHRNO,t).subscribe(n=>{"ok"==n.status?(this.ReffBillObj=i,this._trnMainService.TrnMainObj.REFBILL=1==this.userSetting.EnableCentralizeOrderDeliveryMode&&this._trnMainService.TrnMainObj.VoucherType==l.Km.DeliveryReturn?i.REFBILL:i.VCHRNO,1==this.userSetting.EnableCentralizeOrderDeliveryMode&&this._trnMainService.TrnMainObj.VoucherType==l.Km.DeliveryReturn&&(this._trnMainService.TrnMainObj.REFORDBILL=i.VCHRNO),this._trnMainService.TrnMainObj.PARAC=i.PARAC,this._trnMainService.TrnMainObj.BILLTO=i.BILLTO,this._trnMainService.TrnMainObj.TRNAC=i.TRNAC,this._trnMainService.TrnMainObj.BILLTOADD=i.BILLTOADD,this._trnMainService.TrnMainObj.TRNMODE=i.TRNMODE,this._trnMainService.TrnMainObj.DCRATE=i.DCRATE,this._trnMainService.TrnMainObj.FLATDCAMNT=i.FLATDCAMNT,this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT=i.TOTALFLATDISCOUNT,this._trnMainService.TrnMainObj.TRNACName=i.TRNACNAME?i.TRNACNAME:i.BILLTO,this._trnMainService.TrnMainObj.BILLTOTEL=i.BILLTOTEL,this._trnMainService.TrnMainObj.MEMBERNO=i.MEMBERNO,this._trnMainService.TrnMainObj.MEMBERNAME=i.MEMBERNAME,this._trnMainService.TrnMainObj.COSTCENTER=i.COSTCENTER,this._trnMainService.TrnMainObj.RECEIVEBY=i.RECEIVEBY,15===this._trnMainService.TrnMainObj.VoucherType&&0===this._trnMainService.TrnMainObj.DOFULLRETURN&&(this._trnMainService.TrnMainObj.DIVISION=i.DIVISION,this._trnMainService.TrnMainObj.MWAREHOUSE=i.MWAREHOUSE,1==i.isDeliveryOrder&&(this._trnMainService.TrnMainObj.MWAREHOUSE=this.userProfile.userWarehouse)),this._trnMainService.TrnMainObj.AdditionalObj.AFTERFLATDISCRATE=i.AFTERFLATDISCRATE,this._trnMainService.TrnMainObj.AdditionalObj.BEFOREFLATDISCRATE=i.BEFOREFLATDISCRATE,this._trnMainService.isRatePartial=i.DCRATE>0,(i.AFTERFLATDISCRATE>0||i.BEFOREFLATDISCRATE>0)&&(this._trnMainService.TrnMainObj.DCRATE=i.AFTERFLATDISCRATE>0?i.AFTERFLATDISCRATE:i.BEFOREFLATDISCRATE),this._trnMainService.TrnMainObj.VoucherType!=l.Km.DeliveryReturn&&("credit"==this._trnMainService.TrnMainObj.TRNMODE?.toLowerCase()?this._trnMainService.DisableMasterMode(!0):(this._trnMainService.setSalesReturnVoucherAccount(),this._trnMainService.DisableMasterMode(!1),this._trnMainService.disableMaster.Account=!0)),"creditcard"==i.TRNMODE&&(this._trnMainService.showModesForCC=!1),this._trnMainService.callPipe=!this._trnMainService.callPipe,15===this._trnMainService.TrnMainObj.VoucherType&&"add-creditnote-itembase"===this.activeurlpath&&1==this._trnMainService.TrnMainObj.DOFULLRETURN?this._trnMainService.loadDataForSalesReturn(i.VCHRNO,i.DIVISION,i.PhiscalID,"","","creditnote"):15===this._trnMainService.TrnMainObj.VoucherType&&0==this._trnMainService.TrnMainObj.DOFULLRETURN?(this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow()):15===this._trnMainService.TrnMainObj.VoucherType&&"add-creditnote-itembase-approval"===this.activeurlpath?this._trnMainService.loadDataForSalesReturnArrpoval(i.VCHRNO,i.DIVISION,i.PhiscalID):21===this._trnMainService.TrnMainObj.VoucherType&&1==this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.loadDataForDeliveryChalanReturn(i.VCHRNO,i.DIVISION,i.PhiscalID,"","",1==this.userSetting.EnableCentralizeOrderDeliveryMode?"FORDLRETURNCentralized":"FORDLRETURN"),15===this._trnMainService.TrnMainObj.VoucherType&&"add-creditnote-itembase"===this.activeurlpath&&0==this._trnMainService.TrnMainObj.DOFULLRETURN&&this.getRecurringLogDetails(i)):this._alertService.info(n.result.error)},n=>{console.log("err",n),this._alertService.info(n)})}getRecurringLogDetails(i){this._trnMainService.GetRecurringLogDetails(i.VCHRNO,i.DIVISION,i.PhiscalID).subscribe(t=>{console.log("recurring log get",t),"ok"==t.status?(this._trnMainService.TrnMainObj.RecurringItemList=t.result?t.result:[],this._trnMainService.TrnMainObj.CommissionItemList=t.result2?t.result2:[],console.log("recurring items",this._trnMainService.TrnMainObj.RecurringItemList),console.log("commsiion items",this._trnMainService.TrnMainObj.CommissionItemList),this._trnMainService.TrnMainObj.RecurringItemList.forEach(n=>{n.LAST_RECUR_DATE=n.LAST_RECUR_DATE.toString().substring(0,10),n.RECURRING_DATE=n.RECURRING_DATE.toString().substring(0,10),n.STATUS=10==n.STATUS?1:0}),this._trnMainService.TrnMainObj.CommissionItemList.forEach(n=>{n.STATUS=10==n.STATUS?1:0})):(this._trnMainService.TrnMainObj.RecurringItemList=[],this._trnMainService.TrnMainObj.CommissionItemList=[])})}RefBillFieldDisabled(){return!1}UnitandFormatDisabled(){return null!=this._trnMainService.TrnMainObj.ProdList&&this._trnMainService.TrnMainObj.ProdList.filter(i=>null!=i.MCODE).length>0}salesManEnterCommand(){this.getSalesManList(),this.genericGridSalesMan.show()}onSalesManSelect(i){console.log("sales man select",i),this._trnMainService.TrnMainObj.SALESMANID=i.SALESMANID,this._trnMainService.TrnMainObj.SALESMAN=i.NAME,console.log("trnmain on sales man slect",this._trnMainService.TrnMainObj.SALESMANID,this._trnMainService.TrnMainObj.SALESMAN),this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.CreditNote?this.masterService.focusAnyControl("costCenter"):this._trnMainService.TrnMainObj.VoucherType==l.Km.Quotation&&document.getElementById("itemDesc0").focus()}deleteSalesman(){null!=this._trnMainService.TrnMainObj.SALESMAN&&(this._trnMainService.TrnMainObj.SALESMAN=null,this._trnMainService.TrnMainObj.SALESMANID=null)}getSalesManList(){this.gridPopupSettingsForSalesMan=this.masterService.getGenericGridPopUpSettings("SalesManList")}loadCompanyInfo(){1!=this._trnMainService.inputCode&&this.masterService.loadCompany().subscribe(i=>{this._trnMainService.TrnMainObj.AdditionalObj.BILLFORMATS=i.BILLFORMATS,this._trnMainService.TrnMainObj.AdditionalObj.BILLUNITS=i.BILLUNITS})}WarehouseEnterCommand(i){this.gridPopupSettingsForWarehouse={title:2==this.appType?"Godown":"Warehouse",apiEndpoints:"/getDivisionWiseWarehousePagedList",defaultFilterIndex:0,columns:[{key:"NAME",title:"NAME",hidden:!1,noSearch:!1}]},this.genericGridWarehouse.show()}WarehouseEnterForUnsalableCommand(i){this.gridPopupSettingsForWarehouse={title:2==this.appType?"Godown":"Warehouse",apiEndpoints:"/getUnsalableWarehousePagedList",defaultFilterIndex:0,columns:[{key:"NAME",title:"NAME",hidden:!1,noSearch:!1}]},this.genericGridWarehouse.show()}onWarehouseSelected(i){this._trnMainService.TrnMainObj.MWAREHOUSE=i.NAME,document.getElementById("costCenter").focus()}setFocusSalesman(){this.focusSalesman.nativeElement.focus()}onItemDoubleClick(i){this._trnMainService.TrnMainObj.REFBILL=i.VCHRNO,this._trnMainService.loadDataForTaxCancel(i.VCHRNO,i.DIVISION,i.PhiscalID),this._trnMainService.showPerformaApproveReject=!1}newRefBill(){this.newgridPopupSettingsForTaxCancel={title:"Vouchers",apiEndpoints:"/getTrnMainPagedListForTaxCancel/TI",defaultFilterIndex:1,useDefinefilterValue:this._trnMainService.TrnMainObj.REFBILL,columns:[{key:"TRNDATE",title:"DATE",hidden:!1,noSearch:!1},{key:"CHALANNO",title:"VOUCHER NO.",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"AMOUNT",hidden:!1,noSearch:!1},{key:"REMARKS",title:"REMARKS",hidden:!1,noSearch:!1}]}}SalesmanFieldDisabled(){return null!=this._trnMainService.TrnMainObj.ProdList&&this._trnMainService.TrnMainObj.ProdList.filter(i=>null!=i.MCODE).length>0}getCustomersList(){this.gridPopupSettingsForCustomer={title:"Customers",apiEndpoints:"cash"==this._trnMainService.TrnMainObj.TRNMODE||"salesreturn"==this._trnMainService.TrnMainObj.TRNMODE&&1==this.userSetting.ENABLEMANUALSALESRETURN?"/getCustomerFromCustomerProfile":"/getAccountPagedListByPType/PA/C/0",defaultFilterIndex:this.userSetting.FilterIndexForCustomer,useDefinefilterValue:this._trnMainService.TrnMainObj.BILLTO,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"VATNO",title:"VAT No.",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"MOBILENO",title:"Mobile No.",hidden:!1,noSearch:!1}]}}getCustomerLists(i="0"){this.getNormalCustomerForSalesInvoice(i)}getNormalCustomerForSalesInvoice(i="0"){this.gridPopupSettingsForCustomer={title:"Customers",apiEndpoints:`/getAccountPagedListByPType/PA/C/${i}`,defaultFilterIndex:this.userSetting.FilterIndexForCustomer,useDefinefilterValue:this._trnMainService.TrnMainObj.BILLTO,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"VATNO",title:"VAT No.",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"MOBILE",title:"MOBILE No.",hidden:!1,noSearch:!1}]}}getCashcustomerList(){let i="Customers";"add-membership-sales-invoice"===this.activeurlpath&&(i="Members"),this.gridPopupSettingsForCustomer={title:i,apiEndpoints:"/getCustomerFromCustomerProfile",defaultFilterIndex:0,useDefinefilterValue:this._trnMainService.TrnMainObj.BILLTO,columns:[{key:"CUSTNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"MOBILENO",title:"MOBILE",hidden:!1,noSearch:!1}]}}getMembershipList(){this.gridPopupSettingsForCustomer={title:"Members",apiEndpoints:"/getMembersFromMembership",defaultFilterIndex:0,useDefinefilterValue:this._trnMainService.TrnMainObj.BILLTO,columns:[{key:"CUSTNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"MOBILENO",title:"MOBILE",hidden:!1,noSearch:!1}]}}getB2CWiseCustomer(){"credit"==this._trnMainService.TrnMainObj.TRNMODE&&null!=this._trnMainService.TrnMainObj.TRNAC?this.gridPopupSettingsForCustomer={title:"Customers",apiEndpoints:`/getCustomerProfilebyACID/${this._trnMainService.TrnMainObj.TRNAC}`,defaultFilterIndex:2,useDefinefilterValue:this._trnMainService.TrnMainObj.BILLTO,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"MOBILENO",title:"MOBILE",hidden:!1,noSearch:!1}]}:"cash"==this._trnMainService.TrnMainObj.TRNMODE||"cashondelivery"==this._trnMainService.TrnMainObj.TRNMODE?this.gridPopupSettingsForCustomer={title:"Customers",apiEndpoints:"/getCustomerFromCustomerProfile",defaultFilterIndex:this.userSetting.FilterIndexForCustomer,useDefinefilterValue:this._trnMainService.TrnMainObj.BILLTO,columns:[{key:"CUSTNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"MOBILENO",title:"MOBILE",hidden:!1,noSearch:!1}]}:this.getNormalCustomerForSalesInvoice()}getCustomerList(){this._trnMainService.TrnMainObj.SALESMANID=this._trnMainService.salesmanID,this._trnMainService.TrnMainObj.ROUTE=this._trnMainService.routeCode,this.gridPopupSettingsForCustomerListBySalesmanAndRoute={title:"Customers",apiEndpoints:`/getPagedCustomerListBySalesmanAndRoute/${this._trnMainService.TrnMainObj.SALESMANID}/${this._trnMainService.TrnMainObj.ROUTE}`,defaultFilterIndex:this.userSetting.FilterIndexForCustomer,useDefinefilterValue:this._trnMainService.TrnMainObj.BILLTO,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ACCODE",title:"CODE",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"EMAIL",title:"EMAIL",hidden:!1,noSearch:!1}]}}genericGridSettingForSalesReturn(i){this.newgridPopupSettingsForSalesReturn={title:"Vouchers",apiEndpoints:`${i}`,defaultFilterIndex:1,columns:[{key:"TRNDATE",title:"DATE",hidden:!1,noSearch:!1},{key:"VCHRNO",title:"VOUCHER NO.",hidden:!1,noSearch:!1},{key:"REFBILL",title:"REF NO.",hidden:!1,noSearch:!1},{key:"BILLTO",title:"CUSTOMER",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"AMOUNT",hidden:!1,noSearch:!1},{key:"REMARKS",title:"REMARKS",hidden:!1,noSearch:!1}]}}genericGridSettingForDeliveryChalanReturn(i){this.newgridPopupSettingsForDeliveryChalanReturn=1==this.userSetting.EnableCentralizeOrderDeliveryMode?{title:"Vouchers",apiEndpoints:`${i}`,defaultFilterIndex:1,columns:[{key:"TRNDATE",title:"DATE",hidden:!1,noSearch:!1},{key:"REFBILL",title:"Delivery Chalan No",hidden:!1,noSearch:!1},{key:"REFORDBILL",title:"SO No",hidden:!1,noSearch:!1},{key:"BILLTO",title:"Customer ",hidden:!1,noSearch:!1},{key:"BILLTOADD",title:"Address",hidden:!1,noSearch:!1},{key:"MOBILE",title:"Mobile No",hidden:!1,noSearch:!1}]}:{title:"Vouchers",apiEndpoints:`${i}`,defaultFilterIndex:1,columns:[{key:"TRNDATE",title:"DATE",hidden:!1,noSearch:!1},{key:"VCHRNO",title:"VOUCHER NO.",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"AMOUNT",hidden:!1,noSearch:!1},{key:"REMARKS",title:"REMARKS",hidden:!1,noSearch:!1}]}}triggerRefBillCheck(){if(this._trnMainService.TrnMainObj.VoucherType==l.Km.CreditNote){if(null==this._trnMainService.TrnMainObj.REFBILL||null===this._trnMainService.TrnMainObj.REFBILL||"undefined"===this._trnMainService.TrnMainObj.REFBILL)return;this.masterService.getRefBillCheck(this._trnMainService.TrnMainObj.REFBILL).subscribe(i=>{this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE="ok"==i.status?"NewBill":""})}}paymentTermsChange(i){let t=this.paymentList.filter(n=>n.MODEVALUE==this._trnMainService.TrnMainObj.TRNMODE)[0];this.flushCreditSelectedData(),this.disableOnCreditSelect=!1,this._trnMainService.disableAccountInputField=!1,"self-billing"!=this.activeurlpath&&(this._trnMainService.TrnMainObj.TRNACName=null,this._trnMainService.TrnMainObj.TRNAC=null),t&&(!t.MODE||"FIXED"==t.MODE?.toUpperCase())&&(this._trnMainService.TrnMainObj.TRNAC=t.ACID,this._trnMainService.TrnMainObj.TRNACName=t.ACNAME,this._trnMainService.disableAccountInputField=!0),(null!=this._trnMainService.TrnMainObj.PARAC||"credit"!=this._trnMainService.TrnMainObj.TRNMODE||"PP"!=this._trnMainService.TrnMainObj.VoucherAbbName||confirm("Are you sure you want to override proforma tagged customer?"))&&("cash"==this._trnMainService.TrnMainObj.TRNMODE?this._trnMainService.setCashProperty():this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice&&0!==this.userSetting.ENABLE_SOINTI&&this._trnMainService.TrnMainObj.REFORDBILL&&"credit"==this._trnMainService.TrnMainObj.TRNMODE&&(this._trnMainService.TrnMainObj.TRNACName=this._trnMainService.TrnMainObj.BILLTO,this._trnMainService.TrnMainObj.TRNAC=this._trnMainService.TrnMainObj.PARAC,this._trnMainService.TrnMainObj.REFORDBILL.startsWith("SO")&&!this._trnMainService.TrnMainObj.PARAC&&(this._trnMainService.TrnMainObj.TRNACName=null),this.disableOnCreditSelect=!0),this._trnMainService.TrnMainObj.VoucherType===l.Km.CreditNote&&0==this.userSetting.ENABLEMANUALSALESRETURN&&this._trnMainService.TrnMainObj.REFBILL&&(this._trnMainService.disableMaster.Account=!1,"credit"==this._trnMainService.TrnMainObj.TRNMODE?this._trnMainService.disableMaster.Account=!0:"salesreturn"==this._trnMainService.TrnMainObj.TRNMODE&&this._trnMainService.setSalesReturnVoucherAccount()),this._trnMainService.TrnMainObj.VoucherType===l.Km.CreditNote&&1==this.userSetting.ENABLEMANUALSALESRETURN&&"salesreturn"==this._trnMainService.TrnMainObj.TRNMODE&&this._trnMainService.setSalesReturnVoucherAccount())}AccountEnterCommand(){this.showPartyMasterPopup=!1,this.showCustomerProfilePopup=!1,this.paymentList.find(t=>t.MODEVALUE==this._trnMainService.TrnMainObj.TRNMODE),this.genericGridAccountSetting={title:"Accounts",apiEndpoints:"/getpaymentmodepagedlist",defaultFilterIndex:1,columns:[{key:"ACCODE",title:"AC CODE",hidden:!1,noSearch:!1},{key:"ACNAME",title:"A/C NAME",hidden:!1,noSearch:!1}]},this.genericGridAccount.show()}flushCreditSelectedData(){0!=this.userSetting.ENABLE_SOINTI&&this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("SO")&&this._trnMainService.TrnMainObj.VoucherType!=l.Km.SalesOrder||this._trnMainService.TrnMainObj.VoucherType==l.Km.CreditNote||(this._trnMainService.TrnMainObj.PARAC="",this._trnMainService.TrnMainObj.BILLTO="",this._trnMainService.TrnMainObj.BILLTOADD="",this._trnMainService.TrnMainObj.BILLTOTEL="",this._trnMainService.TrnMainObj.MEMBERNO="",this._trnMainService.TrnMainObj.RECEIVEBY="",this._trnMainService.TrnMainObj.TRNAC="",this._trnMainService.TrnMainObj.TRNACName="",this._trnMainService.TrnMainObj.MEMBERNAME="",this._trnMainService.TrnMainObj.SCHEMENAME="")}onAccountSelect(i){try{if(1==this.userSetting.EnableContractPrice&&(this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.SalesOrder)&&this._trnMainService.TrnMainObj.TRNAC&&this._trnMainService.TrnMainObj.ProdList.find(t=>t.MCODE)&&i.ACID!=this._trnMainService.TrnMainObj.TRNAC&&i.CUSTID!=this._trnMainService.TrnMainObj.TRNAC){if(!confirm("Are you sure you want to change account? This will empty product selection grid."))return;this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow()}this.flushCreditSelectedData(),this._trnMainService.TrnMainObj.TRNAC=i.ACID,"credit"==this._trnMainService.TrnMainObj.TRNMODE?.toLowerCase()&&(this._trnMainService.TrnMainObj.PARAC=i.ACID,this._trnMainService.TrnMainObj.RECEIVEBY=i.CUSTID),this._trnMainService.TrnMainObj.TRNACName=i.ACNAME,this._trnMainService.TrnMainObj.AdditionalObj.MOBILE=i.MOBILE,this._trnMainService.TrnMainObj.PRICEMODE=i?.PRICEMODE,2==this.userSetting.SendInvoiceEmail&&(this._trnMainService.CUSEMAIL=i.ACID?i.ACID:i.CUSTID),"credit"==this._trnMainService.TrnMainObj.TRNMODE&&"add-membership-sales-invoice"!=this.activeurlpath&&(this._trnMainService.TrnMainObj.SALESMAN=i.SALESMAN,this._trnMainService.TrnMainObj.SALESMANID=i.SALESMANID,this._trnMainService.TrnMainObj.BILLTO=i.ACNAME,this._trnMainService.TrnMainObj.BILLTOADD=i.ADDRESS,this._trnMainService.TrnMainObj.BILLTOTEL=i.VATNO,this._trnMainService.TrnMainObj.BILLTOMOB=this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.Sales||this._trnMainService.TrnMainObj.VoucherType==l.Km.CreditNote?i.MOBILE:i.PHONE,this._trnMainService.TrnMainObj.CREDITLIMIT=i.CRLIMIT,"add-sales-invoice"==this.activeurlpath&&0==this.userSetting.GblEnableMixedTenderMode&&this.masterService.getCustomerwiseCreditLimit(this._trnMainService.TrnMainObj.PARAC,this._trnMainService.TrnMainObj.TRN_DATE).subscribe(t=>{this._trnMainService.TrnMainObj.BALANCEAMOUNT=t.BL.toFixed(2),this._trnMainService.TrnMainObj.BALANCEAMOUNT<0?(this._trnMainService.TrnMainObj.BALANCEAMOUNT=Math.abs(this._trnMainService.TrnMainObj.BALANCEAMOUNT),this._trnMainService.TrnMainObj.LIMITINDICATOR="Cr."):this._trnMainService.TrnMainObj.LIMITINDICATOR="Dr."}),(this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.Sales)&&(this._trnMainService.TrnMainObj.DELIVERYREF="",this._trnMainService.TrnMainObj.SalesDeliveryList=[],this._trnMainService.getCustomerwiseCreditLimit(this._trnMainService.TrnMainObj.PARAC,this._trnMainService.TrnMainObj.TRN_DATE)),this.masterService.getCustomerIDFromCProfile(i.ACID).subscribe(t=>{t.length>0&&1==this.masterService.userSetting.EnableMembershipModule&&(this._trnMainService.TrnMainObj.MEMBERNO=t[0].CUSTID,this._trnMainService.TrnMainObj.MEMBERNAME=t[0].CUSTNAME,this._trnMainService.TrnMainObj.SCHEMENAME=t[0].SCHEMEID)}),this._trnMainService.vatFreeBill(),null!=this._trnMainService.TrnMainObj.ProdList[0].MENUCODE&&this._trnMainService.ReCalculateBillWithNormal())}catch(t){alert(t)}1==this.userSetting.enableCostCenter?document.getElementById("costCenter").focus():"add-membership-sales-invoice"==this.activeurlpath?document.getElementById("customerselectid").focus():"export-sales-invoice"==this.activeurlpath?document.getElementById("country").focus():document.getElementById("remarksid").focus()}focusToCustomer(){this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice&&document.getElementById("customerselectid").focus()}focusToCostcenter(){this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice&&document.getElementById("costCenter").focus()}focusToWarehouse(){this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice&&document.getElementById("warehouseId").focus()}focusToRemarks(){if(this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice)"credit"==this._trnMainService.TrnMainObj.TRNMODE?this.masterService.focusAnyControl("remarksid"):"credit"!=this._trnMainService.TrnMainObj.TRNMODE&&this.masterService.focusAnyControl("customerselectid");else{if(this._trnMainService.TrnMainObj.VoucherType!=l.Km.PerformaSalesInvoice||null==this._trnMainService.TrnMainObj.REFORDBILL)return;this.masterService.focusAnyControl("remarksid")}}onpaymentmodechange(){"B2C"==this.userSetting.CompanyType&&(this._trnMainService.TrnMainObj.BILLTO="",this._trnMainService.TrnMainObj.BILLTOMOB="",this._trnMainService.TrnMainObj.BILLTOADD="",this._trnMainService.TrnMainObj.BILLTOTEL="")}CustomerProfileDate(i){"B2C"==this.userSetting.CompanyType&&14==this._trnMainService.TrnMainObj.VoucherType&&"cash"==this._trnMainService.TrnMainObj.TRNMODE&&0==i&&confirm("Cannot find Customer. Do you want to create new?")&&(this.genericGridCustomer.hide(),this.showCustomerProfile.emit(i))}openQuickCusProfilePopup(){("TI"==this._trnMainService.TrnMainObj.VoucherPrefix||this._trnMainService.TrnMainObj.VoucherType==l.Km.Sales||this._trnMainService.TrnMainObj.VoucherType==l.Km.Quotation&&1==this.userSetting.EnableCusProfileInSOrder)&&(this.CreateCustomerProfile.show(),this.genericGridCustomer.hide(),this.showCustomerProfilePopup=!1)}openQuickPartyMasterPopup(){"TI"==this._trnMainService.TrnMainObj.VoucherPrefix&&1==this.showPartyMasterPopup&&(this.masterService.isSalesPage=!0,this.CreateQuickParty.show(),this.genericGridAccount.hide(),this.showPartyMasterPopup=!1)}onSaveCustomerProfile(i){1==this.userSetting.ShowCashAccountingInLedgerReport&&(this._trnMainService.TrnMainObj.PARAC=i.account,this._trnMainService.TrnMainObj.RECEIVEBY=i.memID,"B2C"==this.userSetting.CompanyType&&(this._trnMainService.TrnMainObj.TRNACName=i.name,this._trnMainService.TrnMainObj.TRNAC=i.account)),this._trnMainService.TrnMainObj.BILLTO=i.name,this._trnMainService.TrnMainObj.BILLTOADD=i.address,this._trnMainService.TrnMainObj.BILLTOTEL=i.pan,this._trnMainService.TrnMainObj.BILLTOMOB=i.mobNo,2===this.userSetting.SendInvoiceEmail&&(this._trnMainService.CUSEMAIL=i.memID?i.memID:""),document.getElementById("remarksid").focus(),this.masterService.getMemershipFromMemberNo(i.memID).subscribe(t=>{this._trnMainService.TrnMainObj.MEMBERNO=t[0].MEMID,this._trnMainService.TrnMainObj.MEMBERNAME=t[0].FNAME,this._trnMainService.TrnMainObj.SCHEMENAME=t[0].SCHEMEID,this._trnMainService.TrnMainObj.RECEIVEBY=t[0].MEMID,t[0].ACCOUNT&&(this._trnMainService.TrnMainObj.PARAC=t[0].ACCOUNT)})}onSavePartyMaster(i){this._trnMainService.TrnMainObj.TRNACName=i.ACNAME,this._trnMainService.TrnMainObj.TRNAC=i.ACID,this._trnMainService.TrnMainObj.BILLTO=i.ACNAME,this._trnMainService.TrnMainObj.BILLTOADD=i.ADDRESS,this._trnMainService.TrnMainObj.BILLTOTEL=i.VATNO,this._trnMainService.TrnMainObj.PARAC=i.ACID,this.masterService.getMemershipFromCustID(i.ACID).subscribe(t=>{t.length>0&&(this._trnMainService.TrnMainObj.MEMBERNO=t[0].MEMID,this._trnMainService.TrnMainObj.MEMBERNAME=t[0].FNAME,this._trnMainService.TrnMainObj.SCHEMENAME=t[0].SCHEMEID)})}getMembershipInfoFromCustId(i){this.masterService.getMemershipFromMemberNo(i).subscribe(t=>{t.length>0&&(this._trnMainService.TrnMainObj.MEMBERNO=t[0].MEMID,this._trnMainService.TrnMainObj.MEMBERNAME=t[0].FNAME,this._trnMainService.TrnMainObj.SCHEMENAME=t[0].SCHEMEID)})}ConfirmChangeReturnMode(i){0==i?(this._trnMainService.DOFULLRETURN=0,1==this._trnMainService.TrnMainObj.isDeliveryOrder&&(this._trnMainService.TrnMainObj.MWAREHOUSE=null),this._trnMainService.isRatePartial=this._trnMainService.TrnMainObj.DCRATE>0,this._trnMainService.TrnMainObj.DCRATE=0!=this._trnMainService.nullToZeroConverter(this.ReffBillObj.AFTERFLATDISCRATE)?this.ReffBillObj.AFTERFLATDISCRATE:this.ReffBillObj.BEFOREFLATDISCRATE,this._trnMainService.TrnMainObj.FLATDCAMNT=0):(this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow(),this._trnMainService.onFlatDiscountClear())}disableRefBill(){return 1!=this.userSetting.ENABLEMANUALSALESRETURN&&(!this._trnMainService.disableAllFieldinPurchase||void 0)}DoManualSalesReturn(i){1==i?(this._trnMainService.DisableMasterMode(!1),this._trnMainService.TrnMainObj.DOFULLRETURN=0):(this._trnMainService.DisableMasterMode(!0),this._trnMainService.TrnMainObj.DOFULLRETURN=1),this._trnMainService.callPipe=!this._trnMainService.callPipe,this._trnMainService.showCertainModes=!0}DoFulReturnClick(i){if(null==this._trnMainService.TrnMainObj.REFBILL||""==this._trnMainService.TrnMainObj.REFBILL||null==this._trnMainService.TrnMainObj.REFBILL)return;const t=0==this._trnMainService.TrnMainObj.DOFULLRETURN?1:0;i?confirm("Below data will be refreshed. Do you want to continue?")?(this._trnMainService.TrnMainObj.DOFULLRETURN=1,this.ConfirmChangeReturnMode(i),this._trnMainService.callPipe=!this._trnMainService.callPipe):setTimeout(()=>{this._trnMainService.TrnMainObj.DOFULLRETURN=t}):confirm("Do you want to switch to Partial Return Mode?")?(this._trnMainService.TrnMainObj.DOFULLRETURN=0,this.ConfirmChangeReturnMode(i),this._trnMainService.callPipe=!this._trnMainService.callPipe):setTimeout(()=>{this._trnMainService.TrnMainObj.DOFULLRETURN=t})}preventInput(i){return i.preventDefault(),!1}updown(i){"Insert"===i.code&&!this.hideCustomerPlus()&&(i.preventDefault(),1==this.showCustomerProfilePopup||l.Km.TaxInvoice?this.openQuickCusProfilePopup():(1==this.showPartyMasterPopup||l.Km.TaxInvoice)&&this.openQuickPartyMasterPopup()),"F2"===i.key&&i.altKey&&(i.preventDefault(),document.getElementById("flatDis").focus())}JobCardNoEnter(){this.genericGridJobCardNoSetting={title:"Job Card List",apiEndpoints:"/getJobCardNoPagedList",defaultFilterIndex:0,columns:[{key:"JobCardNO",title:"Job Card No",hidden:!1,noSearch:!1},{key:"CustomerName",title:"Customer Name",hidden:!1,noSearch:!1},{key:"MobileNo",title:"Mobile No",hidden:!1,noSearch:!1},{key:"VehicleNO",title:"VehicleNo",hidden:!1,noSearch:!1}]},this.genericGridJobCardNO.show()}SalesOrderEnter(){let i="SO";"add-sales-invoice-wholesale"==this.activeurlpath&&(i="SOWHOLESALE"),("add-sales-invoice"==this.activeurlpath||this._trnMainService.TrnMainObj.VoucherType===l.Km.Sales)&&(i="SORETAIL");let t,n=`/getPurchaseOrderPagedList/${t}/${i}`;this._trnMainService.TrnMainObj.VoucherType==l.Km.DeliveryChalan&&1==this.userSetting.EnableCentralizeOrderDeliveryMode&&(this._trnMainService.TrnMainObj.PARAC&&(t=this._trnMainService.TrnMainObj.PARAC),n=`/getSalesOrderForCentralizedOrderPagedList/${t}/${this._trnMainService.TrnMainObj.MWAREHOUSE}`),this.genericGridSalesOrderSetting={title:"Sales Order",apiEndpoints:n,defaultFilterIndex:0,columns:[{key:"PONUMBER",title:"SO Number",hidden:!1,noSearch:!1},{key:"DATE",title:"Date",hidden:!1,noSearch:!1},{key:"SUPPLIERNAME",title:"Customer Name",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"Address",hidden:!1,noSearch:!1},{key:"MOBILE",title:"Mobile No",hidden:!1,noSearch:!1}]},this.genericGridSalesOrder.show()}SalesOrderDetail(){this.LoadSalesOrder.show()}onSelectJobCardEntry(i){this._trnMainService.TrnMainObj.BILLTO=i.CustomerName,this._trnMainService.TrnMainObj.BILLTOADD=i.Address,this._trnMainService.TrnMainObj.PARAC=i.ACID,this._trnMainService.TrnMainObj.AdditionalObj.JOBCARDNO=i.JobCardNO,this._trnMainService.TrnMainObj.MobileNo=i.MobileNo}onSalesOrderSelect(i){i&&(this._trnMainService.TrnMainObj.REFORDBILL=i.PONUMBER,this._trnMainService.TrnMainObj.CREDITLIMIT=i.CRLIMIT,this._trnMainService.TrnMainObj.AdditionalObj.SONO=i.PONUMBER,this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE="FROMSO",this._trnMainService.TrnMainObj.BILLTO=i.SUPPLIERNAME,this._trnMainService.TrnMainObj.BILLTOADD=i.ADDRESS,this._trnMainService.TrnMainObj.BILLTOTEL=i.VATNO,this._trnMainService.TrnMainObj.TRNAC=i.ACID,this._trnMainService.TrnMainObj.PARAC=i.ACID,this._trnMainService.TrnMainObj.RECEIVEBY=i.CUSTID,this._trnMainService.TrnMainObj.SALESMAN=i.SALESMAN,this._trnMainService.TrnMainObj.SALESMANID=i.SALESMANID,(this._trnMainService.TrnMainObj.VoucherType===l.Km.Sales||this._trnMainService.TrnMainObj.VoucherType===l.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice)&&0==this._trnMainService.TrnMainObj.LOADFULLFROMQT&&(this._trnMainService.TrnMainObj.AdditionalObj.AFTERFLATDISCRATE=i.AFTERFLATDISCRATE,this._trnMainService.TrnMainObj.AdditionalObj.BEFOREFLATDISCRATE=i.BEFOREFLATDISCRATE,this._trnMainService.isRatePartial=i.DCRATE>0,(this._trnMainService.TrnMainObj.AdditionalObj.AFTERFLATDISCRATE>0||this._trnMainService.TrnMainObj.AdditionalObj.BEFOREFLATDISCRATE>0)&&(this._trnMainService.TrnMainObj.DCRATE=i.AFTERFLATDISCRATE>0?i.AFTERFLATDISCRATE:i.BEFOREFLATDISCRATE)),this._trnMainService.TrnMainObj.PARAC?this._trnMainService.TrnMainObj.TRNMODE="credit":(this._trnMainService.TrnMainObj.TRNMODE="cash",this._trnMainService.setCashProperty()),"credit"==this._trnMainService.TrnMainObj.TRNMODE&&(this._trnMainService.TrnMainObj.TRNACName=i.SUPPLIERNAME),1==this._trnMainService.TrnMainObj.LOADFULLFROMQT&&(this._trnMainService.disableOnCreditSelect=!0,this._trnMainService.disableAccountInputField=!0),this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow(),this._trnMainService.TrnMainObj.TOTALSQTY=0,this._trnMainService.TrnMainObj.GROSSAMNT=0,this._trnMainService.TrnMainObj.TAXABLE=0,this._trnMainService.TrnMainObj.NONTAXABLE=0,this._trnMainService.TrnMainObj.VATAMNT=0,this._trnMainService.TrnMainObj.NETWITHOUTROUNDOFF=0,this._trnMainService.callPipe=!this._trnMainService.callPipe,("abbreviated-sales-invoice"===this._trnMainService.activeurlpath||"add-sales-invoice"===this._trnMainService.activeurlpath||"add-sales-invoice-wholesale"==this.activeurlpath)&&(this._trnMainService.disableCustomerInputField=!0),1===this._trnMainService.TrnMainObj.LOADFULLFROMQT&&(this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==l.Km.Sales)&&this._trnMainService.loadDataForSalesInoviceFromSO(this._trnMainService.TrnMainObj.REFORDBILL,this._trnMainService.TrnMainObj.DIVISION,this._trnMainService.TrnMainObj.PhiscalID,"SOINTI"),1===this._trnMainService.TrnMainObj.LOADFULLFROMQT&&this._trnMainService.TrnMainObj.VoucherType===l.Km.DeliveryChalan&&this._trnMainService.loadDataForDeliveryChalanFromSO(this._trnMainService.TrnMainObj.REFORDBILL,i.DIVISION,this._trnMainService.TrnMainObj.PhiscalID,"SOINDL"),1===this._trnMainService.TrnMainObj.LOADFULLFROMQT&&this._trnMainService.TrnMainObj.VoucherType===l.Km.PerformaSalesInvoice&&this._trnMainService.loadDataForPerfromaInoviceFromSO(this._trnMainService.TrnMainObj.REFORDBILL,this._trnMainService.TrnMainObj.DIVISION,this._trnMainService.TrnMainObj.PhiscalID,"SOINTI"),this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice?setTimeout(()=>{document.getElementById("paymentTerms").focus()},100):this._trnMainService.TrnMainObj.VoucherType===l.Km.PerformaSalesInvoice&&setTimeout(()=>{document.getElementById("warehouseId").focus()},100),(1==this._trnMainService.TrnMainObj.LOADFULLFROMQT||this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice&&0==this._trnMainService.TrnMainObj.LOADFULLFROMQT)&&0==this.userSetting.EnableCusProfileInSOrder&&this._trnMainService.TrnMainObj.REFORDBILL?.startsWith("SO")&&(this._trnMainService.disableAccountInputField=!0),(this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType===l.Km.Sales)&&1==this.userSetting.EnableCusProfileInSOrder&&this._trnMainService.TrnMainObj.REFORDBILL.startsWith("SO")&&(this._trnMainService.TrnMainObj.TRNMODE="cash",this._trnMainService.setCashProperty()),"credit"==this._trnMainService.TrnMainObj.TRNMODE&&(this._trnMainService.TrnMainObj.TRNACName=i.SUPPLIERNAME),null!=this._trnMainService.TrnMainObj.ProdList[0].MENUCODE&&this._trnMainService.ReCalculateBillWithNormal())}salesOrderDelete(){null!=this._trnMainService.TrnMainObj.REFORDBILL&&(this._trnMainService.TrnMainObj.REFORDBILL=null,this._trnMainService.TrnMainObj.AdditionalObj.SONO=null,this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE=null,this._trnMainService.TrnMainObj.TRNACName=null,this._trnMainService.TrnMainObj.BILLTO=null,this._trnMainService.TrnMainObj.BILLTOADD=null,this._trnMainService.TrnMainObj.BILLTOTEL=null,this._trnMainService.TrnMainObj.TRNAC=null,this._trnMainService.TrnMainObj.PARAC=null,this._trnMainService.TrnMainObj.SALESMAN=null,this._trnMainService.TrnMainObj.SALESMANID=null,this._trnMainService.TrnMainObj.TRNMODE="credit",this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow(),this._trnMainService.TrnMainObj.TOTALSQTY=0,this._trnMainService.TrnMainObj.GROSSAMNT=0,this._trnMainService.TrnMainObj.TAXABLE=0,this._trnMainService.TrnMainObj.NONTAXABLE=0,this._trnMainService.TrnMainObj.VATAMNT=0,this._trnMainService.TrnMainObj.NETWITHOUTROUNDOFF=0)}OKLoadSalesOrder(i){for(let t in i)this._trnMainService.TrnMainObj.ProdList[t].MENUCODE=this._trnMainService.TrnMainObj.PODetailList[t].MENUCODE,this._trnMainService.TrnMainObj.ProdList[t].MCODE=this._trnMainService.TrnMainObj.PODetailList[t].MCODE,this._trnMainService.TrnMainObj.ProdList[t].ITEMDESC=this._trnMainService.TrnMainObj.PODetailList[t].DESCA,this._trnMainService.TrnMainObj.ProdList[t].ALTUNIT=this._trnMainService.TrnMainObj.PODetailList[t].UNIT,this._trnMainService.TrnMainObj.ProdList[t].BASEUNIT=this._trnMainService.TrnMainObj.PODetailList[t].UNIT,this._trnMainService.TrnMainObj.ProdList[t].ALTERNATEQUANTIY=this._trnMainService.TrnMainObj.PODetailList[t].DELIVERQTY,this._trnMainService.TrnMainObj.ProdList[t].Quantity=this._trnMainService.TrnMainObj.PODetailList[t].DELIVERQTY,this._trnMainService.TrnMainObj.ProdList[t].ALTRATE=this._trnMainService.TrnMainObj.PODetailList[t].DELIVERRATE,this._trnMainService.TrnMainObj.ProdList[t].RATE=this._trnMainService.TrnMainObj.PODetailList[t].DELIVERRATE,this._trnMainService.TrnMainObj.ProdList[t].AMOUNT=this._trnMainService.TrnMainObj.PODetailList[t].AMOUNT,this._trnMainService.TrnMainObj.ProdList[t].NETAMOUNT=this._trnMainService.TrnMainObj.PODetailList[t].AMOUNT,this._trnMainService.TrnMainObj.ProdList[t].NETAMNT=this._trnMainService.TrnMainObj.PODetailList[t].AMOUNT,this._trnMainService.TrnMainObj.ProdList[t].MFGDATE=this._trnMainService.TrnMainObj.PODetailList[t].MFGDATE,this._trnMainService.TrnMainObj.ProdList[t].EXPDATE=this._trnMainService.TrnMainObj.PODetailList[t].EXPIRYDATE,this._trnMainService.TrnMainObj.ProdList[t].isPurchaseOrderItem=!0,this._trnMainService.getAllUnitsOfItem(t),this._trnMainService.addRow();this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.TrnMainObj.ProdList.splice(-1),this.LoadSalesOrder.hide()}loadFromSalesOrderinTI(){this._trnMainService.TrnMainObj.REFORDBILL?1===this._trnMainService.TrnMainObj.LOADFULLFROMQT&&this._trnMainService.loadDataForSalesInoviceFromSO(this._trnMainService.TrnMainObj.REFORDBILL,this._trnMainService.TrnMainObj.DIVISION,this._trnMainService.TrnMainObj.PhiscalID,""):this._alertService.info("Please select reference invoice no")}showPopup(){this._trnMainService.TrnMainObj.AdditionalObj.SONO&&this.LoadSalesOrder.show()}closeModal(){this._trnMainService.onFlatDiscountClear(),this._trnMainService.clearDisAuthValues(),this._trnMainService.showDiscountAuth=!1}discountAuthConfirm(){this._trnMainService.disLimitAuthObj.isAuthDisLim=!0,this.loader.show("Authorizing Please wait");let i=this._trnMainService.TrnMainObj.ProdList.reduce((t,n)=>t+(n.INDDISCOUNT??0),0);this.masterService.authorizeDiscountLimitInSO(this._trnMainService.disLimitAuthObj).subscribe(t=>{if(this.loader.hide(),"ok"==t.status){let n=0!=this._trnMainService.nullToZeroConverter(t.result.userDisLimit)?t.result.userDisLimit:t.result.roleDisLimit;this._trnMainService.nullToZeroConverter(this._trnMainService.disLimitAuthObj.discountAmt)>0&&(this._trnMainService.limitValue=100*(i+Number(this._trnMainService.disLimitAuthObj.discountAmt))/this._trnMainService.TrnMainObj.GROSSAMNT),this._trnMainService.nullToZeroConverter(this._trnMainService.disLimitAuthObj.discountRate)>0&&(this._trnMainService.limitValue=100*(i+this._trnMainService.disLimitAuthObj.discountRate*this._trnMainService.TrnMainObj.GROSSAMNT/100)/this._trnMainService.TrnMainObj.GROSSAMNT),this._trnMainService.limitValue>n?(this._alertService.error("Specified discount value exceeded authorized discount limit!!!"),this._trnMainService.clearDisAuthValues(),this._trnMainService.onFlatDiscountClear(),this.savedDiscountObj=this._trnMainService.TrnMainObj.DiscountObj):(this._alertService.success("Authorization Sucessfull"),this._trnMainService.TrnMainObj.FLATDCAMNT=this._trnMainService.disLimitAuthObj.discountAmt,this._trnMainService.TrnMainObj.DCRATE=this._trnMainService.disLimitAuthObj.discountRate,this._trnMainService.resetDisLimitAuthObj()),this._trnMainService.showDiscountAuth=!1}else this._trnMainService.clearDisAuthValues(),this._trnMainService.onFlatDiscountClear()})}showReferenceBill(){return("add-sales-invoice"==this.activeurlpath||"add-sales-invoice-wholesale"==this.activeurlpath)&&0!==this.userSetting.ENABLE_SOINTI||this._trnMainService.TrnMainObj.VoucherType==l.Km.PerformaSalesInvoice&&0!==this.userSetting.ENABLE_SOINTI&&0!==this.userSetting.PERFOMASOBILLMODE||this._trnMainService.TrnMainObj.VoucherType==l.Km.DeliveryChalan&&0!==this.userSetting.ENABLE_SOINTI&&0!==this.userSetting.ENABLE_SOINDCHALAN||this._trnMainService.TrnMainObj.VoucherType==l.Km.Sales&&0!==this.userSetting.ENABLE_SOINTI&&0!=this.userSetting.ENABLE_SOINABB||73==this._trnMainService.TrnMainObj.VoucherType}focusToBarcode(i){i.preventDefault(),this._trnMainService.TrnMainObj.VoucherType!==l.Km.Quotation?0==this.userSetting.GblBarcodeWiseBilling?document.getElementById("itemDesc0").focus():this.masterService.focusAnyControl(this._trnMainService.TrnMainObj.ProdList[0].MCODE?"flatDis1":"barcodeField"):this.masterService.focusAnyControl("salesmanQuo")}showPaymentTerms(){return!(this._trnMainService.TrnMainObj.VoucherType!=l.Km.TaxInvoice&&this._trnMainService.TrnMainObj.VoucherType!=l.Km.ReverseTaxInvoice&&this._trnMainService.TrnMainObj.VoucherType!=l.Km.CreditNote&&this._trnMainService.TrnMainObj.VoucherType!=l.Km.Sales||(("add-sales-invoice"==this.activeurlpath||"add-sales-invoice-wholesale"==this.activeurlpath)&&"B2B"!=this.userSetting.CompanyType||"abbreviated-sales-invoice"==this.activeurlpath)&&1==this.userSetting.GblEnableMixedTenderMode)}disablePaymentTermsField(){return!!("VIEW"==this._trnMainService.TrnMainObj.Mode||1==this._trnMainService.disableMaster?.ReturnMode||1==this._trnMainService.disableAllFieldinPurchase||"self-billing"==this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.REFORDBILL&&this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice&&this._trnMainService.TrnMainObj.REFORDBILL.startsWith("SO")&&0==this.userSetting.EnableCusProfileInSOrder)}onCurrenyChange(i){let t=this.masterService.Currencies.filter(n=>n.CURNAME==i)[0];this._trnMainService.TrnMainObj.EXRATE=t.EXRATE}onActivate(i){window.scroll(0,0)}focusToExcRate(i){i.preventDefault(),this.masterService.focusAnyControl("exchangerateid")}showCashinPaymentTerms(){return"self-billing"!==this.activeurlpath&&!(this._trnMainService.TrnMainObj.VoucherType==l.Km.CreditNote&&0==this.userSetting.showcashinreturnmode)}showReturnVoucherInPaymentTerms(){return this._trnMainService.TrnMainObj.VoucherType==l.Km.CreditNote&&0!=this.userSetting.ShowReturnVoucherAcInReturnMode}valueforCostCenterWiseAccounting(i){if(this.userSetting.enableCostCenter>0&&1==this.userSetting.EnableCostCenterWiseAccounting&&("add-sales-invoice"==this.activeurlpath||"add-creditnote-itembase"==this.activeurlpath)){let t=i.filter(n=>n.COSTCENTERNAME==this.userProfile.costCenter);this._trnMainService.accountWiseCostCenter=t[0].CCID,this._trnMainService.TrnMainObj.COSTCENTER=t[0].CCID}}validateFlatDiscount(i){let t;return t=i instanceof Event?this._trnMainService.nullToZeroConverter(i.target.value):this._trnMainService.nullToZeroConverter(i),t>100?(this._trnMainService.TrnMainObj.DCRATE=0,void this._alertService.info("Flat discount rate cannot be greater than 100%")):t<0?(this._alertService.info("Flat discount rate cannot be less than 0%"),void(this._trnMainService.TrnMainObj.DCRATE=0)):void(0==this._trnMainService.nullToZeroConverter(t)&&this._trnMainService.discountsOnFlatZero())}onAddNewCustomer(){this.openQuickCusProfilePopup()}showAddButton(){if(this._trnMainService.TrnMainObj.VoucherType==l.Km.Sales||this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice&&"self-billing"!=this.activeurlpath||this._trnMainService.TrnMainObj.VoucherType==l.Km.Quotation&&1==this.userSetting.EnableCusProfileInSOrder&&"view"!=this._trnMainService.TrnMainObj.Mode?.toLowerCase())return!0}showDiscountAddButton(){if(this.isSO=!(!this._trnMainService.TrnMainObj.REFORDBILL||!this._trnMainService.TrnMainObj.REFORDBILL.startsWith("SO")||this._trnMainService.TrnMainObj.VoucherType==l.Km.SalesOrder||1==this._trnMainService.TrnMainObj.DOFULLRETURN&&2!=this.userSetting.ENABLE_SOINTI),1==this.userSetting.enableAdditionalFlatDiscountsInSales&&!this.isSO)return!0}onClickAddDiscounts(){this.totalIndividualDiscount=this._trnMainService.TrnMainObj.ProdList.reduce((t,n)=>t+(n.INDDISCOUNT??0),0);const i=this._trnMainService.TrnMainObj?.DiscountObj?.discountRowDetail.some(t=>t.discountAmount>0&&null!=t.discountAmount);if(this.isSO=!(!this._trnMainService.TrnMainObj.REFORDBILL||!this._trnMainService.TrnMainObj.REFORDBILL.startsWith("SO")),this.previousTotalIndividualDiscount=this.masterService.getPreviousTotalIndividualDiscount()?this.masterService.getPreviousTotalIndividualDiscount():0,this._trnMainService.TrnMainObj.GROSSAMNT){if("EDIT"==this._trnMainService.TrnMainObj.Mode&&i&&0==this._trnMainService.discountSelectionEdit)return this._trnMainService.discountSelectionEdit=!0,this.savedDiscountObj=this._trnMainService.TrnMainObj.DiscountObj,this.onAddNewDiscounts(),!0;if("VIEW"==this._trnMainService.TrnMainObj.Mode||this._trnMainService.TrnMainObj.VoucherType!=l.Km.PerformaSalesInvoice&&"PP"==this._trnMainService.TrnMainObj.VoucherAbbName||("abbreviated-sales-invoice"===this.activeurlpath||"add-sales-invoice-wholesale"==this.activeurlpath||"add-sales-invoice"==this.activeurlpath||this._trnMainService.TrnMainObj.VoucherType==l.Km.PerformaSalesInvoice)&&this.isSO)return this.savedDiscountObj=this._trnMainService.TrnMainObj.DiscountObj,this.onAddNewDiscounts(),!0;if("NEW"==this._trnMainService.TrnMainObj.Mode&&0==this._trnMainService.discountSelectionEdit){if(this.savedDiscountObj=this._trnMainService.TrnMainObj.DiscountObj,this._trnMainService.discountSelectionEdit=!0,!this.totalIndividualDiscount)return this.flatDiscountType="after",this.onAddNewDiscounts(),!0}else{if(!this.totalIndividualDiscount)return this.flatDiscountType="after",this.onAddNewDiscounts(),!0;if(this.savedDiscountObj?.discountRowDetail?.find(t=>t.discountAmount)&&(this._trnMainService.nullToZeroConverter(this.previousTotalIndividualDiscount)>0&&this.previousTotalIndividualDiscount==this.totalIndividualDiscount||"EDIT"==this._trnMainService.TrnMainObj.Mode))return this.onAddNewDiscounts(),!0}this.masterService.setPreviousTotalIndividualDiscount(this.totalIndividualDiscount),this.showAdditionalFlatDiscountPopUp=!0}else this._alertService.info("Please Select Product to apply additional discount!!!")}onAddNewDiscounts(){this.showAdditionalFlatDiscountPopUp=!1,!this.flatDiscountType&&"EDIT"!=this._trnMainService.TrnMainObj.Mode&&(this.flatDiscountType=this._trnMainService.TrnMainObj.AdditionalObj.BEFOREFLATDISCRATE?"before":"after"),this._trnMainService.TrnMainObj.DiscountObj?.discountRowDetail.some(t=>t.discountAmount>0&&null!=t.discountAmount)||(this.savedDiscountObj={}),0===this._trnMainService.TrnMainObj.FLATDCAMNT&&(this.savedDiscountObj={}),this.dialog.open(xe.C,{data:{object:this._trnMainService.TrnMainObj,grossAmount:this._trnMainService.TrnMainObj.GROSSAMNT,discountAmount:this._trnMainService.TrnMainObj.FLATDCAMNT,discountRate:this._trnMainService.TrnMainObj.DCRATE,ecsAmount:this._trnMainService.TrnMainObj.TOTALECS,listDiscounts:this.savedDiscountObj,totalIndDiscount:this.totalIndividualDiscount,flatDisCalcType:this.flatDiscountType,urlPath:this.activeurlpath}}).afterClosed().subscribe(t=>{null===t?this._trnMainService.TrnMainObj.DiscountObj=null:(this._trnMainService.TrnMainObj.DiscountObj=t,this._trnMainService.TrnMainObj.FLATDCAMNT=t?.totalDiscountAmount?t?.totalDiscountAmount:0,this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT=t?.totalDiscountAmount?t?.totalDiscountAmount:0,"after"===this.flatDiscountType?this._trnMainService.afterDiscFlat():"before"===this.flatDiscountType?this._trnMainService.beforeDiscFlat():"overwrite"===this.flatDiscountType&&this._trnMainService.TrnMainObj.FLATDCAMNT&&this._trnMainService.onApplyClicked(),this.savedDiscountObj="overwrite"!=this.flatDiscountType?t:this._trnMainService.TrnMainObj.DiscountObj),0==this._trnMainService.nullToZeroConverter(t?.totalDiscountAmount)&&(this._trnMainService.onFlatDiscountClear(),this._trnMainService.clearDisAuthValues(),this._trnMainService.callPipe=!this._trnMainService.callPipe),this._trnMainService.callPipe=!this._trnMainService.callPipe})}showAddDiscount(){if(this._trnMainService.TrnMainObj.VoucherType==l.Km.Sales||this._trnMainService.TrnMainObj.VoucherType==l.Km.TaxInvoice&&"add-sales-invoice"==this.activeurlpath)return!0}validateFlatDiscountAmount(i){let t;t=i instanceof Event?this._trnMainService.nullToZeroConverter(i.target.value):this._trnMainService.nullToZeroConverter(i);let n=this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.NETAMNT/1.13);return t>=n?(this._alertService.info(`Flat discount amount cannot be greater than or equal to total amount: ${n}`),void(this._trnMainService.TrnMainObj.FLATDCAMNT=0)):t<0?(this._alertService.info("Flat discount amount cannot be less than 0"),void(this._trnMainService.TrnMainObj.FLATDCAMNT=0)):void(0==this._trnMainService.nullToZeroConverter(t)&&this._trnMainService.discountsOnFlatZero())}showWholesaleRateOption(){return 1==this.userSetting.LoadWholesaleRateinProforma&&this._trnMainService.TrnMainObj.VoucherType==l.Km.PerformaSalesInvoice}disableWholeSaleRateOption(){return"VIEW"==this._trnMainService.TrnMainObj.Mode||this._trnMainService.TrnMainObj.ProdList.filter(i=>null!=i.MCODE).length>0}applyFlatDiscount(i){this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT=this._trnMainService.TrnMainObj.FLATDCAMNT?this._trnMainService.TrnMainObj.FLATDCAMNT:0,this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.FLATDCAMNT)>0||this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.DCRATE)>0&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.DCRATE)<100?this._trnMainService.showFlatDiscOption=!0:this._trnMainService.beforeDiscFlat()}closeFlatDiscOption(){this._trnMainService.showFlatDiscOption=!1,this._trnMainService.onFlatDiscountClear(),this._trnMainService.clearDisAuthValues()}closeAdditionalFlatDiscOption(){this.showAdditionalFlatDiscountPopUp=!1,this._trnMainService.onFlatDiscountClear(),this._trnMainService.clearDisAuthValues()}onChangeSOLoad(i){!i.target.checked&&this._trnMainService.TrnMainObj.ProdList.find(t=>t.MCODE)&&confirm("Are you sure you want to clear list?")&&(this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.onFlatDiscountClear(),1==this._trnMainService.callPipe&&(this._trnMainService.callPipe=!this._trnMainService.callPipe),this._trnMainService.addRow()),0==this._trnMainService.TrnMainObj.LOADFULLFROMQT&&this._trnMainService.TrnMainObj.REFORDBILL&&(this._trnMainService.disableOnCreditSelect=!1),this._trnMainService.callPipe=!this._trnMainService.callPipe}onClickAdd(){this.paymentTermForm.patchValue(this.selectedPaymentTerm?{paymentName:this.selectedPaymentTerm}:{paymentName:""}),this.addNewPayment=!0}onClickAddRemarks(){this.addNewDeclineRemark=!0}closePaymentTermModal(){this.addNewPayment=!1,this.paymentTermForm.reset(),this.selectedPaymentTerm=""}closeDeclineTermModal(){this.addNewDeclineRemark=!1,this.declineTermForm.reset()}onPaymentSubmit(){let i={};if(i.PAYMENTTERMS=this.paymentTermForm.value.paymentName,i.GUID=oe(),i.INITIALTERM=this.selectedPaymentTerm?this.selectedPaymentTerm:"",i.PAYMENTTERMS&&""!=i.PAYMENTTERMS?.trim())return this.payment.some(n=>n.PAYMENTTERMS===i.PAYMENTTERMS)?(this._alertService.warning("Payment Terms already exist!"),this.paymentTermForm.reset(),void(this.selectedPaymentTerm="")):void this._paymentTermsService.postPaymentTerms(i).subscribe(n=>{"ok"===n.status?(this.loader.hide(),this._alertService.info("Saved Successfully"),this.getPaymentTerms().then(()=>{const r=this.payment.find(s=>s.PAYMENTTERMS===i.PAYMENTTERMS);r&&(this._trnMainService.TrnMainObj.AdditionalObj.PAYMENTTERMS=r.ID,this.selectedPaymentTerm=r.PAYMENTTERMS),this.paymentTermForm.reset(),this.selectedPaymentTerm="",this.closePaymentTermModal()})):(this.loader.hide(),this._alertService.error(n.result))},n=>{this.loader.hide(),this._alertService.error("An error occurred while saving Payment Terms.")});this._alertService.warning("Please Enter Payment Terms!!!")}getPaymentTerms(){return new Promise((i,t)=>{this._paymentTermsService.getPaymentTerms().subscribe(n=>{this.payment=n.result,i()},n=>{console.error("Error fetching payment terms",n),t(n)})})}onRemarkSubmit(){let i={};i.STATUS=this.declineTermForm.value.remarkName,i.GUID=oe(),this.loader.show("Data is Saving ..."),this._paymentTermsService.saveDeclineStatus(i).subscribe(t=>{"ok"==t.status?(this.loader.hide(),this._alertService.info("Saved Successfully"),this.declineTermForm.reset(),this.getDeclineStatusRemarks(),this.closeDeclineTermModal()):(this.loader.hide(),this._alertService.error(t.result))},t=>{this.loader.hide()})}getDeclineStatusRemarks(){this._paymentTermsService.getDeclineStatusRemarks().subscribe(i=>{this.remarksList=i.result})}enterClickOnRefno(i){this._trnMainService.TrnMainObj.VoucherType==l.Km.DeliveryChalan&&1==this.userSetting.EnablePetrolPumpFeatures&&this.enterClickOnRefnoEventEmit.emit(i)}disableCustomerField(){return!!((this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice||"add-sales-invoice-wholesale"==this.activeurlpath)&&("PP"===this._trnMainService.TrnMainObj.VoucherAbbName||"DL"===this._trnMainService.TrnMainObj.VoucherAbbName||1==this._trnMainService.disableCustomerInputField)||"VIEW"===this._trnMainService.TrnMainObj.Mode||1===this.userSetting.EnablePetrolPumpFeatures&&this._trnMainService.TrnMainObj.BILLTO&&83===this._trnMainService.TrnMainObj.VoucherType||"self-billing"===this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType===l.Km.DeliveryReturn||!0===this._trnMainService.disableMaster?.Customer||"CREDIT"==this._trnMainService.TrnMainObj.TRNMODE?.toUpperCase()&&"add-membership-sales-invoice"!=this.activeurlpath)}hideCustomerPlus(){return!!((this._trnMainService.TrnMainObj.VoucherType===l.Km.TaxInvoice||"add-sales-invoice-wholesale"==this.activeurlpath||"abbreviated-sales-invoice"===this._trnMainService.activeurlpath)&&("PP"===this._trnMainService.TrnMainObj.VoucherAbbName||"DL"===this._trnMainService.TrnMainObj.VoucherAbbName||1==this._trnMainService.disableCustomerInputField)||"VIEW"===this._trnMainService.TrnMainObj.Mode||1===this.userSetting.EnablePetrolPumpFeatures&&this._trnMainService.TrnMainObj.BILLTO&&83===this._trnMainService.TrnMainObj.VoucherType||"self-billing"===this._trnMainService.activeurlpath||this._trnMainService.TrnMainObj.VoucherType===l.Km.DeliveryReturn||!0===this._trnMainService.disableMaster?.Customer||"CREDIT"==this._trnMainService.TrnMainObj.TRNMODE?.toUpperCase()&&"add-membership-sales-invoice"!=this.activeurlpath&&"B2C"==this.userSetting.CompanyType&&0==this.userSetting.ShowCashAccountingInLedgerReport)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}showBeforeOverwrite(){return this.totalIndividualDiscount=this._trnMainService.TrnMainObj.ProdList.reduce((i,t)=>i+(t.INDDISCOUNT??0),0),this.totalIndividualDiscount>0}disableFlatDisField(){return this.isSO=!(!this._trnMainService.TrnMainObj.REFORDBILL||!this._trnMainService.TrnMainObj.REFORDBILL.startsWith("SO")),!!(this._trnMainService.TrnMainObj.VoucherType!=l.Km.PerformaSalesInvoice&&"PP"==this._trnMainService.TrnMainObj.VoucherAbbName||("abbreviated-sales-invoice"===this.activeurlpath||"add-sales-invoice-wholesale"==this.activeurlpath||"add-sales-invoice"==this.activeurlpath)&&this.isSO||0==this.userSetting.ENABLEMANUALSALESRETURN&&15==this._trnMainService.TrnMainObj.VoucherType||null==this._trnMainService.TrnMainObj.ProdList[0].MCODE)}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(I.P),e.Y36(f.p),e.Y36(L.gz),e.Y36(P.e),e.Y36(z.uw),e.Y36(D.c),e.Y36(y.V),e.Y36(je.S),e.Y36(p.qu),e.Y36(ie.h))},a.\u0275cmp=e.Xpm({type:a,selectors:[["trnmain-parameters-master"]],viewQuery:function(i,t){if(1&i&&(e.Gf(Ve,5),e.Gf(Be,5),e.Gf(Ge,5),e.Gf(He,5),e.Gf(qe,5),e.Gf(Je,5),e.Gf(Qe,5),e.Gf(Ye,5),e.Gf(Ke,5),e.Gf(We,5),e.Gf(ze,5),e.Gf(Xe,5),e.Gf($e,5),e.Gf(ei,5),e.Gf(ii,5),e.Gf(ti,5),e.Gf(ni,5),e.Gf(ri,5),e.Gf(ai,5),e.Gf(oi,5),e.Gf(si,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.genericGridCustomer=n.first),e.iGM(n=e.CRH())&&(t.genericGridRefBill=n.first),e.iGM(n=e.CRH())&&(t.genericGridSalesMan=n.first),e.iGM(n=e.CRH())&&(t.genericGridForTaxCancel=n.first),e.iGM(n=e.CRH())&&(t.newgenericGridForTaxCancel=n.first),e.iGM(n=e.CRH())&&(t.newgenericGridForSalesReturn=n.first),e.iGM(n=e.CRH())&&(t.newgenericGridForDeliveryChalanReturn=n.first),e.iGM(n=e.CRH())&&(t.genericGridCustomerListBySalesmanAndRoute=n.first),e.iGM(n=e.CRH())&&(t.genericGridAccount=n.first),e.iGM(n=e.CRH())&&(t.CreateCustomerProfile=n.first),e.iGM(n=e.CRH())&&(t.CreateQuickParty=n.first),e.iGM(n=e.CRH())&&(t.genericGridSalesOrder=n.first),e.iGM(n=e.CRH())&&(t.LoadSalesOrder=n.first),e.iGM(n=e.CRH())&&(t.genericGridJobCardNO=n.first),e.iGM(n=e.CRH())&&(t.genericGridVehicleNo=n.first),e.iGM(n=e.CRH())&&(t.addDiscount=n.first),e.iGM(n=e.CRH())&&(t.focusInputUnit=n.first),e.iGM(n=e.CRH())&&(t.focusSalesman=n.first),e.iGM(n=e.CRH())&&(t.focusInputFormat=n.first),e.iGM(n=e.CRH())&&(t.FocusCustomer=n.first),e.iGM(n=e.CRH())&&(t.genericGridWarehouse=n.first)}},hostBindings:function(i,t){1&i&&e.NdJ("keydown",function(r){return t.updown(r)},!1,e.evT)},outputs:{onDblClickSOLoadInTI:"onDblClickSOLoadInTI",enterClickOnRefnoEventEmit:"enterClickOnRefnoEventEmit",showCustomerProfile:"showCustomerProfile"},decls:67,vars:46,consts:[[1,"pd0","mr5","plainBackGround",3,"ngStyle"],[1,"row","col-md-12",2,"padding","15px"],[1,"col-md-4"],["class","row",4,"ngIf"],[4,"ngIf"],["class","row","style","float: right;",4,"ngIf"],["class","row","style","margin-top: 6px;",4,"ngIf"],["class","col-md-4","style","overflow-x: hidden",4,"ngIf"],[1,"col-md-4",2,"overflow-x","hidden"],[1,"row","cell-with-comment"],[2,"width","25%"],["id","customerselectid","type","text","autocomplete","off","title","Enter or Tab to select",2,"width","69%",3,"disabled","readOnly","ngModel","placeholder","change","ngModelChange","keydown.enter"],["focusInputFormat",""],["style","margin-left: 2px;","class","add",3,"click",4,"ngIf"],["class","col-md-4","style","overflow-x: hidden; overflow-y: auto; height: 160px;","id","scrollableDiv",4,"ngIf"],["class","col-md-4","style","overflow-x: hidden; overflow-y: auto; height: 160px;",4,"ngIf"],[3,"popupsettings","onItemDoubleClick","isCustomerProfileData"],["genericGridCustomer",""],[3,"popupsettings","onItemDoubleClick"],["genericGridSalesMan",""],["genericGridRefBill",""],["genericGridWarehouse",""],["genericGridCustomerListBySalesmanAndRoute",""],["genericGridForTaxCancel",""],["newgenericGridForTaxCancel",""],["newgenericGridForSalesReturn",""],["newgenericGridForDeliveryChalanReturn",""],["genericGridAccount",""],["genericGridSalesOrder",""],[3,"onLoadPO"],["LoadSalesOrder",""],[3,"onSaveParty"],["CreateQuickParty",""],[3,"onSave"],["CreateCustomerProfile",""],["genericGridJobCardNO",""],["genericGridVehicleNo",""],["class","backdrop",4,"ngIf"],[1,"row"],[2,"float","right","width","73%","margin-top","3px","font-weight","bold"],[2,"float","right","width","34%","margin-top","7px"],["type","date",2,"width","100%",3,"ngModel","disabled","min","max","ngModelChange","change"],[2,"float","right","width","27.2%","margin-top","7px"],["name","InvnepaliDateFrom",3,"id","label","disable","ngModel","change","ngModelChange"],["name","EntrynepaliDateFrom",3,"id","label","disable","ngModel","change","ngModelChange"],["id","refbill","type","text","autocomplete","off","placeholder","Please Enter To Select Ref Bill No",2,"width","64%",3,"disabled","ngModel","ngModelChange","keydown.enter","keydown.tab","keydown"],["id","refbill","type","text","autocomplete","off","style","width:64%;","placeholder","Please Enter To Select Ref Bill No",3,"disabled","ngModel","readonly","ngModelChange","keydown.enter","keydown.tab",4,"ngIf"],["id","refbill","type","text","autocomplete","off","style","width:64%;",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["id","refbill","type","text","autocomplete","off","placeholder","Please Enter To Select Ref Bill No",2,"width","64%",3,"disabled","ngModel","readonly","ngModelChange","keydown.enter","keydown.tab"],["id","refbill","type","text","autocomplete","off",2,"width","64%",3,"ngModel","disabled","ngModelChange"],[1,"row",2,"float","right"],["style","display: flex; padding-right: 36px;",4,"ngIf"],[2,"display","flex","padding-right","36px"],["type","checkbox",2,"width","25px","height","19px","margin-top","4px","margin-right","9px",3,"ngModel","disabled","ngModelChange","change"],[2,"width","100%"],[4,"ngIf","ngIfThen","ngIfElse"],["refNo",""],["couponNo",""],[2,"float","right","width","73%","margin-top","7px"],["name","refno","id","refno","style","width:52%;",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["id","refnoInput","type","text","autocomplete","off",3,"ngClass","ngModel","disabled","ngModelChange","focus","keydown.tab","keydown.enter","change"],["name","refno","id","refno",2,"width","52%",3,"ngModel","disabled","ngModelChange"],["value","",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["value",""],[2,"float","right","width","73%"],["id","payment",2,"width","75%",3,"ngModel","disabled","ngModelChange","change"],["value","","disabled",""],["class","add",3,"click",4,"ngIf"],[1,"add",3,"click"],["id","refbill","type","text","autocomplete","off","placeholder","Please Enter To Select Ref Bill No",2,"width","64%",3,"disabled","ngModel","ngModelChange","keydown.enter","keydown.tab"],[2,"display","flex","/* margin-left","20px","*/\n        padding-right","36px"],["type","checkbox",2,"width","25px","height","19px","margin-top","4px","margin-right","9px",3,"ngModel","disabled","change","ngModelChange","click"],["type","text",2,"width","31%","margin-top","7px",3,"ngModel","disabled","ngModelChange"],["type","date",2,"width","33%","margin-top","7px",3,"ngModel","disabled","ngModelChange"],["id","refnoInput","type","text","placeholder","Enter to Select Job Card Entry no.","autocomplete","off",2,"width","87%",3,"ngModel","disabled","ngModelChange","Keydown.Enter","focus"],[2,"width","64%",3,"ngModel","disabled","ngModelChange"],["value","FULL"],["value","HALF"],[1,"row",2,"margin-top","6px"],[2,"float","right","width","36%"],["id","soNoId","type","text","placeholder","Enter to Select SO no.","autocomplete","off","readonly","",2,"width","95%",3,"ngModel","disabled","ngModelChange","keydown.enter","keydown.Tab","keydown.delete"],["type","checkbox",2,"width","17px","height","19px","margin-top","-8px",3,"ngModel","disabled","change","ngModelChange","keydown.delete"],[2,"width","auto","font-size","12px"],[1,"row",3,"hidden"],["type","text",2,"width","52%",3,"ngModel","disabled","ngModelChange"],["type","date",2,"width","44%",3,"ngModel","disabled","ngModelChange","change"],["class","row cell-with-comment","style","padding: 0px;",4,"ngIf"],[1,"row",2,"margin-top","-5px"],["style","width: 50%",4,"ngIf"],["class","row","style","margin-top: 3px;",4,"ngIf"],["id","paymentTerms","style","width:70%;",3,"ngModel","disabled","ngModelChange","change",4,"ngIf"],["id","exportpaymentTerms","style","width:70%;",3,"ngModel","disabled","ngModelChange","change",4,"ngIf"],["id","paymentTerms",2,"width","70%",3,"ngModel","disabled","ngModelChange","change"],["id","exportpaymentTerms",2,"width","70%",3,"ngModel","disabled","ngModelChange","change"],["id","accountField","type","text","autocomplete","off","placeholder","Press Enter to Select Account","readonly","",2,"width","70%",3,"disabled","ngModel","ngModelChange","keydown.enter"],["id","warehouseId","type","text","style","width:70%;","autocomplete","off","placeholder","Press Enter to Select Warehouse",3,"disabled","ngModel","readonly","ngModelChange","keydown.enter",4,"ngIf"],["id","warehouseId","type","text","style","width:70%;","autocomplete","off","placeholder","Press Enter to Select Warehouse","readonly","",3,"disabled","ngModel","ngModelChange","keydown.enter",4,"ngIf"],["id","warehouseId","type","text","autocomplete","off","placeholder","Press Enter to Select Warehouse",2,"width","70%",3,"disabled","ngModel","readonly","ngModelChange","keydown.enter"],["id","warehouseId","type","text","autocomplete","off","placeholder","Press Enter to Select Warehouse","readonly","",2,"width","70%",3,"disabled","ngModel","ngModelChange","keydown.enter"],[1,"row","cell-with-comment",2,"padding","0px"],["type","text","placeholder","Press ENTER to Select Salesman","autocomplete","off","readonly","",2,"width","70%",3,"ngModel","disabled","ngModelChange","keydown.enter","keydown.delete"],["id","costCenter",2,"width","70%",3,"ngModel","disabled","ngModelChange","keydown.tab"],["type","number","disabled","true",2,"width","35%","position","absolute","right","37%","text-align","right",3,"ngModel","ngModelChange"],[2,"width","25%","position","absolute","right","10%"],[2,"width","50%"],["id","currency",2,"width","47%",3,"ngModel","disabled","ngModelChange","change","keydown.Tab","keydown.Enter"],[2,"width","40%"],["id","exchangerateid","type","number",2,"width","50%",3,"ngModel","disabled","ngModelChange"],[1,"row",2,"margin-top","3px"],["id","modetransportation",2,"width","70%",3,"ngModel","disabled","ngModelChange"],["value","BY AIR CARGO"],["value","BY COURIER"],["value","ship"],["id","billMode",2,"width","70%",3,"ngModel","disabled","ngModelChange"],["value","new"],["value","renew"],[2,"width","70%",3,"disabled","ngModel","ngModelChange"],["id","unit",2,"width","70%",3,"disabled","ngModel","ngModelChange","keydown.tab","keydown.enter"],["focusInputUnit",""],["value","CASE"],["value","EACH"],["id","itembarcode","type","text",2,"width","70%",3,"ngModel","ngModelChange","keydown.enter"],[2,"width","20%"],[2,"width","30%",3,"ngModel","ngModelChange","change"],[3,"ngValue",4,"ngFor","ngForOf"],["type","text","readonly","",2,"width","18%",3,"ngModel","ngModelChange"],[3,"ngValue"],[1,"add",2,"margin-left","2px",3,"click"],["type","text","readonly","",2,"width","70%",3,"ngModel","disabled","ngModelChange"],["class","row cell-with-comment",4,"ngIf"],["id","remarksid","type","text",2,"width","70%","height","24px","min-height","24px","max-height","55px",3,"ngModel","disabled","keydown.Tab","ngModelChange"],["type","text","autocomplete","off","placeholder","Press Enter to Select Account",2,"width","70%",3,"disabled","ngModel","ngModelChange","keydown.enter"],["id","country","type","text",2,"width","70%",3,"ngModel","disabled","ngModelChange"],["id","vehiclenoid","type","text","autocomplete","off","placeholder","Press ENTER to Select Vehicle No",2,"width","70%",3,"disabled","ngModel","ngModelChange","keydown.enter","keyup"],[1,"col-md-6",2,"padding","0px"],["type","number","id","flatDis1",2,"width","46%",3,"ngModel","disabled","ngModelChange","keydown.Enter","keydown.Tab","focusout"],["type","number",2,"width","48%",3,"ngModel","disabled","ngModelChange","focusout","keydown.Enter","change"],["class","add-discount-button add",3,"click",4,"ngIf"],[1,"add-discount-button","add",3,"click"],[1,"tooltip-text"],[2,"width","25%","font-size","11px"],["type","checkbox",2,"width","17px","height","19px","margin-top","4px","margin-right","9px",3,"ngModel","disabled","change","ngModelChange"],["id","scrollableDiv",1,"col-md-4",2,"overflow-x","hidden","overflow-y","auto","height","160px"],["type","text","id","flatDis",2,"width","46%",3,"ngModel","disabled","focusout","keydown.Enter","keydown.Tab","ngModelChange"],[2,"width","45%"],["type","text",2,"width","46%",3,"ngModel","disabled","ngModelChange","focusout","keydown.Enter","keydown.Tab"],["id","paymentTermsview",2,"width","70%",3,"ngModel","disabled"],["value","credit"],["value","cash"],["value","creditcard"],["value","cheque"],["value","mixed"],["type","text","autocomplete","off",2,"width","70%",3,"disabled","ngModel"],[1,"col-md-4",2,"overflow-x","hidden","overflow-y","auto","height","160px"],[1,"col-11","pl-0","pr-1"],[2,"width","27%"],["id","flatDisRate","type","text",2,"width","63%",3,"ngModel","disabled","change","ngModelChange","keydown.Enter","keydown.Tab"],["type","text",2,"width","63%",3,"ngModel","disabled","ngModelChange","change","keydown.Enter"],[1,"col-1","pl-0","pr-0"],["id","quotationstatus",2,"width","60%",3,"ngModel","disabled","ngModelChange"],[1,"tooltip-text","quotation"],["id","salesmanQuo","type","text","placeholder","Press ENTER to Select Salesman","autocomplete","off","readonly","",2,"width","60%",3,"ngModel","disabled","ngModelChange","keydown.enter","keydown.delete"],["id","remarksid","type","text",2,"width","60%","height","24px","min-height","24px","max-height","55px",3,"ngModel","disabled","keydown.Tab","ngModelChange","change"],[1,"backdrop"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","-4rem","margin-right","20rem"],[1,"modal-content","modal-content-main-area",2,"width","auto","height","auto"],[1,"modal-header",2,"padding","0px","background","#c0c0c0"],[1,"modal-title",2,"padding-left","5px"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group","row","mb-2",2,"margin","0.5rem"],[1,"col-md-6","col-sm-12"],[1,"col-5","form-control-label","p-0","m-0",2,"font-size","13px"],[1,"col-6",2,"padding","0px"],["type","text","id","Parent","autocomplete","off",1,"form-control",2,"height","4vh","font-size","13px",3,"ngModel","ngModelChange"],["type","password","id","Parent","autocomplete","off",1,"form-control",2,"height","4vh","font-size","13px",3,"ngModel","ngModelChange"],["type","number","id","Parent","autocomplete","off",1,"col-6","form-control",2,"height","4vh","font-size","13px",3,"disabled","ngModel","ngModelChange"],[1,"form-group-row",2,"margin","0.5rem"],[2,"border","2px solid #d9d9d9","width","100%"],[2,"font-size","13px","text-align","left","margin-bottom","3px","width","auto"],[1,"form-control",2,"width","100%",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","submit",1,"btn","btn-sm","btn-info",2,"font-size","12px",3,"click"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","0rem","margin-right","-1rem"],[1,"modal-content","modal-content-main-area",2,"width","53%"],["class"," form-control-label","style","font-size: 14px;",4,"ngIf"],["type","button","class","btn btn-sm btn-info","style","font-size: 10px;padding:6px",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-info",2,"font-size","10px","padding","6px",3,"click"],[1,"form-control-label",2,"font-size","14px"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","20px","margin-right","8rem"],[1,"modal-content","modal-content-main-area",2,"width","70%"],[3,"formGroup","ngSubmit"],[1,"form-group","row",2,"margin-top","1rem","margin-bottom","2px"],[1,"col-sm-4","form-control-label",2,"margin-left","-12px"],[1,"col-sm-8"],["type","text","formControlName","paymentName","autocomplete","off",1,"form-control",2,"height","4vh","font-size","13px"],["type","submit",1,"btn","btn-sm","btn-info",2,"font-size","12px"],["type","text","formControlName","remarkName","autocomplete","off",1,"form-control",2,"height","4vh","font-size","13px"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,li,5,2,"div",3),e.YNc(4,di,2,1,"ng-container",4),e.YNc(5,_i,2,1,"ng-container",4),e.YNc(6,ui,7,8,"div",3),e.YNc(7,Mi,4,3,"div",3),e.YNc(8,Si,5,2,"div",3),e.YNc(9,mi,2,1,"div",5),e.YNc(10,gi,1,0,"div",3),e.YNc(11,Pi,9,7,"div",3),e.YNc(12,Di,9,4,"div",3),e.YNc(13,yi,4,2,"div",3),e.YNc(14,Ri,5,2,"div",5),e.YNc(15,xi,5,4,"div",3),e.YNc(16,ji,5,2,"div",3),e.YNc(17,wi,8,2,"div",3),e.YNc(18,Fi,6,3,"div",6),e.qZA(),e.YNc(19,dt,19,16,"div",7),e.TgZ(20,"div",8)(21,"div",9)(22,"label",10),e._uU(23),e.qZA(),e.TgZ(24,"input",11,12),e.NdJ("change",function(){return t.customerFieldChange()})("ngModelChange",function(r){return t._trnMainService.TrnMainObj.BILLTO=r})("keydown.enter",function(r){return t.customerEnterCommand(r)}),e.qZA(),e.YNc(26,ht,3,0,"span",13),e.qZA(),e.YNc(27,bt,17,12,"div",4),e.qZA(),e.YNc(28,At,8,5,"div",14),e.YNc(29,yt,2,1,"div",15),e.qZA()(),e.TgZ(30,"generic-popup-grid",16,17),e.NdJ("onItemDoubleClick",function(r){return t.onCustomerSelected(r)})("isCustomerProfileData",function(r){return t.CustomerProfileDate(r)}),e.qZA(),e.TgZ(32,"generic-popup-grid",18,19),e.NdJ("onItemDoubleClick",function(r){return t.onSalesManSelect(r)}),e.qZA(),e.TgZ(34,"generic-popup-grid",18,20),e.NdJ("onItemDoubleClick",function(r){return t.onRefBillSelected(r)}),e.qZA(),e.TgZ(36,"generic-popup-grid",18,21),e.NdJ("onItemDoubleClick",function(r){return t.onWarehouseSelected(r)}),e.qZA(),e.TgZ(38,"new-generic-popup-grid",18,22),e.NdJ("onItemDoubleClick",function(r){return t.onCustomerSelected(r)}),e.qZA(),e.TgZ(40,"generic-popup-grid",18,23),e.NdJ("onItemDoubleClick",function(r){return t.onItemDoubleClick(r)}),e.qZA(),e.TgZ(42,"new-generic-popup-grid",18,24),e.NdJ("onItemDoubleClick",function(r){return t.onItemDoubleClick(r)}),e.qZA(),e.TgZ(44,"generic-popup-grid",18,25),e.NdJ("onItemDoubleClick",function(r){return t.onRefBillSelected(r)}),e.qZA(),e.TgZ(46,"generic-popup-grid",18,26),e.NdJ("onItemDoubleClick",function(r){return t.onRefBillSelected(r)}),e.qZA(),e.TgZ(48,"generic-popup-grid",18,27),e.NdJ("onItemDoubleClick",function(r){return t.onAccountSelect(r)}),e.qZA(),e.TgZ(50,"generic-popup-grid",18,28),e.NdJ("onItemDoubleClick",function(r){return t.onSalesOrderSelect(r)}),e.qZA(),e.TgZ(52,"load-purchase-order",29,30),e.NdJ("onLoadPO",function(r){return t.OKLoadSalesOrder(r)}),e.qZA(),e.TgZ(54,"quick-party-master",31,32),e.NdJ("onSaveParty",function(r){return t.onSavePartyMaster(r)}),e.qZA(),e.TgZ(56,"create-customer-dialog",33,34),e.NdJ("onSave",function(r){return t.onSaveCustomerProfile(r)}),e.qZA(),e.TgZ(58,"generic-popup-grid",18,35),e.NdJ("onItemDoubleClick",function(r){return t.onSelectJobCardEntry(r)}),e.qZA(),e.TgZ(60,"generic-popup-grid",18,36),e.NdJ("onItemDoubleClick",function(r){return t.onVehicleNoSelected(r)}),e.qZA(),e.YNc(62,Rt,42,7,"div",37),e.YNc(63,Ft,19,4,"div",37),e.YNc(64,Gt,17,4,"div",37),e.YNc(65,Ht,19,1,"div",4),e.YNc(66,qt,19,1,"div",4)),2&i&&(e.Q6J("ngStyle",14!=t._trnMainService.TrnMainObj.VoucherType&&"abbreviated-sales-invoice"!=t.activeurlpath||"lite"!=t.AppMode?null:e.DdM(45,Jt)),e.xp6(3),e.Q6J("ngIf",t.ShowTransactionMode),e.xp6(1),e.Q6J("ngIf",1==t.userSetting.SHOWTRNDATE&&"lite"!=t.AppMode),e.xp6(1),e.Q6J("ngIf",1==t.userSetting.SHOWTRNDATE&&"lite"==t.AppMode&&"abbreviated-sales-invoice"!=t.activeurlpath),e.xp6(1),e.Q6J("ngIf",14==t._trnMainService.TrnMainObj.VoucherType||43==t._trnMainService.TrnMainObj.VoucherType||1==t._trnMainService.TrnMainObj.VoucherType||15==t._trnMainService.TrnMainObj.VoucherType||57==t._trnMainService.TrnMainObj.VoucherType||83==t._trnMainService.TrnMainObj.VoucherType||86==t._trnMainService.TrnMainObj.VoucherType||64==t._trnMainService.TrnMainObj.VoucherType||41==t._trnMainService.TrnMainObj.VoucherType||73==t._trnMainService.TrnMainObj.VoucherType||46==t._trnMainService.TrnMainObj.VoucherType||21==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",2==t._trnMainService.TrnMainObj.VoucherType||61==t._trnMainService.TrnMainObj.VoucherType||"canceladdsientry"==t.activeurlpath),e.xp6(1),e.Q6J("ngIf",15==t._trnMainService.TrnMainObj.VoucherType||41==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",15==t._trnMainService.TrnMainObj.VoucherType||41==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",1==t.userSetting.REFBILLCOMPULSORINDNOTE&&15==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",14==t._trnMainService.TrnMainObj.VoucherType||43==t._trnMainService.TrnMainObj.VoucherType||57==t._trnMainService.TrnMainObj.VoucherType||64==t._trnMainService.TrnMainObj.VoucherType||73==t._trnMainService.TrnMainObj.VoucherType||83==t._trnMainService.TrnMainObj.VoucherType||86==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",64==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",21==t._trnMainService.TrnMainObj.VoucherType||46==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",21==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf","export-sales-invoice"==t.activeurlpath),e.xp6(1),e.Q6J("ngIf",1==t.userSetting.EnableJobCardEntry&&14==t._trnMainService.TrnMainObj.VoucherType&&"lite"!=t.AppMode),e.xp6(1),e.Q6J("ngIf",1==t.userSetting.ENABLEMULTISPRINTFORMAT&&14==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",t.showReferenceBill()),e.xp6(1),e.Q6J("ngIf",64!=t._trnMainService.TrnMainObj.VoucherType&&15==t._trnMainService.TrnMainObj.VoucherType&&"lite"==t.AppMode||64!=t._trnMainService.TrnMainObj.VoucherType&&"pro"==t.AppMode),e.xp6(4),e.Oqu(t.customerLabel),e.xp6(1),e.MGl("placeholder","Press ENTER to Select ",t.customerLabel,""),e.Q6J("disabled",t.disableCustomerField())("readOnly",!0)("ngModel",t._trnMainService.TrnMainObj.BILLTO),e.xp6(2),e.Q6J("ngIf",t.showAddButton()&&!t.hideCustomerPlus()),e.xp6(1),e.Q6J("ngIf",1==t.masterService.ShowMore),e.xp6(1),e.Q6J("ngIf","lite"==t.AppMode&&(14==t._trnMainService.TrnMainObj.VoucherType||"abbreviated-sales-invoice"==t.activeurlpath)),e.xp6(1),e.Q6J("ngIf",64==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("popupsettings",t.gridPopupSettingsForCustomer),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForSalesMan),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForRefBill),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForWarehouse),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForCustomerListBySalesmanAndRoute),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForTaxCancel),e.xp6(2),e.Q6J("popupsettings",t.newgridPopupSettingsForTaxCancel),e.xp6(2),e.Q6J("popupsettings",t.newgridPopupSettingsForSalesReturn),e.xp6(2),e.Q6J("popupsettings",t.newgridPopupSettingsForDeliveryChalanReturn),e.xp6(2),e.Q6J("popupsettings",t.genericGridAccountSetting),e.xp6(2),e.Q6J("popupsettings",t.genericGridSalesOrderSetting),e.xp6(8),e.Q6J("popupsettings",t.genericGridJobCardNoSetting),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForVehicleNo),e.xp6(2),e.Q6J("ngIf",t._trnMainService.showDiscountAuth),e.xp6(1),e.Q6J("ngIf",t._trnMainService.showFlatDiscOption),e.xp6(1),e.Q6J("ngIf",t.showAdditionalFlatDiscountPopUp),e.xp6(1),e.Q6J("ngIf",t.addNewPayment),e.xp6(1),e.Q6J("ngIf",t.addNewDeclineRemark))},dependencies:[T.mk,T.sg,T.O5,T.PC,p._Y,p.YN,p.Kr,p.Fj,p.wV,p.Wl,p.EJ,p.JJ,p.JL,p.On,p.sg,p.u,u.Zl,Y.QE,we.X,Ze.c,Fe.r,ke.v,Ue.u],styles:['.prefixYes[_ngcontent-%COMP%] {\n        width: 34%;\n    }\n    \n    .prefixNo[_ngcontent-%COMP%] {\n        width: 88%;\n    }\n    \n    .btn[_ngcontent-%COMP%] {\n        width: 65px;\n    }\n\n    .add[_ngcontent-%COMP%]{\n  color: #2E8B57;\n  border: 2px solid #2E8B57;\n  margin-left: 2px;\n}\n\nspan.add[_ngcontent-%COMP%]:hover{\ncolor: #04AA6D;\nborder-color:#04AA6D;\n}\n\nspan.add[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{\n  position: absolute;\n  left: 50%;\n  top:50%;\n  transform: translate(-50%, -50%);\n}\n\nspan.add[_ngcontent-%COMP%]{\n  display: inline-block;\n    width: 15px;\n    height: 15px;\n    text-align: center;\n    font-size: 16px;\n    font-family: "Roboto";\n    border-radius: 50%;\n    background: #F7F7F7;\n    position: relative;\n    cursor: pointer;\n    margin-top: 7px;\n}\n.add-discount-button[_ngcontent-%COMP%] {\n      position: relative;\n      display: inline-block;\n      cursor: pointer;\n    }\n\n.add-discount-button[_ngcontent-%COMP%]   .quotation[_ngcontent-%COMP%]{\n    bottom: -500% !important;\n    right: 150% !important;\n}\n.add-discount-button[_ngcontent-%COMP%]   .tooltip-text[_ngcontent-%COMP%] {\n  visibility: hidden;\n  width: 100px;\n  background-color: #555;\n  color: #fff;\n  text-align: center;\n  border-radius: 5px;\n  padding: 5px;\n  position: absolute;\n  z-index: 1;\n  bottom: 125%;\n  right: 50%;\n  opacity: 0;\n  transition: opacity 0.3s;\n}\n\n.add-discount-button[_ngcontent-%COMP%]:hover   .tooltip-text[_ngcontent-%COMP%] {\n  visibility: visible;\n  opacity: 1;\n}\n\n.backdrop[_ngcontent-%COMP%] {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(61, 60, 60, 0.5);\n    z-index: 9999;\n  }']}),a})();var R=_(68527),x=_(58349),F=_(78159),K=_(3047),B=_(54471),se=_(32635);const Qt=["fileUploadPopup"],Yt=["genericGridMemberShip"];function Kt(a,o){1&a&&(e.TgZ(0,"div",15),e._UZ(1,"discounts-insert"),e.qZA())}function Wt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"productentry",20),e.NdJ("onClickItemSelectPopUp",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onClickPoReferenceProduct(n))}),e.qZA()}}function zt(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"productentryLite",20),e.NdJ("onClickItemSelectPopUp",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onClickPoReferenceProduct(n))}),e.qZA()}}let Xt=(()=>{class a{constructor(i,t,n,r,s,c){this.masterService=i,this._trnMainService=t,this.route=n,this.authService=r,this.loadingSerive=s,this.alertService=c,this.fileUploadPopupSettings=new k.s,this.gridPopupSettingsForMember=new u.im,this.applyReferValue=!1,this.userProfile=r.getUserProfile(),"add-creditnote-itembase"===this.route.snapshot.url[0].path?(this._trnMainService.initialFormLoad(15),this._trnMainService.pageHeading="CREDIT NOTE (SALES RETURN)",this.userSetting=this.authService.getSetting()):"add-creditnote-itembase-approval"===this.route.snapshot.url[0].path&&(this._trnMainService.initialFormLoad(15),this._trnMainService.pageHeading="CREDIT NOTE (SALES RETURN) Approval",this.userSetting=this.authService.getSetting());try{this.route.queryParams.subscribe(h=>{if("DRILL"!=h.mode){if(h.voucher){let d=h.voucher,v=h.fromcompanyid;console.log("HO case fro alert mesage check",d,v),this.getSalesReturnInvoiceFromDistributor(d,v),this._trnMainService.fromNotification=h.fromNotification}h.status&&1==h.status&&(this._trnMainService.showPerformaApproveReject=!1)}})}catch(h){alert(h)}}updown(i){"F10"==i.code&&this.calculateMemberPointsForView()}ngOnInit(){this.route.queryParams.subscribe(i=>{if("DRILL"==i.mode){let t=i.voucher,n=[];n=t.split("-"),console.log("Drill case for Credit Note",t,n),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(t,n[1],n[2]).subscribe(r=>{console.log("what is the response here",r),"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.VoucherType=15,this._trnMainService.pageHeading="Credit Note",this._trnMainService.TrnMainObj.VoucherPrefix="CN",this._trnMainService.TrnMainObj.Mode="VIEW",this._trnMainService.TrnMainObj.ProdList.forEach(s=>{0==s.ALTERNATEQUANTIY&&(s.ALTERNATEQUANTIY=s.ALTQTY_IN),s.rowMode="VIEW"}),null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}),this._trnMainService.ReCalculateBillWithNormal())},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}else i.voucher&&this.getSalesReturnInvoiceFromDistributor(i.voucher,i.fromcompanyid),i.status&&1==i.status&&(this._trnMainService.showPerformaApproveReject=!1)}),this.fileUploadPopupSettings=Object.assign(new k.s,{title:"Sales Return",sampleFileUrl:`/downloadSampleExcelforMasterMigration?importName=${this._trnMainService.TrnMainObj.VoucherPrefix}`,uploadEndpoints:`/importFileForTransaction/${this._trnMainService.TrnMainObj.VoucherPrefix}`,allowMultiple:!1,acceptFormat:".xlsx",filename:"Sales Return Sample"})}getSalesReturnInvoiceFromDistributor(i,t){this.loadingSerive.show("Getting Data. Please Wait..."),this.masterService.loadSalesInvoiceFromSupplierHO(i,t).subscribe(n=>{if(this.loadingSerive.hide(),"ok"==n.status){if(this._trnMainService.TrnMainObj=n.result,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherType=15,this._trnMainService.TrnMainObj.VoucherPrefix="CN",this._trnMainService.TrnMainObj.VoucherAbbName="CN",this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.REFORDBILL=i,this._trnMainService.TrnMainObj.REFBILL=i,this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="",this._trnMainService.TrnMainObj.INVOICETYPE="INTERBRANCH",this._trnMainService.TrnMainObj.DIVISION=this.userProfile.CompanyInfo.INITIAL,this._trnMainService.TrnMainObj.PhiscalID=this.userProfile.CompanyInfo.PhiscalID,this._trnMainService.disableAllFieldinPurchase=!0;for(let r in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[r].inputMode=!1,this._trnMainService.TrnMainObj.ProdList[r].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[r].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[r].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[r].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[r].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].VARIANTDESCA=this._trnMainService.getVariantDescriptionFromList(this._trnMainService.TrnMainObj.ProdList[r]);this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate()}},n=>{this.loadingSerive.hide()})}onClickMemberReferIDSearch(i){this.applyReferValue=!0,this.getMemberShipList(),this.genericGridMemberShip.show()}calculateMemberPointsForView(){this.removeInvalidRowsFromprod(),this._trnMainService.TrnMainObj.ProdList.length&&this.masterService.postMemberPointCalculation(this._trnMainService.TrnMainObj).subscribe(i=>{"ok"==i.status&&(this._trnMainService.TrnMainObj.EARNPOINS=i.result.pointsGained,this._trnMainService.TrnMainObj.TOTMEMPOINTS=i.result2)})}removeInvalidRowsFromprod(){this._trnMainService.TrnMainObj.ProdList.length>1&&(this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(i=>null!=i.MCODE&&""!=i.MCODE))}onClickMemberIDSearch(i){this.getMemberShipList(),this.genericGridMemberShip.show()}getMemberShipList(){this.gridPopupSettingsForMember=this.masterService.getGenericGridPopUpSettings("MemberList")}showSalesInvoicePopup(i){null!=this._trnMainService.TrnMainObj.BILLTOADD&&""!=this._trnMainService.TrnMainObj.BILLTOADD?this.fileUploadPopup.show():this.alertService.warning("Please select the account...")}fileUploadSuccess(i){if("ok"==i.status){if(this._trnMainService.TrnMainObj.ProdList=i.result,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherType=15,this._trnMainService.TrnMainObj.VoucherPrefix="CN",this._trnMainService.TrnMainObj.VoucherAbbName="CN",this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="";for(let t of this._trnMainService.TrnMainObj.ProdList)t.MFGDATE=null==t.MFGDATE?"":t.MFGDATE.toString().substring(0,10),t.EXPDATE=null==t.EXPDATE?"":t.EXPDATE.toString().substring(0,10),t.REALRATE=t.ALTRATE/t.ALTCONFACTOR,t.RATE=t.ALTRATE/t.ALTCONFACTOR;this._trnMainService.ReCalculateBillWithNormal()}}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(I.P),e.Y36(f.p),e.Y36(L.gz),e.Y36(P.e),e.Y36(y.V),e.Y36(D.c))},a.\u0275cmp=e.Xpm({type:a,selectors:[["creditnote-itembase"]],viewQuery:function(i,t){if(1&i&&(e.Gf(Qt,5),e.Gf(Yt,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.fileUploadPopup=n.first),e.iGM(n=e.CRH())&&(t.genericGridMemberShip=n.first)}},hostBindings:function(i,t){1&i&&e.NdJ("keydown",function(r){return t.updown(r)},!1,e.evT)},features:[e._Bn([f.p])],decls:27,vars:8,consts:[[1,"sectionWrapper"],[1,"topWrapper"],[1,"sticky-top",2,"padding-bottom","1px"],[1,"row","clearfix"],[1,"col-md-2"],[1,"col-md-3"],[2,"white-space","nowrap","margin-left","-145px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[3,"onMemberIDSearch","onMemberReferIDSearch","onClickSlider"],[1,"col-md-7"],[3,"buttonShow","onFileUploadPopupEmit"],[1,"main-container"],[3,"hidden"],[1,"row","row-margin"],["class","col-md-12 pd5",4,"ngIf"],[1,"midTableWrapper"],[1,"col-md-12","pd5"],[3,"onClickItemSelectPopUp",4,"ngIf"],[1,"footer-wrapper"],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],[3,"onClickItemSelectPopUp"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"voucher-master-toggler"),e.qZA(),e.TgZ(6,"div",5)(7,"label",6),e._uU(8),e.qZA(),e.TgZ(9,"div")(10,"voucher-sidebar-billdetail",7),e.NdJ("onMemberIDSearch",function(r){return t.onClickMemberIDSearch(r)})("onMemberReferIDSearch",function(r){return t.onClickMemberReferIDSearch(r)})("onClickSlider",function(){return t.calculateMemberPointsForView()}),e.qZA()()(),e.TgZ(11,"div",8)(12,"voucher-master-action",9),e.NdJ("onFileUploadPopupEmit",function(r){return t.showSalesInvoicePopup(r)}),e.qZA()()()(),e.TgZ(13,"div",10)(14,"div",11),e._UZ(15,"trnmain-parameters-master"),e.qZA(),e.TgZ(16,"div",12),e.YNc(17,Kt,2,0,"div",13),e.qZA()()(),e.TgZ(18,"div",14)(19,"div",12)(20,"div",15),e.YNc(21,Wt,1,0,"productentry",16),e.YNc(22,zt,1,0,"productentryLite",16),e.qZA()()(),e.TgZ(23,"div",17),e._UZ(24,"voucher-total-area"),e.qZA()(),e.TgZ(25,"file-uploader-popup",18,19),e.NdJ("onUploaded",function(r){return t.fileUploadSuccess(r)}),e.qZA()),2&i&&(e.xp6(8),e.AsE("",t._trnMainService.pageHeading," [",t._trnMainService.TrnMainObj.Mode,"]"),e.xp6(4),e.Q6J("buttonShow",!1),e.xp6(2),e.Q6J("hidden",!t.masterService.ShowMore),e.xp6(3),e.Q6J("ngIf",1==t.masterService.userSetting.GblBarcodeWiseBilling),e.xp6(4),e.Q6J("ngIf","pro"==t._trnMainService.AppMode),e.xp6(1),e.Q6J("ngIf","lite"==t._trnMainService.AppMode),e.xp6(3),e.Q6J("popupsettings",t.fileUploadPopupSettings))},dependencies:[T.O5,V.x,U,R.q,x.i,F.u,K.d,k.U,B.o,se.j],styles:[".table-summary[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{font-size:10px}.table-summary[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child{text-align:left!important}"]}),a})(),$t=(()=>{class a{constructor(){}}return a.\u0275fac=function(i){return new(i||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["sales"]],decls:1,vars:0,template:function(i,t){1&i&&e._UZ(0,"router-outlet")},dependencies:[L.lC],encapsulation:2}),a})(),en=(()=>{class a{constructor(i,t,n,r,s){this._fb=i,this.masterservice=t,this._trnMainService=n,this.alertService=r,this.loadingSerive=s,this.isActive=!1,this.CustomerForm=i.group({CUSTNAME:["",p.kI.required],MOBILENO:["",p.kI.required],ADDRESS:["",p.kI.required]})}show(){this.isActive=!0}hide(){this.isActive=!1}onClickCustomerHide(){this.hide()}onClickCreateCustomer(){}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(p.qu),e.Y36(I.P),e.Y36(f.p),e.Y36(D.c),e.Y36(y.V))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-create-customer"]],decls:23,vars:4,consts:[[3,"formGroup"],[1,"modal-sticky",2,"display","block","padding","0px"],[1,"modal-content",2,"background-color","#f1f1f1","width","30% !important","height","200px","border","1px solid","margin-top","6%","margin-right","15%","border","1px solid"],[1,"modal-header",2,"padding","0px","background","#f1f1f1"],[1,"modal-title",2,"text-align","center"],[1,"row",2,"margin-top","10px"],["type","text","formControlName","CUSTNAME","placeholder","Customer Name",2,"width","100px","margin-left","8%","width","50%","margin-left","8%"],[1,"row"],["type","number","placeholder","Mobile","formControlName","MOBILENO",2,"width","100px","margin-left","8%","width","50%","margin-left","8%"],["type","text","placeholder","Address","formControlName","ADDRESS",2,"width","100px","margin-left","8%","width","50%","margin-left","8%"],[1,"col-md-12",2,"margin-top","20px"],[1,"btn","btn-info",2,"height","26px","width","100px",3,"disabled","click"],[1,"btn","btn-info",2,"height","26px","width","100px",3,"click"]],template:function(i,t){1&i&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e._uU(5," Create Customer "),e.qZA()(),e.TgZ(6,"div",5)(7,"label"),e._uU(8,"Customer Name"),e.qZA(),e._UZ(9,"input",6),e.qZA(),e.TgZ(10,"div",7)(11,"label"),e._uU(12,"Mobile"),e.qZA(),e._UZ(13,"input",8),e.qZA(),e.TgZ(14,"div",7)(15,"label"),e._uU(16,"Address"),e.qZA(),e._UZ(17,"input",9),e.qZA(),e.TgZ(18,"div",10)(19,"button",11),e.NdJ("click",function(){return t.onClickCreateCustomer()}),e._uU(20,"Create"),e.qZA(),e.TgZ(21,"button",12),e.NdJ("click",function(){return t.onClickCustomerHide()}),e._uU(22,"Cancel"),e.qZA()()()()()),2&i&&(e.Q6J("formGroup",t.CustomerForm),e.xp6(1),e.ekj("modal-sticky-hide",!t.isActive),e.xp6(18),e.Q6J("disabled",!t.CustomerForm.valid))},dependencies:[p._Y,p.Fj,p.wV,p.JJ,p.JL,p.sg,p.u],styles:[".modal-dialog.modal-md[_ngcontent-%COMP%], .modal-dialog.modal-sm[_ngcontent-%COMP%]{top:45%;margin-top:0}.btn-file[_ngcontent-%COMP%]{position:relative;overflow:hidden}.btn-file[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:0;right:0;min-width:100%;min-height:100%;font-size:100px;text-align:right;filter:alpha(opacity=0);opacity:0;outline:none;background:white;cursor:inherit;display:block}",".modal-content[_ngcontent-%COMP%] {\n      padding: 1px;\n      margin: 0px;\n      float: right;\n  }\n\n  .table-scroll[_ngcontent-%COMP%] {\n      overflow-y: scroll;\n      overflow-x: hidden;\n  }\n\n  tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover {\n      background-color: #f3f5f4;\n      cursor: pointer;\n  }\n\n  tr[_ngcontent-%COMP%] {\n      font-size: 11px;\n  }\n\n  .selected-row[_ngcontent-%COMP%] {\n      background-color: #ced6d3 !important;\n  }\n\n  td[_ngcontent-%COMP%] {\n      padding: 2px;\n      border: 1px solid black;\n  }\n\n  th[_ngcontent-%COMP%] {\n      padding: 2px;\n      border: 1px solid black;\n  }\n\n  .modal-sticky[_ngcontent-%COMP%] {\n      position: fixed;\n      bottom: 45px;\n      right: 14%;\n      width: 120%;\n      height: 76%;\n      z-index: 2;\n  }\n\n  .input[_ngcontent-%COMP%] {\n      width: 80%\n  }\n\n  td[_ngcontent-%COMP%] {\n      line-height: 0px !important;\n      height: 26px\n  }\n\n  .table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%] {\n      border-top: 0px solid gainsboro !important;\n  }\n\n  .TopMargin[_ngcontent-%COMP%] {\n      Margin-Top: 10px\n  }\n\n  .table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child {\n      text-align: left !important;\n  }\n\n  input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button {\n      -webkit-appearance: none;\n      margin: 0;\n  }\n\n  label[_ngcontent-%COMP%] {\n      \n      \n      \n      \n      font-size: 13px;\n      padding-top: 6px;\n      margin-left: 8%;\n      width: 25%\n  }"]}),a})();const tn=["genericGridSO"],nn=["genericPerformaInvoiceGridSO"],rn=["genericCancelSales"],an=["popupCustomerCreation"],on=["genericGridSalesMan"],sn=["genericGridSalesManRoute"],ln=["genericGridCustomerListBySalesmanAndRoute"];function cn(a,o){if(1&a&&(e.ynx(0),e.TgZ(1,"div",7)(2,"span")(3,"b"),e._uU(4,"PO Qty:"),e.qZA(),e._uU(5),e.qZA()(),e.TgZ(6,"div",22)(7,"span")(8,"b"),e._uU(9,"Rate:"),e.qZA(),e._uU(10),e.ALo(11,"currency"),e.qZA()(),e.BQk()),2&a){const i=e.oxw();e.xp6(5),e.hij("\xa0",i._trnMainService.purchaseOrderQty," \xa0"),e.xp6(5),e.hij("\xa0",e.Dn7(11,2,i._trnMainService.purchaseOrderRate,"INR","Rs. ")," ")}}let dn=(()=>{class a{constructor(i,t,n,r,s,c){this.masterService=i,this._trnMainService=t,this.route=n,this.alertService=r,this.loadingSerive=s,this.authservice=c,this.hideShow=!1,this.salesManList=[],this.routerMasterList=[],this.userProfile={},this.RouteList=[],this.CustomerList=[],this.gridPopupSettings=new u.im,this.gridPerformaInvoicePopupSettings=new u.im,this.gridcancelSalesPopupSettings=new u.im,this.gridPopupSettingsForSalesMan=new u.im,this.gridPopupSettingsForSalesManRoute=new u.im,this.gridPopupSettingsForCustomerListBySalesmanAndRoute=new u.im,this.userProfile=c.getUserProfile(),this.userSetting=this.authservice.getSetting(),"canceladdsientry"==this.route.snapshot.url[0].path?this._trnMainService.initialFormLoad(61):"addsientry"==this.route.snapshot.url[0].path&&this._trnMainService.initialFormLoad(14),this.masterService.getSalesmanList().subscribe(h=>{this.salesManList.push(h)}),this.gridPopupSettings={title:"Sales Vouchers",apiEndpoints:"/getTrnMainPagedList/SO/tag",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"Voucher No.",hidden:!1,noSearch:!1},{key:"DIVISION",title:"Division",hidden:!1,noSearch:!1},{key:"TRNAC",title:"Trn. A/c",hidden:!1,noSearch:!1},{key:"PhiscalId",title:"Fiscal Year",hidden:!1,noSearch:!1}]},this.gridPerformaInvoicePopupSettings={title:"Approved Proforma Vouchers",apiEndpoints:"/getApprovedHOPerformaInvoicePagedList",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"Voucher No.",hidden:!1,noSearch:!1},{key:"BILLTO",title:"Customer Name",hidden:!1,noSearch:!1},{key:"BILLTOTEL",title:"VAT NO.",hidden:!1,noSearch:!1}]},this.gridcancelSalesPopupSettings={title:"Sales Invoice ",apiEndpoints:"/getTrnMainDateWisePagedList/TI",defaultFilterIndex:0,columns:[{key:"CHALANNO",title:"BILL NO",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"DATE",hidden:!1,noSearch:!1},{key:"TRNMODE",title:"TYPE",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"AMOUNT",hidden:!1,noSearch:!1}]},this.route.queryParams.subscribe(h=>{h.voucher&&this.getSelectedPerformaInvoice(h.voucher)})}getSalesManList(){this.gridPopupSettingsForSalesMan=this.masterService.getGenericGridPopUpSettings("SalesManList")}onclickOnResetPopupEmit(i){}onSalesManSelect(i){this._trnMainService.TrnMainObj.SALESMANID=i.SALESMANID,this._trnMainService.TrnMainObj.SALESMAN=i.NAME,this._trnMainService.salesmanID=i.SALESMANID,this._trnMainService.salesmanName=i.NAME,this.getSalesManRouteList(),this.genericGridSalesManRoute.show()}onRouteSelect(i){this._trnMainService.doubleClick=!0,this._trnMainService.TrnMainObj.SALESMANID=i.SALESMANID,this._trnMainService.TrnMainObj.ROUTE=i.RouteCode,this._trnMainService.routeCode=this._trnMainService.TrnMainObj.ROUTE,this._trnMainService.getCustomerListRouteAndSalesmanWise(this._trnMainService.TrnMainObj.SALESMANID,this._trnMainService.TrnMainObj.ROUTE),this.getCustomerList(),this.genericGridCustomerListBySalesmanAndRoute.show()}onCustomerSelected(i){console.log("kkmparac"),this._trnMainService.customerDoubleClick=!0,this._trnMainService.billunitevent=!0,this._trnMainService.TrnMainObj.BILLTO=i.ACNAME,this._trnMainService.TrnMainObj.TRNAC=i.ACID,this._trnMainService.TrnMainObj.PARAC=i.ACID,this._trnMainService.TrnMainObj.TRNMODE=null==i.PMODE||""==i.PMODE?"credit":i.PMODE,this.masterService.focusAnyControl("unit")}getSalesManRouteList(){this.gridPopupSettingsForSalesManRoute=this.masterService.getGenericGridSettintForSalemanRoute(this._trnMainService.TrnMainObj.SALESMANID)}getCustomerList(){this.gridPopupSettingsForCustomerListBySalesmanAndRoute=this.masterService.getGridSettingForCustomerBySalesmanRoute(this._trnMainService.TrnMainObj.SALESMANID,this._trnMainService.TrnMainObj.ROUTE)}ngOnInit(){}getSalesmanRoute(i){}showLoadFromSOPopup(i){this.genericGridSO.show()}showApprovedPreformaInvoicePopup(i){this.genericPerformaInvoiceGridSO.show()}showSalesDayWise(i){this.genericCancelSales.show()}onPerformaInvoiceSelect(i){this.getSelectedPerformaInvoice(i.VCHRNO)}oncancelSalesSelect(i){}getSelectedPerformaInvoice(i){this.loadingSerive.show("Getting data, Please wait..."),this.masterService.loadHoPerformaInvoice(i).subscribe(t=>{if(this.loadingSerive.hide(),"ok"==t.status){this._trnMainService.TrnMainObj=JSON.parse(t.result),this._trnMainService.TrnMainObj.Mode="NEW";for(let n=0;n<this._trnMainService.TrnMainObj.ProdList.length;n++)this._trnMainService.TrnMainObj.ProdList[n].inputMode=!1;console.log("prevphiscalid",this._trnMainService.TrnMainObj,this.userProfile.PhiscalYearInfo.PhiscalID),this._trnMainService.TrnMainObj.VoucherPrefix="TI",this._trnMainService.TrnMainObj.VoucherType=14,this._trnMainService.pageHeading="Tax Invoice",this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),this._trnMainService.ReCalculateBillWithNormal()}},t=>{this.loadingSerive.hide()})}onSalesOrderSelect(i){this.masterService.loadSalesInvoiceFromSalesOrder(i.VCHRNO).subscribe(t=>{if("ok"==t.status){if(this._trnMainService.TrnMainObj=JSON.parse(t.result),this._trnMainService.TrnMainObj.Mode="NEW",!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.REFBILL=i.VCHRNO,this._trnMainService.TrnMainObj.VoucherType=14,this._trnMainService.TrnMainObj.VoucherPrefix="TI",this._trnMainService.TrnMainObj.TransporterEway={},this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate();for(let r in this._trnMainService.TrnMainObj.ProdList){this._trnMainService.setAltunitDropDownForView(r),this._trnMainService.AssignSellingPriceAndDiscounts(this._trnMainService.TrnMainObj.ProdList[r].PClist,r);let s=this._trnMainService.TrnMainObj.ProdList[r].ALTUNITObj;this._trnMainService.RealQuantitySet(r,null==s?1:s.CONFACTOR),this._trnMainService.TrnMainObj.ProdList[r].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[r].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[r].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[r].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[r].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].inputMode=!0,this._trnMainService.TrnMainObj.ProdList[r].VCHRNO=this._trnMainService.TrnMainObj.VCHRNO;let h=0;this._trnMainService.TrnMainObj.ProdList[r].inputMode=!0,h=this._trnMainService.TrnMainObj.ProdList[r].PRATE}var n=this._trnMainService.TrnMainObj.ProdList.filter(r=>r.SELECTEDITEM.STOCK<=0);this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(r=>r.SELECTEDITEM.STOCK>0),this._trnMainService.ReCalculateBillWithNormal(),null!=n&&n.length>0&&this.alertService.error("Some Of the item have been excluded because of unavailable Stock")}},t=>{})}onItemDoubleClick(i){this._trnMainService.TrnMainObj.REFORDBILL=i.VCHRNO,this._trnMainService.loadSODataToSales(i.VCHRNO)}onSalesCancelSelect(i){this.loadTaxInvoiceForCancel(i.VCHRNO,i.DIVISION,i.PhiscalId)}loadTaxInvoiceForCancel(i,t,n){this.loadingSerive.show("Getting data, Please wait..."),this.masterService.LoadTransaction(i,t,n).subscribe(r=>{if(this.loadingSerive.hide(),"ok"==r.status){this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.REFBILL=i,this._trnMainService.TrnMainObj.VoucherType=61,this._trnMainService.pageHeading="Tax Invoice [Cancel]",this._trnMainService.TrnMainObj.VoucherPrefix="SC",this._trnMainService.TrnMainObj.Mode="VIEW",this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate();for(let s in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.setAltunitDropDownForViewStock(s),this._trnMainService.getPricingOfItem(s,"",!0),this._trnMainService.TrnMainObj.ProdList[s].inputMode=!1}},r=>{this.loadingSerive.hide()})}getRouteListSalesmanWise(i){this.masterService.getRouteListBasedUponSalesman(i).subscribe(t=>{this.RouteList=t})}onClickCreateCustomer(){}onClickCustomerHide(){}DisplayCustomerProfile(i){0==i&&this.popupCustomerCreation.show()}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(I.P),e.Y36(f.p),e.Y36(L.gz),e.Y36(D.c),e.Y36(y.V),e.Y36(P.e))},a.\u0275cmp=e.Xpm({type:a,selectors:[["addsales-invoice"]],viewQuery:function(i,t){if(1&i&&(e.Gf(tn,5),e.Gf(nn,5),e.Gf(rn,5),e.Gf(an,5),e.Gf(on,5),e.Gf(sn,5),e.Gf(ln,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.genericGridSO=n.first),e.iGM(n=e.CRH())&&(t.genericPerformaInvoiceGridSO=n.first),e.iGM(n=e.CRH())&&(t.genericCancelSales=n.first),e.iGM(n=e.CRH())&&(t.popupCustomerCreation=n.first),e.iGM(n=e.CRH())&&(t.genericGridSalesMan=n.first),e.iGM(n=e.CRH())&&(t.genericGridSalesManRoute=n.first),e.iGM(n=e.CRH())&&(t.genericGridCustomerListBySalesmanAndRoute=n.first)}},features:[e._Bn([f.p])],decls:35,vars:9,consts:[[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-2","pd0"],[1,"col-md-3","pd0"],[2,"color","black"],[1,"col-md-2","row",2,"padding-top","0.8vh","font-size","15px","font-style","italic","padding-left","0px","padding-right","0px"],[4,"ngIf"],[1,"col-md-5","pd0"],[3,"onLoadFromSOClickEmit","onLoadFromPerformaInvoiceClickEmit","onLoadCancelSalesEmit"],[3,"popupsettings","onItemDoubleClick"],["genericGridSO",""],["genericPerformaInvoiceGridSO",""],["genericCancelSales",""],["genericGridSalesMan",""],["genericGridSalesManRoute",""],["genericGridCustomerListBySalesmanAndRoute",""],[1,"main-container"],[3,"showCustomerProfile"],[1,"row",2,"margin-top","5px"],[1,"col-md-12","pd5"],[1,"sticky-bottom"],["popupCustomerCreation",""],[1,"col-md-6","pd0"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",3)(5,"h2",4),e._uU(6),e.qZA(),e.TgZ(7,"div"),e._UZ(8,"voucher-sidebar-billdetail"),e.qZA()(),e.TgZ(9,"div",5),e.YNc(10,cn,12,6,"ng-container",6),e.qZA(),e.TgZ(11,"div",7)(12,"voucher-master-action",8),e.NdJ("onLoadFromSOClickEmit",function(r){return t.showLoadFromSOPopup(r)})("onLoadFromPerformaInvoiceClickEmit",function(r){return t.showApprovedPreformaInvoicePopup(r)})("onLoadCancelSalesEmit",function(r){return t.showSalesDayWise(r)}),e.qZA(),e.TgZ(13,"generic-popup-grid",9,10),e.NdJ("onItemDoubleClick",function(r){return t.onSalesOrderSelect(r)}),e.qZA(),e.TgZ(15,"generic-popup-grid",9,11),e.NdJ("onItemDoubleClick",function(r){return t.onPerformaInvoiceSelect(r)}),e.qZA(),e.TgZ(17,"generic-popup-grid",9,12),e.NdJ("onItemDoubleClick",function(r){return t.onSalesCancelSelect(r)}),e.qZA(),e.TgZ(19,"generic-popup-grid",9,13),e.NdJ("onItemDoubleClick",function(r){return t.onSalesManSelect(r)}),e.qZA(),e.TgZ(21,"generic-popup-grid",9,14),e.NdJ("onItemDoubleClick",function(r){return t.onRouteSelect(r)}),e.qZA(),e.TgZ(23,"generic-popup-grid",9,15),e.NdJ("onItemDoubleClick",function(r){return t.onCustomerSelected(r)}),e.qZA()()()(),e.TgZ(25,"div",16)(26,"div")(27,"trnmain-parameters-master",17),e.NdJ("showCustomerProfile",function(r){return t.DisplayCustomerProfile(r)}),e.qZA()(),e.TgZ(28,"div",18)(29,"div",19),e._UZ(30,"productentry"),e.qZA()()(),e.TgZ(31,"div",20),e._UZ(32,"voucher-total-area"),e.qZA(),e._UZ(33,"app-create-customer",null,21)),2&i&&(e.xp6(6),e.AsE("",t._trnMainService.pageHeading,"[",t._trnMainService.TrnMainObj.Mode,"]"),e.xp6(4),e.Q6J("ngIf",0!=t.userSetting.ENABLE_SOINTI),e.xp6(3),e.Q6J("popupsettings",t.gridPopupSettings),e.xp6(2),e.Q6J("popupsettings",t.gridPerformaInvoicePopupSettings),e.xp6(2),e.Q6J("popupsettings",t.gridcancelSalesPopupSettings),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForSalesMan),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForSalesManRoute),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForCustomerListBySalesmanAndRoute))},dependencies:[T.O5,V.x,U,R.q,x.i,F.u,K.d,u.Zl,en,T.H9],styles:[".GRNPopUp[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.GRNPopUp[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#123456!important;color:#fff}.modal-dialog.modal-md[_ngcontent-%COMP%], .modal-dialog.modal-sm[_ngcontent-%COMP%]{top:45%;margin-top:0}"]}),a})();const hn=["genericGridSO"],_n=["genericGridPerformaInvoice"];function un(a,o){if(1&a&&(e.ynx(0),e.TgZ(1,"div",21)(2,"span")(3,"b"),e._uU(4,"SO Qty:"),e.qZA(),e._uU(5),e.qZA()(),e.TgZ(6,"div",22)(7,"span")(8,"b"),e._uU(9,"Rate:"),e.qZA(),e._uU(10),e.ALo(11,"currency"),e.qZA()(),e.BQk()),2&a){const i=e.oxw();e.xp6(5),e.hij("\xa0",i._trnMainService.purchaseOrderQty," \xa0"),e.xp6(5),e.hij("\xa0",e.Dn7(11,2,i._trnMainService.purchaseOrderRate,"INR","Rs. ")," ")}}function Mn(a,o){1&a&&(e.TgZ(0,"div"),e._UZ(1,"trnmain-parameters-master"),e.qZA())}function pn(a,o){1&a&&(e.TgZ(0,"div",18),e._UZ(1,"discounts-insert"),e.qZA())}let Tn=(()=>{class a{constructor(i,t,n,r,s,c,h,d,v,A){this.masterService=i,this._trnMainService=t,this.route=n,this.alertService=r,this.loadingSerive=s,this.authService=c,this.genericProductEntryService=h,this.itemKeyEventService=d,this.quantityChangeEventService=v,this.entryValidateService=A,this.gridPopupSettings=new u.im,this.gridPopupSettingsForHOPerformaRequest=new u.im,this._trnMainService.initialFormLoad(57),this.userSetting=this.authService.getSetting(),this.gridPopupSettings={title:"Proforma Vouchers",apiEndpoints:"/getTrnMainPagedList/SO/tag",defaultFilterIndex:0,columns:[{key:"CHALANNO",title:"SO NO.",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"DATE",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"AMOUNT",hidden:!1,noSearch:!1}]},this.gridPopupSettingsForHOPerformaRequest={title:"Proforma Requested Vouchers",apiEndpoints:"/getAllHOPerformaInvoicePagedList",defaultFilterIndex:0,columns:[{key:"CHALANNO",title:"PROFORMA NO.",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"DATE",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"AMOUNT",hidden:!1,noSearch:!1}]},this.route.queryParams.subscribe(O=>{O.voucher&&this.getSelectedPerofrmaVoucher(O.voucher),O.status&&1==O.status&&(this._trnMainService.showPerformaApproveReject=!1)})}ngOnInit(){this.route.queryParams.subscribe(i=>{if("DRILL"==i.mode){let t=i.voucher,n=[];n=t.split("-"),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(t,n[1],n[2]).subscribe(r=>{"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.VoucherType=57,this._trnMainService.pageHeading="Proforma Invoice",this._trnMainService.TrnMainObj.VoucherPrefix="PP",this._trnMainService.TrnMainObj.Mode="VIEW",null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}),this._trnMainService.TrnMainObj.ProdList.forEach(s=>s.rowMode="VIEW"),this._trnMainService.ReCalculateBillWithNormal())},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}else this.masterService.masterGetmethod("/gettransactionmodes").subscribe(t=>{"ok"==t.status&&(this._trnMainService.paymentmodelist=t.result)},t=>{})}),this.setProductEntryTable()}setProductEntryTable(){var i=this._trnMainService.TrnMainObj.ProdList;this.genericProductEntrySetting=new J.Vn(this._trnMainService),this.genericProductEntrySetting.columns=[{field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"40px"}},{field:"BC",header:"Barcode",hidden:!1,isActiveColumnHeader:!0,inputType:"barcodeInputText",headerNgStyle:{width:"90px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r)},{field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"350px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableItemDesc",n,r),focusTo:"ALTUNIT"},{field:"BATCH",header:"Batch",hidden:!1,isActiveColumnHeader:!0,inputType:"batch",headerNgStyle:{width:"80px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableBatch",n,r),onEnter:(n,r,s,c)=>{this.genericProductEntryService.BatchEnter(n,r,s,c)},onKeyPress:(n,r)=>{this.genericProductEntryService.onKeyDownBatch(n,r)}},{field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"unitsOption",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},focusTo:"ALTERNATEQUANTIY",disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltUnit",n,r),onEnter:(n,r,s,c)=>this.entryValidateService.AlternateUnitEnterEventClick(n,r,s,c)},{field:"ALTERNATEQUANTIY",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"ALTRATE",onChange:(n,r,s)=>this.QuantityChangeEvent_default(n,r,s),applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r)},{field:"ALTRATE",header:"Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onEnter:(n,r,s)=>this.mrpEnterEvent(n,r,s),onChange:(n,r,s,c)=>this.entryValidateService.MRPChangeEvent(n,r,s,c),focusTo:"INDDISCOUNTRATE",disablePipe:(n,r)=>this.getColumnDisablePipe("disableRateandDiscount",n,r)},{field:"AMOUNT",header:"Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"INDDISCOUNTRATE",header:"Dis%",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountRate",n,r),applyTwoDigitPipe:!1,onEnter:(n,r,s)=>{this.genericProductEntryService.discRateEnterClicked(n,r,s),this.genericProductEntryService.IndDiscountRateChangeEvent(n,s,r)},onChange:(n,r,s)=>this.genericProductEntryService.IndDiscountRateChangeEvent(n,r,s),focusTo:"INDDISCOUNT",decimalPlacesRestriction:"2"},{field:"INDDISCOUNT",header:"Dis Amt",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountAmount",n,r),applyTwoDigitPipe:!0,onEnter:(n,r,s)=>{this.genericProductEntryService.discEnterClicked(n,r,s)},onChange:(n,r,s,c)=>this.genericProductEntryService.IndDiscountAmountChangeEvent(n,r,s,c),focusTo:"ITEMDESC",decimalPlacesRestriction:"2"},{field:"VAT",header:"VAT",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"70px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"}}],this.genericProductEntrySetting.height="100%",this.genericProductEntrySetting.prodlist=i,this.genericProductEntrySetting.voucherType=l.Km.PerformaSalesInvoice,this.genericProductEntrySetting.setRowItemFromSelectedItem=n=>this.SetRowItemFromSelectedItem(n),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(n,r=new Function)=>this.SetRowItemRate(n,r)}showGenericGrid(i){this.itemKeyEventService.ItemkeyEvent(i.index,i.event,()=>S.K.default,t=>S.K.default,()=>S.K.default,()=>S.K.default,()=>S.K.default)}SetRowItemFromSelectedItem(i){let t=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];this._trnMainService.prepareItem(t,i),this._trnMainService.assignPrateaAsRATE(t,i)}SetAllUnitsOfItem(){this._trnMainService.getAllUnitsOfItem(this.genericProductEntryService.activerowIndex)}QuantityChangeEvent_default(i,t,n){this.quantityChangeEventService.QuantityChangeEvent(n)}SetRowItemRate(i,t){t()}getColumnDisablePipe(i,t,n){return i}mrpEnterEvent(i,t,n){this.entryValidateService.mrpEnterEvent(i,t,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}showLoadFromSOPopup(i){this.genericGridSO.show()}showLoadFromPerformaInvoiceRequestPopup(i){this.genericGridPerformaInvoice.show()}onSalesOrderSelect(i){this.masterService.loadSalesInvoiceFromSalesOrder(i.VCHRNO).subscribe(t=>{if("ok"==t.status){if(this._trnMainService.TrnMainObj=JSON.parse(t.result),this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.REFBILL=i.VCHRNO,this._trnMainService.TrnMainObj.VoucherType=57,this._trnMainService.TrnMainObj.VoucherPrefix="PP",this._trnMainService.TrnMainObj.TransporterEway={},this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;for(let r in this._trnMainService.TrnMainObj.ProdList){this._trnMainService.setAltunitDropDownForView(r),this._trnMainService.AssignSellingPriceAndDiscounts(this._trnMainService.TrnMainObj.ProdList[r].PClist,r);let s=this._trnMainService.TrnMainObj.ProdList[r].ALTUNITObj;this._trnMainService.RealQuantitySet(r,null==s?1:s.CONFACTOR),this._trnMainService.TrnMainObj.ProdList[r].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[r].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[r].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[r].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[r].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].inputMode=!0,this._trnMainService.TrnMainObj.ProdList[r].VCHRNO=this._trnMainService.TrnMainObj.VCHRNO;let h=0;this._trnMainService.TrnMainObj.ProdList[r].inputMode=!0,h=this._trnMainService.TrnMainObj.ProdList[r].PRATE}var n=this._trnMainService.TrnMainObj.ProdList.filter(r=>r.SELECTEDITEM.STOCK<=0);this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(r=>r.SELECTEDITEM.STOCK>0),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.showPerformaApproveReject=!1,this._trnMainService.TrnMainObj.Mode="NEW",null!=n&&n.length>0&&this.alertService.error("Some Of the item have been excluded because of unavailable Stock")}},t=>{})}onHoPerformaInvoiceClicked(i){this.getSelectedPerofrmaVoucher(i.VCHRNO)}getSelectedPerofrmaVoucher(i){this.loadingSerive.show("Getting data, Please wait..."),this.masterService.loadHoPerformaInvoice(i).subscribe(t=>{if(this.loadingSerive.hide(),"ok"==t.status){this._trnMainService.TrnMainObj=JSON.parse(t.result);for(let n in this._trnMainService.TrnMainObj.ProdList){this._trnMainService.setAltunitDropDownForView(n),this._trnMainService.AssignSellingPriceAndDiscounts(this._trnMainService.TrnMainObj.ProdList[n].PClist,n);let r=this._trnMainService.TrnMainObj.ProdList[n].ALTUNITObj;this._trnMainService.RealQuantitySet(n,null==r?1:r.CONFACTOR),this._trnMainService.TrnMainObj.ProdList[n].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[n].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[n].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[n].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[n].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[n].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[n].inputMode=!0,this._trnMainService.TrnMainObj.ProdList[n].VCHRNO=this._trnMainService.TrnMainObj.VCHRNO;let c=0;this._trnMainService.TrnMainObj.ProdList[n].inputMode=!0,c=this._trnMainService.TrnMainObj.ProdList[n].PRATE}this._trnMainService.TrnMainObj.VoucherType=57,this._trnMainService.TrnMainObj.VoucherPrefix="PP",this._trnMainService.TrnMainObj.Mode="VIEW",this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.showPerformaApproveReject=!0}},t=>{this.loadingSerive.hide()})}onItemDoubleClick(i){this._trnMainService.TrnMainObj.REFORDBILL=i.VCHRNO,this._trnMainService.loadSODataToSales(i.VCHRNO)}onClickPoReferenceProduct(i){console.log("PERFORMA INVOUCE",i),i&&(this._trnMainService.purchaseOrderQty=i.ALTERNATEQTY,this._trnMainService.purchaseOrderRate=i.RATE)}updown(i){"F10"==i.code&&this._trnMainService.rounding()}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(I.P),e.Y36(f.p),e.Y36(L.gz),e.Y36(D.c),e.Y36(y.V),e.Y36(P.e),e.Y36(j.w),e.Y36(S.X),e.Y36(w.s),e.Y36(Z.C))},a.\u0275cmp=e.Xpm({type:a,selectors:[["add-performa-invoice"]],viewQuery:function(i,t){if(1&i&&(e.Gf(hn,5),e.Gf(_n,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.genericGridSO=n.first),e.iGM(n=e.CRH())&&(t.genericGridPerformaInvoice=n.first)}},hostBindings:function(i,t){1&i&&e.NdJ("keydown",function(r){return t.updown(r)},!1,e.evT)},features:[e._Bn([f.p,Z.C,S.X,j.w,w.s])],decls:28,vars:7,consts:[[1,"sectionWrapper"],[1,"topWrapper"],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-2"],[1,"col-md-3"],[2,"white-space","nowrap","margin-left","-145px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-2","row",2,"padding-top","0.8vh","font-size","15px","font-style","italic","padding-left","0px","padding-right","0px"],[4,"ngIf"],[1,"col-md-5"],[3,"onLoadFromSOClickEmit","onLoadFromHOPerformaInvoiceClickEmit"],[3,"popupsettings","onItemDoubleClick"],["genericGridSO",""],["genericGridPerformaInvoice",""],[1,"main-container"],[1,"row","row-margin"],["class","col-md-12 pd5",4,"ngIf"],[1,"midTableWrapper"],[1,"col-md-12","pd5"],[3,"onClickItemSelectPopUp"],[1,"footer-wrapper"],[1,"col-md-5","pd0"],[1,"col-md-7","pd0"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"voucher-master-toggler"),e.qZA(),e.TgZ(6,"div",5)(7,"label",6),e._uU(8),e.qZA(),e._UZ(9,"voucher-sidebar-billdetail"),e.qZA(),e.TgZ(10,"div",7),e.YNc(11,un,12,6,"ng-container",8),e.qZA(),e.TgZ(12,"div",9)(13,"voucher-master-action",10),e.NdJ("onLoadFromSOClickEmit",function(r){return t.showLoadFromSOPopup(r)})("onLoadFromHOPerformaInvoiceClickEmit",function(r){return t.showLoadFromPerformaInvoiceRequestPopup(r)}),e.qZA(),e.TgZ(14,"generic-popup-grid",11,12),e.NdJ("onItemDoubleClick",function(r){return t.onSalesOrderSelect(r)}),e.qZA(),e.TgZ(16,"generic-popup-grid",11,13),e.NdJ("onItemDoubleClick",function(r){return t.onHoPerformaInvoiceClicked(r)}),e.qZA()()()(),e.TgZ(18,"div",14),e.YNc(19,Mn,2,0,"div",8),e.TgZ(20,"div",15),e.YNc(21,pn,2,0,"div",16),e.qZA()()(),e.TgZ(22,"div",17)(23,"div",15)(24,"div",18)(25,"productentry",19),e.NdJ("onClickItemSelectPopUp",function(r){return t.onClickPoReferenceProduct(r)}),e.qZA()()()(),e.TgZ(26,"div",20),e._UZ(27,"voucher-total-area"),e.qZA()()),2&i&&(e.xp6(8),e.AsE("",t._trnMainService.pageHeading," [",t._trnMainService.TrnMainObj.Mode,"]"),e.xp6(3),e.Q6J("ngIf",(0!=t.userSetting.ENABLE_SOINTI||0!=t.userSetting.PERFOMASOBILLMODE)&&t._trnMainService.TrnMainObj.REFORDBILL),e.xp6(3),e.Q6J("popupsettings",t.gridPopupSettings),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForHOPerformaRequest),e.xp6(3),e.Q6J("ngIf",t.masterService.ShowMore),e.xp6(2),e.Q6J("ngIf",1==t.masterService.userSetting.GblBarcodeWiseBilling))},dependencies:[T.O5,V.x,U,R.q,x.i,F.u,K.d,u.Zl,B.o,T.H9],styles:[".GRNPopUp[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.GRNPopUp[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#123456!important;color:#fff}.modal-dialog.modal-md[_ngcontent-%COMP%], .modal-dialog.modal-sm[_ngcontent-%COMP%]{top:45%;margin-top:0}.table-summary[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{font-size:12px;font-weight:700}.table-summary[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child{text-align:left!important}"]}),a})();const Sn=["genericHOSalesInvoiceGridTI"],vn=["genericsGridSAPPI"],mn=["fileUploadPopup"],gn=["digitalSignUpload"];function bn(a,o){if(1&a&&(e.ynx(0),e.TgZ(1,"div",19)(2,"span")(3,"b"),e._uU(4,"QT Qty:"),e.qZA(),e._uU(5),e.qZA()(),e._UZ(6,"div",14),e.TgZ(7,"div",21)(8,"span")(9,"b"),e._uU(10,"Rate:"),e.qZA(),e._uU(11),e.ALo(12,"currency"),e.qZA()(),e.BQk()),2&a){const i=e.oxw(2);e.xp6(5),e.AsE("\xa0",i._trnMainService.purchaseOrderQty," \xa0 ",i._trnMainService.produstWiseOrderUnit," "),e.xp6(6),e.hij("\xa0",e.Dn7(12,3,i._trnMainService.purchaseOrderRate,"INR","Rs. ")," ")}}function fn(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",12)(1,"div",13)(2,"div",14),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",15)(5,"label",16),e._uU(6),e.qZA()(),e.TgZ(7,"div",17),e.YNc(8,bn,13,7,"ng-container",18),e.qZA(),e.TgZ(9,"div",19)(10,"voucher-master-action",20),e.NdJ("onFileUploadPopupEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showPurchaseInvoicePopup(n))})("onDigitalSignatureUploadPopupEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showDigitalSignPopup(n))}),e.qZA()()()()}if(2&a){const i=e.oxw();e.xp6(6),e.AsE("",i._trnMainService.pageHeading," [",i._trnMainService.TrnMainObj.Mode,"] "),e.xp6(2),e.Q6J("ngIf",1==i.userSetting.ENABLE_QUOTATTION_INSO&&i._trnMainService.TrnMainObj.REFORDBILL)}}function Cn(a,o){1&a&&(e.TgZ(0,"div"),e._UZ(1,"trnmain-purchase-entry",24),e.qZA())}function On(a,o){1&a&&(e.TgZ(0,"div",6),e._UZ(1,"discounts-insert"),e.qZA())}function An(a,o){if(1&a&&(e.TgZ(0,"div",22),e.YNc(1,Cn,2,0,"div",18),e.TgZ(2,"div",5),e.YNc(3,On,2,0,"div",23),e.qZA()()),2&a){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.masterService.ShowMore),e.xp6(2),e.Q6J("ngIf",1==i.masterService.userSetting.GblBarcodeWiseBilling)}}function En(a,o){1&a&&(e.TgZ(0,"div",25),e._UZ(1,"voucher-total-area"),e.qZA())}let le=(()=>{class a{constructor(i,t,n,r,s,c,h,d,v,A,O){this.masterService=i,this._trnMainService=t,this.dialog=n,this.alertService=r,this.loadingSerive=s,this.authservice=c,this.route=h,this.genericProductEntryService=d,this.itemKeyEventService=v,this.quantityChangeEventService=A,this.entryValidateService=O,this.hideShow=!1,this.fileUploadPopupSettings=new k.s,this.gridHoSalesInvoicePopupSettings=new u.im,this.gridSAPPIPopupSettings=new u.im,this.disableView=!1,this.prefix={},this.userProfile={},this.userSetting=this.authservice.getSetting(),this.appType=this.masterService.appType,this._trnMainService.initialFormLoad(20),i.Currencies=[],i.getCurrencies(),this.userProfile=c.getUserProfile(),this.route.queryParams.subscribe(M=>{"DRILL"!=M.mode&&(M.voucher&&(this.getPurchaseOrderFromCustomer(M.voucher,M.fromcompanyid,!0),this._trnMainService.fromNotification=M.fromNotification),M.status&&1==M.status&&(this._trnMainService.showPerformaApproveReject=!1))})}ngOnInit(){this.route.queryParams.subscribe(i=>{if("DRILL"==i.mode){let t=i.voucher,n=[];n=t.split("-"),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(t,n[1],n[2]).subscribe(r=>{"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.VoucherType=20,this._trnMainService.pageHeading="Sales Order",this._trnMainService.TrnMainObj.VoucherPrefix="SO",this._trnMainService.TrnMainObj.Mode="VIEW",null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}),this._trnMainService.TrnMainObj.ProdList.forEach(s=>s.rowMode="VIEW"),this._trnMainService.ReCalculateBillWithNormal())},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}else console.log(this._trnMainService.TrnMainObj),console.log(this._trnMainService.TrnMainObj.Mode),this.masterService.refreshTransactionList()}),this.fileUploadPopupSettings=Object.assign(new k.s,{title:"Sales Order",sampleFileUrl:`/downloadSampleExcelforMasterMigration?importName=${this._trnMainService.TrnMainObj.VoucherPrefix}`,uploadEndpoints:`/importFileForTransaction/${this._trnMainService.TrnMainObj.VoucherPrefix}`,allowMultiple:!1,acceptFormat:".xlsx",filename:"Sales Order Sample"}),this.setProductEntryTable()}setProductEntryTable(){var i=this._trnMainService.TrnMainObj.ProdList;this.genericProductEntrySetting=new J.Vn(this._trnMainService);var t=[{field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{width:"40px"}},{field:"MENUCODE",header:"Code",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"90px"}},{field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{width:"350px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableItemDesc",n,r),focusTo:"ALTUNIT"},{field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"unitsOption",headerNgStyle:{width:"80px"},focusTo:"ALTERNATEQUANTIY",disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltUnit",n,r),onEnter:(n,r,s,c)=>this.entryValidateService.AlternateUnitEnterEventClick(n,r,s,c)},{field:"ALTERNATEQUANTIY",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"ALTRATE",onChange:(n,r,s)=>this.QuantityChangeEvent_default(n,r,s),applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r)},{field:"ALTRATE",header:"Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onEnter:(n,r,s)=>this.mrpEnterEvent(n,r,s),onChange:(n,r,s,c)=>this.entryValidateService.MRPChangeEvent(n,r,s,c),focusTo:"INDDISCOUNTRATE",disablePipe:(n,r)=>this.getColumnDisablePipe("disableRateandDiscount",n,r)},{field:"INDDISCOUNTRATE",header:"Dis%",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountRate",n,r),applyTwoDigitPipe:!1,onEnter:(n,r,s)=>{this.genericProductEntryService.discRateEnterClicked(n,r,s),this.genericProductEntryService.IndDiscountRateChangeEvent(n,s,r)},onChange:(n,r,s)=>this.genericProductEntryService.IndDiscountRateChangeEvent(n,r,s),focusTo:"INDDISCOUNT",decimalPlacesRestriction:"2"},{field:"INDDISCOUNT",header:"Dis Amt",hidden:!1,inputType:"number",isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDiscountAmount",n,r),applyTwoDigitPipe:!0,onEnter:(n,r,s)=>{this.genericProductEntryService.discEnterClicked(n,r,s)},onChange:(n,r,s,c)=>this.genericProductEntryService.IndDiscountAmountChangeEvent(n,r,s,c),focusTo:"REMARKS",decimalPlacesRestriction:"2"},{field:"AMOUNT",header:"Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"VAT",header:"VAT",hidden:this.hideVAT(),isActiveColumnHeader:!0,headerNgStyle:{width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{width:"70px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"REMARKS",header:"Remarks",hidden:!1,isActiveColumnHeader:!0,inputType:"inputText",headerNgStyle:{width:"40px"},focusTo:"ITEMDESC",onEnter:(n,r,s,c)=>{this.entryValidateService.RemarksEnterCommand(n,r,s,c)}},{field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableDeleteRow",n,r)}];this.genericProductEntrySetting.columns=t,this.genericProductEntrySetting.height="100%",this.genericProductEntrySetting.prodlist=i,this.genericProductEntrySetting.voucherType=l.Km.PerformaSalesInvoice,this.genericProductEntrySetting.setRowItemFromSelectedItem=n=>this.SetRowItemFromSelectedItem(n),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(n,r=new Function)=>this.SetRowItemRate(n,r)}getPurchaseOrderFromCustomer(i,t,n=!1){this.loadingSerive.show("Getting Data. Please Wait..."),this.masterService.loadSalesInvoiceFromSupplierHO(i,t).subscribe(r=>{if(this.loadingSerive.hide(),"ok"==r.status){if(this._trnMainService.TrnMainObj=r.result,this._trnMainService.disableAllFieldinPurchase=!0,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;const s=_(67816);this._trnMainService.TrnMainObj.guid=s(),this._trnMainService.TrnMainObj.VoucherType=20,this._trnMainService.TrnMainObj.VoucherPrefix="SO",this._trnMainService.TrnMainObj.VoucherAbbName="SO",this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.REFBILL=i,this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="",this._trnMainService.TrnMainObj.DIVISION=this.userProfile.userDivision,this._trnMainService.TrnMainObj.PhiscalID=this.userProfile.CompanyInfo.PhiscalID,n&&(this._trnMainService.TrnMainObj.INVOICETYPE="FROMNOTIFICATION");for(let d in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[d].inputMode=!1,this._trnMainService.TrnMainObj.ProdList[d].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[d].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[d].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[d].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[d].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[d].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[d].VARIANTDESCA=this._trnMainService.getVariantDescriptionFromList(this._trnMainService.TrnMainObj.ProdList[d]);const h=this._trnMainService.TrnMainObj.ProdList.filter(d=>"Non-Discountable"===d.DISMODE&&(d.INDDISCOUNT>0||d.INDDISCOUNTRATE>0||d.FLATDISCOUNT>0)).map(d=>d.ITEMDESC);h.length>0&&this.alertService.warning(`The following items have discounts applied but are marked as Non-Discountable: ${h.join(", ")}`),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate()}},r=>{this.loadingSerive.hide()})}showGenericGrid(i){this.itemKeyEventService.ItemkeyEvent(i.index,i.event,()=>S.K.default,t=>S.K.default,()=>S.K.default,()=>S.K.default,()=>S.K.default)}getColumnDisablePipe(i,t,n){return i}SetRowItemFromSelectedItem(i){this._trnMainService.prepareItem(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex],i)}SetAllUnitsOfItem(){this._trnMainService.getAllUnitsOfItem(this.genericProductEntryService.activerowIndex)}hideVAT(){return 0==this.userSetting.ENABLE_VTEXCLUDINGRATE_INSORDER}mrpEnterEvent(i,t,n){this.entryValidateService.mrpEnterEvent(i,t,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}QuantityChangeEvent_default(i,t,n){this.quantityChangeEventService.QuantityChangeEvent(n)}SetRowItemRate(i,t){t()}showDigitalSignPopup(i){this.digitalSignUpload.show()}showPurchaseInvoicePopup(i){null!=this._trnMainService.TrnMainObj.BILLTOADD&&""!=this._trnMainService.TrnMainObj.BILLTOADD?this.fileUploadPopup.show():this.alertService.warning("Please select the Customer...")}fileUploadSuccess(i){if("ok"==i.status){if(this._trnMainService.TrnMainObj.ProdList=i.result,!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.VoucherPrefix="SO",this._trnMainService.TrnMainObj.VoucherAbbName="SO",this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.VCHRNO="",this._trnMainService.TrnMainObj.CHALANNO="";for(let t of this._trnMainService.TrnMainObj.ProdList)t.MFGDATE=null==t.MFGDATE?"":t.MFGDATE.toString().substring(0,10),t.EXPDATE=null==t.EXPDATE?"":t.EXPDATE.toString().substring(0,10),t.REALRATE=t.ALTRATE/t.ALTCONFACTOR,t.RATE=t.ALTRATE/t.ALTCONFACTOR;console.log("prodlist",this._trnMainService.TrnMainObj.ProdList),this._trnMainService.ReCalculateBillWithNormal()}}onClickPoReferenceProduct(i){i&&(this._trnMainService.purchaseOrderQty=i.ALTERNATEQTY,this._trnMainService.purchaseOrderRate=i.RATE,this._trnMainService.produstWiseOrderUnit=i.BASEUNIT)}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(I.P),e.Y36(f.p),e.Y36(z.uw),e.Y36(D.c),e.Y36(y.V),e.Y36(P.e),e.Y36(L.gz),e.Y36(j.w),e.Y36(S.X),e.Y36(w.s),e.Y36(Z.C))},a.\u0275cmp=e.Xpm({type:a,selectors:[["salesorder"]],viewQuery:function(i,t){if(1&i&&(e.Gf(Sn,5),e.Gf(vn,5),e.Gf(mn,5),e.Gf(gn,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.genericHOSalesInvoiceGridTI=n.first),e.iGM(n=e.CRH())&&(t.genericsGridSAPPI=n.first),e.iGM(n=e.CRH())&&(t.fileUploadPopup=n.first),e.iGM(n=e.CRH())&&(t.digitalSignUpload=n.first)}},features:[e._Bn([f.p,Z.C,S.X,j.w,w.s])],decls:13,vars:4,consts:[[1,"sectionWrapper"],[1,"topWrapper"],["class","sticky-top",4,"ngIf"],["class","main-container",4,"ngIf"],[1,"midTableWrapper"],[1,"row","row-margin"],[1,"col-md-12","pd5"],[3,"onClickItemSelectPopUp"],["class","footer-wrapper",4,"ngIf"],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],["digitalSignUpload",""],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-1","pd0"],[1,"col-md-3","pd0"],[2,"white-space","nowrap","margin-left","-33px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-3","row",2,"padding-top","0.8vh","font-size","15px","font-style","italic"],[4,"ngIf"],[1,"col-md-5","pd0"],[3,"onFileUploadPopupEmit","onDigitalSignatureUploadPopupEmit"],[1,"col-md-6","pd0"],[1,"main-container"],["class","col-md-12 pd5",4,"ngIf"],["viewDisable","disableView"],[1,"footer-wrapper"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,fn,11,3,"div",2),e.YNc(3,An,4,2,"div",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"productentry",7),e.NdJ("onClickItemSelectPopUp",function(r){return t.onClickPoReferenceProduct(r)}),e.qZA()()()(),e.YNc(8,En,2,0,"div",8),e.qZA(),e.TgZ(9,"file-uploader-popup",9,10),e.NdJ("onUploaded",function(r){return t.fileUploadSuccess(r)}),e.qZA(),e._UZ(11,"digital-signature-popup",null,11)),2&i&&(e.xp6(2),e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName),e.xp6(5),e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("popupsettings",t.fileUploadPopupSettings))},styles:[".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n        text-align: center;\n        vertical-align: middle;\n    }"]}),a})();const In=["genericGridSO"],Pn=["genericGridPerformaInvoice"];function Nn(a,o){1&a&&(e.TgZ(0,"div"),e._UZ(1,"trnmain-parameters-master"),e.qZA())}function Ln(a,o){1&a&&(e.TgZ(0,"div",17),e._UZ(1,"discounts-insert"),e.qZA())}let Dn=(()=>{class a{constructor(i,t,n,r,s,c){this.masterService=i,this._trnMainService=t,this.route=n,this.alertService=r,this.loadingSerive=s,this.authService=c,this.gridPopupSettings=new u.im,this.gridPopupSettingsForHOPerformaRequest=new u.im,this._trnMainService.initialFormLoad(64),this.userSetting=this.authService.getSetting(),this.gridPopupSettings={title:"Proforma Vouchers",apiEndpoints:"/getTrnMainPagedList/SO/tag",defaultFilterIndex:0,columns:[{key:"CHALANNO",title:"SO NO.",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"DATE",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"AMOUNT",hidden:!1,noSearch:!1}]},this.gridPopupSettingsForHOPerformaRequest={title:"Proforma Requested Vouchers",apiEndpoints:"/getAllHOPerformaInvoicePagedList",defaultFilterIndex:0,columns:[{key:"CHALANNO",title:"PROFORMA NO.",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"DATE",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"AMOUNT",hidden:!1,noSearch:!1}]},this.route.queryParams.subscribe(h=>{h.voucher&&this.getSelectedPerofrmaVoucher(h.voucher),h.status&&1==h.status&&(this._trnMainService.showPerformaApproveReject=!1)})}ngOnInit(){this.route.queryParams.subscribe(i=>{if("DRILL"==i.mode){let t=i.voucher,n=[];n=t.split("-"),this.loadingSerive.show("Loading Invoice"),this.masterService.LoadTransaction(t,n[1],n[2]).subscribe(r=>{"ok"==r.status&&(this.loadingSerive.hide(),this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.VoucherType=64,this._trnMainService.pageHeading="Quotation",this._trnMainService.TrnMainObj.VoucherPrefix="QT",this._trnMainService.TrnMainObj.Mode="VIEW",null==this._trnMainService.TrnMainObj.AdditionalObj&&(this._trnMainService.TrnMainObj.AdditionalObj={}),this._trnMainService.TrnMainObj.ProdList.forEach(s=>s.rowMode="VIEW"),this._trnMainService.ReCalculateBillWithNormal())},r=>{this.loadingSerive.hide(),this.alertService.error(r)})}else this.masterService.masterGetmethod("/gettransactionmodes").subscribe(t=>{"ok"==t.status&&(this._trnMainService.paymentmodelist=t.result)},t=>{})})}showLoadFromSOPopup(i){this.genericGridSO.show()}showLoadFromPerformaInvoiceRequestPopup(i){this.genericGridPerformaInvoice.show()}onSalesOrderSelect(i){this.masterService.loadSalesInvoiceFromSalesOrder(i.VCHRNO).subscribe(t=>{if("ok"==t.status){if(this._trnMainService.TrnMainObj=JSON.parse(t.result),this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.REFBILL=i.VCHRNO,this._trnMainService.TrnMainObj.VoucherType=57,this._trnMainService.TrnMainObj.VoucherPrefix="PP",this._trnMainService.TrnMainObj.TransporterEway={},this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||null==this._trnMainService.TrnMainObj.ProdList)return;for(let r in this._trnMainService.TrnMainObj.ProdList){this._trnMainService.setAltunitDropDownForView(r),this._trnMainService.AssignSellingPriceAndDiscounts(this._trnMainService.TrnMainObj.ProdList[r].PClist,r);let s=this._trnMainService.TrnMainObj.ProdList[r].ALTUNITObj;this._trnMainService.RealQuantitySet(r,null==s?1:s.CONFACTOR),this._trnMainService.TrnMainObj.ProdList[r].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[r].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[r].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[r].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[r].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].inputMode=!0,this._trnMainService.TrnMainObj.ProdList[r].VCHRNO=this._trnMainService.TrnMainObj.VCHRNO;let h=0;this._trnMainService.TrnMainObj.ProdList[r].inputMode=!0,h=this._trnMainService.TrnMainObj.ProdList[r].PRATE}var n=this._trnMainService.TrnMainObj.ProdList.filter(r=>r.SELECTEDITEM.STOCK<=0);this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(r=>r.SELECTEDITEM.STOCK>0),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.showPerformaApproveReject=!1,this._trnMainService.TrnMainObj.Mode="NEW",null!=n&&n.length>0&&this.alertService.error("Some Of the item have been excluded because of unavailable Stock")}},t=>{})}onHoPerformaInvoiceClicked(i){this.getSelectedPerofrmaVoucher(i.VCHRNO)}getSelectedPerofrmaVoucher(i){this.loadingSerive.show("Getting data, Please wait..."),this.masterService.loadHoPerformaInvoice(i).subscribe(t=>{if(this.loadingSerive.hide(),"ok"==t.status){this._trnMainService.TrnMainObj=JSON.parse(t.result);for(let n in this._trnMainService.TrnMainObj.ProdList){this._trnMainService.setAltunitDropDownForView(n),this._trnMainService.AssignSellingPriceAndDiscounts(this._trnMainService.TrnMainObj.ProdList[n].PClist,n);let r=this._trnMainService.TrnMainObj.ProdList[n].ALTUNITObj;this._trnMainService.RealQuantitySet(n,null==r?1:r.CONFACTOR),this._trnMainService.TrnMainObj.ProdList[n].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[n].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[n].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[n].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[n].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[n].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[n].inputMode=!0,this._trnMainService.TrnMainObj.ProdList[n].VCHRNO=this._trnMainService.TrnMainObj.VCHRNO;let c=0;this._trnMainService.TrnMainObj.ProdList[n].inputMode=!0,c=this._trnMainService.TrnMainObj.ProdList[n].PRATE}this._trnMainService.TrnMainObj.VoucherType=57,this._trnMainService.TrnMainObj.VoucherPrefix="PP",this._trnMainService.TrnMainObj.Mode="VIEW",this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.showPerformaApproveReject=!0}},t=>{this.loadingSerive.hide()})}onItemDoubleClick(i){this._trnMainService.TrnMainObj.REFORDBILL=i.VCHRNO,this._trnMainService.loadSODataToSales(i.VCHRNO)}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(I.P),e.Y36(f.p),e.Y36(L.gz),e.Y36(D.c),e.Y36(y.V),e.Y36(P.e))},a.\u0275cmp=e.Xpm({type:a,selectors:[["add-quotation"]],viewQuery:function(i,t){if(1&i&&(e.Gf(In,5),e.Gf(Pn,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.genericGridSO=n.first),e.iGM(n=e.CRH())&&(t.genericGridPerformaInvoice=n.first)}},features:[e._Bn([f.p])],decls:25,vars:6,consts:[[1,"sectionWrapper"],[1,"topWrapper"],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-2"],[1,"col-md-3"],[2,"white-space","nowrap","margin-left","-145px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-7"],[3,"onLoadFromSOClickEmit","onLoadFromHOPerformaInvoiceClickEmit"],[3,"popupsettings","onItemDoubleClick"],["genericGridSO",""],["genericGridPerformaInvoice",""],[1,"main-container"],[4,"ngIf"],[1,"row","row-margin"],["class","col-md-12 pd5",4,"ngIf"],[1,"midTableWrapper"],[1,"col-md-12","pd5"],[1,"footer-wrapper"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"voucher-master-toggler"),e.qZA(),e.TgZ(6,"div",5)(7,"label",6),e._uU(8),e.qZA()(),e.TgZ(9,"div",7)(10,"voucher-master-action",8),e.NdJ("onLoadFromSOClickEmit",function(r){return t.showLoadFromSOPopup(r)})("onLoadFromHOPerformaInvoiceClickEmit",function(r){return t.showLoadFromPerformaInvoiceRequestPopup(r)}),e.qZA(),e.TgZ(11,"generic-popup-grid",9,10),e.NdJ("onItemDoubleClick",function(r){return t.onSalesOrderSelect(r)}),e.qZA(),e.TgZ(13,"generic-popup-grid",9,11),e.NdJ("onItemDoubleClick",function(r){return t.onHoPerformaInvoiceClicked(r)}),e.qZA()()()(),e.TgZ(15,"div",12),e.YNc(16,Nn,2,0,"div",13),e.TgZ(17,"div",14),e.YNc(18,Ln,2,0,"div",15),e.qZA()()(),e.TgZ(19,"div",16)(20,"div",14)(21,"div",17),e._UZ(22,"productentry"),e.qZA()()(),e.TgZ(23,"div",18),e._UZ(24,"voucher-total-area"),e.qZA()()),2&i&&(e.xp6(8),e.AsE("",t._trnMainService.pageHeading," [",t._trnMainService.TrnMainObj.Mode,"]"),e.xp6(3),e.Q6J("popupsettings",t.gridPopupSettings),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForHOPerformaRequest),e.xp6(3),e.Q6J("ngIf",t.masterService.ShowMore),e.xp6(2),e.Q6J("ngIf",1==t.masterService.userSetting.GblBarcodeWiseBilling))},dependencies:[T.O5,V.x,U,R.q,x.i,F.u,u.Zl,B.o],styles:[".GRNPopUp[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.GRNPopUp[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#123456!important;color:#fff}.modal-dialog.modal-md[_ngcontent-%COMP%], .modal-dialog.modal-sm[_ngcontent-%COMP%]{top:45%;margin-top:0}.table-summary[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{font-size:12px;font-weight:700}.table-summary[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child{text-align:left!important}"]}),a})();class X{constructor(){this.SalesVoucher=[],this.REFBILL=[],this.COLLECTIONSHEET=[],this.ITEMSUMMARY=[]}}var yn=_(16738),$=_.n(yn),te=_(35732),H=_(79765),Rn=_(71180);let ce=(()=>{class a{constructor(i,t,n){this.http=i,this.authService=t,this.gblState=n,this.gblState.getGlobalSetting("apiUrl"),this.apiUrl=q.N.apiUrl,console.log("this.apiUrl",this.apiUrl)}getRequestOption(){return new te.WM({"Content-type":"application/json",Authorization:this.authService.getAuth().token,"X-Requested-With":"XMLHttpRequest"})}saveLoadChartInfo(i){let t={status:"error",result:""},n=new H.xQ,r={data:i};const s={headers:this.getRequestOption(),method:"post"};return this.http.post(this.apiUrl+"/saveDeliveryChalan",r,s).subscribe(c=>{let h=c;"ok"==h.status?(t.status="ok",t.result=h.result,n.next(t),n.unsubscribe()):(t.status="error",t.result=h.result,n.next(t),n.unsubscribe())},c=>{t.status="error",t.result=c,n.next(t),n.unsubscribe()}),n}loadInvoiceForLoadChart(i){let t={status:"error",result:""},n=new H.xQ;const r={headers:this.getRequestOption(),method:"post"};return this.http.post(`${this.apiUrl}/loadDeliveryChalanInvoice`,i,r).subscribe(s=>{let c=s;"ok"==c.status?(t.status="ok",t.result=c.result,n.next(t),n.unsubscribe()):(t.status="error",t.result=c.result,n.next(t),n.unsubscribe())},s=>{t.status="error",t.result=s,n.next(t),n.unsubscribe()}),n}loadChartItemSummary(i){let t={status:"error",result:""},n=new H.xQ;const r={headers:this.getRequestOption(),method:"post"};return this.http.post(`${this.apiUrl}/loadDeliveryChalanItemSummary`,i,r).subscribe(s=>{let c=s;"ok"==c.status?(t.status="ok",t.result=c.result,n.next(t),n.unsubscribe()):(t.status="error",t.result=c.result,n.next(t),n.unsubscribe())},s=>{t.status="error",t.result=s,n.next(t),n.unsubscribe()}),n}getLoadChartInfoVoucherWise(i){let t={status:"error",result:""},n=new H.xQ;const r={headers:this.getRequestOption(),method:"post"};return this.http.post(`${this.apiUrl}/loadDeliveryChalanVoucherWise`,{VOUCHERNO:i},r).subscribe(s=>{let c=s;"ok"==c.status?(t.status="ok",t.result=c.result,n.next(t),n.unsubscribe()):(t.status="error",t.result=c.result,n.next(t),n.unsubscribe())},s=>{t.status="error",t.result=s,n.next(t),n.unsubscribe()}),n}getCollectionSheet(i){let t={status:"error",result:""},n=new H.xQ;const r={headers:this.getRequestOption(),method:"post"};return this.http.post(`${this.apiUrl}/getCollectionSheet`,{VOUCHERNO:i},r).subscribe(s=>{let c=s;"ok"==c.status?(t.status="ok",t.result=c.result,n.next(t),n.unsubscribe()):(t.status="error",t.result=c.result,n.next(t),n.unsubscribe())},s=>{t.status="error",t.result=s,n.next(t),n.unsubscribe()}),n}cancelLoadSheet(i){let t={status:"error",result:""},n=new H.xQ;return this.http.post(`${q.N.apiUrl}/cancelLoadDeliveryChalan`,i).subscribe(r=>{"ok"==r.status?(t.status="ok",t.result=r.result,n.next(t),n.unsubscribe()):(t.status="error",t.result=r.result,n.next(t),n.unsubscribe())},r=>{t.status="error",t.result=r,n.next(t),n.unsubscribe()}),n}getDivisionWiseAllocationData(i){return this.http.post(this.apiUrl+"/getDivisionWiseAllocationData",{division:i})}viewLoadSheet(i,t,n){return this.http.post(this.apiUrl+"/viewLoadSheet",{vchrno:i,division:t,phiscalid:n})}}return a.\u0275fac=function(i){return new(i||a)(e.LFG(te.eN),e.LFG(P.e),e.LFG(Rn.q))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac}),a})();var xn=_(69389);const jn=["genericGrid"],wn=["genericSalesManGrid"],Zn=["genericBeatGrid"],Fn=["genericDivisionGrid"];function kn(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"button",46),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.save())}),e._uU(1," Save "),e.qZA()}}function Un(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.cancel())}),e._uU(1," Cancel "),e.qZA()}}function Vn(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.print())}),e._uU(1," Print "),e.qZA()}}function Bn(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.CollectionSheet())}),e._uU(1," Collection Sheet "),e.qZA()}}function Gn(a,o){if(1&a){const i=e.EpF();e.ynx(0),e.TgZ(1,"label",33),e._uU(2,"Filter Option : "),e.qZA(),e.TgZ(3,"input",61),e.NdJ("keydown.enter",function(){e.CHM(i);const n=e.oxw(3);return e.KtG(n.loadFilter())})("keydown.tab",function(){e.CHM(i);const n=e.oxw(3);return e.KtG(n.loadFilter())}),e.qZA(),e.BQk()}}function Hn(a,o){if(1&a&&(e.ynx(0),e.YNc(1,Gn,4,0,"ng-container",24),e.BQk()),2&a){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf","VIEW"!=i.LoadChartModel.MODE)}}function qn(a,o){if(1&a){const i=e.EpF();e.ynx(0,null,62),e.TgZ(2,"label",33),e._uU(3,"To Division :"),e.qZA(),e.TgZ(4,"input",63),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.LoadChartModel.DivisionName=n)})("keydown.Enter",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n.onDivisionEnter())}),e.qZA(),e.BQk()}if(2&a){const i=e.oxw(2);e.xp6(4),e.Q6J("ngModel",i.LoadChartModel.DivisionName)("disabled","VIEW"==i.LoadChartModel.MODE)}}function Jn(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",54)(1,"label",58),e._uU(2,"Sales Man Name : "),e.qZA(),e.TgZ(3,"input",64),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.LoadChartModel.SALESMANNAME=n)})("keydown.Tab",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n.onClickCustomerlist())})("keydown.Enter",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n.onClickCustomerlist())}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i.LoadChartModel.SALESMANNAME)("disabled","VIEW"==i.LoadChartModel.MODE)}}function Qn(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",54)(1,"label",58),e._uU(2,"Route No : "),e.qZA(),e.TgZ(3,"input",65),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.LoadChartModel.ROUTENO=n)}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i.LoadChartModel.ROUTENO)("disabled","VIEW"==i.LoadChartModel.MODE)}}function Yn(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",54)(1,"label",58),e._uU(2,"VCTS No. :"),e.qZA(),e.TgZ(3,"input",66),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw(2);return e.KtG(r.LoadChartModel.VCTS=n)}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngModel",i.LoadChartModel.VCTS)("disabled","VIEW"==i.LoadChartModel.MODE)}}function Kn(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",53)(1,"div",33)(2,"div",37)(3,"label",33),e._uU(4,"Load Sheet No : "),e.qZA(),e.TgZ(5,"span")(6,"b"),e._uU(7),e.qZA()()(),e.TgZ(8,"div",54),e.YNc(9,Hn,2,1,"ng-container",24),e.YNc(10,qn,5,2,"ng-container",24),e.qZA(),e.TgZ(11,"div",54)(12,"label",33),e._uU(13,"Vehicle No : "),e.qZA(),e.TgZ(14,"input",55),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.LoadChartModel.VEHICLENO=n)}),e.qZA()(),e.TgZ(15,"div",54)(16,"label",33),e._uU(17,"Driver Name : "),e.qZA(),e.TgZ(18,"input",56),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.LoadChartModel.DRIVERNAME=n)}),e.qZA()()(),e.TgZ(19,"div",57)(20,"div",54)(21,"label",58),e._uU(22,"Driver license No : "),e.qZA(),e.TgZ(23,"input",59),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.LoadChartModel.DRIVERLISCENSENO=n)}),e.qZA()(),e.YNc(24,Jn,4,2,"div",60),e.YNc(25,Qn,4,2,"div",60),e.YNc(26,Yn,4,2,"div",60),e.qZA()()}if(2&a){const i=e.oxw();e.xp6(7),e.hij(" ",i.LoadChartModel.VOUCHERNO," "),e.xp6(2),e.Q6J("ngIf",!i._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("ngIf",i._transactionService.userSetting.DispatchWiseLoadSheet&&i.userSetting.IsBBSM),e.xp6(4),e.Q6J("ngModel",i.LoadChartModel.VEHICLENO)("disabled","VIEW"==i.LoadChartModel.MODE),e.xp6(4),e.Q6J("ngModel",i.LoadChartModel.DRIVERNAME)("disabled","VIEW"==i.LoadChartModel.MODE),e.xp6(5),e.Q6J("ngModel",i.LoadChartModel.DRIVERLISCENSENO)("disabled","VIEW"==i.LoadChartModel.MODE),e.xp6(1),e.Q6J("ngIf",0==i._transactionService.userSetting.DispatchWiseLoadSheet&&i.hideSalesman()),e.xp6(1),e.Q6J("ngIf",0==i._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("ngIf",1==i._transactionService.userSetting.DispatchWiseLoadSheet&&i.userSetting.IsBBSM)}}function Wn(a,o){1&a&&e._UZ(0,"th",19)}function zn(a,o){1&a&&e._UZ(0,"th",19)}function Xn(a,o){1&a&&e._UZ(0,"th",19)}function $n(a,o){1&a&&e._UZ(0,"th",19)}function er(a,o){1&a&&(e.TgZ(0,"th",19),e._uU(1,"Batch"),e.qZA())}function ir(a,o){1&a&&(e.TgZ(0,"th",19),e._uU(1,"MFG Date"),e.qZA())}function tr(a,o){1&a&&(e.TgZ(0,"th",19),e._uU(1,"Exp Date"),e.qZA())}function nr(a,o){1&a&&(e.TgZ(0,"th",19),e._uU(1,"Net Amount"),e.qZA())}function rr(a,o){if(1&a&&(e.TgZ(0,"td",19),e._uU(1),e.qZA()),2&a){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(null==i?null:i.BATCH)}}function ar(a,o){if(1&a&&(e.TgZ(0,"td",19),e._uU(1),e.ALo(2,"date"),e.qZA()),2&a){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,null==i?null:i.MFGDATE,"dd-MM-yyyy"))}}function or(a,o){if(1&a&&(e.TgZ(0,"td",19),e._uU(1),e.ALo(2,"date"),e.qZA()),2&a){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,null==i?null:i.EXPDATE,"dd-MM-yyyy"))}}function sr(a,o){if(1&a&&(e.TgZ(0,"td",19),e._uU(1),e.qZA()),2&a){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(null==i?null:i.AltQty)}}function lr(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"td",19)(1,"input",69),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw().$implicit;return e.KtG(r.ALTERNATEQUANTIY=n)})("change",function(){e.CHM(i);const n=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.quantityChange(n))}),e.qZA()()}if(2&a){const i=e.oxw().$implicit,t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",i.ALTERNATEQUANTIY)("disabled","VIEW"==t.LoadChartModel.MODE)}}function cr(a,o){if(1&a&&(e.TgZ(0,"td",19),e._uU(1),e.ALo(2,"number"),e.qZA()),2&a){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,null==i?null:i.NETAMOUNT,"1.2-2"))}}function dr(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"td",70)(1,"div",71)(2,"button",72),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().index,r=e.oxw(2);return e.KtG(r.removeInvoiceFromListBBSM(n))}),e._UZ(3,"img",73),e.qZA()()()}}const ne=function(a){return{"font-size":a}};function hr(a,o){if(1&a&&(e.TgZ(0,"tr",22)(1,"td",18),e._uU(2),e.qZA(),e.TgZ(3,"td",19),e._uU(4),e.qZA(),e.TgZ(5,"td",20),e._uU(6),e.qZA(),e.YNc(7,rr,2,1,"td",21),e.TgZ(8,"td",19),e._uU(9),e.qZA(),e.YNc(10,ar,3,4,"td",21),e.YNc(11,or,3,4,"td",21),e.YNc(12,sr,2,1,"td",21),e.YNc(13,lr,2,2,"td",21),e.TgZ(14,"td",19),e._uU(15),e.qZA(),e.YNc(16,cr,3,4,"td",21),e.YNc(17,dr,4,0,"td",68),e.qZA()),2&a){const i=o.$implicit,t=o.index,n=e.oxw(2);e.Q6J("ngStyle",e.VKq(13,ne,1==n._transactionService.userSetting.DispatchWiseLoadSheet?"12px":"11px")),e.xp6(2),e.hij(" ",n._transactionService.nullToZeroConverter(t+1)," "),e.xp6(2),e.Oqu(null==i?null:i.MENUCODE),e.xp6(2),e.Oqu(null==i?null:i.ITEMDESC),e.xp6(1),e.Q6J("ngIf",0==n._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(2),e.Oqu(null==i?null:i.ALTUNIT),e.xp6(1),e.Q6J("ngIf",0==n._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("ngIf",0==n._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("ngIf",0==n._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("ngIf",1==n._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(2),e.Oqu(null==i?null:i.WEIGHT),e.xp6(1),e.Q6J("ngIf",0==n._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("ngIf",n._transactionService.userSetting.DispatchWiseLoadSheet&&n.userSetting.IsBBSM)}}function _r(a,o){if(1&a&&(e.ynx(0),e.YNc(1,hr,18,15,"tr",67),e.BQk()),2&a){const i=e.oxw();e.xp6(1),e.Q6J("ngForOf",i.LoadChartModel.ITEMSUMMARY)}}function ur(a,o){if(1&a&&(e.TgZ(0,"tfoot")(1,"tr")(2,"th",19),e._uU(3,"Total Weight"),e.qZA(),e._UZ(4,"th",19),e.TgZ(5,"th",20),e._uU(6),e.ALo(7,"number"),e.qZA(),e._UZ(8,"th",19)(9,"th",19)(10,"th",19)(11,"th",19)(12,"th",19)(13,"th",19)(14,"th",19),e.qZA(),e.TgZ(15,"tr")(16,"th",19),e._uU(17,"Tota No. Of Bills"),e.qZA(),e._UZ(18,"th",19),e.TgZ(19,"th",20),e._uU(20),e.ALo(21,"number"),e.qZA(),e._UZ(22,"th",19)(23,"th",19)(24,"th",19)(25,"th",19)(26,"th",19)(27,"th",19)(28,"th",19),e.qZA(),e.TgZ(29,"tr")(30,"th",19),e._uU(31,"Total Taxable"),e.qZA(),e._UZ(32,"th",19),e.TgZ(33,"th",20),e._uU(34),e.ALo(35,"number"),e.qZA(),e._UZ(36,"th",19)(37,"th",19)(38,"th",19)(39,"th",19)(40,"th",19)(41,"th",19)(42,"th",19),e.qZA(),e.TgZ(43,"tr")(44,"th",19),e._uU(45,"Total Amount"),e.qZA(),e._UZ(46,"th",19),e.TgZ(47,"th",20),e._uU(48),e.ALo(49,"number"),e.qZA(),e._UZ(50,"th",19)(51,"th",19)(52,"th",19)(53,"th",19)(54,"th",19)(55,"th",19)(56,"th",19),e.qZA()()),2&a){const i=e.oxw();e.xp6(6),e.hij(" ",e.xi3(7,4,null==i.LoadChartModel?null:i.LoadChartModel.TOTALWEIGHT,"1.2-2")," "),e.xp6(14),e.hij(" ",e.xi3(21,7,null==i.LoadChartModel?null:i.LoadChartModel.TOTALNUMBEROFBILLS,"1.2-2")," "),e.xp6(14),e.hij(" ",e.xi3(35,10,null==i.LoadChartModel?null:i.LoadChartModel.TOTALTAXABLE,"1.2-2")," "),e.xp6(14),e.hij(" ",e.xi3(49,13,null==i.LoadChartModel?null:i.LoadChartModel.TOTALAMOUNT,"1.2-2")," ")}}function Mr(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"tr",86),e.NdJ("dblclick",function(){const r=e.CHM(i).$implicit,s=e.oxw(4);return e.KtG(s.doubleClick(r))})("click",function(){const r=e.CHM(i).index,s=e.oxw(4);return e.KtG(s.singleClick(r))}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",87),e._uU(6),e.qZA(),e.TgZ(7,"td",88),e._uU(8),e.qZA()()}if(2&a){const i=o.$implicit;e.xp6(2),e.Oqu(null==i?null:i.VCHRNO),e.xp6(2),e.Oqu(null==i?null:i.TRNDATE),e.xp6(2),e.Oqu(null==i?null:i.BILLTO),e.xp6(2),e.hij(" ",null==i?null:i.NETAMNT," ")}}function pr(a,o){if(1&a&&(e.ynx(0),e.YNc(1,Mr,9,4,"tr",85),e.BQk()),2&a){const i=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",i.LoadChartModel.SalesVoucher)}}function Tr(a,o){if(1&a&&(e.TgZ(0,"div",80)(1,"div",81)(2,"div",82)(3,"table",83,16)(5,"thead")(6,"tr",79),e._UZ(7,"th",19),e.TgZ(8,"th",84),e._uU(9,"Invoice"),e.qZA(),e.TgZ(10,"th",19),e._uU(11,"List"),e.qZA(),e._UZ(12,"th",19),e.qZA(),e.TgZ(13,"tr")(14,"th",19),e._uU(15,"VCHRNO"),e.qZA(),e.TgZ(16,"th",19),e._uU(17,"TRNDATE"),e.qZA(),e.TgZ(18,"th",19),e._uU(19,"CUSTOMER NAME"),e.qZA(),e.TgZ(20,"th",19),e._uU(21,"AMOUNT"),e.qZA()()(),e.TgZ(22,"tbody",23),e.YNc(23,pr,2,1,"ng-container",24),e.qZA()()()()()),2&a){const i=e.oxw(2);e.xp6(23),e.Q6J("ngIf",i.LoadChartModel.SalesVoucher&&i.LoadChartModel.SalesVoucher.length)}}function Sr(a,o){if(1&a&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&a){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(null==i?null:i.ClientName)}}function vr(a,o){if(1&a&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&a){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(null==i?null:i.BILLTO)}}function mr(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"td")(1,"i",91),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().index,r=e.oxw(3);return e.KtG(r.removeInvoiceFromList(n))}),e._uU(2,"delete"),e.qZA()()}}function gr(a,o){if(1&a&&(e.TgZ(0,"tr")(1,"td",90),e._uU(2),e.qZA(),e.YNc(3,Sr,2,1,"td",24),e.YNc(4,vr,2,1,"td",24),e.YNc(5,mr,3,0,"td",24),e.qZA()),2&a){const i=o.$implicit,t=e.oxw(3);e.xp6(2),e.Oqu(null==i?null:i.REFBILL),e.xp6(1),e.Q6J("ngIf","EDIT"==t.LoadChartModel.MODE||"VIEW"==t.LoadChartModel.MODE),e.xp6(1),e.Q6J("ngIf","NEW"==t.LoadChartModel.MODE),e.xp6(1),e.Q6J("ngIf","VIEW"!=t.LoadChartModel.MODE)}}function br(a,o){if(1&a&&(e.ynx(0),e.YNc(1,gr,6,4,"tr",89),e.BQk()),2&a){const i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",i.LoadChartModel.REFBILL)}}function fr(a,o){if(1&a&&(e.TgZ(0,"div",74),e.YNc(1,Tr,24,1,"div",75),e.TgZ(2,"div",76)(3,"div",77)(4,"div",78)(5,"table",15,16)(7,"thead")(8,"tr",79),e._UZ(9,"th",19),e.TgZ(10,"th",19),e._uU(11,"Selected Invoice List"),e.qZA(),e._UZ(12,"th",19),e.qZA(),e.TgZ(13,"tr")(14,"th",19),e._uU(15,"VCHRNO"),e.qZA(),e.TgZ(16,"th",19),e._uU(17,"CUSTOMER NAME"),e.qZA(),e.TgZ(18,"th",19),e._uU(19,"ACTION"),e.qZA()()(),e.TgZ(20,"tbody",23),e.YNc(21,br,2,1,"ng-container",24),e.qZA()()()()()()),2&a){const i=e.oxw();e.xp6(1),e.Q6J("ngIf","VIEW"!=i.LoadChartModel.MODE),e.xp6(20),e.Q6J("ngIf",i.LoadChartModel.REFBILL.length)}}function Cr(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",88),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"i",93),e.NdJ("click",function(){const r=e.CHM(i).index,s=e.oxw(2);return e.KtG(s.removeDSM(r))}),e.qZA()()()}if(2&a){const i=o.$implicit,t=o.index,n=e.oxw(2);e.ekj("selected-row",n.activeIndex==t),e.xp6(2),e.Oqu(null==i?null:i.DSMNAME),e.xp6(2),e.hij(" ",null==i?null:i.DSMCODE," ")}}function Or(a,o){if(1&a&&(e.TgZ(0,"table")(1,"thead")(2,"tr")(3,"th"),e._uU(4,"SalesMan NAME"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"SalesMan CODE"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Action"),e.qZA()()(),e.TgZ(9,"tbody"),e.YNc(10,Cr,7,4,"tr",92),e.qZA()()),2&a){const i=e.oxw();e.xp6(10),e.Q6J("ngForOf",i.SELECTEDSALESMANLIST)}}function Ar(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"i",93),e.NdJ("click",function(){const r=e.CHM(i).index,s=e.oxw(2);return e.KtG(s.removeBEAT(r))}),e.qZA()()()}if(2&a){const i=o.$implicit,t=o.index,n=e.oxw(2);e.ekj("selected-row",n.activeIndex==t),e.xp6(2),e.Oqu(null==i?null:i.BEAT)}}function Er(a,o){if(1&a&&(e.TgZ(0,"table")(1,"thead")(2,"tr")(3,"th"),e._uU(4,"BEAT NAME"),e.qZA()()(),e.TgZ(5,"tbody"),e.YNc(6,Ar,5,3,"tr",92),e.qZA()()),2&a){const i=e.oxw();e.xp6(6),e.Q6J("ngForOf",i.SELECTEdBEATLIST)}}function Ir(a,o){if(1&a&&(e.TgZ(0,"div",94)(1,"div",95)(2,"div",37),e._UZ(3,"div",41),e.TgZ(4,"div",43)(5,"h6"),e._uU(6),e.ALo(7,"number"),e.qZA()(),e.TgZ(8,"div",43)(9,"h6"),e._uU(10),e.ALo(11,"number"),e.qZA()()()()()),2&a){const i=e.oxw();e.xp6(6),e.hij("TOTAL WEIGHT: ",e.xi3(7,2,null==i.LoadChartModel?null:i.LoadChartModel.TOTALWEIGHT,"1.2-2"),""),e.xp6(4),e.hij("TOTAL AMOUNT: ",e.xi3(11,5,null==i.LoadChartModel?null:i.LoadChartModel.TOTALAMOUNT,"1.2-2"),"")}}const Pr=function(a){return{"overflow-x":a}},Nr=function(a){return{"col-md-12 pd0":a}},Lr=function(a){return{height:a}};let Dr=(()=>{class a{constructor(i,t,n,r,s,c,h,d,v,A){this.masterService=i,this.deliveryChalan=t,this.dialog=n,this._transactionService=r,this._alertService=s,this._spinnerService=c,this.fb=h,this.authService=d,this.arouter=v,this.setting=A,this.LoadChartModel=new X,this.SELECTEDSALESMANLIST=[],this.SELECTEdBEATLIST=[],this.trnmain={},this.gridPopupSettings=new u.im,this.gridPopupSettingsForSalesMan=new u.im,this.beatGridPopupSettings=new u.im,this.gridPopupSettingsForDivision=new u.im,this.activeIndex=0,this.isFilterActive=!1,this.mode="NEW",this.promptPrintDevice=!1,this.printControl=new p.NI(0),this.enableCancelButton=!1,this.TOTALCLD=0,this.TOTALPCS=0,this.userSetting=d.getSetting(),this.activeurlpath=v.snapshot.url[0].path,this.calendarForm=this.fb.group({selectedDate:[{startDate:$()(),endDate:$()()},p.kI.required]}),this.getDivisionList(),this.ranges=this.masterService.dateFilterRange,this.LoadChartModel.MODE="NEW",this.gridPopupSettings=Object.assign(new u.im,{title:"Load Sheets",apiEndpoints:"/VoucherListTranWise/LoadSheet",defaultFilterIndex:0,columns:[{key:"VOUCHERNO",title:"VCHRNO",hidden:!1,noSearch:!1},{key:"TOTALWEIGHT",title:"Total Wt.",hidden:!1,noSearch:!1},{key:"DIVISIONNAME",title:"Division",hidden:!1,noSearch:!1},{key:"TOTAMOUNT",title:"Net Amount",hidden:!1,noSearch:!1}]}),this.gridPopupSettingsForSalesMan=Object.assign(new u.im,{title:"SalesMan",apiEndpoints:"/getSalesmanPagedList",defaultFilterIndex:0,columns:[{key:"SALESMANID",title:"DSM CODE",hidden:!1,noSearch:!1},{key:"NAME",title:"Name",hidden:!1,noSearch:!1}]}),this.userProfile=d.getUserProfile(),this.trnmain.VoucherPrefix="LS",this.trnmain.PhiscalID=this.userProfile.PhiscalYearInfo.PhiscalID,this.trnmain.Mode="NEW",this.trnmain.DIVISION=this.userProfile.userDivision,this.trnmain.MWAREHOUSE=this.userProfile.userWarehouse,console.log("delivery chalan",this.trnmain,this.trnmain.DIVISION),this.masterService.getVoucherNo(this.trnmain).subscribe(O=>{this.LoadChartModel.VOUCHERNO=O.result.VCHRNO,this.enableCancelButton=!1})}getDivisionList(){this.divisonList=[],this.masterService.getAllDivisionList().subscribe(i=>{this.divisonList=i})}ngOnInit(){this.masterService.ShowMore=!0}loadFilter(){this.isFilterActive=!0}singleClick(i){this.activeIndex=i}doubleClick(i){let t;t=this.LoadChartModel.REFBILL.filter(n=>n.REFBILL==i.VCHRNO),!(t.length>0)&&(this.LoadChartModel.REFBILL.push({REFBILL:i.VCHRNO,BILLTO:i.BILLTO,VOUCHERNO:this.LoadChartModel.VOUCHERNO}),this.getLoadCharSummary())}doubleClickSamesMan(i){let t;console.log("Sales ma k aaucha",i),t=this.SELECTEDSALESMANLIST.filter(n=>n.DSMCODE==i.DSMCODE),!(t.length>0)&&(this.LoadChartModel.SALESMANNAME=i.NAME,this.LoadChartModel.ROUTENO=i.ROUTE)}reset(){this.LoadChartModel=new X,this.LoadChartModel.MODE="NEW",this.LoadChartModel.REFBILL=[],this.LoadChartModel.ITEMSUMMARY=[],this.LoadChartModel.SalesVoucher=[],this.TOTALCLD=0,this.TOTALPCS=0,this.masterService.getVoucherNo(this.trnmain).subscribe(i=>{this.LoadChartModel.VOUCHERNO=i.result.VCHRNO,this.enableCancelButton=!1})}getLoadCharSummary(){this.deliveryChalan.loadChartItemSummary(this.LoadChartModel.REFBILL).subscribe(i=>{if("ok"==i.status){this.LoadChartModel.ITEMSUMMARY=i.result;let t=0,n=0,r=0;this.LoadChartModel.ITEMSUMMARY.forEach(s=>{t=this._transactionService.nullToZeroConverter(t)+this._transactionService.nullToZeroConverter(s.WEIGHT),r=this._transactionService.nullToZeroConverter(r)+this._transactionService.nullToZeroConverter(s.NETAMOUNT),n=this._transactionService.nullToZeroConverter(n)+this._transactionService.nullToZeroConverter(s.TAXABLE),s.CLD=Math.floor(this._transactionService.nullToZeroConverter(s.RealQty)/this._transactionService.nullToZeroConverter(s.CONFACTOR)),s.PCS=Math.ceil(this._transactionService.nullToZeroConverter(s.RealQty)%this._transactionService.nullToZeroConverter(s.CONFACTOR))}),this.LoadChartModel.TOTALWEIGHT=t,this.LoadChartModel.TOTALAMOUNT=r,this.LoadChartModel.TOTALNUMBEROFBILLS=this.LoadChartModel.REFBILL.length,this.LoadChartModel.TOTALTAXABLE=n}else alert(i.result)},i=>{alert(i)})}onFilterApply(){let i=[],t=[];this.SELECTEDSALESMANLIST.forEach(r=>{i.push(`'${r.DSMCODE}'`)}),this.SELECTEdBEATLIST.forEach(r=>{t.push(`'${r.BEAT}'`)});let n={};n.dsmlist=i.join(),n.beatlist=t.join(),console.log("FROMDATE",this.FROMDATE,"TODATE",this.TODATE),n.FROM=(0,T.p6)(this.FROMDATE,"MM-dd-yyyy","en-US"),n.TO=(0,T.p6)(this.TODATE,"MM-dd-yyyy","en-US"),this.isFilterActive=!1,this.deliveryChalan.loadInvoiceForLoadChart(n).subscribe(r=>{"ok"==r.status?(this.LoadChartModel.SalesVoucher=r.result,this.LoadChartModel.REFBILL=[],this.LoadChartModel.ITEMSUMMARY=[],this.resetOnApply()):(this.LoadChartModel.SalesVoucher=[],this.LoadChartModel.REFBILL=[],this.LoadChartModel.ITEMSUMMARY=[],this.resetOnApply())},r=>{this.LoadChartModel.SalesVoucher=[]})}resetOnApply(){this.LoadChartModel.TOTALWEIGHT=0,this.LoadChartModel.TOTALAMOUNT=0,this.LoadChartModel.TOTALNUMBEROFBILLS=0,this.LoadChartModel.TOTALTAXABLE=0,this.TOTALCLD=0,this.TOTALPCS=0}removeInvoiceFromList(i){this.LoadChartModel.REFBILL.splice(i,1),0!=this.LoadChartModel.REFBILL.length?this.getLoadCharSummary():this.LoadChartModel.ITEMSUMMARY=[]}removeInvoiceFromListBBSM(i){this.LoadChartModel.ITEMSUMMARY.splice(i,1),0!=this.LoadChartModel.ITEMSUMMARY.length||this.reset()}save(){0!=this.LoadChartModel.REFBILL?.length||0!=this._transactionService.userSetting.DispatchWiseLoadSheet?this.LoadChartModel.DivisionName||1!=this._transactionService.userSetting.DispatchWiseLoadSheet?(this.LoadChartModel.ITEMSUMMARY.forEach(i=>{i.RealQty=i.AltQty,i.BASEQUANTITY=i.QUANTITY=i.RealQty}),this._spinnerService.show("Saving Load Sheet"),1==this._transactionService.userSetting.DispatchWiseLoadSheet&&(this.LoadChartModel.ITEMSUMMARY=this.LoadChartModel.ITEMSUMMARY.filter(i=>i.QUANTITY>0)),this.deliveryChalan.saveLoadChartInfo(this.LoadChartModel).subscribe(i=>{"ok"==i.status?(console.log("response catach test",i,i.result2),this.voucher=i.result2?i.result2:this.LoadChartModel.VOUCHERNO,this._spinnerService.hide(),this._alertService.success(i.result),this.deliveryChalan.getLoadChartInfoVoucherWise(this.LoadChartModel.VOUCHERNO).subscribe(t=>{"ok"==t.status&&(t.result.ITEMSUMMARY.forEach(n=>{n.RealQty=n.QUANTITY}),this.print())},t=>{this._alertService.error(t)}),this.reset()):this._spinnerService.hide()},i=>{this._alertService.error(i)})):this._alertService.error("Please select Division first."):this._alertService.error("No Data to save.")}view(){this.mode="VIEW",this.genericGrid.show()}Edit(){this.mode="EDIT",this.genericGrid.show()}onClickCustomerlist(){this.mode="NEW",this.genericSalesManGrid.show()}popupClose(){this.isFilterActive=!1}loadDSMFilter(){this.genericSalesManGrid.show("",!1,"dsmList",!1)}loadBeatilter(){this.genericBeatGrid.show("",!1,"beatlist",!1)}print(){this.checkUserRights("print")&&this.setPrinterAndprint()}checkUserRights(i){console.log("acitve",this.activeurlpath);const t=this.userProfile.menuRights.find(n=>n.menu==this.activeurlpath);if(console.log("menurights",this.userProfile.menuRights,t,this.activeurlpath),t){let r,n=t.right,s=!0;switch(i){case"add":r=n.find(c=>"add"==c),null==r&&(s=!1);break;case"edit":r=n.find(c=>"edit"==c),null==r&&(s=!1);break;case"delete":r=n.find(c=>"delete"==c),null==r&&(s=!1);break;case"print":r=n.find(c=>"print"==c),null==r&&(s=!1);break;case"view":r=n.find(c=>"view"==c),null==r&&(s=!1)}return 0!=s||(this._alertService.warning("Current user has no rights to "+i),!1)}return this._alertService.warning("Cannot find any user rights."),!1}setPrinterAndprint(){if(console.log("set printer and print",this.printControl.value),this.promptPrintDevice=!1,this.userProfile.PrintMode=this.printControl.value,this._transactionService.printModeForInvoice=this.userProfile.PrintMode,this.modeis=this.LoadChartModel.MODE,this.userProfile.PrintMode=1,console.log("print mode",this.userProfile.PrintMode),0!=this.userProfile.PrintMode){this._spinnerService.show("please wait. Getting invoice data ready for printing.");try{if(this.parac=this._transactionService.TrnMainObj.PARAC,"VIEW"==this.modeis||"EDIT"==this.modeis){this.billFormatsForPrint=null,1!=this._transactionService.inputCode&&this.masterService.loadCompany().subscribe(i=>{this._transactionService.TrnMainObj.AdditionalObj.BILLFORMATS=i.BILLFORMATS,this._transactionService.TrnMainObj.AdditionalObj.BILLUNITS=i.BILLUNITS}),1==this._transactionService.inputCode&&this.masterService.loadCompany().subscribe(i=>{this._transactionService.TrnMainObj.AdditionalObj.BILLFORMATS=i.BILLFORMATS,this._transactionService.TrnMainObj.AdditionalObj.BILLUNITS=i.BILLUNITS});try{this.voucher=this.LoadChartModel.VOUCHERNO,console.log("print voucher no",this.voucher),this.masterService.savePrintLog(this.LoadChartModel.VOUCHERNO,this.trnmain.DIVISION,this.trnmain.PhiscalID,this.userProfile.username).subscribe(i=>{if("ok"==i.status){if("add-sales-invoice"==this.activeurlpath||"add-sales-invoice-wholesale"==this.activeurlpath||"self-billing"==this.activeurlpath||"performa-invoice"==this.activeurlpath||"abbreviated-sales-invoice"==this.activeurlpath||"export-sales-invoice"==this.activeurlpath||"quotation"==this.activeurlpath)try{this.masterService.getPrintTitle(this.voucher,this.trnmain.DIVISION,this.trnmain.PhiscalID,this.userProfile.username).subscribe(t=>{"ok"==t.status&&(this.titleVIEW=t.result,this.caption=t.result2,1==this.userSetting.ENABLEMULTISPRINTFORMAT?this.masterService.getBillFormat(this.voucher).subscribe(n=>{"ok"==n.status&&(this.resvalues=n.result?n.result[0].BILLFORMATS:"FULL",this.pdfDesingerPrintFormat(this.voucher,this.trnmain.PhiscalID,this.titleVIEW,this.caption,this.resvalues),this._spinnerService.hide())}):(this.pdfDesingerPrintFormat(this.voucher,this.trnmain.PhiscalID,this.titleVIEW,this.caption,"FULL"),this._spinnerService.hide()))},t=>{this._alertService.error(t)})}catch(t){this._alertService.error(t)}if(14!=this._transactionService.TrnMainObj.VoucherType||"canceladdsientry"==this.activeurlpath)try{this.masterService.getPrintTitleAsCopy(this.voucher,this.trnmain.DIVISION,this.trnmain.PhiscalID,this.userProfile.username).subscribe(t=>{"ok"==t.status&&(this.titleVIEW=t.result,this.caption="",1==this.userSetting.ENABLEMULTISPRINTFORMAT?this.masterService.getBillFormat(this.voucher).subscribe(n=>{"ok"==n.status&&(this.resvalues=n.result?n.result[0].BILLFORMATS:"FULL",this.pdfDesingerPrintFormat(this.voucher,this.trnmain.PhiscalID,this.titleVIEW,this.caption,this.resvalues),this._spinnerService.hide())}):(this.pdfDesingerPrintFormat(this.voucher,this.trnmain.PhiscalID,this.titleVIEW,this.caption,"FULL"),this._spinnerService.hide()))},t=>{this._alertService.error(t)})}catch(t){this._alertService.error(t)}}},i=>{this._alertService.error(i)})}catch(i){this._alertService.error(i)}1==this.userSetting.EnableBillFormatInBilling&&this.masterService.getBillUnits(this._transactionService.TrnMainObj.VCHRNO).subscribe(i=>{"ok"==i.status&&(console.log("ok"),"CASE"==i.result?(this._transactionService.qtyCheckForPrint=!0,console.log("this is case",this._transactionService.qtyCheckForPrint)):this._transactionService.qtyCheckForPrint=!1)})}else if("NEW"==this.modeis)try{this.voucherno=this.LoadChartModel.VOUCHERNO,console.log("print voucher no 5",this.voucherno,this.voucher),this.masterService.savePrintLog(this.voucher,this.trnmain.DIVISION,this.trnmain.PhiscalID,this.userProfile.username).subscribe(i=>{if("ok"==i.status){if("add-sales-invoice"==this.activeurlpath||"add-sales-invoice-wholesale"==this.activeurlpath||"self-billing"==this.activeurlpath||"performa-invoice"==this.activeurlpath||"add-membership-sales-invoice"==this.activeurlpath||"abbreviated-sales-invoice"==this.activeurlpath||"export-sales-invoice"==this.activeurlpath||"quotation"==this.activeurlpath)try{this.masterService.getPrintTitle(this.voucher,this._transactionService.TrnMainObj.DIVISION,this.trnmain.PhiscalID,this.userProfile.username).subscribe(t=>{"ok"==t.status&&(this.titleNEW=t.result,this.caption=t.result2,1==this.userSetting.ENABLEMULTISPRINTFORMAT?(this.pdfDesingerPrintFormat(this.voucher,this.trnmain.PhiscalID,this.titleNEW,this.caption,this.billFormatsForPrint),this._spinnerService.hide()):(this.pdfDesingerPrintFormat(this.voucher,this.trnmain.PhiscalID,this.titleNEW,this.caption,"FULL"),this._spinnerService.hide()))},t=>{this._alertService.error(t)})}catch(t){this._alertService.error(t)}if(14!=this._transactionService.TrnMainObj.VoucherType||"canceladdsientry"==this.activeurlpath)try{this.masterService.getPrintTitleAsCopy(this.voucher,this._transactionService.TrnMainObj.DIVISION,this._transactionService.TrnMainObj.PhiscalID,this.userProfile.username).subscribe(t=>{"ok"==t.status&&(console.log("PRINT-TITLE-as copy",t.result),this.titleNEW=t.result,this.caption="",1==this.userSetting.ENABLEMULTISPRINTFORMAT?(this.pdfDesingerPrintFormat(this.voucher,this._transactionService.TrnMainObj.PhiscalID,this.titleNEW,this.caption,this.billFormatsForPrint),this._spinnerService.hide()):(this.pdfDesingerPrintFormat(this.voucher,this._transactionService.TrnMainObj.PhiscalID,this.titleNEW,this.caption,"FULL"),this._spinnerService.hide()))},t=>{this._alertService.error(t)})}catch(t){this._alertService.error(t)}}},i=>{this._alertService.error(i)})}catch(i){this._alertService.error(i)}}catch(i){this._alertService.error(i)}setTimeout(()=>{this._transactionService.TrnMainObj.VoucherType=61==this._transactionService.TrnMainObj.VoucherType?14:this._transactionService.TrnMainObj.VoucherType,this._transactionService.initialFormLoad(this._transactionService.TrnMainObj.VoucherType)},100)}else try{this.masterService.getReprintData(this.LoadChartModel.VOUCHERNO,this.trnmain.DIVISION,this.trnmain.PhiscalID,this.userProfile.username,1).subscribe(i=>(this.trnmain.printStringForPos=i.result,this.authService.setSessionVariable("USER_PROFILE",this.userProfile),this.AppSettings.ShowPrintPreview?void(this.showPosPrinterPreview=!0):void this.printPosBill()),i=>{this._alertService.error(i._body)})}catch(i){return void this._alertService.error(i)}}pdfDesingerPrintFormat(i,t,n,r,s){(null==s||null==s)&&(s="FULL");let c=this._transactionService.TrnMainObj.VoucherPrefix;"purchase-import"==this.activeurlpath&&(c="IMPORTPURCHASE"),"export-sales-invoice"==this.activeurlpath&&(c="EXPORTSI"),"deliver-chalan"==this.activeurlpath&&(console.log("hi from delivery chalan"),c="LS");let h=1==this.userSetting.DISPLAY?this.userProfile.CompanyInfo.GSTNO:this.userProfile.CompanyInfo.VAT;console.log("vat",h);let d=h?.split("");this.masterService.getPrintFileName(c,this.userProfile.CompanyInfo.COMPANYID,s).subscribe(v=>{if(console.log("get print file name",v),"ok"==v.status){console.log("result",v,c),this.filename=v.result?v.result[0].FileName:"",this.rownumber=v.result?v.result[0].RowsNumber:0;let A=this.userProfile.userDivision?this.userProfile.userDivision:this.userProfile.CompanyInfo.INITIAL;this.masterService.getNumberToWords(i,A,t,this.userProfile.CompanyInfo.COMPANYID).subscribe(O=>{if("ok"==O.status){this.numtowords=O.result?O.result[0].NUMTOWORDS:"";let M=this.userProfile.CompanyInfo.ADDRESS,m=this.userProfile.CompanyInfo.NAME,g=this.userProfile.CompanyInfo.TELA,N=this.userProfile.CompanyInfo.TELB,G=this.userProfile.CompanyInfo.EMAIL;this.masterService.getDetailsByUserDivision(A).subscribe(C=>{if("ok"==C.status){C.result&&C.result.length>0&&C.result[0]&&C.result[0].COMADD&&(M=C.result[0].COMADD),(null==M||""===M)&&(M=this.userProfile.CompanyInfo.ADDRESS?this.userProfile.CompanyInfo.ADDRESS:" "),C.result&&C.result.length>0&&C.result[0]&&C.result[0].COMNAME&&(m=C.result[0].COMNAME),(null==m||""===m)&&(m=this.userProfile.CompanyInfo.NAME?this.userProfile.CompanyInfo.NAME:" "),C.result&&C.result.length>0&&C.result[0]&&C.result[0].TELA&&(g=C.result[0].TELA),(null==g||""===g)&&(g=this.userProfile.CompanyInfo.TELA?this.userProfile.CompanyInfo.TELA:" "),C.result&&C.result.length>0&&C.result[0]&&C.result[0].TELB&&(N=C.result[0].TELB),(null==N||""===N)&&(N=this.userProfile.CompanyInfo.TELB?this.userProfile.CompanyInfo.TELB:" "),C.result&&C.result.length>0&&C.result[0]&&C.result[0].EMAIL&&(G=C.result[0].EMAIL),(null==G||""===G)&&(G=this.userProfile.CompanyInfo.EMAIL?this.userProfile.CompanyInfo.EMAIL:" ");let he,b={};b.filename=this.filename,b.rownumber=this.rownumber,b.VCHRNO=i,b.NAME=m||this.userProfile.CompanyInfo.NAME,b.ADDRESS=M||" ",b.INITIAL=A||this.userProfile.CompanyInfo.INITIAL,b.PhiscalID=t||this.userProfile.CompanyInfo.PhiscalID,b.COMPANYID=this.userProfile.CompanyInfo.COMPANYID,b.phone1=g||" ",b.phone2=N||" ",b.EMAIL=G||" ",b.numtowords=this.numtowords?this.numtowords:" ",b.panno1=d[0]?d[0]:" ",b.panno2=d[1]?d[1]:" ",b.panno3=d[2]?d[2]:" ",b.panno4=d[3]?d[3]:" ",b.panno5=d[4]?d[4]:" ",b.panno6=d[5]?d[5]:" ",b.panno7=d[6]?d[6]:" ",b.panno8=d[7]?d[7]:" ",b.panno9=d[8]?d[8]:" ",b.title=n||" ",b.caption=r||" ",b.VoucherPrefix=this._transactionService.TrnMainObj.VoucherPrefix,b.PRINTBY=this.userProfile.username?this.userProfile.username:" ",b.COMPANYVAT=h||this.userProfile.CompanyInfo.VAT,this.masterService.getAllInvoiceData(b).subscribe(ja=>{he=new Blob([ja],{type:"application/pdf"});const wa=URL.createObjectURL(he),ee=document.createElement("iframe");ee.style.display="none",ee.src=wa,document.body.appendChild(ee),ee.contentWindow.print()})}})}})}})}printPosBill(){var i;this.showPosPrinterPreview=!1,(i=new WebSocket("ws://127.0.0.1:1660")).addEventListener("message",function n(r){},!1),i.addEventListener("open",function t(r){i.onopen=()=>i.send(r)}(this.trnmain.printStringForPos),!1),this.trnmain.VoucherType=61==this._transactionService.TrnMainObj.VoucherType?14:this.trnmain.VoucherType}getLoadSheetVoucher(i){if(console.log("VIEW VOUCHER",i),"VIEW"==this.mode&&(this.enableCancelButton=!0),this._spinnerService.show("Getting LoadSheet Data. Please Wait"),1==this._transactionService.userSetting.DispatchWiseLoadSheet){if(10==i.STATUS&&"EDIT"==this.mode)return this._alertService.info(`${i.VOUCHERNO} has already been dispatched to divison: ${i.DIVISIONNAME} and cannot be edited.`),void this._spinnerService.hide();this.deliveryChalan.viewLoadSheet(i.VOUCHERNO,i.DIVISION,i.PHISCALID).subscribe(t=>{"ok"==t.status&&(this._spinnerService.hide(),this.LoadChartModel=t.result,this.LoadChartModel.ITEMSUMMARY=t.result.ITEMSUMMARY,this.LoadChartModel.REFBILL=t.result.REFBILL,this.LoadChartModel.DivisionName=this.divisonList.find(n=>n.INITIAL==t.result.DIVISION).NAME,this.LoadChartModel.ITEMSUMMARY.forEach(n=>{n.AltQty=n.RealQty}),this.LoadChartModel.MODE=this.mode,this.LoadChartModel.BILLTO=this.masterService.userProfile.userDivision,this.LoadChartModel.BILLTOADD=t.result.DIVISION,this.calculateWeightAndAmnt())},t=>{this._spinnerService.hide(),this._alertService.error(t)})}else this.deliveryChalan.getLoadChartInfoVoucherWise(i.VOUCHERNO).subscribe(t=>{"ok"==t.status&&(this._spinnerService.hide(),this.LoadChartModel=t.result,this.LoadChartModel.ITEMSUMMARY=t.result.ITEMSUMMARY,this.LoadChartModel.REFBILL=t.result.REFBILL,this.LoadChartModel.DivisionName=this.divisonList.find(n=>n.INITIAL==t.result.DIVISION).NAME,this.LoadChartModel.ITEMSUMMARY.forEach(n=>{n.AltQty=n.RealQty}),this.LoadChartModel.MODE=this.mode)},t=>{this._spinnerService.hide(),this._alertService.error(t)})}cancel(){this._spinnerService.show("Cancelling LoadSheet."),this.deliveryChalan.cancelLoadSheet(this.LoadChartModel).subscribe(i=>{"ok"==i.status?(this._spinnerService.hide(),this._alertService.success(i.result),this.reset()):(this._spinnerService.hide(),this._alertService.error(i.result))},i=>{this._spinnerService.hide(),this._alertService.error(i)})}transformDate(i){return null!=i?$()(i).format("DD/MM/YYYY"):""}limitDecimal(i){return new T.JJ("en-US").transform(i,"1.2-2")}CollectionSheet(){this._spinnerService.show("Please wait! Generating Collection Sheet."),this.deliveryChalan.getCollectionSheet(this.LoadChartModel.REFBILL).subscribe(i=>{"ok"==i.status?(this._spinnerService.hide(),this.LoadChartModel.COLLECTIONSHEET=i.result,this.printCollectionSheet(this.LoadChartModel)):(this._spinnerService.hide(),this._alertService.error(i.result))},i=>{this._spinnerService.hide(),this._alertService.error(i)})}printCollectionSheet(i){let t=0;i.COLLECTIONSHEET.forEach(M=>{t+=this._transactionService.nullToZeroConverter(M.NETAMNT)});let r,n=this,s="<table *ngIf=\"itemDetail\" style='width: 100%;font-size: 12px;\n            border-collapse: collapse;border-top: none;border: 1px solid black;'>";s=s+function v(M){let m="";return m+=`\n      <thead>\n      <tr>\n        <td style="border-bottom:1px solid black;"></td>\n        <td style="border-bottom:1px solid black;"></td>\n        <td style="border-bottom:1px solid black;"></td>\n        <td colspan="2" style="border-bottom:1px solid black;">\n          ${n._transactionService.userProfile.CompanyInfo.NAME} <br>\n          ${n._transactionService.userProfile.CompanyInfo.ADDRESS} <br> \n          ${n._transactionService.userProfile.CompanyInfo.TELA},${n._transactionService.userProfile.CompanyInfo.EMAIL} <br>\n          ${n._transactionService.userProfile.CompanyInfo.GSTNO}\n        </td>\n        <td style="border-bottom:1px solid black;"></td>\n        <td style="border-bottom:1px solid black;"></td>\n        <td style="border-bottom:1px solid black;"></td>\n        <td style="border-bottom:1px solid black;"></td>\n      </tr>\n  \n      <tr>\n        <td colspan="2" style="border-bottom:1px solid black;border-right:1px solid black">Load sheet No</td>\n        <td style="border-bottom:1px solid black;">${M.VOUCHERNO}</td>\n        <td style="border-bottom:1px solid black;"></td>\n        <td colspan="2"  style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black">Vehicle No</td>\n        <td  colspan="3" style="border-bottom:1px solid black;">${M.VEHICLENO}</td>\n      </tr>\n      <tr>\n        <td colspan="2"  style="border-bottom:1px solid black;border-right:1px solid black">Load sheet Date</td>\n        <td style="border-bottom:1px solid black;">${n.transformDate(M.DATE)}</td>\n        <td style="border-bottom:1px solid black;"></td>       \n        <td colspan="2"  style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black">Salesman name</td>\n        <td colspan="3" style="border-bottom:1px solid black;">${M.SALESMANNAME}</td>\n      </tr>\n      <tr>\n        <td style="border-bottom:1px solid black;"></td>\n        <td style="border-bottom:1px solid black;"></td>\n        <td style="border-bottom:1px solid black;"></td>\n        <td style="border-bottom:1px solid black;"></td>\n   \n        <td colspan="2"  style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black">Route Name</td>\n        <td colspan="3" style="border-bottom:1px solid black;">${M.ROUTENO}</td>\n      </tr>\n      <tr>\n        <td style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black;">S.No</td>\n        <td style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black;">Invoice No</td>\n        <td style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black;">Date</td>\n        <td style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black;">party Name</td>\n        <td style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black;">Amount </td>\n        <td style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black;">Cash</td>\n        <td style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black;">Cheque</td>\n        <td style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black;">Credit</td>\n        <td style="border-bottom:1px solid black;border-right:1px solid black;border-left:1px solid black;">Remark</td>\n      </tr>\n    </thead>\n                      `,m}(i)+function A(M){let m="<tbody>";for(let g in M.COLLECTIONSHEET)m+=`\n        <tr>\n          <td style="border-right:1px solid black">${n._transactionService.nullToZeroConverter(g)+1}</td>\n          <td style="border-right:1px solid black">${M.COLLECTIONSHEET[g].VCHRNO}</td>\n          <td style="border-right:1px solid black">${n.transformDate(M.COLLECTIONSHEET[g].TRNDATE)}</td>\n          <td style="border-right:1px solid black">${M.COLLECTIONSHEET[g].BILLTO}</td>\n          <td style="border-right:1px solid black;text-align:right">${n.limitDecimal(M.COLLECTIONSHEET[g].NETAMNT)}</td>\n          <td style="border-right:1px solid black"></td>\n          <td style="border-right:1px solid black"></td>\n          <td style="border-right:1px solid black"></td>\n          <td style="border-right:1px solid black"></td>\n        </tr>\n                  `;return m+"</tbody>"}(i)+function O(){let M="";return M+=`\n                      <tfoot>\n                      <tr>\n                        <td style="border-top:1px solid black;border-bottom:1px solid black;border-right:1px solid black;"></td>\n                        <td style="border-top:1px solid black;border-bottom:1px solid black;border-right:1px solid black;"></td>\n                        <td style="border-top:1px solid black;border-bottom:1px solid black;border-right:1px solid black;"></td>\n                        <td style="border-top:1px solid black;border-bottom:1px solid black;border-right:1px solid black;">Total</td>\n                        <td style="border-top:1px solid black;border-bottom:1px solid black;border-right:1px solid black;">${t}</td>\n                        <td style="border-top:1px solid black;border-bottom:1px solid black;border-right:1px solid black;"></td>\n                        <td style="border-top:1px solid black;border-bottom:1px solid black;border-right:1px solid black;">No Of Bills</td>\n                        <td style="border-top:1px solid black;border-bottom:1px solid black;border-right:1px solid black;">${n._transactionService.nullToZeroConverter(n.LoadChartModel.COLLECTIONSHEET.length)}</td>\n                        <td style="border-top:1px solid black;border-bottom:1px solid black;border-right:1px solid black;"></td>\n                      </tr>\n                      </tfoot>\n                      `,M}()+"</table>",r=window.open("","_blank","top=0,left=0,height=100%,width=auto"),r.document.write(`\n        <html> <head>\n        <title>Collection Sheet</title>\n        <style>\n        td{\n          padding:2px;\n        }\n        </style>\n        </head>\n        <body onload="window.print();window.close()">\n        ${s}\n\n        </body>\n          </html>`),r.document.close()}onDivisionEnter(){this.gridPopupSettingsForDivision=Object.assign(new u.im,{title:"Division",apiEndpoints:"/getDivisionPagedlist",defaultFilterIndex:1,columns:[{key:"INITIAL",title:"INITIAL",hidden:!1,noSearch:!1},{key:"NAME",title:"DIVISION NAME",hidden:!1,noSearch:!1}]}),this.genericDivisionGrid.show()}doubleClickDivision(i){this._spinnerService.show("Loading Data..."),this.LoadChartModel.DIVISION=i.INITIAL,this.LoadChartModel.DivisionName=i.NAME,this.LoadChartModel.BILLTOADD=i.INITIAL,this.LoadChartModel.BILLTO=this.masterService.userProfile.userDivision,this.deliveryChalan.getDivisionWiseAllocationData(i.INITIAL).subscribe(t=>{t&&(this._spinnerService.hide(),"ok"==t.status?t?.result?.length>0?(this.LoadChartModel.ITEMSUMMARY=t.result,this.LoadChartModel.ITEMSUMMARY.forEach(n=>{n.ActualQty=n.ALTERNATEQUANTIY}),this.LoadChartModel.MODE="NEW",this.calculateWeightAndAmnt()):0==t?.result?.length&&this._alertService.info("There is no Data!"):this._alertService.error(t.error))},t=>{this._spinnerService.hide(),this._alertService.error(t)})}quantityChange(i){i.ALTERNATEQUANTIY>i.ActualQty&&(this._alertService.error("Enter quantity exceeded approved quantity!"),i.ALTERNATEQUANTIY=i.ActualQty),this.calculateWeightAndAmnt()}updown(i){if("ArrowDown"==i.code){if(i.preventDefault(),this.activeIndex+1>this.LoadChartModel.SalesVoucher.length)return;this.activeIndex++}else if("ArrowUp"==i.code){if(i.preventDefault(),this.activeIndex-1<0)return;this.activeIndex--}}calculateWeightAndAmnt(){this.LoadChartModel.TOTALWEIGHT=0,this.LoadChartModel.TOTALAMOUNT=0,this.LoadChartModel.ITEMSUMMARY.forEach(i=>{this.LoadChartModel.TOTALWEIGHT+=i.WEIGHT,this.LoadChartModel.TOTALAMOUNT+=Number(i.MRP)*i.RealQty})}hideSalesman(){return 0!=this.userSetting.enablesalesman}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(I.P),e.Y36(ce),e.Y36(z.uw),e.Y36(f.p),e.Y36(D.c),e.Y36(y.V),e.Y36(p.qu),e.Y36(P.e),e.Y36(L.gz),e.Y36(xn.R))},a.\u0275cmp=e.Xpm({type:a,selectors:[["Deliver_Chalan"]],viewQuery:function(i,t){if(1&i&&(e.Gf(jn,5),e.Gf(wn,5),e.Gf(Zn,5),e.Gf(Fn,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.genericGrid=n.first),e.iGM(n=e.CRH())&&(t.genericSalesManGrid=n.first),e.iGM(n=e.CRH())&&(t.genericBeatGrid=n.first),e.iGM(n=e.CRH())&&(t.genericDivisionGrid=n.first)}},hostBindings:function(i,t){1&i&&e.NdJ("keydown",function(r){return t.updown(r)},!1,e.evT)},features:[e._Bn([ce])],decls:106,vars:42,consts:[["href","https://fonts.googleapis.com/icon?family=Material+Icons","rel","stylesheet"],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-2"],[1,"col-md-5"],[2,"white-space","nowrap","margin-left","-158px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-8"],[1,"btn","btn-info","pull-right",2,"margin-right","5px",3,"click"],["class","btn btn-info pull-right",3,"click",4,"ngIf"],["class","btn btn-info pull-right","style","margin-right: 5px",3,"click",4,"ngIf"],[1,"col-md-12","row","pd0",2,"overflow-y","hidden",3,"ngStyle"],[1,"col-md-8","pd0",3,"ngClass"],["class","col-md-12 row pd0 plainBackGround mr5",4,"ngIf"],[1,"col-md-12","pd0","mr5","ims-scrollable-table"],[1,"table-container",3,"ngStyle"],["id","BlueHeaderResizableTable",1,"reportTabel",2,"font-size","12px","width","100%","overflow-x","auto"],["reportHtmlTable",""],[2,"background","#d5d5d5",3,"ngStyle"],["width","50px"],["width","100px"],["width","200px"],["width","100px",4,"ngIf"],[3,"ngStyle"],[2,"width","fit-content"],[4,"ngIf"],["class","col-md-4 pd0",4,"ngIf"],[2,"display","block","padding","0px","position","fixed","top","85px","left","0","width","100%","height","auto","z-index","9999999","max-height","500px","overflow-y","auto"],[1,"modal-content-main-area",2,"background-color","#fefefe","margin","auto","padding","20px","border","1px solid #888","width","45%","height","-webkit-fill-available","margin-left","10px","margin-top","5%"],[1,"modal-header",2,"padding","0px","background","rgba(0, 0, 0, 0.1)"],[1,"modal-title",2,"text-align","center"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"clearfix"],[1,"col-md-4"],[1,"clearfix","loadsheet-date-filter"],[2,"width","28rem"],[1,"legend-class",2,"width","auto","font-size","15px"],[1,"row"],[1,"row","col-md-12",2,"margin-top","-15px"],[1,"col-md-6",2,"margin-left","-4%"],["type","date","placeholder","Start Date",1,"date-input","form-control",3,"ngModel","ngModelChange"],[1,"col-md-6"],["type","date","placeholder","End Date",1,"date-input","form-control",3,"ngModel","ngModelChange"],[1,"col-md-3"],[1,"clearfix",2,"padding","10px","float","bottom"],[1,"btn","btn-info","pull-right",2,"margin-left","10px",3,"click"],[1,"btn","btn-info","pull-right",3,"click"],[2,"position","fixed","bottom","0px","height","60px","width","100%"],["class","row footer",4,"ngIf"],[3,"popupsettings","onItemDoubleClick"],["genericGrid",""],["genericSalesManGrid",""],["genericDivisionGrid",""],[1,"col-md-12","row","pd0","plainBackGround","mr5"],[1,"row",2,"padding-bottom","5px"],["type","text","id","vechNoId","name","vno",2,"width","60%",3,"ngModel","disabled","ngModelChange"],["type","text","id","DrivernameId","name","dnme",2,"width","60%",3,"ngModel","disabled","ngModelChange"],[1,"col-md-4",2,"padding-top","37px"],[2,"width","30%"],["type","text","id","licenseNoId","name","dlicno",2,"width","60%",3,"ngModel","disabled","ngModelChange"],["class","row","style","padding-bottom: 5px",4,"ngIf"],["type","text","id","filter","autocomplete","off","placeholder","Enter or Tab to load Filter option","name","filter",2,"width","60%",3,"keydown.enter","keydown.tab"],["divName",""],["type","text","placeholder","Please ENTER to Select Division","readonly","",2,"width","60%",3,"ngModel","disabled","ngModelChange","keydown.Enter"],["type","text","id","SalesManName","name","SalesMan_Name","autocomplete","off","placeholder","Enter to select the salesman",2,"width","60%",3,"ngModel","disabled","ngModelChange","keydown.Tab","keydown.Enter"],["type","text","id","RouteNo","name","ROUTENO",2,"width","60%",3,"ngModel","disabled","ngModelChange"],["type","text","id","vcts",2,"width","60%",3,"ngModel","disabled","ngModelChange"],[3,"ngStyle",4,"ngFor","ngForOf"],["style","width:3%;",4,"ngIf"],["type","number",2,"width","100px",3,"ngModel","disabled","ngModelChange","change"],[2,"width","3%"],[1,"close-wrapper"],[1,"closeTooltip",3,"click"],["src","../../../assets/icons/close-icon.png","alt","",2,"width","20px","padding","2.5px"],[1,"col-md-4","pd0"],["class","col-md-12","style","\n       min-height: 45vh;\n    max-height: 45vh;\n    padding-right: 0px;\n    padding-left: 10px;\n    padding-top: 5px;\n    height: 45vh;\n      ",4,"ngIf"],[1,"col-md-12",2,"margin-top","10px","min-height","270px","max-height","270px","padding-left","10px","padding-right","0px","padding-top","5px"],[1,"col-md-12","pd0","ims-scrollable-table"],[1,"table-container",2,"height","35vh"],[2,"background","#d5d5d5"],[1,"col-md-12",2,"min-height","45vh","max-height","45vh","padding-right","0px","padding-left","10px","padding-top","5px","height","45vh"],[1,"col-md-12","pd0","ims-scrollable-table",2,"height","inherit"],[1,"table-container",2,"height","inherit"],["id","BlueHeaderResizableTable",1,"reportTabel",2,"font-size","12px","width","100%","overflow-x","auto","height","inherit"],["width","100px",2,"text-align","end"],[3,"dblclick","click",4,"ngFor","ngForOf"],[3,"dblclick","click"],[2,"font-size","10px"],[2,"text-align","right"],[4,"ngFor","ngForOf"],[2,"width","33%"],[1,"material-icons",2,"font-size","18px",3,"click"],[3,"selected-row",4,"ngFor","ngForOf"],[1,"fa","fa-trash",3,"click"],[1,"row","footer"],[1,"col-md-12",2,"vertical-align","center"]],template:function(i,t){1&i&&(e._UZ(0,"link",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3),e._UZ(4,"voucher-master-toggler"),e.qZA(),e.TgZ(5,"div",3)(6,"div",4)(7,"label",5),e._uU(8),e.qZA()()(),e.TgZ(9,"div",6)(10,"button",7),e.NdJ("click",function(){return t.view()}),e._uU(11," View "),e.qZA(),e.TgZ(12,"button",7),e.NdJ("click",function(){return t.Edit()}),e._uU(13," Edit "),e.qZA(),e.YNc(14,kn,2,0,"button",8),e.YNc(15,Un,2,0,"button",9),e.TgZ(16,"button",7),e.NdJ("click",function(){return t.reset()}),e._uU(17," Reset "),e.qZA(),e.YNc(18,Vn,2,0,"button",9),e.YNc(19,Bn,2,0,"button",9),e.qZA()()(),e.TgZ(20,"div",10)(21,"div",11),e.YNc(22,Kn,27,12,"div",12),e.TgZ(23,"div",13)(24,"div",14)(25,"table",15,16)(27,"thead")(28,"tr",17),e._UZ(29,"th",18)(30,"th",19)(31,"th",20),e.YNc(32,Wn,1,0,"th",21),e.TgZ(33,"th",19),e._uU(34,"Item Details"),e.qZA(),e.YNc(35,zn,1,0,"th",21),e.YNc(36,Xn,1,0,"th",21),e._UZ(37,"th",19)(38,"th",19),e.YNc(39,$n,1,0,"th",21),e.qZA(),e.TgZ(40,"tr",22)(41,"th",18),e._uU(42,"S.No"),e.qZA(),e.TgZ(43,"th",19),e._uU(44,"Item Code"),e.qZA(),e.TgZ(45,"th",20),e._uU(46,"Item name"),e.qZA(),e.YNc(47,er,2,0,"th",21),e.TgZ(48,"th",19),e._uU(49,"Unit"),e.qZA(),e.YNc(50,ir,2,0,"th",21),e.YNc(51,tr,2,0,"th",21),e.TgZ(52,"th",19),e._uU(53,"Quantity"),e.qZA(),e.TgZ(54,"th",19),e._uU(55,"Weight"),e.qZA(),e.YNc(56,nr,2,0,"th",21),e.qZA()(),e.TgZ(57,"tbody",23),e.YNc(58,_r,2,1,"ng-container",24),e.qZA(),e.YNc(59,ur,57,16,"tfoot",24),e.qZA()()()(),e.YNc(60,fr,22,2,"div",25),e.qZA(),e.TgZ(61,"div",26)(62,"div",27)(63,"div",28)(64,"h5",29),e._uU(65,"Filter Options"),e.qZA(),e.TgZ(66,"button",30),e.NdJ("click",function(){return t.popupClose()}),e.TgZ(67,"span",31),e._uU(68,"\xd7"),e.qZA()()(),e.TgZ(69,"div",32)(70,"div",33)(71,"div",34)(72,"fieldset",35)(73,"legend",36),e._uU(74,"Date Range Selection : "),e.qZA(),e.TgZ(75,"div",37)(76,"div",38)(77,"div",39)(78,"div")(79,"label"),e._uU(80," From:(AD) "),e.qZA()(),e.TgZ(81,"div")(82,"input",40),e.NdJ("ngModelChange",function(r){return t.FROMDATE=r}),e.qZA()()(),e.TgZ(83,"div",41)(84,"div")(85,"label"),e._uU(86," To:(AD) "),e.qZA()(),e.TgZ(87,"div")(88,"input",42),e.NdJ("ngModelChange",function(r){return t.TODATE=r}),e.qZA()()()()()()()(),e.TgZ(89,"div",4),e.YNc(90,Or,11,1,"table",24),e.qZA(),e.TgZ(91,"div",43),e.YNc(92,Er,7,1,"table",24),e.qZA()(),e.TgZ(93,"div",44)(94,"button",45),e.NdJ("click",function(){return t.popupClose()}),e._uU(95," Cancel "),e.qZA(),e.TgZ(96,"button",46),e.NdJ("click",function(){return t.onFilterApply()}),e._uU(97," Apply "),e.qZA()()()(),e.TgZ(98,"div",47),e.YNc(99,Ir,12,8,"div",48),e.qZA(),e.TgZ(100,"generic-popup-grid",49,50),e.NdJ("onItemDoubleClick",function(r){return t.getLoadSheetVoucher(r)}),e.qZA(),e.TgZ(102,"generic-popup-grid",49,51),e.NdJ("onItemDoubleClick",function(r){return t.doubleClickSamesMan(r)}),e.qZA(),e.TgZ(104,"generic-popup-grid",49,52),e.NdJ("onItemDoubleClick",function(r){return t.doubleClickDivision(r)}),e.qZA()),2&i&&(e.xp6(8),e.hij("LOAD SHEET [",t.LoadChartModel.MODE,"]"),e.xp6(6),e.Q6J("ngIf","NEW"==t.LoadChartModel.MODE||"EDIT"==t.LoadChartModel.MODE),e.xp6(1),e.Q6J("ngIf",t.enableCancelButton),e.xp6(3),e.Q6J("ngIf","VIEW"==t.LoadChartModel.MODE),e.xp6(1),e.Q6J("ngIf","VIEW"==t.LoadChartModel.MODE),e.xp6(1),e.Q6J("ngStyle",e.VKq(32,Pr,1==t._transactionService.userSetting.DispatchWiseLoadSheet?"hidden":"auto")),e.xp6(1),e.Q6J("ngClass",e.VKq(34,Nr,1==t._transactionService.userSetting.DispatchWiseLoadSheet)),e.xp6(1),e.Q6J("ngIf",t.masterService.ShowMore),e.xp6(2),e.Q6J("ngStyle",e.VKq(36,Lr,t.masterService.ShowMore?"50vh":"80vh")),e.xp6(4),e.Q6J("ngStyle",e.VKq(38,ne,1==t._transactionService.userSetting.DispatchWiseLoadSheet?"12px":"11px")),e.xp6(4),e.Q6J("ngIf",0==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(3),e.Q6J("ngIf",0==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("ngIf",0==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(3),e.Q6J("ngIf",0==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("ngStyle",e.VKq(40,ne,1==t._transactionService.userSetting.DispatchWiseLoadSheet?"12px":"11px")),e.xp6(7),e.Q6J("ngIf",0==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(3),e.Q6J("ngIf",0==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("ngIf",0==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(5),e.Q6J("ngIf",0==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(2),e.Q6J("ngIf",t.LoadChartModel.ITEMSUMMARY.length),e.xp6(1),e.Q6J("ngIf",0==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("ngIf",0==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.ekj("modal-sticky-hide",!t.isFilterActive),e.xp6(21),e.Q6J("ngModel",t.FROMDATE),e.xp6(6),e.Q6J("ngModel",t.TODATE),e.xp6(2),e.Q6J("ngIf",t.SELECTEDSALESMANLIST&&t.SELECTEDSALESMANLIST.length),e.xp6(2),e.Q6J("ngIf",t.SELECTEdBEATLIST&&t.SELECTEdBEATLIST.length),e.xp6(7),e.Q6J("ngIf",1==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("popupsettings",t.gridPopupSettings),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForSalesMan),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForDivision))},dependencies:[T.mk,T.sg,T.O5,T.PC,R.q,p.Fj,p.wV,p.JJ,p.On,u.Zl,T.JJ,T.uU],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], option[_ngcontent-%COMP%]{height:23px;vertical-align:middle;font-size:13px;color:#000;border-bottom:1px solid #ddd}textarea[_ngcontent-%COMP%]{font-size:13px;border:1px solid #cbcbcb;border-radius:3px;color:#000}.plainBackGround[_ngcontent-%COMP%]{border:2px solid #e6e6e6;margin-bottom:5px;padding:10px}label[_ngcontent-%COMP%]{height:28px;font-weight:400;width:90px;margin:2px;vertical-align:middle;font-size:13px;padding-top:4px}input[_ngcontent-%COMP%]{padding-left:4px}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[_ngcontent-%COMP%]:disabled, select[_ngcontent-%COMP%]:disabled, textarea[_ngcontent-%COMP%]:disabled{cursor:not-allowed!important;color:#000!important;background-color:#ebebe4!important}button[_ngcontent-%COMP%]:disabled{cursor:not-allowed!important}.btn-add-focus[_ngcontent-%COMP%]:focus{transform:scale(1.2);-webkit-transform:scale(1.2);-ms-transform:scale(1.2);-moz-transform:scale(1.2);-o-transform:scale(1.2)}tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:700}.tableBorder[_ngcontent-%COMP%]{border:1px solid;border-color:#dcdcdc}.show[_ngcontent-%COMP%]{overflow:visible;height:auto}.alert-danger[_ngcontent-%COMP%]{background-color:none!important;border-color:none!important;color:#a94442}.tab[_ngcontent-%COMP%]{overflow:hidden;border:1px solid #ccc;background-color:#f1f1f1}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s;font-size:17px}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#ddd}.tab[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#ccc}.tabcontent[_ngcontent-%COMP%]{display:none;padding:6px 12px;border:1px solid #ccc;border-top:none}.custom-asset-dropdown[_ngcontent-%COMP%]    {line-height:13px;font-size:14px}  .custom-asset-dropdown .multiselect-dropdown .dropdown-btn{padding:2px 11px}.sourceBatchRate[_ngcontent-%COMP%]{height:23px;border:1px solid #b4b4b4;background-color:#f9f9f9;width:9%;.batchRateInput{width: 100%; text-align: right}}.sourceBarCode[_ngcontent-%COMP%]{height:23px;border:1px solid #b4b4b4;width:6%;.barCodeInput{width: 100%;}}.backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#3d3c3c80;z-index:9999}",".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n      text-align: center;\n      vertical-align: middle;\n    }\n  \n    .footer[_ngcontent-%COMP%] {\n    border: 1px solid #eaeaea;\n    background-color: #fff;\n    min-height: 60px;\n  }\n\n    th[_ngcontent-%COMP%] {\n      height: 25px !important;\n    }\n  \n    tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover {\n      background-color: #f3f5f4;\n      cursor: pointer;\n    }\n  \n    tr[_ngcontent-%COMP%] {\n      font-size: 11px;\n    }\n  \n    .selected-row[_ngcontent-%COMP%] {\n      background-color: rgba(0, 0, 0, 0.1) !important;\n    }\n  \n    .table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%] {\n      line-height: 30px !important;\n    }\n  \n    .table[_ngcontent-%COMP%] > thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%] {\n      line-height: 5px !important;\n    }\n  \n    .table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child {\n      text-align: left !important;\n      padding: 0px 0px 0px 11px !important;\n    }\n  \n    td[_ngcontent-%COMP%] {\n      padding: 5px;\n    }\n   input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%] {\n      font-size: 13px;\n      height: 23px !important;\n      margin-top: 7px;\n    }\n  \n    [_ngcontent-%COMP%]::-webkit-scrollbar-track {\n      background: none !important;\n    }\n\n    .closeTooltip[_ngcontent-%COMP%] {\n  \n  display: inline-block;\n  transition: 0.3s ease;\n  border: none;\n  background:none\n  }\n\n  .closeTooltip[_ngcontent-%COMP%]:focus{\n  outline: none;\n  }"]}),a})();function yr(a,o){if(1&a&&(e.TgZ(0,"div",3)(1,"div",4)(2,"div",5),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",6)(5,"label",7),e._uU(6),e.qZA(),e._UZ(7,"div"),e.qZA(),e._UZ(8,"div",8),e.TgZ(9,"div",9),e._UZ(10,"voucher-master-action"),e.qZA()()()),2&a){const i=e.oxw();e.xp6(6),e.AsE("",i._trnMainService.pageHeading," [",i._trnMainService.TrnMainObj.Mode,"]")}}function Rr(a,o){1&a&&e._UZ(0,"div",15)}function xr(a,o){if(1&a&&(e.TgZ(0,"div",10)(1,"div",11),e._UZ(2,"trnmain-parameters-master",12),e.qZA(),e.TgZ(3,"div",13),e.YNc(4,Rr,1,0,"div",14),e.qZA(),e.TgZ(5,"div",13)(6,"div",15),e._UZ(7,"productentry"),e.qZA()()()),2&a){const i=e.oxw();e.xp6(1),e.Q6J("hidden",!i.masterService.ShowMore),e.xp6(3),e.Q6J("ngIf",1==i.masterService.userSetting.GblBarcodeWiseBilling)}}function jr(a,o){1&a&&(e.TgZ(0,"div",16),e._UZ(1,"voucher-total-area"),e.qZA())}let wr=(()=>{class a{constructor(i,t,n,r,s){this.masterService=i,this._trnMainService=t,this.route=n,this.authservice=r,this.changeDetection=s,this.userProfile={},this.applyReferValue=!1,this.userProfile=r.getUserProfile(),this.userSetting=this.authservice.getSetting(),"add-membership-sales-invoice"===this.route.snapshot.url[0].path&&(this._trnMainService.initialFormLoad(1),this._trnMainService.TrnMainObj.INVOICETYPE="MembershipSalesInvoice",this._trnMainService.TrnMainObj.AdditionalObj.tag="MembershipSalesInvoice",this._trnMainService.TrnMainObj.BILLMODE="new")}ngAfterContentChecked(){this.changeDetection.detectChanges()}ngAfterViewInit(){}ngOnInit(){}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(I.P),e.Y36(f.p),e.Y36(L.gz),e.Y36(P.e),e.Y36(e.sBO))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-membership-sales-invoice"]],features:[e._Bn([f.p])],decls:3,vars:3,consts:[["class","sticky-top",4,"ngIf"],["class","main-container",4,"ngIf"],["class","sticky-bottom",4,"ngIf"],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-2","pd0"],[1,"col-md-3","pd0"],[2,"white-space","nowrap","margin-left","-145px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-2","row",2,"padding-top","0.8vh","font-size","15px","font-style","italic","padding-left","0px","padding-right","0px"],[1,"col-md-5","pd0"],[1,"main-container"],[3,"hidden"],["viewDisable","disableView"],[1,"row","row-margin"],["class","col-md-12 pd5",4,"ngIf"],[1,"col-md-12","pd5"],[1,"sticky-bottom"]],template:function(i,t){1&i&&(e.YNc(0,yr,11,2,"div",0),e.YNc(1,xr,8,2,"div",1),e.YNc(2,jr,2,0,"div",2)),2&i&&(e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName))},dependencies:[T.O5,V.x,U,R.q,x.i,F.u],styles:[".GRNPopUp[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.GRNPopUp[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#123456!important;color:#fff}.modal-dialog.modal-md[_ngcontent-%COMP%], .modal-dialog.modal-sm[_ngcontent-%COMP%]{top:45%;margin-top:0}",".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n    text-align: center;\n    vertical-align: middle;\n  }"]}),a})();const Zr=["genericGridSO"],Fr=["genericPerformaInvoiceGridSO"],kr=["genericCancelSales"],Ur=["popupCustomerCreation"],Vr=["genericGridMemberShip"],Br=["genericGridsalesMan"],Gr=["genericReverseInvoiceGridSO"],Hr=["genericGridSalesManRoute"],qr=["genericGridCustomerListBySalesmanAndRoute"];function Jr(a,o){if(1&a&&(e.ynx(0),e.TgZ(1,"div",22)(2,"span")(3,"b"),e._uU(4,"SO Qty:"),e.qZA(),e._uU(5),e.qZA()(),e.TgZ(6,"div",28)(7,"span")(8,"b"),e._uU(9,"Rate:"),e.qZA(),e._uU(10),e.ALo(11,"currency"),e.qZA()(),e.BQk()),2&a){const i=e.oxw(2);e.xp6(5),e.hij("\xa0",i._trnMainService.purchaseOrderQty," \xa0"),e.xp6(5),e.hij("\xa0",e.Dn7(11,2,i._trnMainService.purchaseOrderRate,"INR","Rs. ")," ")}}function Qr(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",14)(1,"div",15)(2,"div",16),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",17)(5,"label",18),e._uU(6),e.qZA(),e.TgZ(7,"div")(8,"voucher-sidebar-billdetail",19),e.NdJ("onMemberIDSearch",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onClickMemberIDSearch(n))})("onMemberReferIDSearch",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onClickMemberReferIDSearch(n))})("onClickSlider",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.calculateMemberPointsForView())}),e.qZA()()(),e.TgZ(9,"div",20),e.YNc(10,Jr,12,6,"ng-container",21),e.qZA(),e.TgZ(11,"div",22)(12,"voucher-master-action",23),e.NdJ("onLoadFromSOClickEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showLoadFromSOPopup(n))})("onLoadFromPerformaInvoiceClickEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showApprovedPreformaInvoicePopup(n))})("onLoadCancelSalesEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showSalesDayWise(n))})("onClickSalesMan",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onClickNewSalesman(n))})("onLoadFromReverseEntryEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.showReverseVoucherInvoicePopup(n))})("onclickOnResetPopupEmit",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onclickOnResetPopupEmit(n))})("onSaveSelfBilling",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onclickOnResetPopupEmit(n))}),e.qZA(),e.TgZ(13,"generic-popup-grid",9,24),e.NdJ("onItemDoubleClick",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onSalesOrderSelect(n))}),e.qZA(),e.TgZ(15,"generic-popup-grid",9,25),e.NdJ("onItemDoubleClick",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onPerformaInvoiceSelect(n))}),e.qZA(),e.TgZ(17,"generic-popup-grid",9,26),e.NdJ("onItemDoubleClick",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onSalesCancelSelect(n))}),e.qZA(),e.TgZ(19,"generic-popup-grid",9,27),e.NdJ("onItemDoubleClick",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onReverseEntrySelect(n))}),e.qZA()()()()}if(2&a){const i=e.oxw();e.xp6(6),e.AsE("",i._trnMainService.pageHeading," [",i._trnMainService.TrnMainObj.Mode,"]"),e.xp6(4),e.Q6J("ngIf",0!=i.userSetting.ENABLE_SOINTI&&i._trnMainService.TrnMainObj.REFORDBILL),e.xp6(3),e.Q6J("popupsettings",i.gridPopupSettings),e.xp6(2),e.Q6J("popupsettings",i.gridPerformaInvoicePopupSettings),e.xp6(2),e.Q6J("popupsettings",i.gridcancelSalesPopupSettings),e.xp6(2),e.Q6J("popupsettings",i.gridReverseEntryPopupSettings)}}function Yr(a,o){1&a&&(e.TgZ(0,"div",6),e._UZ(1,"discounts-insert"),e.qZA())}function Kr(a,o){if(1&a&&(e.TgZ(0,"div",29)(1,"div",30),e._UZ(2,"trnmain-parameters-master",31),e.qZA(),e.TgZ(3,"div",5),e.YNc(4,Yr,2,0,"div",32),e.qZA()()),2&a){const i=e.oxw();e.xp6(1),e.Q6J("hidden",!i.masterService.ShowMore),e.xp6(3),e.Q6J("ngIf",1==i.masterService.userSetting.GblBarcodeWiseBilling)}}function Wr(a,o){1&a&&(e.TgZ(0,"div",33),e._UZ(1,"voucher-total-area"),e.qZA())}let zr=(()=>{class a{constructor(i,t,n,r,s,c,h){this.masterService=i,this._trnMainService=t,this.route=n,this.alertService=r,this.loadingSerive=s,this.authservice=c,this.changeDetection=h,this.hideShow=!1,this.gridPopupSettingsForMember=new u.im,this.gridPopupSettingsalesMan=new u.im,this.gridReverseEntryPopupSettings=new u.im,this.salesManList=[],this.routerMasterList=[],this.userProfile={},this.RouteList=[],this.CustomerList=[],this.applyReferValue=!1,this.costlists=[],this.gridPopupSettings=new u.im,this.gridPerformaInvoicePopupSettings=new u.im,this.gridcancelSalesPopupSettings=new u.im,this.gridPopupSettingsForSalesManRoute=new u.im,this.gridPopupSettingsForCustomerListBySalesmanAndRoute=new u.im,i.Currencies=[],i.getCurrencies().subscribe(d=>{i.Currencies=d}),this.userProfile=c.getUserProfile(),this.userSetting=this.authservice.getSetting(),"export-sales-invoice"===this.route.snapshot.url[0].path&&(this._trnMainService.initialFormLoad(14),this._trnMainService.TrnMainObj.CNDN_MODE=10,this.getSalesManList()),this.masterService.getSalesmanList().subscribe(d=>{this.salesManList.push(d)}),this.gridPopupSettings={title:"Sales Vouchers",apiEndpoints:"/getTrnMainPagedList/SO/tag",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"Voucher No.",hidden:!1,noSearch:!1},{key:"DIVISION",title:"Division",hidden:!1,noSearch:!1},{key:"TRNAC",title:"Trn. A/c",hidden:!1,noSearch:!1},{key:"PhiscalId",title:"Fiscal Year",hidden:!1,noSearch:!1}]},this.gridPerformaInvoicePopupSettings=1==this.userSetting.EnableGRNInPIForCargo?{title:"Approved Proforma Vouchers",apiEndpoints:"/getProformaVoucherListFromCargo",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"Voucher No.",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"Date",hidden:!1,noSearch:!1},{key:"BOOKINGID",title:"Booking ID",hidden:!1,noSearch:!1}]}:{title:"Approved Proforma Vouchers",apiEndpoints:"/getApprovedHOPerformaInvoicePagedList/null",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"Voucher No.",hidden:!1,noSearch:!1},{key:"BILLTO",title:"Customer Name",hidden:!1,noSearch:!1},{key:"BILLTOTEL",title:"VAT NO.",hidden:!1,noSearch:!1}]},this.gridcancelSalesPopupSettings={title:"Sales Invoice ",apiEndpoints:"/getTrnMainDateWisePagedList/TI",defaultFilterIndex:0,columns:[{key:"CHALANNO",title:"BILL NO",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"DATE",hidden:!1,noSearch:!1},{key:"TRNMODE",title:"TYPE",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"AMOUNT",hidden:!1,noSearch:!1}]},this.gridReverseEntryPopupSettings={title:"Reverse Entry VoucherList",apiEndpoints:"/getReverseEntryPagedList",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"Voucher No.",hidden:!1,noSearch:!1},{key:"DIVISION",title:"Division",hidden:!1,noSearch:!1},{key:"TRNAC",title:"Trn. A/c",hidden:!1,noSearch:!1},{key:"PhiscalId",title:"Fiscal Year",hidden:!1,noSearch:!1}]},this.route.queryParams.subscribe(d=>{"DRILL"!=d.mode&&("FROMSI"==d.mode?(this.masterService.TempTrnMainObj.VCHRNO=this._trnMainService.TrnMainObj.VCHRNO,this.masterService.TempTrnMainObj.VoucherPrefix=this._trnMainService.TrnMainObj.VoucherPrefix,this.masterService.TempTrnMainObj.VoucherType=l.Km.TaxInvoice,this._trnMainService.TrnMainObj=this.masterService.TempTrnMainObj,this.masterService.getCustomerIDFromCProfile(d.ID).subscribe(v=>{v.length>0&&(this._trnMainService.TrnMainObj.RECEIVEBY=v[0].CUSTID),this._trnMainService.TrnMainObj.PARAC=d.ID})):d.voucher&&this.getSelectedPerformaInvoice(d.voucher))})}updown(i){"F10"==i.code&&this.calculateMemberPointsForView()}ngAfterContentChecked(){this.changeDetection.detectChanges()}getMemberShipList(){this.gridPopupSettingsForMember=this.masterService.getGenericGridPopUpSettings("MemberList")}onclickOnResetPopupEmit(i){console.log("event"),this.setLoginDivisionName()}getSalesManList(){this.gridPopupSettingsalesMan=this.masterService.getGenericGridPopUpSettings("SalesManList")}setLoginDivisionName(){this.masterService.getloginDivisionName().subscribe(i=>{console.log("get login divison ",i),"ok"==i.status&&(i.result?(this._trnMainService.TrnMainObj.BILLTO=i.result.ACNAME,this._trnMainService.TrnMainObj.TRNAC=i.result.ACID,this._trnMainService.TrnMainObj.PARAC=i.result.ACID,this._trnMainService.TrnMainObj.VATNO=i.result.VATNO,this._trnMainService.TrnMainObj.BILLTOTEL=i.result.VATNO,this._trnMainService.TrnMainObj.BILLTOADD=i.result.ADDRESS,this._trnMainService.TrnMainObj.TRNACName=i.result.ACNAME):this.alertService.warning("Please set default account for the current division."))},i=>{this.alertService.warning("Please set default account for the current division")})}onSalesManSelect(i){this._trnMainService.TrnMainObj.SALESMANID=i.SALESMANID,this._trnMainService.TrnMainObj.SALESMAN=i.NAME,this._trnMainService.salesmanID=i.SALESMANID,this._trnMainService.salesmanName=i.NAME,this.getSalesManRouteList(),this.genericGridSalesManRoute.show()}onRouteSelect(i){this._trnMainService.doubleClick=!0,this._trnMainService.TrnMainObj.SALESMANID=i.SALESMANID,this._trnMainService.TrnMainObj.ROUTE=i.RouteCode,this._trnMainService.routeCode=this._trnMainService.TrnMainObj.ROUTE,this._trnMainService.getCustomerListRouteAndSalesmanWise(this._trnMainService.TrnMainObj.SALESMANID,this._trnMainService.TrnMainObj.ROUTE),this.getCustomerList(),this.genericGridCustomerListBySalesmanAndRoute.show()}onCustomerSelected(i){this._trnMainService.customerDoubleClick=!0,this._trnMainService.billunitevent=!0,this._trnMainService.TrnMainObj.BILLTO=i.ACNAME,this._trnMainService.TrnMainObj.TRNAC=i.ACID,this._trnMainService.TrnMainObj.PARAC=i.ACID,this._trnMainService.TrnMainObj.BILLTOTEL=i.VATNO,this._trnMainService.TrnMainObj.BILLTOADD=i.ADDRESS,this._trnMainService.TrnMainObj.BILLTOMOB=i.MOBILE,this._trnMainService.TrnMainObj.TRNACName=i.ACNAME,this._trnMainService.TrnMainObj.TRNMODE=null==i.PMODE||""===i.PMODE?"credit":i.PMODE}getSalesManRouteList(){this.gridPopupSettingsForSalesManRoute=this.masterService.getGenericGridSettintForSalemanRoute(this._trnMainService.TrnMainObj.SALESMANID)}getCustomerList(){this.gridPopupSettingsForCustomerListBySalesmanAndRoute=this.masterService.getGridSettingForCustomerBySalesmanRoute(this._trnMainService.TrnMainObj.SALESMANID,this._trnMainService.TrnMainObj.ROUTE),this.gridPopupSettingsForCustomerListBySalesmanAndRoute={title:"Customers",apiEndpoints:`/getPagedCustomerListBySalesmanAndRoute/${this._trnMainService.TrnMainObj.SALESMANID}/${this._trnMainService.TrnMainObj.ROUTE}`,defaultFilterIndex:this.userSetting.FilterIndexForCustomer,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ACCODE",title:"CODE",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"EMAIL",title:"EMAIL",hidden:!1,noSearch:!1}]}}ngAfterViewInit(){1===this.userSetting.ENABLE_SALESMAN_ROUTE&&(this.getSalesManList(),this.genericGridsalesMan.show())}onClickNewSalesman(){1===this.userSetting.ENABLE_SALESMAN_ROUTE&&(this.getSalesManList(),this.genericGridsalesMan.show())}ngOnInit(){this._trnMainService.pageHeading="EXPORT SALES INVOICE",this._trnMainService.TrnMainObj.TRNMODE="credit"}getSalesmanRoute(i){}showLoadFromSOPopup(i){this.genericGridSO.show()}showApprovedPreformaInvoicePopup(i){this.genericPerformaInvoiceGridSO.show()}showSalesDayWise(i){this.genericCancelSales.show()}onPerformaInvoiceSelect(i){1==this.userSetting.EnableGRNInPIForCargo?this.getSelectedPerformaInvoiceCargo(i):this.getSelectedPerformaInvoice(i.VCHRNO)}oncancelSalesSelect(i){}onMemberSelect(i){this.applyReferValue?(this._trnMainService.TrnMainObj.REFERMEMBERNAME=i.FNAME,this._trnMainService.TrnMainObj.REFERMEMBERNO=i.MEMID):(this._trnMainService.TrnMainObj.MEMBERNO=i.MEMID,this._trnMainService.TrnMainObj.MEMBERNAME=i.FNAME,this._trnMainService.TrnMainObj.SCHEMENAME=i.SCHEMEID)}onClickMemberReferIDSearch(i){this.applyReferValue=!0,this.getMemberShipList(),this.genericGridMemberShip.show()}getSelectedPerformaInvoice(i){this.loadingSerive.show("Getting data, Please wait..."),this.masterService.loadHoPerformaInvoice(i).subscribe(t=>{if(this.loadingSerive.hide(),"ok"===t.status){console.log("loaded from proforma",JSON.parse(t.result)),this._trnMainService.TrnMainObj=JSON.parse(t.result),this._trnMainService.TrnMainObj.Mode="NEW";for(let n=0;n<this._trnMainService.TrnMainObj.ProdList.length;n++)this._trnMainService.TrnMainObj.ProdList[n].inputMode=!1;console.log("firstparac3"),this._trnMainService.TrnMainObj.PARAC=this._trnMainService.TrnMainObj.TRNAC,this._trnMainService.TrnMainObj.TRNACName=this._trnMainService.TrnMainObj.BILLTO,this._trnMainService.TrnMainObj.RECURREFBILL=this._trnMainService.TrnMainObj.REFBILL,this._trnMainService.TrnMainObj.REFBILL=i,this._trnMainService.TrnMainObj.VoucherPrefix="TI",this._trnMainService.TrnMainObj.VoucherType=14,this._trnMainService.pageHeading="Export Sales Invoice",this._trnMainService.TrnMainObj.TRNMODE="credit",this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.disableOnPerFormaSelect=!0}},t=>{this.loadingSerive.hide()})}getSelectedPerformaInvoiceCargo(i){this.loadingSerive.show("Getting data, Please wait..."),this.masterService.loadCargoProdList(i.VCHRNO).subscribe(t=>{this.loadingSerive.hide(),"ok"===t.status&&(this._trnMainService.TrnMainObj.ProdList=t.result,this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.PARAC=this._trnMainService.TrnMainObj.TRNAC,this._trnMainService.TrnMainObj.TRNACName=this._trnMainService.TrnMainObj.BILLTO,this._trnMainService.TrnMainObj.RECURREFBILL=this._trnMainService.TrnMainObj.REFBILL,this._trnMainService.TrnMainObj.REFBILL=i.VCHRNO,this._trnMainService.TrnMainObj.COUNTRY=i.COUNTRY,this._trnMainService.TrnMainObj.AdditionalObj.TRANSPORTATIONMODE=i.TRANSPORTATIONMODE,this._trnMainService.TrnMainObj.FCurrency=i.FOREIGN_CURR,this._trnMainService.TrnMainObj.EXRATE=i.CurRate,this._trnMainService.TrnMainObj.ProdList.forEach(n=>n.NETAMOUNT=n.AMOUNT),this.getCostCenterforCargo(t),this._trnMainService.TrnMainObj.VoucherPrefix="TI",this._trnMainService.TrnMainObj.VoucherType=14,this._trnMainService.pageHeading="Export Sales Invoice",this._trnMainService.TrnMainObj.AdditionalObj.PAYMENTTERMS="TELEX",this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),this.calculateCargoTotal(),this._trnMainService.disableOnPerFormaSelect=!0,this._trnMainService.disableCostCenterForCargo=!0)},t=>{this.loadingSerive.hide()})}calculateCargoTotal(){this._trnMainService.TrnMainObj.TOTALSQTY=0,this._trnMainService.TrnMainObj.GROSSAMNT=0,this._trnMainService.TrnMainObj.NONTAXABLE=0,this._trnMainService.TrnMainObj.NETAMNT=0,this._trnMainService.TrnMainObj.TOTAMNT=0,this._trnMainService.TrnMainObj.ProdList.forEach(i=>{this._trnMainService.TrnMainObj.TOTALSQTY+=i.ALTERNATEQUANTIY,this._trnMainService.TrnMainObj.GROSSAMNT+=i.AMOUNT,this._trnMainService.TrnMainObj.NONTAXABLE=this._trnMainService.TrnMainObj.GROSSAMNT,this._trnMainService.TrnMainObj.NETAMNT=this._trnMainService.TrnMainObj.GROSSAMNT,this._trnMainService.TrnMainObj.TOTAMNT=this._trnMainService.TrnMainObj.GROSSAMNT})}getCostCenterforCargo(i){this.masterService.getAllCostCenter().subscribe(t=>{this.costlists=t;let n=this.costlists.filter(r=>r.COSTCENTERNAME==i.result[0].BOOKINGID);n&&(this._trnMainService.TrnMainObj.COSTCENTER=n[0].CCID)},t=>{this.costlists=[]})}onSalesOrderSelect(i){this.masterService.loadSalesInvoiceFromSalesOrder(i.VCHRNO).subscribe(t=>{if("ok"===t.status){if(this._trnMainService.TrnMainObj=JSON.parse(t.result),this._trnMainService.TrnMainObj.Mode="NEW",!this._trnMainService.TrnMainObj||!this._trnMainService.TrnMainObj.ProdList||void 0===this._trnMainService.TrnMainObj.ProdList)return;this._trnMainService.TrnMainObj.REFBILL=i.VCHRNO,this._trnMainService.TrnMainObj.VoucherType=14,this._trnMainService.TrnMainObj.VoucherPrefix="TI",this._trnMainService.TrnMainObj.TransporterEway={},this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate();for(let r in this._trnMainService.TrnMainObj.ProdList){this._trnMainService.setAltunitDropDownForView(r),this._trnMainService.AssignSellingPriceAndDiscounts(this._trnMainService.TrnMainObj.ProdList[r].PClist,r);let s=this._trnMainService.TrnMainObj.ProdList[r].ALTUNITObj;this._trnMainService.RealQuantitySet(r,null==s?1:s.CONFACTOR),this._trnMainService.TrnMainObj.ProdList[r].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[r].MFGDATE?"":this._trnMainService.TrnMainObj.ProdList[r].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[r].EXPDATE?"":this._trnMainService.TrnMainObj.ProdList[r].EXPDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[r].inputMode=!0,this._trnMainService.TrnMainObj.ProdList[r].VCHRNO=this._trnMainService.TrnMainObj.VCHRNO;let h=0;this._trnMainService.TrnMainObj.ProdList[r].inputMode=!0,h=this._trnMainService.TrnMainObj.ProdList[r].PRATE}var n=this._trnMainService.TrnMainObj.ProdList.filter(r=>r.SELECTEDITEM.STOCK<=0);this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(r=>r.SELECTEDITEM.STOCK>0),this._trnMainService.ReCalculateBillWithNormal(),null!=n&&n.length>0&&this.alertService.error("Some Of the item have been excluded because of unavailable Stock")}},t=>{})}onItemDoubleClick(i){this._trnMainService.TrnMainObj.REFORDBILL=i.VCHRNO,this._trnMainService.loadSODataToSales(i.VCHRNO)}onSalesCancelSelect(i){this.loadTaxInvoiceForCancel(i.VCHRNO,i.DIVISION,i.PhiscalId)}onClickMemberIDSearch(i){this.getMemberShipList(),this.genericGridMemberShip.show()}loadTaxInvoiceForCancel(i,t,n){this.loadingSerive.show("Getting data, Please wait..."),this.masterService.LoadTransaction(i,t,n).subscribe(r=>{if(this.loadingSerive.hide(),"ok"===r.status){this._trnMainService.TrnMainObj=r.result,this._trnMainService.TrnMainObj.REFBILL=i,this._trnMainService.TrnMainObj.VoucherType=61,this._trnMainService.pageHeading="Export Sales Invoice [Cancel]",this._trnMainService.TrnMainObj.VoucherPrefix="SC",this._trnMainService.TrnMainObj.Mode="VIEW",this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate();for(let s in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.setAltunitDropDownForViewStock(s),this._trnMainService.getPricingOfItem(s,"",!0),this._trnMainService.TrnMainObj.ProdList[s].inputMode=!1}},r=>{this.loadingSerive.hide()})}getRouteListSalesmanWise(i){this.masterService.getRouteListBasedUponSalesman(i).subscribe(t=>{this.RouteList=t})}onClickCreateCustomer(){}onClickCustomerHide(){}DisplayCustomerProfile(i){!1===i&&this.popupCustomerCreation.show()}calculateMemberPointsForView(){this.removeInvalidRowsFromprod(),this._trnMainService.TrnMainObj.ProdList.length&&this.masterService.postMemberPointCalculation(this._trnMainService.TrnMainObj).subscribe(i=>{"ok"==i.status&&(this._trnMainService.TrnMainObj.EARNPOINS=i.result.pointsGained)})}onClickPoReferenceProduct(i){i&&(this._trnMainService.purchaseOrderQty=i.ALTERNATEQTY,this._trnMainService.purchaseOrderRate=i.RATE)}removeInvalidRowsFromprod(){this._trnMainService.TrnMainObj.ProdList.length>1&&(this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(i=>null!=i.MCODE&&""!=i.MCODE))}showReverseVoucherInvoicePopup(i){this.genericReverseInvoiceGridSO.show()}onReverseEntrySelect(i){this.getReverseInvoice(i.VCHRNO)}getReverseInvoice(i){this.loadingSerive.show("Getting data, Please wait..."),this.masterService.loadReverseInvoice(i).subscribe(t=>{if(this.loadingSerive.hide(),"ok"===t.status){this._trnMainService.TrnMainObj=JSON.parse(t.result),this._trnMainService.TrnMainObj.Mode="NEW";for(let n=0;n<this._trnMainService.TrnMainObj.ProdList.length;n++)this._trnMainService.TrnMainObj.ProdList[n].inputMode=!1;console.log("firstparac5"),this._trnMainService.TrnMainObj.PARAC=this._trnMainService.TrnMainObj.TRNAC,this._trnMainService.TrnMainObj.TRNACName=this._trnMainService.TrnMainObj.BILLTO,this._trnMainService.TrnMainObj.REFBILL=i,this._trnMainService.TrnMainObj.VoucherPrefix="TI",this._trnMainService.TrnMainObj.VoucherType=14,this._trnMainService.pageHeading="Export Sales Invoice",this._trnMainService.TrnMainObj.TRNMODE="credit",this._trnMainService.getVoucherNumber(),this._trnMainService.getCurrentDate(),this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.disableOnPerFormaSelect=!0}},t=>{this.loadingSerive.hide()})}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(I.P),e.Y36(f.p),e.Y36(L.gz),e.Y36(D.c),e.Y36(y.V),e.Y36(P.e),e.Y36(e.sBO))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-exportsales-invoice"]],viewQuery:function(i,t){if(1&i&&(e.Gf(Zr,5),e.Gf(Fr,5),e.Gf(kr,5),e.Gf(Ur,5),e.Gf(Vr,5),e.Gf(Br,5),e.Gf(Gr,5),e.Gf(Hr,5),e.Gf(qr,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.genericGridSO=n.first),e.iGM(n=e.CRH())&&(t.genericPerformaInvoiceGridSO=n.first),e.iGM(n=e.CRH())&&(t.genericCancelSales=n.first),e.iGM(n=e.CRH())&&(t.popupCustomerCreation=n.first),e.iGM(n=e.CRH())&&(t.genericGridMemberShip=n.first),e.iGM(n=e.CRH())&&(t.genericGridsalesMan=n.first),e.iGM(n=e.CRH())&&(t.genericReverseInvoiceGridSO=n.first),e.iGM(n=e.CRH())&&(t.genericGridSalesManRoute=n.first),e.iGM(n=e.CRH())&&(t.genericGridCustomerListBySalesmanAndRoute=n.first)}},hostBindings:function(i,t){1&i&&e.NdJ("keydown",function(r){return t.updown(r)},!1,e.evT)},features:[e._Bn([f.p])],decls:17,vars:7,consts:[[1,"sectionWrapper"],[1,"topWrapper"],["class","sticky-top",4,"ngIf"],["class","main-container",4,"ngIf"],[1,"midTableWrapper"],[1,"row","row-margin"],[1,"col-md-12","pd5"],[3,"onClickItemSelectPopUp"],["class","footer-wrapper",4,"ngIf"],[3,"popupsettings","onItemDoubleClick"],["genericGridMemberShip",""],["genericGridsalesMan",""],["genericGridSalesManRoute",""],["genericGridCustomerListBySalesmanAndRoute",""],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-2","pd0"],[1,"col-md-3","pd0"],[2,"white-space","nowrap","margin-left","-145px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[3,"onMemberIDSearch","onMemberReferIDSearch","onClickSlider"],[1,"col-md-2","row",2,"padding-top","0.8vh","font-size","15px","font-style","italic","padding-left","0px","padding-right","0px"],[4,"ngIf"],[1,"col-md-5","pd0"],[3,"onLoadFromSOClickEmit","onLoadFromPerformaInvoiceClickEmit","onLoadCancelSalesEmit","onClickSalesMan","onLoadFromReverseEntryEmit","onclickOnResetPopupEmit","onSaveSelfBilling"],["genericGridSO",""],["genericPerformaInvoiceGridSO",""],["genericCancelSales",""],["genericReverseInvoiceGridSO",""],[1,"col-md-7","pd0"],[1,"main-container"],[3,"hidden"],["viewDisable","disableView"],["class","col-md-12 pd5",4,"ngIf"],[1,"footer-wrapper"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Qr,21,7,"div",2),e.YNc(3,Kr,5,2,"div",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"productentry",7),e.NdJ("onClickItemSelectPopUp",function(r){return t.onClickPoReferenceProduct(r)}),e.qZA()()()(),e.YNc(8,Wr,2,0,"div",8),e.qZA(),e.TgZ(9,"generic-popup-grid",9,10),e.NdJ("onItemDoubleClick",function(r){return t.onMemberSelect(r)}),e.qZA(),e.TgZ(11,"generic-popup-grid",9,11),e.NdJ("onItemDoubleClick",function(r){return t.onSalesManSelect(r)}),e.qZA(),e.TgZ(13,"generic-popup-grid",9,12),e.NdJ("onItemDoubleClick",function(r){return t.onRouteSelect(r)}),e.qZA(),e.TgZ(15,"generic-popup-grid",9,13),e.NdJ("onItemDoubleClick",function(r){return t.onCustomerSelected(r)}),e.qZA()),2&i&&(e.xp6(2),e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName),e.xp6(5),e.Q6J("ngIf",!t._trnMainService.TrnMainObj.hasShipName),e.xp6(1),e.Q6J("popupsettings",t.gridPopupSettingsForMember),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsalesMan),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForSalesManRoute),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForCustomerListBySalesmanAndRoute))},dependencies:[T.O5,V.x,U,R.q,x.i,F.u,K.d,u.Zl,B.o,T.H9],styles:[".GRNPopUp[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.GRNPopUp[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#123456!important;color:#fff}.modal-dialog.modal-md[_ngcontent-%COMP%], .modal-dialog.modal-sm[_ngcontent-%COMP%]{top:45%;margin-top:0}",".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n    text-align: center;\n    vertical-align: middle;\n  }"]}),a})();const Xr=["genericViewpopup"];function $r(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"button",6,31),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.saveDenomination())}),e._uU(2,"Save"),e.qZA()}}function ea(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"button",6,31),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.onPrint())}),e._uU(2,"Print"),e.qZA()}}function ia(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"tr")(1,"td",32),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"input",33),e.NdJ("change",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.calculateDenomination())})("ngModelChange",function(n){const s=e.CHM(i).$implicit;return e.KtG(s.qty=n)}),e.qZA()(),e.TgZ(5,"td",34),e._uU(6),e.qZA()()}if(2&a){const i=o.$implicit,t=e.oxw();e.xp6(2),e.Oqu(i.denO_NAME),e.xp6(2),e.Q6J("ngModel",i.qty)("disabled",t.disableonview),e.xp6(2),e.hij(" ",i.amount," ")}}function ta(a,o){1&a&&e.GkF(0)}function na(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",35)(1,"div",36)(2,"div",37)(3,"h4",38),e._uU(4,"Print Preview"),e.qZA()(),e.TgZ(5,"div",39)(6,"pre"),e._uU(7),e.qZA()(),e.TgZ(8,"div",40)(9,"button",41),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.cancelprint())}),e._uU(10," Close "),e.qZA(),e.TgZ(11,"button",42),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.printPosBill())}),e._uU(12," Print "),e.qZA()()()()}if(2&a){const i=e.oxw();e.xp6(7),e.hij("        ",i.print,"\n      ")}}let ra=(()=>{class a{constructor(i,t,n,r,s){this.authService=i,this.masterService=t,this._trnMainService=n,this.alertService=r,this.loadingservice=s,this.total=0,this.screenOne=!0,this.counterArray=[],this.denoArray=[],this.amountArray=[],this.showPosPrinterPreview=!1,this.settlementAmount=0,this.disableonview=!1,this.promptPrintDevice=!1,this.genericGridViewSettings=new u.im}ngOnInit(){this.userProfile=this.authService.getUserProfile(),this.obj={VoucherPrefix:"CS",DIVISION:this.userProfile.userDivision,PhiscalID:this.userProfile.PhiscalYearInfo.PhiscalID,VoucherName:"Cash Settlement"},this.masterService.masterGetmethod("/getDenominationList").subscribe(i=>{"ok"==i.status&&(this.denoList=i.result)}),this.masterService.getVoucherNo(this.obj).subscribe(i=>{this.userSettlement=i.result.VCHRNO})}enableSaveButton(){return!!$()(new Date).isSame(this.date,"day")}changeMorningCash(i){this.calculateDenomination()}changeCashTaken(i){this.calculateDenomination()}dateChange(i){this.noOfBills=null,this.noOfItems=null,this.totalSales=null,this.discountAmount=null,this.modeOfPaymentList=null,this.date=i.target.value}reset(){this.masterService.masterGetmethod("/getDenominationList").subscribe(i=>{"ok"==i.status&&(this.denoList=i.result)}),this.masterService.getVoucherNo(this.obj).subscribe(i=>{this.userSettlement=i.result.VCHRNO}),this.disableonview=!1,this.total=0}canclePreview(){this.showPosPrinterPreview=!1}calculateDenomination(){this.total=this.masterService.nullToZeroConverter(this.morningCash)-this.masterService.nullToZeroConverter(this.cashTaken);for(let i of this.denoList)i.amount=this.masterService.nullToZeroConverter(i.qty)*i.basevalue,this.total=this.total+i.amount}changeScreen(){this.screenOne=1!=this.screenOne}saveDenomination(){this.denoList.forEach(i=>{i.morning_cash=this.morningCash,i.cash_taken=this.cashTaken,i.total=this.total}),this.loadingservice.show("Saving data, please wait.."),this.masterService.saveDenomination(this.denoList).subscribe(i=>{"ok"==i.status?(this.loadingservice.hide(),this.alertService.success("Data Saved SuccessFully"),this.masterService.getVoucherNo(this.obj).subscribe(t=>{this.userSettlement=t.result.VCHRNO}),this.denoList.forEach(t=>{t.amount=0,t.qty=0}),this.total=0,this.onPrint()):(this.loadingservice.hide(),this.alertService.warning(i.result.error))},i=>{this.loadingservice.hide()})}printPosBill(i){var t;(t=new WebSocket("ws://127.0.0.1:1660")).addEventListener("message",function r(){},!1),t.addEventListener("open",function n(s){alert("Are you sure to print?"),t.onopen=()=>t.send(s)}(this.print),!1),this.showPosPrinterPreview=!1}printDayEndBill(){this.printPosBill(this.print)}onPrint(){null==this.userSettlement||null==this.userSettlement||""==this.userSettlement||this.masterService.masterGetmethod(`/getprintCashHandover?dateTime=${this.date}&sessionId=${this.userSettlement}`).subscribe(i=>{this.print=i.result,console.log("print",i.result),this.showPosPrinterPreview=!0})}denoprint(){let i=[];this.denoList.forEach(t=>{i.push({Qty:t.qty+"  =",amount:t.amount,deno_name:t.denO_NAME+"  X"})}),i.push({Qty:this.denoList.reduce((t,n)=>t+(n.qty||0),0),amount:this.denoList.reduce((t,n)=>t+(n.amount||0),0),deno_name:"TOTAL   "}),this.masterService.masterPostmethod("/getDenoPrint",i).subscribe(t=>{this.print=t.result,this.showPosPrinterPreview=!0})}viewDenomination(){this.genericGridViewSettings={title:"Cash",apiEndpoints:"/getCashSettlementPagedList",defaultFilterIndex:1,columns:[{key:"Date",title:"Date",hidden:!1,noSearch:!1},{key:"User",title:"User",hidden:!1,noSearch:!1},{key:"SESSIONID",title:"Cash settlement ID",hidden:!1,noSearch:!1},{key:"Amount",title:"Total Amount",hidden:!1,noSearch:!1,alignment:"right"}]},this.genericViewpopup.show()}onCachSettlementSelect(i){this.masterService.masterGetmethod(`/getCashSettlementFromID?sessionID=${i.SESSIONID}`).subscribe(t=>{"ok"==t.status?(this.denoList=t.result,this.total=t.result.map(n=>n.amount).reduce((n,r)=>n+r),this.date=t.result[0].TRNDATE.toString().substring(0,10),this.userSettlement=t.result[0].SESSIONID,this.disableonview=!0):this.alertService.error(t.result)},t=>{this.alertService.error(t)})}cancelprint(){this.promptPrintDevice=!1,this.showPosPrinterPreview=!1}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(P.e),e.Y36(I.P),e.Y36(f.p),e.Y36(D.c),e.Y36(y.V))},a.\u0275cmp=e.Xpm({type:a,selectors:[["cash-handover"]],viewQuery:function(i,t){if(1&i&&e.Gf(Xr,5),2&i){let n;e.iGM(n=e.CRH())&&(t.genericViewpopup=n.first)}},decls:52,vars:14,consts:[[1,"sticky-top","row"],[1,"col-md-4"],[2,"white-space","nowrap","margin-bottom","8px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-8",2,"padding-right","3vw"],[1,"row","pull-right"],["type","button","class","btn  btn-info","style","font-size: 12px;",3,"click",4,"ngIf"],["type","button",1,"btn","btn-info",2,"font-size","12px",3,"click"],["view",""],[1,"card"],[1,"card-body"],[1,"row","col-md-12","plainBackGround",2,"margin","0px !important","padding","0","height","2.5rem"],[1,"row"],[2,"width","25%"],["type","date","name","date",1,"head",2,"margin-left","-10%",3,"max","ngModel","disabled","change","ngModelChange"],[2,"width","14%","margin-left","-15%"],["type","text","readonly","",1,"head",2,"width","70%",3,"ngModel","disabled","ngModelChange"],[2,"width","31%","margin-left","-14%"],["type","text","readonly","",1,"head",2,"width","70%","margin-left","4%",3,"ngModel","disabled","ngModelChange"],[2,"padding","0 !important","margin-top","2rem"],[2,"display","flex","justify-content","center"],[1,"tableBorder",2,"padding","10px","width","60%"],[2,"background-color","#f7f7f7","padding-left","10px"],[2,"padding-left","10px","background-color","#f7f7f7"],[2,"background-color","#f7f7f7"],[4,"ngFor","ngForOf"],["colspan","2"],["colspan","2",2,"background-color","#f7f7f7","text-align","end"],[3,"popupsettings","onItemDoubleClick"],["genericViewpopup",""],[4,"ngIf","ngIfThen"],["printPopup",""],["save",""],[2,"padding-left","10px"],["type","number",2,"text-align","end",3,"ngModel","disabled","change","ngModelChange"],[2,"background-color","#f7f7f7","text-align","end"],[1,"print-modal-sticky"],[1,"modal-content","modal-content-main-area",2,"width","100%"],[1,"modal-header"],["id","myModalLabel",1,"modal-title"],[1,"modal-body",2,"height","320px","overflow-y","scroll"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"CASH HANDOVER"),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4),e.YNc(6,$r,3,0,"button",5),e.YNc(7,ea,3,0,"button",5),e.TgZ(8,"button",6),e.NdJ("click",function(){return t.reset()}),e._uU(9,"Reset"),e.qZA(),e.TgZ(10,"button",6,7),e.NdJ("click",function(){return t.viewDenomination()}),e._uU(12,"View"),e.qZA()()()(),e.TgZ(13,"div",8)(14,"div",9)(15,"div",10)(16,"div",1)(17,"div",11)(18,"label",12),e._uU(19,"Date :"),e.qZA(),e.TgZ(20,"input",13),e.NdJ("change",function(r){return t.dateChange(r)})("ngModelChange",function(r){return t.date=r}),e.qZA()()(),e.TgZ(21,"div",1)(22,"div",11)(23,"label",14),e._uU(24,"User:"),e.qZA(),e.TgZ(25,"input",15),e.NdJ("ngModelChange",function(r){return t.userProfile.username=r}),e.qZA()()(),e.TgZ(26,"div",1)(27,"div",11)(28,"label",16),e._uU(29,"Settlement ID:"),e.qZA(),e.TgZ(30,"input",17),e.NdJ("ngModelChange",function(r){return t.userSettlement=r}),e.qZA()()()(),e.TgZ(31,"div",18)(32,"div",19)(33,"table",20)(34,"tr")(35,"th",21),e._uU(36," Deno "),e.qZA(),e.TgZ(37,"th",22),e._uU(38," Count "),e.qZA(),e.TgZ(39,"th",23),e._uU(40,"Amount"),e.qZA()(),e.YNc(41,ia,7,4,"tr",24),e.TgZ(42,"tr")(43,"td",25),e._uU(44,"Total"),e.qZA(),e.TgZ(45,"td",26),e._uU(46),e.qZA()()()()()(),e.TgZ(47,"generic-popup-grid",27,28),e.NdJ("onItemDoubleClick",function(r){return t.onCachSettlementSelect(r)}),e.qZA(),e.YNc(49,ta,1,0,"ng-container",29),e.YNc(50,na,13,1,"ng-template",null,30,e.W1O),e.qZA()),2&i){const n=e.MAs(51);e.xp6(6),e.Q6J("ngIf",!t.disableonview),e.xp6(1),e.Q6J("ngIf",t.disableonview),e.xp6(13),e.Q6J("max",t.date)("ngModel",t.date)("disabled",t.disableonview),e.xp6(5),e.Q6J("ngModel",t.userProfile.username)("disabled",t.disableonview),e.xp6(5),e.Q6J("ngModel",t.userSettlement)("disabled",t.disableonview),e.xp6(11),e.Q6J("ngForOf",t.denoList),e.xp6(5),e.Oqu(t.total),e.xp6(1),e.Q6J("popupsettings",t.genericGridViewSettings),e.xp6(2),e.Q6J("ngIf",t.showPosPrinterPreview)("ngIfThen",n)}},dependencies:[T.sg,T.O5,p.Fj,p.wV,p.JJ,p.On,u.Zl],styles:[".print-modal-sticky[_ngcontent-%COMP%]{display:block;padding:0;margin-bottom:25px;height:auto;position:absolute;right:0vw;width:30vw;z-index:9999999}",".GRNPopUp[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.GRNPopUp[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#123456!important;color:#fff}.modal-dialog.modal-md[_ngcontent-%COMP%], .modal-dialog.modal-sm[_ngcontent-%COMP%]{top:45%;margin-top:0}",".card[_ngcontent-%COMP%] {\n  width: 85%;\n  margin:0 auto;\n}\n\n input[_ngcontent-%COMP%]{\n    height: 26px;\n }\n\n .head[_ngcontent-%COMP%]{\n    margin-top: 3px;\n\n }"]}),a})();var de=_(33159);function aa(a,o){if(1&a&&(e.ynx(0),e.TgZ(1,"div",17)(2,"span")(3,"b"),e._uU(4,"SO Qty:"),e.qZA(),e._uU(5),e.qZA()(),e.TgZ(6,"div",18)(7,"span")(8,"b"),e._uU(9,"Rate:"),e.qZA(),e._uU(10),e.ALo(11,"currency"),e.qZA()(),e.BQk()),2&a){const i=e.oxw();e.xp6(5),e.hij("\xa0",i._trnMainService.purchaseOrderQty," \xa0"),e.xp6(5),e.hij("\xa0",e.Dn7(11,2,i._trnMainService.purchaseOrderRate,"INR","Rs. ")," ")}}function oa(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div")(1,"trnmain-parameters-master",19),e.NdJ("enterClickOnRefnoEventEmit",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.EnterClickEmitFromRefno(n.event))}),e.qZA()()}}function sa(a,o){1&a&&(e.TgZ(0,"div",14),e._UZ(1,"discounts-insert"),e.qZA())}let la=(()=>{class a{constructor(i,t,n,r,s,c,h,d,v,A,O){this.route=i,this.masterService=t,this.authService=n,this.alertService=r,this.loadingSerive=s,this._trnMainService=c,this.itemKeyEventService=h,this.entryValidateService=d,this.genericProductEntryService=v,this.quantityChangeEventService=A,this.productHelper=O,this._trnMainService.initialFormLoad(83)}ngOnInit(){this.setProductEntryTable()}setProductEntryTable(){var i=this._trnMainService.TrnMainObj.ProdList;this.genericProductEntrySetting=new J.Vn(this._trnMainService),this.genericProductEntrySetting.columns=[{field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"40px"}},{field:"BC",header:"Barcode",hidden:!1,isActiveColumnHeader:!0,inputType:"barcodeInputText",headerNgStyle:{width:"90px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r)},{field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"350px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableItemDesc",n,r),focusTo:2==this.masterService.userSetting.EnablePartialSalesFromDeliveryChalan?"ALTERNATEQUANTIY":"ALTUNIT"},{field:"BATCH",header:"Batch",hidden:0==this._trnMainService.userSetting.EnableBatch||1==this._trnMainService.userSetting.ENABLESINGLEBATCHMODE||1==this._trnMainService.userSetting.EnableBatch&&0===this._trnMainService.userSetting.EnableProperExpTracking&&0===this._trnMainService.userSetting.EnableBatchWisePrice,isActiveColumnHeader:!0,inputType:"batch",headerNgStyle:{width:"80px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableBatch",n,r),onEnter:(n,r,s,c)=>{this.genericProductEntryService.BatchEnter(n,r,s,c)},onKeyPress:(n,r)=>{this.genericProductEntryService.onKeyDownBatch(n,r)}},{field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"unitsOption",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},focusTo:"ALTERNATEQUANTIY",disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltUnit",n,r),onEnter:(n,r,s,c)=>this.entryValidateService.AlternateUnitEnterEventClick(n,r,s,c)},{field:"ALTERNATEQUANTIY",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"ALTRATE",onChange:(n,r,s)=>this.QuantityChangeEvent_default(n,r,s),applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r),onEnter:(n,r,s)=>this.mrpEnterEvent(n,r,s),decimalPlacesRestriction:"3"},{field:"ALTRATE",header:"Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,onEnter:(n,r,s)=>this.mrpEnterEvent(n,r,s),onChange:(n,r,s,c)=>this.entryValidateService.MRPChangeEvent(n,r,s,c),focusTo:"INDDISCOUNTRATE",disablePipe:(n,r)=>this.getColumnDisablePipe("disableRateandDiscount",n,r)},{field:"AMOUNT",header:"Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"VAT",header:"VAT",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"70px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"}}],this.genericProductEntrySetting.height="100%",this.genericProductEntrySetting.prodlist=i,this.genericProductEntrySetting.voucherType=l.Km.PerformaSalesInvoice,this.genericProductEntrySetting.setRowItemFromSelectedItem=n=>this.SetRowItemFromSelectedItem(n),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(n,r=new Function)=>this.SetRowItemRate(n,r)}showGenericGrid(i){this.itemKeyEventService.ItemkeyEvent(i.index,i.event,()=>S.K.default,t=>S.K.default,()=>S.K.default,()=>S.K.default,()=>S.K.default)}SetRowItemFromSelectedItem(i){this._trnMainService.prepareItem(this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex],i)}SetAllUnitsOfItem(){this._trnMainService.getAllUnitsOfItem(this.genericProductEntryService.activerowIndex)}QuantityChangeEvent_default(i,t,n){this.quantityChangeEventService.QuantityChangeEvent(n)}SetRowItemRate(i,t){t()}getColumnDisablePipe(i,t,n){return i}mrpEnterEvent(i,t,n){this.entryValidateService.mrpEnterEvent(i,t,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}EnterClickEmitFromRefno(i){if(1==this.masterService.userSetting.EnablePetrolPumpFeatures){const t=parseInt(this._trnMainService.TrnMainObj.REFBILL);Number.isFinite(t)&&this.masterService.masterGetmethod(`/checkActiveCoupon?couponNo=${t}`).subscribe(n=>{"ok"===n.status?this.assignCustomerInformation(n.result):(this._trnMainService.TrnMainObj.BILLTO=void 0,this._trnMainService.TrnMainObj.BILLTOADD=void 0,this._trnMainService.TrnMainObj.RECEIVEBY=void 0,this._trnMainService.TrnMainObj.PARAC=void 0,this._trnMainService.TrnMainObj.BILLTOTEL=void 0,this.productHelper.communicateToTrnMain({}))})}}assignCustomerInformation(i){this._trnMainService.TrnMainObj.BILLTO=i.ACNAME,this._trnMainService.TrnMainObj.BILLTOADD=i.ADDRESS,this._trnMainService.TrnMainObj.RECEIVEBY=i.ACID,this._trnMainService.TrnMainObj.PARAC=i.ACID,this._trnMainService.TrnMainObj.BILLTOTEL=i.VATNO,this.productHelper.communicateToTrnMain(i)}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(L.gz),e.Y36(I.P),e.Y36(P.e),e.Y36(D.c),e.Y36(y.V),e.Y36(f.p),e.Y36(S.X),e.Y36(Z.C),e.Y36(j.w),e.Y36(w.s),e.Y36(ie.h))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-delivery-chalan"]],features:[e._Bn([f.p,S.X,Z.C,j.w,w.s])],decls:23,vars:6,consts:[[1,"sectionWrapper"],[1,"topWrapper"],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-2"],[1,"col-md-3"],[2,"white-space","nowrap","margin-left","-145px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-2","row",2,"padding-top","0.8vh","font-size","15px","font-style","italic","padding-left","0px","padding-right","0px"],[4,"ngIf"],[1,"col-md-5"],[1,"main-container"],[1,"row","row-margin"],["class","col-md-12 pd5",4,"ngIf"],[1,"midTableWrapper"],[1,"col-md-12","pd5"],[3,"GenericProductEntrySetting","ShowGenericGridEvent"],[1,"footer-wrapper"],[1,"col-md-5","pd0"],[1,"col-md-7","pd0"],[3,"enterClickOnRefnoEventEmit"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"voucher-master-toggler"),e.qZA(),e.TgZ(6,"div",5)(7,"label",6),e._uU(8),e.qZA()(),e.TgZ(9,"div",7),e.YNc(10,aa,12,6,"ng-container",8),e.qZA(),e.TgZ(11,"div",9),e._UZ(12,"voucher-master-action"),e.qZA()()(),e.TgZ(13,"div",10),e.YNc(14,oa,2,0,"div",8),e.TgZ(15,"div",11),e.YNc(16,sa,2,0,"div",12),e.qZA()()(),e.TgZ(17,"div",13)(18,"div",11)(19,"div",14)(20,"generic-product-entry",15),e.NdJ("ShowGenericGridEvent",function(r){return t.showGenericGrid(r)}),e.qZA()()()(),e.TgZ(21,"div",16),e._UZ(22,"voucher-total-area"),e.qZA()()),2&i&&(e.xp6(8),e.AsE("",t._trnMainService.pageHeading," [",t._trnMainService.TrnMainObj.Mode,"]"),e.xp6(2),e.Q6J("ngIf",0!=t.masterService.userSetting.ENABLE_SOINTI&&0!=t.masterService.userSetting.ENABLE_SOINDCHALAN&&t._trnMainService.TrnMainObj.REFORDBILL),e.xp6(4),e.Q6J("ngIf",t.masterService.ShowMore),e.xp6(2),e.Q6J("ngIf",1==t.masterService.userSetting.GblBarcodeWiseBilling),e.xp6(4),e.Q6J("GenericProductEntrySetting",t.genericProductEntrySetting))},dependencies:[T.O5,U,R.q,x.i,F.u,B.o,de.Z,T.H9]}),a})();function ca(a,o){1&a&&(e.TgZ(0,"div"),e._UZ(1,"trnmain-parameters-master"),e.qZA())}function da(a,o){1&a&&(e.TgZ(0,"div",12),e._UZ(1,"discounts-insert"),e.qZA())}let ha=(()=>{class a{constructor(i,t,n,r,s,c,h,d,v,A){this.route=i,this.masterService=t,this.authService=n,this.alertService=r,this.loadingSerive=s,this._trnMainService=c,this.itemKeyEventService=h,this.entryValidateService=d,this.genericProductEntryService=v,this.quantityChangeEventService=A,this._trnMainService.initialFormLoad(21)}ngOnInit(){this.setProductEntryTable()}setProductEntryTable(){var i=this._trnMainService.TrnMainObj.ProdList;this.genericProductEntrySetting=new J.Vn(this._trnMainService),this.genericProductEntrySetting.columns=[{field:"SNO",header:"Sno",hidden:!1,isActiveColumnHeader:!1,isSno:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"40px"}},{field:"BC",header:"Barcode",hidden:!1,isActiveColumnHeader:!0,inputType:"barcodeInputText",headerNgStyle:{width:"90px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r)},{field:"ITEMDESC",header:"Particular",hidden:!1,isActiveColumnHeader:!0,inputType:"itemDesc",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"350px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableItemDesc",n,r),focusTo:"ALTUNIT"},{field:"BATCH",header:"Batch",hidden:0==this._trnMainService.userSetting.EnableBatch||1==this._trnMainService.userSetting.ENABLESINGLEBATCHMODE||1==this._trnMainService.userSetting.EnableBatch&&0===this._trnMainService.userSetting.EnableProperExpTracking&&0===this._trnMainService.userSetting.EnableBatchWisePrice,isActiveColumnHeader:!0,inputType:"batch",headerNgStyle:{width:"80px"},disablePipe:(n,r)=>this.getColumnDisablePipe("disableBatch",n,r),onEnter:(n,r,s,c)=>{this.genericProductEntryService.BatchEnter(n,r,s,c)},onKeyPress:(n,r)=>{this.genericProductEntryService.onKeyDownBatch(n,r)}},{field:"ALTUNIT",header:"Unit",hidden:!1,isActiveColumnHeader:!0,inputType:"unitsOption",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},focusTo:"ALTERNATEQUANTIY",disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltUnit",n,r),onEnter:(n,r,s,c)=>this.entryValidateService.AlternateUnitEnterEventClick(n,r,s,c)},{field:"ALTERNATEQUANTIY",header:"Quantity",hidden:!1,isActiveColumnHeader:!0,inputType:"quantity",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},focusTo:"ITEMDESC",onEnter:(n,r,s)=>{this.genericProductEntryService.QuantityEnterClicked(n,r,s)},onChange:(n,r,s)=>this.QuantityChangeEvent_default(n,r,s),applyTwoDigitPipe:!1,disablePipe:(n,r)=>this.getColumnDisablePipe("disableAltQty",n,r),decimalPlacesRestriction:"3"},{field:"ALTRATE",header:"Rate",hidden:!1,isActiveColumnHeader:!0,inputType:"number",headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0,disablePipe:(n,r)=>this.getColumnDisablePipe("disableRateandDiscount",n,r)},{field:"AMOUNT",header:"Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"80px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"VAT",header:"VAT",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"60px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"NETAMOUNT",header:"Net Amt",hidden:!1,isActiveColumnHeader:!0,headerNgStyle:{borderRight:"1px solid #e6e6e6",width:"70px"},columnNgStyle:{width:"100%","text-align":"right"},applyTwoDigitPipe:!0},{field:"",header:"",hidden:!1,isActiveColumnHeader:!0,removeButton:!0,headerNgStyle:{width:"30px"},columnNgStyle:{width:"100%","text-align":"right"}}],this.genericProductEntrySetting.height="100%",this.genericProductEntrySetting.prodlist=i,this.genericProductEntrySetting.voucherType=l.Km.PerformaSalesInvoice,this.genericProductEntrySetting.setRowItemFromSelectedItem=n=>this.SetRowItemFromSelectedItem(n),this.genericProductEntrySetting.setAllUnitsOfItem=()=>this.SetAllUnitsOfItem(),this.genericProductEntrySetting.setRowItemRate=(n,r=new Function)=>this.SetRowItemRate(n,r)}showGenericGrid(i){this.itemKeyEventService.ItemkeyEvent(i.index,i.event,()=>S.K.default,t=>S.K.default,()=>S.K.default,()=>S.K.default,()=>S.K.default)}SetRowItemFromSelectedItem(i){let t=this._trnMainService.TrnMainObj.ProdList[this.genericProductEntryService.activerowIndex];this._trnMainService.prepareItem(t,i),this.assignAlternateUnitInCaseOfPartialReturn(t,i),this.prepareAlternateUnitList(t,i)}assignAlternateUnitInCaseOfPartialReturn(i,t){i.ALTUNIT=t.ALTUNIT,i.ALTRATE=t.ALTRATE,i.PRATE=t.PRATE,i.RATE=t.RATE,i.BATCH=t.BATCH,i.UNIT=t.UNIT,i.BASEUNIT=t.UNIT,i.STOCK=t.STOCK,i.WAREHOUSE=t.WAREHOUSE,i.INDDISCOUNTRATE=t.INDDISCOUNTRATE,i.INDDISCOUNT=t.INDDISCOUNT,console.log("firsrtdebugger",i,t)}SetAllUnitsOfItem(){}prepareAlternateUnitList(i,t){let n={};n.ALTUNIT=t.ALTUNIT,n.CONFACTOR=t.ALTCONFACTOR,i.Product={},i.Product.MCODE=i.MCODE,i.Product.AlternateUnits=[],i.ALTUNIT=t.ALTUNIT,i.ALTCONFACTOR=t.ALTCONFACTOR,i.Product.AlternateUnits.push(n),console.log("prodlist",i),this._trnMainService.ReCalculateBillWithNormal()}QuantityChangeEvent_default(i,t,n){this.quantityChangeEventService.QuantityChangeEvent(n)}SetRowItemRate(i,t){t()}getColumnDisablePipe(i,t,n){return i}mrpEnterEvent(i,t,n){this.entryValidateService.mrpEnterEvent(i,t,n,()=>"default",()=>({useDefault:!0,preCheck:!0}),()=>!1)}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(L.gz),e.Y36(I.P),e.Y36(P.e),e.Y36(D.c),e.Y36(y.V),e.Y36(f.p),e.Y36(S.X),e.Y36(Z.C),e.Y36(j.w),e.Y36(w.s))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-delivery-chalan-return"]],features:[e._Bn([f.p,S.X,Z.C,j.w,w.s])],decls:21,vars:5,consts:[[1,"sectionWrapper"],[1,"topWrapper"],[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-2"],[1,"col-md-5"],[2,"white-space","nowrap","margin-left","-145px","margin-bottom","8px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"main-container"],[4,"ngIf"],[1,"row","row-margin"],["class","col-md-12 pd5",4,"ngIf"],[1,"midTableWrapper"],[1,"col-md-12","pd5"],[3,"GenericProductEntrySetting","ShowGenericGridEvent"],[1,"footer-wrapper"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"voucher-master-toggler"),e.qZA(),e.TgZ(6,"div",5)(7,"label",6),e._uU(8),e.qZA()(),e.TgZ(9,"div",5),e._UZ(10,"voucher-master-action"),e.qZA()()(),e.TgZ(11,"div",7),e.YNc(12,ca,2,0,"div",8),e.TgZ(13,"div",9),e.YNc(14,da,2,0,"div",10),e.qZA()()(),e.TgZ(15,"div",11)(16,"div",9)(17,"div",12)(18,"generic-product-entry",13),e.NdJ("ShowGenericGridEvent",function(r){return t.showGenericGrid(r)}),e.qZA()()()(),e.TgZ(19,"div",14),e._UZ(20,"voucher-total-area"),e.qZA()()),2&i&&(e.xp6(8),e.AsE("",t._trnMainService.pageHeading," [",t._trnMainService.TrnMainObj.Mode,"]"),e.xp6(4),e.Q6J("ngIf",t.masterService.ShowMore),e.xp6(2),e.Q6J("ngIf",1==t.masterService.userSetting.GblBarcodeWiseBilling),e.xp6(4),e.Q6J("GenericProductEntrySetting",t.genericProductEntrySetting))},dependencies:[T.O5,U,R.q,x.i,F.u,B.o,de.Z]}),a})(),_a=(()=>{class a{constructor(i){this.http=i,this.apiUrl=q.N.apiUrl}getLoadSheetDataForDispatchPost(i){return this.http.get(this.apiUrl+`/getLoadSheetDataForDispatchPost?vchrno=${i}`)}}return a.\u0275fac=function(i){return new(i||a)(e.LFG(te.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const ua=["genericGrid"];function Ma(a,o){if(1&a){const i=e.EpF();e.TgZ(0,"div",24)(1,"div",25)(2,"div",26)(3,"label",27),e._uU(4,"Dispatch Post No :"),e.qZA(),e.TgZ(5,"span")(6,"b"),e._uU(7),e.qZA()()(),e.TgZ(8,"div",28)(9,"label",27),e._uU(10,"Load Sheet Ref No : "),e.qZA(),e.TgZ(11,"input",29),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._transactionService.TrnMainObj.REFBILL=n)})("keydown.enter",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.onEnterLoadSheet())}),e.qZA()(),e.TgZ(12,"div",28)(13,"label",27),e._uU(14,"To Division :"),e.qZA(),e.TgZ(15,"input",30),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._transactionService.LoadChartModel.DivisionName=n)}),e.qZA()(),e.TgZ(16,"div",28)(17,"label",27),e._uU(18,"Vehicle No : "),e.qZA(),e.TgZ(19,"input",31),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._transactionService.TrnMainObj.AdditionalObj.VEHICLENO=n)}),e.qZA()()(),e.TgZ(20,"div",32)(21,"div",28)(22,"label",33),e._uU(23,"Driver Name : "),e.qZA(),e.TgZ(24,"input",34),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._transactionService.TrnMainObj.AdditionalObj.DRIVERNAME=n)}),e.qZA()(),e.TgZ(25,"div",28)(26,"label",33),e._uU(27,"Driver license No : "),e.qZA(),e.TgZ(28,"input",35),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._transactionService.TrnMainObj.AdditionalObj.DRIVERLISCENSENO=n)}),e.qZA()(),e.TgZ(29,"div",28)(30,"label",33),e._uU(31,"VCTS No. :"),e.qZA(),e.TgZ(32,"input",36),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r._transactionService.TrnMainObj.AdditionalObj.VCTS=n)}),e.qZA()()()()}if(2&a){const i=e.oxw();e.xp6(7),e.hij(" ",i._transactionService.TrnMainObj.VCHRNO," "),e.xp6(4),e.Q6J("disabled","VIEW"==i.LoadChartModel.MODE)("ngModel",i._transactionService.TrnMainObj.REFBILL),e.xp6(4),e.Q6J("ngModel",i._transactionService.LoadChartModel.DivisionName),e.xp6(4),e.Q6J("ngModel",i._transactionService.TrnMainObj.AdditionalObj.VEHICLENO),e.xp6(5),e.Q6J("ngModel",i._transactionService.TrnMainObj.AdditionalObj.DRIVERNAME),e.xp6(4),e.Q6J("ngModel",i._transactionService.TrnMainObj.AdditionalObj.DRIVERLISCENSENO),e.xp6(4),e.Q6J("ngModel",i._transactionService.TrnMainObj.AdditionalObj.VCTS)}}function pa(a,o){if(1&a&&(e.TgZ(0,"tr",37)(1,"td",15),e._uU(2),e.qZA(),e.TgZ(3,"td",16),e._uU(4),e.qZA(),e.TgZ(5,"td",17),e._uU(6),e.qZA(),e.TgZ(7,"td",16),e._uU(8),e.qZA(),e.TgZ(9,"td",16),e._uU(10),e.qZA(),e.TgZ(11,"td",16),e._uU(12),e.qZA(),e.TgZ(13,"td",16),e._uU(14),e.qZA()()),2&a){const i=o.$implicit,t=o.index,n=e.oxw();e.xp6(2),e.hij(" ",n._transactionService.nullToZeroConverter(t+1)," "),e.xp6(2),e.Oqu(null==i?null:i.MENUCODE),e.xp6(2),e.Oqu(null==i?null:i.ITEMDESC),e.xp6(2),e.Oqu(null==i?null:i.ALTUNIT),e.xp6(2),e.Oqu(null==i?null:i.MRP),e.xp6(2),e.Oqu(null==i?null:i.AltQty),e.xp6(2),e.Oqu(null==i?null:i.WEIGHT)}}function Ta(a,o){if(1&a&&(e.TgZ(0,"div",38)(1,"div",39)(2,"div",26),e._UZ(3,"div",25),e.TgZ(4,"div",27)(5,"h6"),e._uU(6),e.ALo(7,"number"),e.qZA()(),e.TgZ(8,"div",27)(9,"h6"),e._uU(10),e.ALo(11,"number"),e.qZA()()()()()),2&a){const i=e.oxw();e.xp6(6),e.hij("TOTAL WEIGHT: ",e.xi3(7,2,null==i._transactionService.LoadChartModel?null:i._transactionService.LoadChartModel.TOTALWEIGHT,"1.2-2"),""),e.xp6(4),e.hij("TOTAL AMOUNT: ",e.xi3(11,5,null==i._transactionService.LoadChartModel?null:i._transactionService.LoadChartModel.TOTALAMOUNT,"1.2-2"),"")}}const Sa=function(a){return{"overflow-x":a}},va=function(a){return{"col-md-12 pd0":a}},ba=L.Bz.forChild([{path:"",component:$t,children:[{path:"export-sales-invoice",component:zr,canActivate:[E.C]},{path:"add-sales-invoice",component:Q,canActivate:[E.C]},{path:"add-sales-invoice-wholesale",component:Q,canActivate:[E.C]},{path:"abbreviated-sales-invoice",component:Q,canActivate:[E.C]},{path:"self-billing",component:Q,canActivate:[E.C]},{path:"add-creditnote-itembase",component:Xt,canActivate:[E.C]},{path:"canceladdsientry",component:dn,canActivate:[E.C]},{path:"performa-invoice",component:Tn,canActivate:[E.C]},{path:"salesorder",component:le,canActivate:[E.C]},{path:"quotation",component:Dn,canActivate:[E.C]},{path:"deliver-chalan",component:Dr,canActivate:[E.C]},{path:"load-sheet-post",component:(()=>{class a{constructor(i,t,n,r,s,c,h){this.dialog=i,this.authService=t,this.masterService=n,this.alertService=r,this.spinnerService=s,this._transactionService=c,this.loadSheetPostService=h,this.gridPopupSettings=new u.im,this.LoadChartModel=new X,this.trnmain={},this.userProfile=t.getUserProfile(),this._transactionService.initialFormLoad(71),this.masterService.getAllDivisionList().subscribe(d=>{this.divisonList=d})}ngOnInit(){this.masterService.ShowMore=!0}onEnterLoadSheet(){this.gridPopupSettings=Object.assign(new u.im,{title:"Load Sheets",apiEndpoints:"/getLoadSheetpagedListForDispatch",defaultFilterIndex:0,columns:[{key:"VOUCHERNO",title:"VCHRNO",hidden:!1,noSearch:!1},{key:"TOTALWEIGHT",title:"Total Wt.",hidden:!1,noSearch:!1},{key:"DIVISIONNAME",title:"Division",hidden:!1,noSearch:!1}]}),this.genericGrid.show()}onLoadSheetLoad(i){this.spinnerService.show("Loading Data..."),this.loadSheetPostService.getLoadSheetDataForDispatchPost(i.VOUCHERNO).subscribe(t=>{t&&(this.spinnerService.hide(),t?.result?.ProdList?.length>0?(this._transactionService.TrnMainObj=t.result,this._transactionService.TrnMainObj.VoucherType=71,this._transactionService.TrnMainObj.Mode="NEW",this._transactionService.TrnMainObj.VoucherPrefix="DP",this._transactionService.TrnMainObj.BILLTO=this.masterService.userProfile.userDivision,this._transactionService.TrnMainObj.BILLTOADD=t.result.AdditionalObj.DIVISION,this._transactionService.LoadChartModel.DivisionName=this.divisonList.find(n=>n.INITIAL==t.result.AdditionalObj.DIVISION).NAME,this._transactionService.getCurrentDate(),this._transactionService.TrnMainObj.DIVISION=this.masterService.userProfile.userDivision,this._transactionService.getVoucherNumber(),this.calculateWeightAndAmnt()):0==t?.result?.ProdList?.length&&this.alertService.info("There is no Data!"))},t=>{this.spinnerService.hide(),this.alertService.error(t.error)})}onclickOnResetPopupEmit(){this._transactionService.LoadChartModel=new X,this._transactionService.LoadChartModel.TOTALWEIGHT=0,this._transactionService.LoadChartModel.TOTALAMOUNT=0}calculateWeightAndAmnt(){this._transactionService.LoadChartModel.TOTALWEIGHT=0,this._transactionService.LoadChartModel.TOTALAMOUNT=0,this._transactionService.TrnMainObj.ProdList.forEach(i=>{this._transactionService.LoadChartModel.TOTALWEIGHT+=i.WEIGHT,this._transactionService.LoadChartModel.TOTALAMOUNT+=Number(i.MRP)*i.Quantity})}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(z.uw),e.Y36(P.e),e.Y36(I.P),e.Y36(D.c),e.Y36(y.V),e.Y36(f.p),e.Y36(_a))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-load-sheet-post"]],viewQuery:function(i,t){if(1&i&&e.Gf(ua,5),2&i){let n;e.iGM(n=e.CRH())&&(t.genericGrid=n.first)}},decls:49,vars:10,consts:[[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-2"],[1,"col-md-5"],[2,"white-space","nowrap","margin-left","-158px","margin-top","-3px","font-family","Segoe UI Light","font-weight","bold","font-size","20px","padding-left","4%","width","192px"],[1,"col-md-8"],[3,"onclickOnResetPopupEmit"],[1,"col-md-12","row","pd0",2,"overflow-y","hidden",3,"ngStyle"],[1,"col-md-8","pd0",3,"ngClass"],["class","col-md-12 row pd0 plainBackGround mr5",4,"ngIf"],[1,"col-md-12","pd0","mr5","ims-scrollable-table"],[1,"table-container",2,"height","80vh"],["id","BlueHeaderResizableTable",1,"reportTabel",2,"font-size","12px","width","100%","overflow-x","auto"],["reportHtmlTable",""],[2,"background","#d5d5d5"],["width","50px"],["width","100px"],["width","200px"],[2,"width","fit-content"],["style","width: 99.97%",4,"ngFor","ngForOf"],[2,"position","fixed","bottom","0px","height","60px","width","100%"],["class","row footer",4,"ngIf"],[3,"popupsettings","onItemDoubleClick"],["genericGrid",""],[1,"col-md-12","row","pd0","plainBackGround","mr5"],[1,"col-md-6"],[1,"row"],[1,"col-md-3"],[1,"row",2,"padding-bottom","5px"],["type","text","id","loadSheet","placeholder","Press ENTER to Select","readonly","",2,"width","50%",3,"disabled","ngModel","ngModelChange","keydown.enter"],["type","text","readonly","",2,"width","50%",3,"ngModel","ngModelChange"],["type","text","id","vechNoId","name","vno","readonly","",2,"width","50%",3,"ngModel","ngModelChange"],[1,"col-md-6",2,"padding-top","32px"],[2,"width","25%"],["type","text","id","DrivernameId","name","dnme","readonly","",2,"width","50%",3,"ngModel","ngModelChange"],["type","text","id","licenseNoId","name","dlicno","readonly","",2,"width","50%",3,"ngModel","ngModelChange"],["type","text","id","vcts","readonly","",2,"width","50%",3,"ngModel","ngModelChange"],[2,"width","99.97%"],[1,"row","footer"],[1,"col-md-12",2,"vertical-align","center"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"voucher-master-toggler"),e.qZA(),e.TgZ(4,"div",2)(5,"div",3)(6,"label",4),e._uU(7,"DISPATCH POST"),e.qZA()()(),e.TgZ(8,"div",5)(9,"voucher-master-action",6),e.NdJ("onclickOnResetPopupEmit",function(){return t.onclickOnResetPopupEmit()}),e.qZA()()()(),e.TgZ(10,"div",7)(11,"div",8),e.YNc(12,Ma,33,8,"div",9),e.TgZ(13,"div",10)(14,"div",11)(15,"table",12,13)(17,"thead")(18,"tr",14),e._UZ(19,"th",15)(20,"th",16)(21,"th",17),e.TgZ(22,"th",16),e._uU(23,"Item Details"),e.qZA(),e._UZ(24,"th",16)(25,"th",16)(26,"th",16),e.qZA(),e.TgZ(27,"tr")(28,"th",15),e._uU(29,"S.No"),e.qZA(),e.TgZ(30,"th",16),e._uU(31,"Item Code"),e.qZA(),e.TgZ(32,"th",17),e._uU(33,"Item name"),e.qZA(),e.TgZ(34,"th",16),e._uU(35,"Unit"),e.qZA(),e.TgZ(36,"th",16),e._uU(37,"MRP"),e.qZA(),e.TgZ(38,"th",16),e._uU(39,"Quantity"),e.qZA(),e.TgZ(40,"th",16),e._uU(41,"Weight"),e.qZA()()(),e.TgZ(42,"tbody",18),e.ynx(43),e.YNc(44,pa,15,7,"tr",19),e.BQk(),e.qZA()()()()()(),e.TgZ(45,"div",20),e.YNc(46,Ta,12,8,"div",21),e.qZA(),e.TgZ(47,"generic-popup-grid",22,23),e.NdJ("onItemDoubleClick",function(r){return t.onLoadSheetLoad(r)}),e.qZA()),2&i&&(e.xp6(10),e.Q6J("ngStyle",e.VKq(6,Sa,1==t._transactionService.userSetting.DispatchWiseLoadSheet?"hidden":"auto")),e.xp6(1),e.Q6J("ngClass",e.VKq(8,va,1==t._transactionService.userSetting.DispatchWiseLoadSheet)),e.xp6(1),e.Q6J("ngIf",t.masterService.ShowMore),e.xp6(32),e.Q6J("ngForOf",t._transactionService.TrnMainObj.ProdList),e.xp6(2),e.Q6J("ngIf",1==t._transactionService.userSetting.DispatchWiseLoadSheet),e.xp6(1),e.Q6J("popupsettings",t.gridPopupSettings))},dependencies:[T.mk,T.sg,T.O5,T.PC,R.q,x.i,p.Fj,p.JJ,p.On,u.Zl,T.JJ],styles:[".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center;vertical-align:middle}th[_ngcontent-%COMP%]{height:25px!important}tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover{background-color:#f3f5f4;cursor:pointer}tr[_ngcontent-%COMP%]{font-size:12px}.selected-row[_ngcontent-%COMP%]{background-color:#0000001a!important}.table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{line-height:30px!important}.table[_ngcontent-%COMP%] > thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{line-height:5px!important}.table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child{text-align:left!important;padding:0 0 0 11px!important}td[_ngcontent-%COMP%]{padding:5px}.footer[_ngcontent-%COMP%]{border:1px solid #eaeaea;background-color:#fff;min-height:60px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{font-size:13px;height:23px!important;margin-top:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:none!important}"]}),a})(),canActivate:[E.C]},{path:"add-membership-sales-invoice",component:wr,canActivate:[E.C]},{path:"cash-handover",component:ra,canActivate:[E.C]},{path:"delivery-chalan",component:la,canActivate:[E.C]},{path:"delivery-chalan-return",component:ha,canActivate:[E.C]}]}]);var fa=_(21919),Ca=_(74263),Oa=_(60694),Aa=_(7782),Ea=_(33612),Ia=_(32404),Pa=_(56209),Na=_(18177),La=_(64548),Da=_(76018),ya=_(2847),Ra=_(11728);let xa=(()=>{class a{}return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({providers:[E.C,f.p,ae.M,Ca.R,Oa.T,Aa.y,ie.h,Ea.i,Ia.i],imports:[T.ez,_e.h,fa.k.forRoot(),ba,Pa.u,Na.$,La.x]}),a})();e.B6R(Q,function(){return[T.O5,V.x,U,R.q,x.i,F.u,K.d,k.U,u.Zl,B.o,se.j,Da.E]},function(){return[T.H9]}),e.B6R(le,function(){return[T.O5,ya.v,V.x,R.q,x.i,F.u,k.U,B.o,Ra.q]},function(){return[T.H9]})}}]);