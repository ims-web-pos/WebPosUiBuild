"use strict";(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[659],{2847:(re,q,g)=>{g.d(q,{v:()=>tt});var n=g(28698),y=g(19102),H=g(23815),_=g.n(H),v=g(42326),F=g(92752),Z=g(92340),U=g(40216),k=g(64762),e=g(36336),w=g(68277),G=g(28049),J=g(54395),b=g(53181),f=g(67311),O=g(63504),I=g(72533);const D=["inputBox"];function R(s,c){if(1&s&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.Q6J("value",t.key),e.xp6(1),e.hij(" ",t.title," ")}}function M(s,c){if(1&s&&(e.ynx(0),e.YNc(1,R,2,2,"option",27),e.BQk()),2&s){const t=c.$implicit;e.xp6(1),e.Q6J("ngIf",!t.noSearch)}}const N=function(s){return{"text-align":s}};function C(s,c){if(1&s&&(e.TgZ(0,"th",30),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.Q6J("ngStyle",e.VKq(2,N,t.alignment)),e.xp6(1),e.hij(" ",t.title," ")}}function x(s,c){if(1&s&&(e.ynx(0),e.YNc(1,C,2,4,"th",29),e.BQk()),2&s){const t=c.$implicit;e.xp6(1),e.Q6J("ngIf",!t.hidden)}}function Q(s,c){1&s&&(e.TgZ(0,"th"),e._uU(1," Action "),e.qZA())}function X(s,c){if(1&s&&(e.TgZ(0,"div",35),e._uU(1),e.qZA()),2&s){const t=e.oxw(2).$implicit,i=e.oxw().$implicit;e.s9C("title",i[t.key]),e.xp6(1),e.hij(" ",i[t.key]," ")}}function z(s,c){if(1&s&&(e.TgZ(0,"div",35),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&s){const t=e.oxw(2).$implicit,i=e.oxw().$implicit;e.s9C("title",i[t.key]),e.xp6(1),e.hij(" ",e.Dn7(2,2,i[t.key],"INR","Rs. ")," ")}}function $(s,c){if(1&s&&(e.TgZ(0,"div",35),e._uU(1),e.ALo(2,"date"),e.qZA()),2&s){const t=e.oxw(2).$implicit,i=e.oxw().$implicit;e.s9C("title",i[t.key]),e.xp6(1),e.hij(" ",e.xi3(2,2,i[t.key],"yyyy-MM-dd")," ")}}function ee(s,c){if(1&s&&(e.TgZ(0,"td",30),e.YNc(1,X,2,2,"div",34),e.YNc(2,z,3,6,"div",34),e.YNc(3,$,3,5,"div",34),e.qZA()),2&s){const t=e.oxw().$implicit;e.Q6J("ngStyle",e.VKq(4,N,t.alignment)),e.xp6(1),e.Q6J("ngIf",!t.pipe&&!t.format),e.xp6(1),e.Q6J("ngIf",t.pipe),e.xp6(1),e.Q6J("ngIf",t.format)}}function ne(s,c){if(1&s&&(e.ynx(0),e.YNc(1,ee,4,6,"td",29),e.BQk()),2&s){const t=c.$implicit;e.xp6(1),e.Q6J("ngIf",!t.hidden)}}function j(s,c){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"span")(2,"i",36),e.NdJ("click",function(){const a=e.CHM(t).$implicit,A=e.oxw(2).index,K=e.oxw(3);return e.KtG(K.onActionClicked(a.text,A))}),e.qZA()(),e.BQk()}if(2&s){const t=c.$implicit;e.xp6(2),e.Tol(t.icon),e.s9C("title",t.title)}}function B(s,c){if(1&s&&(e.ynx(0),e.TgZ(1,"td"),e.YNc(2,j,3,4,"ng-container",12),e.qZA(),e.BQk()),2&s){const t=e.oxw(4);e.xp6(2),e.Q6J("ngForOf",t.popupsettings.actionKeys)}}function d(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"tr",32),e.NdJ("dblclick",function(){const a=e.CHM(t).$implicit,A=e.oxw(3);return e.KtG(A.doubleClick(a))})("click",function(){const a=e.CHM(t).index,A=e.oxw(3);return e.KtG(A.singleClick(a))}),e.TgZ(1,"td")(2,"input",33),e.NdJ("ngModelChange",function(r){const A=e.CHM(t).$implicit;return e.KtG(A.selected=r)})("click",function(r){const A=e.CHM(t).$implicit,K=e.oxw(3);return e.KtG(K.onSelectVchr(r,A))}),e.qZA()(),e.YNc(3,ne,2,1,"ng-container",12),e.YNc(4,B,3,1,"ng-container",2),e.qZA()}if(2&s){const t=c.$implicit,i=c.index,r=e.oxw(3);e.ekj("selected-row",r.selectedRowIndex==i),e.xp6(2),e.Q6J("ngModel",t.selected),e.xp6(1),e.Q6J("ngForOf",r.popupsettings.columns),e.xp6(1),e.Q6J("ngIf",r.popupsettings.showActionButton&&r.popupsettings.actionKeys.length)}}const u=function(s,c,t,i){return{id:s,itemsPerPage:c,currentPage:t,totalItems:i}};function h(s,c){if(1&s&&(e.TgZ(0,"tbody"),e.YNc(1,d,5,5,"tr",31),e.ALo(2,"paginate"),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,t.itemList,e.l5B(4,u,t.tabindex,t.pageSize,t.pageNumber,t.totalItems)))}}function l(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",37)(1,"pagination-controls",38),e.NdJ("pageChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onPageChange(r))}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("id",t.tabindex)}}function E(s,c){if(1&s&&e._UZ(0,"div",39),2&s){const t=e.oxw(2);e.Q6J("innerHTML",t.summary,e.oJD)}}function L(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"div")(2,"div",3)(3,"h4",4),e._uU(4),e.qZA(),e.TgZ(5,"button",5),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.hide())}),e.TgZ(6,"span",6),e._uU(7,"\xd7"),e.qZA()()(),e.TgZ(8,"div",7)(9,"div",8)(10,"div",9)(11,"select",10),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.filterOption=r)})("change",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.triggerSearch(r))}),e.TgZ(12,"option",11),e._uU(13,"Select Filter Option"),e.qZA(),e.YNc(14,M,2,1,"ng-container",12),e.qZA()(),e.TgZ(15,"div",13),e._UZ(16,"input",14,15),e.qZA()()(),e.TgZ(18,"div",16)(19,"div",17)(20,"div",18)(21,"input",19),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.selectAll=r)})("click",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectAll(r))}),e.qZA(),e.TgZ(22,"label",20),e._uU(23," Select All "),e.qZA()(),e.TgZ(24,"button",21),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onImportChalan())}),e._uU(25,"Import Delivery Chalan"),e.qZA()(),e.TgZ(26,"table",22)(27,"thead")(28,"tr",23)(29,"th"),e._uU(30,"Select"),e.qZA(),e.YNc(31,x,2,1,"ng-container",12),e.YNc(32,Q,2,0,"th",2),e.qZA()(),e.YNc(33,h,3,9,"tbody",2),e.qZA(),e.TgZ(34,"div",24),e.YNc(35,l,2,1,"div",25),e.qZA()()(),e.YNc(36,E,1,1,"div",26),e.qZA()}if(2&s){const t=e.oxw();e.xp6(4),e.hij(" ",t.popupsettings.title," "),e.xp6(7),e.Q6J("ngModel",t.filterOption),e.xp6(3),e.Q6J("ngForOf",t.popupsettings.columns),e.xp6(2),e.Q6J("formControl",t.filterValue),e.xp6(5),e.Q6J("ngModel",t.selectAll),e.xp6(10),e.Q6J("ngForOf",t.popupsettings.columns),e.xp6(1),e.Q6J("ngIf",t.popupsettings.showActionButton&&t.popupsettings.actionKeys.length),e.xp6(1),e.Q6J("ngIf",t.itemList.length),e.xp6(2),e.Q6J("ngIf",t.itemList.length),e.xp6(1),e.Q6J("ngIf",t.summary)}}class V extends w.nd{constructor(c,t,i){super(c),this.injector=c,this.dialog=t,this.alertservice=i,this.requestUrl="",this.isActive=!1,this.itemList=[],this.selectedRowIndex=0,this.tabindex="list",this.hideGridOnDoubleClick=!0,this.vchrList=[],this.billTo="",this.tag="",this.isForCancelOrder=!1,this.onPopUpClose=new e.vpe,this.onItemDoubleClick=new e.vpe,this.onImportChalanClick=new e.vpe,this.onDeleteClicked=new e.vpe,this.onEmptyList=new e.vpe}ngAfterViewInit(){this.filterValue.valueChanges.pipe((0,J.b)(500)).subscribe(c=>{this.refreshPage(),this.refresh()})}show(c="",t=!1,i="",r=!0){this.hideGridOnDoubleClick=r,setTimeout(()=>{this.inputBox.nativeElement.focus()},10),this.summary=null,this.billTo=c,this.isForCancelOrder=t,this.itemList=[],this.isActive=!0,this.selectedRowIndex=0,this.tag=i,this.filterOption="",setTimeout(()=>{this.setFilterOption()},100)}setFilterOption(){if(this.popupsettings&&this.popupsettings.columns.length){const c=this.popupsettings.defaultFilterIndex?this.popupsettings.defaultFilterIndex:0;if(this.popupsettings.columns.length<=c)return;this.filterValue.setValue(this.popupsettings.userDefinefilterValue),this.filterOption=this.popupsettings.columns[c].key}}onSelectVchr(c,t){if(c.target.checked)t.selected=1,this.vchrList.push(t.VCHRNO);else{t.selected=0,this.selectAll=!1;const i=this.vchrList.indexOf(t.VCHRNO);i>-1&&this.vchrList.splice(i,1)}}onSelectAll(c){c.target.checked?this.popupsettings.selectAllApiEndpoint&&this._http.get(Z.N.apiUrl+this.popupsettings.selectAllApiEndpoint).pipe((0,G.P)()).subscribe(t=>{t&&(this.vchrList=t,this.itemList.forEach(i=>i.selected=1))}):(this.vchrList=[],this.itemList.forEach(t=>t.selected=0))}getData(){this.summary=null,this.selectedRowIndex=0;let i=`${Z.N.apiUrl}${this.popupsettings.apiEndpoints}?currentPage=${this.pageNumber}&maxResultCount=${this.pageSize}`;return this.billTo&&""!==this.billTo&&null!=this.billTo&&void 0!==this.billTo&&(i+=`&billTo=${this.billTo}`),this.tag&&""!==this.tag&&null!=this.tag&&void 0!==this.isTableLoading&&(i+=`&tag=${this.tag}`),this.isForCancelOrder&&(i+=`&isForCancelOrder=${this.isForCancelOrder}`),this.requestUrl=this.getFilterOption(i),this._http.get(this.requestUrl).pipe((0,G.P)()).subscribe(r=>{this.totalItems=r?r.totalCount:0,this.itemList=r?r.data:[],this.itemList.forEach(function(a){null!=a.TRNDATE&&void 0!==a.TRNDATE&&(a.TRNDATE=a.TRNDATE.toString().substring(0,10)),null!=a.DATE&&void 0!==a.DATE&&(a.DATE=a.DATE.toString().substring(0,10))}),this.itemList.length>0&&0===this.selectedRowIndex&&this.itemList[this.selectedRowIndex].itemSummary&&(this.summary=this.itemList[this.selectedRowIndex].itemSummary)})}hide(){this.itemList=[],this.pageNumber=1,this.totalItems=0,this.isActive=!1}triggerSearch(){null==this.filterOption||void 0===this.filterOption||""===this.filterOption||this.filterValue.setValue("")}singleClick(c){this.selectedRowIndex=c,this.summary=this.itemList[c].itemSummary}doubleClick(c){this.onItemDoubleClick.emit(c),this.hideGridOnDoubleClick&&this.hide()}onImportChalan(){console.log("vchrlist",this.vchrList),0!=this.vchrList?.length?this.onImportChalanClick.emit(this.vchrList):this.alertservice.info("Please select voucher first!")}updown(c){if(!this.isActive)return!0;if("ArrowDown"===c.code)c.preventDefault(),this.selectedRowIndex++,null!=this.itemList[this.selectedRowIndex]&&(this.summary=this.itemList[this.selectedRowIndex].itemSummary),this.calculateTotalPages(),this.selectedRowIndex===this.itemList.length&&this.pageNumber<this.totalPages?(this.pageNumber=this.pageNumber+1,this.refresh(),this.selectedRowIndex=0,this.itemListClosed()):this.selectedRowIndex===this.itemList.length&&this.pageNumber===this.totalPages&&(this.selectedRowIndex=this.itemList.length-1);else if("ArrowUp"===c.code)c.preventDefault(),this.selectedRowIndex--,null!=this.itemList[this.selectedRowIndex]&&(this.summary=this.itemList[this.selectedRowIndex].itemSummary),-1===this.selectedRowIndex&&this.pageNumber>1?(this.pageNumber=this.pageNumber-1,this.refresh(),this.selectedRowIndex=this.itemList.length-1,this.itemListClosed()):-1===this.selectedRowIndex&&1===this.pageNumber&&(this.selectedRowIndex=0);else if(("Enter"===c.code||"NumpadEnter"===c.code)&&this.selectedRowIndex>=0&&this.selectedRowIndex<this.itemList.length)c.preventDefault(),"BARCODE"===this.filterOption||(this.onItemDoubleClick.emit(this.itemList[this.selectedRowIndex]),this.hide(),this.itemListClosed());else if("Escape"===c.code)c.preventDefault(),this.hide(),this.itemListClosed();else if("ArrowRight"===c.code){if(c.preventDefault(),this.calculateTotalPages(),this.pageNumber>=this.totalPages)return void(this.pageNumber=this.totalPages);this.selectedRowIndex=0,this.pageNumber=this.pageNumber+1,this.refresh()}else if("ArrowLeft"===c.code){if(c.preventDefault(),this.pageNumber<=1)return void(this.pageNumber=1);this.selectedRowIndex=0,this.pageNumber=this.pageNumber-1,this.refresh()}}itemListClosed(){this.onPopUpClose.emit()}ngOnChanges(c){this.popupsettings=c.popupsettings.currentValue}onActionClicked(c,t){if(""!==c&&null!=c&&void 0!==c){const i=c.toLowerCase();switch(i){case"delete":case"cancel":confirm(`Are you sure to ${i} this row ?.`)&&this.onDeleteClicked.emit(this.itemList[t])}}}}V.\u0275fac=function(c){return new(c||V)(e.Y36(e.zs3),e.Y36(b.uw),e.Y36(f.c))},V.\u0275cmp=e.Xpm({type:V,selectors:[["generic-multiSelectpopup-grid"]],viewQuery:function(c,t){if(1&c&&e.Gf(D,5),2&c){let i;e.iGM(i=e.CRH())&&(t.inputBox=i.first)}},hostBindings:function(c,t){1&c&&e.NdJ("keydown",function(r){return t.updown(r)},!1,e.evT)},inputs:{popupsettings:"popupsettings",summary:"summary"},outputs:{onPopUpClose:"onPopUpClose",onItemDoubleClick:"onItemDoubleClick",onImportChalanClick:"onImportChalanClick",onDeleteClicked:"onDeleteClicked",onEmptyList:"onEmptyList"},features:[e.qOj,e.TTD],decls:3,vars:3,consts:[[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","25px"],[1,"modal-content","modal-content-main-area"],[4,"ngIf"],[1,"modal-header",2,"padding","0px","background","#7ed0ff"],[1,"modal-title",2,"padding-left","5px","font-size","1.2rem"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"row"],[1,"col-md-12","row"],[1,"col-md-6",2,"margin","2px 0px","display","flex","padding","0px"],[2,"width","100%",3,"ngModel","ngModelChange","change"],["value","","selected",""],[4,"ngFor","ngForOf"],[1,"col-md-6",2,"margin","2px 0px","display","flex","padding-right","0px"],["type","text","placeholder","Enter keyword to search",2,"width","100%",3,"formControl"],["inputBox",""],[1,"col-md-12","table-scroll"],[1,"popupBtn","d-flex","justify-content-between"],[1,"form-check"],["type","checkbox","value","","id","flexCheckChecked",1,"form-check-input",3,"ngModel","ngModelChange","click"],["for","flexCheckChecked",1,"form-check-label",2,"margin-bottom","-10px"],[1,"btn","btn-success","btn-sm","mt-1","mb-1",3,"click"],[1,"table"],[2,"background","#7ed0ff"],[1,"row",2,"float","center","margin","4px 0px"],["class","col-md-12","style","width: 100%; margin-top: -1.8rem",4,"ngIf"],["style","margin-left: 25px; margin-top: -25px; font-size: 12px",3,"innerHTML",4,"ngIf"],[3,"value",4,"ngIf"],[3,"value"],[3,"ngStyle",4,"ngIf"],[3,"ngStyle"],["class","highlight","title","double click for detail view",3,"selected-row","dblclick","click",4,"ngFor","ngForOf"],["title","double click for detail view",1,"highlight",3,"dblclick","click"],["type","checkbox","value","","id","flexCheckChecked",1,"form-check-input",2,"margin-top","-10px","margin-left","13px",3,"ngModel","ngModelChange","click"],[3,"title",4,"ngIf"],[3,"title"],[3,"title","click"],[1,"col-md-12",2,"width","100%","margin-top","-1.8rem"],["maxSize","9","directionLinks","true","autoHide","true","responsive","true","previousLabel","Previous","nextLabel","Next","screenReaderPaginationLabel","Pagination","screenReaderPageLabel","page","screenReaderCurrentLabel","You're on page",2,"margin-left","6rem","margin-bottom","0","font-size","0.8rem",3,"id","pageChange"],[2,"margin-left","25px","margin-top","-25px","font-size","12px",3,"innerHTML"]],template:function(c,t){1&c&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,L,37,10,"div",2),e.qZA()()),2&c&&(e.ekj("modal-sticky-hide",!t.isActive),e.xp6(2),e.Q6J("ngIf",t.popupsettings))},dependencies:[F.sg,F.O5,F.PC,O.YN,O.Kr,O.Fj,O.Wl,O.EJ,O.JJ,O.On,O.oH,I.LS,F.H9,F.uU,I._s],styles:[".modal-content[_ngcontent-%COMP%] {\n    padding: 1px;\n    margin: 0px;\n    float: right;\n    width: auto;\n  }\n\n  tbody[_ngcontent-%COMP%]    > tr[_ngcontent-%COMP%]:hover {\n    background-color: #f3f5f4;\n    cursor: pointer;\n  }\n\n  tr[_ngcontent-%COMP%] {\n    font-size: 11px;\n  }\n\n  .selected-row[_ngcontent-%COMP%] {\n    background-color: #ced6d3 !important;\n  }\n\n  .table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr[_ngcontent-%COMP%]    > td[_ngcontent-%COMP%] {\n    line-height: 24px !important;\n    padding: 5px 10px;\n    vertical-align: middle;\n  }\n\n  .table[_ngcontent-%COMP%]    > thead[_ngcontent-%COMP%]    > tr[_ngcontent-%COMP%]    > th[_ngcontent-%COMP%] {\n    line-height: 5px !important;\n  }\n\n  .table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr[_ngcontent-%COMP%]    > td[_ngcontent-%COMP%]:first-child {\n    text-align: left !important;\n    padding: 0px 0px 0px 11px !important;\n  }\n\n  .modal-content[_ngcontent-%COMP%] {\n    box-shadow: -10px 0px 10px 1px #aaaaaa;\n  }\n\n  .modal-content-main-area[_ngcontent-%COMP%] {\n    max-height: 100%;\n    height: 100%;\n    overflow: auto;\n    overflow-x: hidden;\n  }\n\n  .modal-content-summary-area[_ngcontent-%COMP%] {\n    max-height: 20%;\n    height: 20%;\n    overflow: auto;\n    overflow-x: hidden;\n  }\n\n  .ellipsis[_ngcontent-%COMP%] {\n    \n    white-space: nowrap;\n  }"]}),(0,k.gn)([function de(s){return function(c,t,i){const r=i.value,a=`__timeout__${t}`;return i.value=function(...A){clearTimeout(this[a]),this[a]=setTimeout(()=>r.apply(this,A),s)},i}}(10)],V.prototype,"updown",null);var ae=g(53074),oe=g(14970),_e=g(45365);const ue=["fileInput"];let Me=(()=>{class s{constructor(t,i,r,a,A,K,Y){this.dialogRef=t,this.fb=i,this.masterService=r,this.spinnerService=a,this.alertService=A,this.router=K,this.data=Y,this.shippingLocationObj={},this.onsubmit=new e.vpe,this.mode="add",this.custId=Y?.CUSTID,Y?.shippingLocation&&(this.shippingLocationObj=Y.shippingLocation),this.mode=Y?.mode||"add"}ngOnInit(){this.router.events.subscribe(t=>{"/salesorder"!==this.router.url&&this.dialogRef.close()}),this.shippingForm=this.fb.group({ADDRESS:[this.shippingLocationObj.ADDRESS||"",[O.kI.required]],CONTACT_PERSON:[this.shippingLocationObj.CONTACT_PERSON||"",[O.kI.required]],CONTACT_NO:[this.shippingLocationObj.CONTACT_NO||"",[O.kI.required]]})}onSave(){let t=Object.assign(this.shippingForm.value);console.log("custid",this.custId),this.custId?(t.CUSTID=this.custId,this.SaveShippingLocation({mode:this.mode,data:t})):this.alertService.info("Customer is not selected")}cancelPopup(){this.dialogRef.close(null),this.onReset()}onReset(){this.shippingForm.reset()}onFileChange(){this.fileInput.nativeElement.click()}SaveShippingLocation(t){this.spinnerService.show("Data is Saving ..."),this.masterService.postShippingLocation(t).subscribe(i=>{"ok"==i.status?(this.dialogRef.close(i.result2),this.spinnerService.hide()):(this.alertService.info(i.result),this.spinnerService.hide())},i=>{this.spinnerService.hide()})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(b.so),e.Y36(O.qu),e.Y36(ae.P),e.Y36(oe.V),e.Y36(f.c),e.Y36(_e.F0),e.Y36(b.WI))},s.\u0275cmp=e.Xpm({type:s,selectors:[["create-shipping-location"]],viewQuery:function(t,i){if(1&t&&e.Gf(ue,5),2&t){let r;e.iGM(r=e.CRH())&&(i.fileInput=r.first)}},outputs:{onsubmit:"onsubmit"},decls:33,vars:7,consts:[[1,"backdrop"],["role","document",1,"shipping_container",2,"max-width","100%","max-height","500px","overflow","hidden"],[1,"card"],[1,"card-header","row"],[1,"page-title","col-md-6",2,"font-size","large","padding-top","2px","padding-left","0px"],[1,"button-group","col-md-6",2,"padding-left","0px","padding-right","0px"],[3,"formGroup","ngSubmit"],["title","Cancel","type","reset",1,"btn","btn-info",2,"width","80px","float","right",3,"click"],["title","Reset","type","reset",1,"btn","btn-info",2,"margin-right","2px","width","80px","float","right",3,"disabled","click"],["title","Save","type","submit",1,"btn","btn-info",2,"margin-right","2px","width","80px","float","right",3,"disabled"],[1,"card-body"],[1,"form-horizontal",3,"formGroup"],[1,"form-group","row"],[1,"row","col-sm-12",2,"padding-right","0px","padding-left","0px"],[1,"col-sm-4","form-control-label"],[1,"col-sm-7",2,"padding-left","1px"],["type","text","formControlName","ADDRESS","autocomplete","off",1,"form-control",3,"readonly"],["type","text","formControlName","CONTACT_PERSON","autocomplete","off",1,"form-control",3,"readonly"],["type","number","formControlName","CONTACT_NO","autocomplete","off",1,"form-control",3,"readonly"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5"),e._uU(6,"SHIPPING INFORMATION"),e.qZA()(),e.TgZ(7,"div",5)(8,"form",6),e.NdJ("ngSubmit",function(){return i.onSave()}),e.TgZ(9,"button",7),e.NdJ("click",function(){return i.cancelPopup()}),e._uU(10,"CANCEL"),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){return i.onReset()}),e._uU(12,"RESET"),e.qZA(),e.TgZ(13,"button",9),e._uU(14,"SAVE"),e.qZA()()()(),e.TgZ(15,"div",10)(16,"form",11)(17,"div",12)(18,"div",13)(19,"label",14),e._uU(20,"Shipping Address"),e.qZA(),e.TgZ(21,"div",15),e._UZ(22,"input",16),e.qZA()(),e.TgZ(23,"div",13)(24,"label",14),e._uU(25,"Contact Person"),e.qZA(),e.TgZ(26,"div",15),e._UZ(27,"input",17),e.qZA()(),e.TgZ(28,"div",13)(29,"label",14),e._uU(30,"Contact Number"),e.qZA(),e.TgZ(31,"div",15),e._UZ(32,"input",18),e.qZA()()()()()()()()),2&t&&(e.xp6(8),e.Q6J("formGroup",i.shippingForm),e.xp6(3),e.Q6J("disabled","VIEW"===i.mode),e.xp6(2),e.Q6J("disabled","VIEW"===i.mode),e.xp6(3),e.Q6J("formGroup",i.shippingForm),e.xp6(6),e.Q6J("readonly","VIEW"===i.mode),e.xp6(5),e.Q6J("readonly","VIEW"===i.mode),e.xp6(5),e.Q6J("readonly","VIEW"===i.mode))},dependencies:[O._Y,O.Fj,O.wV,O.JJ,O.JL,O.sg,O.u],styles:["td[_ngcontent-%COMP%]{border:1px solid #e6e6e6}input[_ngcontent-%COMP%]{padding:8px;margin-top:6px;height:30px}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.shipping_container[_ngcontent-%COMP%]{position:fixed!important;transform:translateY(-35px);background:#ffffff;z-index:99999;width:40%;top:22.5%;left:55%}label[_ngcontent-%COMP%]{font-size:14px;margin-left:1rem;margin-top:7px}.backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#3d3c3c80;z-index:9999}"]}),s})();var pe=g(65705),he=g(87584),T=g(67297),P=g(471),o=g(90253),m=g(9267),p=g(23470),S=g(63213);const te=["genericGridSupplier"],le=["genericGridShipName"],ge=["genericGridRefBill"],me=["genericGridWarehouse"],Se=["fileUploadPopup"],Oe=["genericGridAccount"],be=["genericGridImportPurchaseOrder"],fe=["CreateQuickParty"],Ce=["LoadPurchaseOrder"],Ae=["importAdvanceAcGrid"],Ee=["genericGridCustomer"],De=["focusInputFormat"],xe=["genericGridGRN"],Ne=["genericGridImportGRN"],Pe=["genericGridSalesMan"],Re=["CreateCustomerProfile"],je=["CreateShippingLocation"],Ie=["genericGridPurchaseOrder"];function ye(s,c){if(1&s&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&s){const t=c.$implicit;e.s9C("value",null==t?null:t.series),e.xp6(1),e.Oqu(null==t?null:t.series)}}function Le(s,c){if(1&s&&(e.ynx(0),e.YNc(1,ye,2,2,"option",47),e.BQk()),2&s){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.chalanSeries)}}function we(s,c){1&s&&(e.TgZ(0,"option",49),e._uU(1,"Chalan series not found!"),e.qZA())}function Ze(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Refno."),e.qZA(),e.TgZ(3,"td",8)(4,"select",44),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.CHALANNOPREFIX=r)}),e.YNc(5,Le,2,1,"ng-container",11),e.YNc(6,we,2,0,"option",45),e.qZA(),e.TgZ(7,"input",46),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.CHALANNO=r)}),e.qZA()()()}if(2&s){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t._trnMainService.TrnMainObj.CHALANNOPREFIX)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||1==t._trnMainService.disableAllFieldinPurchase),e.xp6(1),e.Q6J("ngIf",t.chalanSeries&&t.chalanSeries.length>0),e.xp6(1),e.Q6J("ngIf",t.chalanSeries&&0===t.chalanSeries.length),e.xp6(1),e.Q6J("ngModel",t._trnMainService.TrnMainObj.CHALANNO)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)}}function Ue(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Entry Date"),e.qZA(),e.TgZ(3,"td",50)(4,"input",51),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.TRNDATE=r)})("change",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.changeEntryDate(r.target.value,"AD"))}),e.qZA()(),e.TgZ(5,"td",52)(6,"nepali-date-picker",53),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.changeEntryDate(r.detail.value,"BS"))})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.BSDATE=r)}),e.qZA()()()}if(2&s){const t=e.oxw(2);e.xp6(4),e.s9C("max",t.currDate),e.Q6J("ngModel",t._trnMainService.TrnMainObj.TRNDATE)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode),e.xp6(2),e.Q6J("id","EntrynepaliDateFromPur")("label","From")("disable",t._trnMainService.disableNepaliDate||"VIEW"==t._trnMainService.TrnMainObj.Mode)("ngModel",t._trnMainService.TrnMainObj.BSDATE)}}function Fe(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"input",56),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw(3);return a._trnMainService.TrnMainObj.DOFULLRETURN=r.target.checked?1:0,e.KtG(a._trnMainService.callPipe=!a._trnMainService.callPipe)})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.DOFULLRETURN=r)}),e.qZA(),e.TgZ(2,"label",57),e._uU(3,"Load Full PO Details"),e.qZA()()}if(2&s){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t._trnMainService.TrnMainObj.DOFULLRETURN)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)}}function Ve(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"input",56),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw(3);return a._trnMainService.TrnMainObj.DOFULLRETURN=r.target.checked?1:0,e.KtG(a._trnMainService.callPipe=!a._trnMainService.callPipe)})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.DOFULLRETURN=r)}),e.qZA(),e.TgZ(2,"label",57),e._uU(3,"Load Full Q.T Details"),e.qZA()()}if(2&s){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t._trnMainService.TrnMainObj.DOFULLRETURN)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)}}const se=function(s){return{width:s}};function Ge(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2),e.qZA(),e.TgZ(3,"td",54)(4,"input",55),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.REFORDBILL=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.PurchaseOrderEnter(r))})("keydown.delete",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.PurchaseOrderDelete(r))}),e.qZA()(),e.TgZ(5,"td"),e.YNc(6,Fe,4,2,"div",11),e.YNc(7,Ve,4,2,"div",11),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(2),e.Oqu(t.poNOLabel),e.xp6(2),e.Q6J("ngStyle",e.VKq(6,se,20==t._trnMainService.TrnMainObj.VoucherType?"95%":"96%"))("ngModel",t._trnMainService.TrnMainObj.REFORDBILL)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode),e.xp6(2),e.Q6J("ngIf",3===t._trnMainService.TrnMainObj.VoucherType&&1!==t.userSetting.ENABLE_GRN_IN_PI||31===t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",20===t._trnMainService.TrnMainObj.VoucherType)}}function Be(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",58),e._uU(2,"Load Wholesale Rate"),e.qZA(),e.TgZ(3,"input",59),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.AdditionalObj.LoadWholeSaleRate=r.target.checked?1:0)})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.AdditionalObj.LoadWholeSaleRate=r)}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.AdditionalObj.LoadWholeSaleRate)}}function ke(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Supplier's Bill No"),e.qZA(),e.TgZ(3,"td",8)(4,"input",60),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.REFORDBILL=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.RefBillEnterCommand(r))}),e.qZA()()()}if(2&s){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t._trnMainService.TrnMainObj.REFORDBILL)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)("placeholder",1==t.userSetting.REFBILLCOMPULSORINDNOTE?"Press Enter to select Supplier bill":"")}}function Je(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2),e.qZA(),e.TgZ(3,"td",50)(4,"input",61),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.TRN_DATE=r)})("change",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.changeInvDate(r.target.value,"AD"))}),e.qZA()(),e.TgZ(5,"td",52)(6,"nepali-date-picker",53),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.changeInvDate(r.detail.value,"BS"))})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.BS_DATE=r)}),e.qZA()()()}if(2&s){const t=e.oxw(2);e.xp6(2),e.Oqu(t.invDateLabel),e.xp6(2),e.s9C("max",t.currDate),e.Q6J("ngModel",t._trnMainService.TrnMainObj.TRN_DATE)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode),e.xp6(2),e.Q6J("id","InvnepaliDateFromPur")("label","From")("disable",t._trnMainService.disableNepaliDate||"VIEW"==t._trnMainService.TrnMainObj.Mode)("ngModel",t._trnMainService.TrnMainObj.BS_DATE)}}function Qe(s,c){1&s&&(e.TgZ(0,"option",66),e._uU(1,"NonTrading"),e.qZA())}function qe(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Purchase Type"),e.qZA(),e.TgZ(3,"select",62),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.INVOICETYPE=r)})("change",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onChangeOnMixedPurchaseType(r))}),e.TgZ(4,"option",63),e._uU(5,"Trading"),e.qZA(),e.YNc(6,Qe,2,0,"option",64),e.TgZ(7,"option",65),e._uU(8,"Mixed"),e.qZA()()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.INVOICETYPE)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||1==t._trnMainService.disableAllFieldinPurchase||16==t._trnMainService.TrnMainObj.VoucherType&&1==t._trnMainService.userSetting.REFBILLCOMPULSORINDNOTE),e.xp6(3),e.Q6J("ngIf","GR"!=(null==t._trnMainService.TrnMainObj.REFORDBILL?null:t._trnMainService.TrnMainObj.REFORDBILL.substring(0,2)))}}function He(s,c){1&s&&e._UZ(0,"label",5)}function Ke(s,c){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",67),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw(2);return a._trnMainService.TrnMainObj.DOFULLRETURN=r.target.checked?1:0,e.KtG(a._trnMainService.callPipe=!a._trnMainService.callPipe)})("click",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.DoFullReturn(r))})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.DOFULLRETURN=r)}),e.qZA(),e.TgZ(2,"label",68),e._uU(3,"Do Full Return"),e.qZA(),e.BQk()}if(2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t._trnMainService.TrnMainObj.DOFULLRETURN)("disabled","VIEW"===t._trnMainService.TrnMainObj.Mode)}}function Ye(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Ref Bill No."),e.qZA(),e.TgZ(3,"input",69),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.REFBILL=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.RefBillEnterCommand(r))})("keydown.tab",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.RefBillEnterCommand(r))}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("disabled",t.showRefBill||"VIEW"==t._trnMainService.TrnMainObj.Mode)("ngModel",t._trnMainService.TrnMainObj.REFBILL)}}function We(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Return Mode"),e.qZA(),e.TgZ(3,"select",70),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.TRNMODE=r)}),e.TgZ(4,"option",71),e._uU(5,"Credit"),e.qZA(),e.TgZ(6,"option",72),e._uU(7,"Cash"),e.qZA()()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.TRNMODE)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)}}function Xe(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"input",73),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw(3);return a._trnMainService.TrnMainObj.DOFULLRETURN=r.target.checked?1:0,e.KtG(a._trnMainService.callPipe=!a._trnMainService.callPipe)})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.DOFULLRETURN=r)})("keydown.delete",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.removeReferenceNumber())}),e.qZA(),e.TgZ(2,"label",57),e._uU(3,"Load Full PO Details"),e.qZA()()}if(2&s){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t._trnMainService.TrnMainObj.DOFULLRETURN)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||t._trnMainService.TrnMainObj.REFORDBILL||("goods-received-note"==t.activeurlpath||"add-purchase-invoice"==t.activeurlpath)&&2!=t.userSetting.PODELIVERYMODE)}}function ze(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"input",56),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.DOFULLRETURN=r.target.checked?1:0)})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.DOFULLRETURN=r)}),e.qZA(),e.TgZ(2,"label",57),e._uU(3,"Load Full Q.T Details"),e.qZA()()}if(2&s){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t._trnMainService.TrnMainObj.DOFULLRETURN)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)}}function $e(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2),e.qZA(),e.TgZ(3,"td",54)(4,"input",55),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.REFORDBILL=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.PurchaseOrderEnter(r))})("keydown.delete",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.PurchaseOrderDelete(r))}),e.qZA()(),e.TgZ(5,"td"),e.YNc(6,Xe,4,2,"div",11),e.YNc(7,ze,4,2,"div",11),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(2),e.Oqu(t.poNOLabel),e.xp6(2),e.Q6J("ngStyle",e.VKq(6,se,20==t._trnMainService.TrnMainObj.VoucherType?"95%":"96%"))("ngModel",t._trnMainService.TrnMainObj.REFORDBILL)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode),e.xp6(2),e.Q6J("ngIf",3===t._trnMainService.TrnMainObj.VoucherType&&1!==t.userSetting.ENABLE_GRN_IN_PI||31===t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",20===t._trnMainService.TrnMainObj.VoucherType)}}function en(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Import PO No."),e.qZA(),e.TgZ(3,"td",54)(4,"input",74),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.REFORDBILL=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.ImportPurchaseOrderEnter(r))})("keydown.delete",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.ImportPOdelete(r))}),e.qZA()(),e.TgZ(5,"td")(6,"input",56),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw(2);return a._trnMainService.TrnMainObj.DOFULLRETURN=r.target.checked?1:0,e.KtG(a._trnMainService.callPipe=!a._trnMainService.callPipe)})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.DOFULLRETURN=r)}),e.qZA(),e.TgZ(7,"label",57),e._uU(8,"Load Full PO Details"),e.qZA()()()}if(2&s){const t=e.oxw(2);e.xp6(4),e.Q6J("ngStyle",e.VKq(5,se,20==t._trnMainService.TrnMainObj.VoucherType?"86%":"96%"))("ngModel",t._trnMainService.TrnMainObj.REFORDBILL)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode),e.xp6(2),e.Q6J("ngModel",t._trnMainService.TrnMainObj.DOFULLRETURN)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||("goods-received-note-import"==t.activeurlpath||"purchase-import"==t.activeurlpath)&&2!=t.userSetting.IMPORTPOBILLMODE)}}function nn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Import GRN No."),e.qZA(),e.TgZ(3,"td",8)(4,"input",75),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG((null==a._trnMainService?null:a._trnMainService.TrnMainObj).REFORDBILL=r)})("keydown.enter",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.ImportGRNEnter())}),e.qZA()()()}if(2&s){const t=e.oxw(2);e.xp6(4),e.Q6J("ngStyle",e.VKq(3,se,20==t._trnMainService.TrnMainObj.VoucherType?"86%":"96%"))("ngModel",null==t._trnMainService?null:t._trnMainService.TrnMainObj.REFORDBILL)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)}}function tn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"GRN No"),e.qZA(),e.TgZ(3,"td",8)(4,"input",76),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.REFORDBILL=r)})("keydown.enter",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.GrnNoEnter())}),e.qZA()()()}if(2&s){const t=e.oxw(2);e.xp6(4),e.Q6J("ngStyle",e.VKq(3,se,20==t._trnMainService.TrnMainObj.VoucherType?"86%":"96%"))("ngModel",t._trnMainService.TrnMainObj.REFORDBILL)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)}}function rn(s,c){1&s&&(e.TgZ(0,"option",71),e._uU(1,"Credit"),e.qZA())}function an(s,c){1&s&&(e.TgZ(0,"option",72),e._uU(1,"Cash"),e.qZA())}function on(s,c){1&s&&(e.TgZ(0,"option",81),e._uU(1,"Cheque"),e.qZA())}function sn(s,c){if(1&s&&(e.TgZ(0,"option",83),e._uU(1),e.qZA()),2&s){const t=c.$implicit;e.Q6J("ngValue",t.PAYMODE),e.xp6(1),e.hij("",t.PAYMODE," ")}}function cn(s,c){if(1&s&&(e.ynx(0),e.YNc(1,sn,2,2,"option",82),e.BQk()),2&s){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.paymentTermList)}}function _n(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2),e.qZA(),e.TgZ(3,"select",77),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.TRNMODE=r)})("change",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.paymentTermsChange())}),e.YNc(4,rn,2,0,"option",78),e.YNc(5,an,2,0,"option",79),e.YNc(6,on,2,0,"option",80),e.YNc(7,cn,2,1,"ng-container",11),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(2),e.Oqu(t.paymentTermLabel),e.xp6(1),e.Q6J("ngModel",t._trnMainService.TrnMainObj.TRNMODE)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||1==t._trnMainService.disableAllFieldinPurchase||t._trnMainService.disablePaymentTerms||t.disableReturnModeInPartialDN||1===t.userSetting.REFBILLCOMPULSORINDNOTE&&1==t._trnMainService.TrnMainObj.DOFULLRETURN&&16===t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE"!=(null==t._trnMainService.TrnMainObj||null==t._trnMainService.TrnMainObj.AdditionalObj?null:t._trnMainService.TrnMainObj.AdditionalObj.tag)||16==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType||31==t._trnMainService.TrnMainObj.VoucherType||40==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE"!=(null==t._trnMainService.TrnMainObj||null==t._trnMainService.TrnMainObj.AdditionalObj?null:t._trnMainService.TrnMainObj.AdditionalObj.tag)||16==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType||31==t._trnMainService.TrnMainObj.VoucherType||40==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE"!=(null==t._trnMainService.TrnMainObj||null==t._trnMainService.TrnMainObj.AdditionalObj?null:t._trnMainService.TrnMainObj.AdditionalObj.tag)||16==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType||31==t._trnMainService.TrnMainObj.VoucherType||40==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",(3==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType)&&"IMPORT_PURCHASE"==t._trnMainService.TrnMainObj.AdditionalObj.tag)}}function ln(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Account"),e.qZA(),e.TgZ(3,"input",84),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.TRNACName=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.AccountEnterCommand(r))})("keydown.tab",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.focusToWarehouse())})("keydown",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.preventInput(r))}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||1==t._trnMainService.disableAllFieldinPurchase||t._trnMainService.disableAccountInputField||1==t._trnMainService.disableOnCreditSelect||1===t.userSetting.REFBILLCOMPULSORINDNOTE&&1==t._trnMainService.TrnMainObj.DOFULLRETURN&&16===t._trnMainService.TrnMainObj.VoucherType)("ngModel",t._trnMainService.TrnMainObj.TRNACName)}}function dn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Account"),e.qZA(),e.TgZ(3,"input",85),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.TRNACName=r)})("keydown.Enter",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onImportAdvanceEnterClicked())})("keydown.tab",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.focusToWarehouse())})("keydown",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.preventInput(r))}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||1==t._trnMainService.disableAllFieldinPurchase||1==t._trnMainService.disableAccountInputField||1==t._trnMainService.disableOnCreditSelect)("ngModel",t._trnMainService.TrnMainObj.TRNACName)}}function un(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Cheque No:"),e.qZA(),e.TgZ(3,"td",8)(4,"input",86),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.CHEQUENO=r)}),e.qZA(),e.TgZ(5,"input",87),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.CHEQUEDATE=r)})("change",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.getEnglishDate())}),e.qZA()()()}if(2&s){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t._trnMainService.TrnMainObj.CHEQUENO)("disabled","cheque"!=t._trnMainService.TrnMainObj.TRNMODE||1==t._trnMainService.disableAllFieldinPurchase),e.xp6(1),e.Q6J("ngModel",t._trnMainService.TrnMainObj.CHEQUEDATE)("disabled","cheque"!=t._trnMainService.TrnMainObj.TRNMODE)}}function Mn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"input",90),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.MWAREHOUSE=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.WarehouseEnterCommand(r))}),e.ALo(1,"disableField"),e.qZA()}if(2&s){const t=e.oxw(3);e.Q6J("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)("ngModel",t._trnMainService.TrnMainObj.MWAREHOUSE)("disabled",e.lcZ(1,3,"disableWareHouse")||1===t.userSetting.REFBILLCOMPULSORINDNOTE&&1==t._trnMainService.TrnMainObj.DOFULLRETURN&&16===t._trnMainService.TrnMainObj.VoucherType||t.disableForLite)}}function pn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"input",91),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.MWAREHOUSE=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.WarehouseEnterCommand(r))}),e.qZA()}if(2&s){const t=e.oxw(3);e.Q6J("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)("ngModel",t._trnMainService.TrnMainObj.MWAREHOUSE)}}function hn(s,c){if(1&s&&(e.TgZ(0,"div",4)(1,"label",5),e._uU(2),e.qZA(),e.YNc(3,Mn,2,5,"input",88),e.YNc(4,pn,1,2,"input",89),e.qZA()),2&s){const t=e.oxw(2);e.xp6(2),e.Oqu(2==t.appType?"Godown":"Warehouse"),e.xp6(1),e.Q6J("ngIf","self-billing"!=t.activeurlpath),e.xp6(1),e.Q6J("ngIf","self-billing"==t.activeurlpath)}}function Tn(s,c){if(1&s&&(e.ynx(0),e.TgZ(1,"option",48),e._uU(2),e.qZA(),e.BQk()),2&s){const t=c.$implicit;e.xp6(1),e.s9C("value",t.LocIDString),e.xp6(1),e.Oqu(t.Name)}}function vn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Location"),e.qZA(),e.TgZ(3,"select",92),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.MWAREHOUSE=r)}),e.YNc(4,Tn,3,2,"ng-container",93),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)("ngModel",t._trnMainService.TrnMainObj.MWAREHOUSE),e.xp6(1),e.Q6J("ngForOf",t.locationList)}}function gn(s,c){if(1&s&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&s){const t=c.$implicit;e.s9C("value",t.CURNAME),e.xp6(1),e.hij(" ",t.CURNAME," ")}}function mn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",94)(1,"label",94),e._uU(2,"Currency :"),e.qZA(),e.TgZ(3,"select",95),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.FCurrency=r)})("change",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onCurrenyChange(r.target.value))})("keydown.Tab",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.focusToExcRate(r))})("keydown.Enter",function(r){e.CHM(t);const a=e.oxw(2);return r.preventDefault(),e.KtG(a.focusToExcRate(r))}),e.YNc(4,gn,2,2,"option",47),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.FCurrency)("disabled",t._trnMainService.itemselectevent||"VIEW"==t._trnMainService.TrnMainObj.Mode||"IMPORT_PURCHASE"==t._trnMainService.TrnMainObj.AdditionalObj.tag&&t._trnMainService.TrnMainObj.REFORDBILL||"GOODS_RECEIVED_NOTE_IMPORT"==t._trnMainService.TrnMainObj.AdditionalObj.tag&&t._trnMainService.TrnMainObj.REFORDBILL&&"EDIT"==t._trnMainService.TrnMainObj.Mode),e.xp6(1),e.Q6J("ngForOf",t.masterService.Currencies)}}function Sn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",94)(1,"label",96),e._uU(2,"EX Rate :"),e.qZA(),e.TgZ(3,"input",97),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.EXRATE=r)})("change",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onEnterExrate())})("keydown.enter",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onEnterExrate())}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.EXRATE)("disabled",t._trnMainService.itemselectevent||1==t._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI&&"purchase-import"==t._trnMainService.activeurlpath&&t._trnMainService.TrnMainObj.REFORDBILL||"VIEW"==t._trnMainService.TrnMainObj.Mode)}}function On(s,c){if(1&s&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&s){const t=c.$implicit;e.s9C("value",t.CCID),e.xp6(1),e.hij(" ",t.COSTCENTERNAME,"")}}function bn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Cost Center"),e.qZA(),e.TgZ(3,"select",100),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.COSTCENTER=r)}),e.YNc(4,On,2,2,"option",47),e.qZA()()}if(2&s){const t=e.oxw(3);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.COSTCENTER)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode),e.xp6(1),e.Q6J("ngForOf",t.costlists)}}function fn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",101)(1,"div",102)(2,"div",4)(3,"div",103)(4,"label"),e._uU(5,"Delivery Date:"),e.qZA()(),e.TgZ(6,"div",104)(7,"input",105),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.DeliveryDate=r)})("change",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.changeDeliveryDate(r.target.value,"AD",r))})("focusout",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.dateValidation(r.target.value,"DeliveryDate"))}),e.qZA()(),e.TgZ(8,"div",106)(9,"nepali-date-picker",107),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.changeDeliveryDate(r.detail.value,"BS",r))})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.DeliveryMiti=r)})("focusout",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.dateValidationBS(r.target.value,"DeliveryDate"))}),e.qZA()()()(),e.TgZ(10,"div",108)(11,"div",4)(12,"div",109)(13,"label"),e._uU(14,"Time:"),e.qZA()(),e.TgZ(15,"div",110)(16,"input",111),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.DeliveryTime=r)}),e.qZA()()()()()}if(2&s){const t=e.oxw(3);e.xp6(7),e.s9C("min",t.currDate),e.Q6J("ngModel",t._trnMainService.TrnMainObj.DeliveryDate)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode),e.xp6(2),e.Q6J("id","DeliveryDate")("label","Delivery Date")("ngModel",t._trnMainService.TrnMainObj.DeliveryMiti)("max",!1)("disable",t._trnMainService.disableNepaliDate||"VIEW"==t._trnMainService.TrnMainObj.Mode),e.xp6(7),e.Q6J("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode)("ngModel",t._trnMainService.TrnMainObj.DeliveryTime)}}function Cn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Order Expiry Date: "),e.qZA(),e.TgZ(3,"td",112)(4,"input",113),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.ORDEXPDATE=r)})("change",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.changeExpiryDate(r.target.value,"AD"))})("focusout",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.dateValidation(r.target.value,"OrderExpiryDate"))}),e.qZA()(),e.TgZ(5,"td",52)(6,"nepali-date-picker",114),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.changeExpiryDate(r.detail.value,"BS"))})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.ORDEXPMITI=r)})("focusout",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.dateValidationBS(r.target.value,"OrderExpiryDate"))}),e.qZA()()()}if(2&s){const t=e.oxw(3);e.xp6(4),e.s9C("min",t.currDate),e.Q6J("ngModel",t._trnMainService.TrnMainObj.ORDEXPDATE)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode),e.xp6(2),e.Q6J("id","OrderExpiryDate")("label","Expiry Date")("disable","VIEW"==t._trnMainService.TrnMainObj.Mode)("ngModel",t._trnMainService.TrnMainObj.ORDEXPMITI)("max",!1)}}function An(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Salesman"),e.qZA(),e.TgZ(3,"input",115),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.SALESMAN=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.salesManEnterCommand(r))})("keydown.delete",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.salesmanDelete())}),e.qZA()()}if(2&s){const t=e.oxw(3);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.SALESMAN)}}function En(s,c){if(1&s&&(e.TgZ(0,"option",83),e._uU(1),e.qZA()),2&s){const t=c.$implicit;e.Q6J("ngValue",t.MODEVALUE),e.xp6(1),e.hij("",t.PAYMENTMODENAME," ")}}function Dn(s,c){if(1&s){const t=e.EpF();e.ynx(0,4),e.TgZ(1,"fieldset",116)(2,"legend",117),e._uU(3,"Advance Payment"),e.qZA(),e.TgZ(4,"div",118)(5,"label",119),e._uU(6,"Amount"),e.qZA(),e.TgZ(7,"input",120),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.ADVANCE=r)}),e.qZA()(),e.TgZ(8,"div",121)(9,"label",119),e._uU(10,"Payment Mode"),e.qZA(),e.TgZ(11,"select",122),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.TRNMODE=r)})("change",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.onChangePaymentMode())}),e.YNc(12,En,2,2,"option",82),e.qZA()(),e.TgZ(13,"div",121)(14,"label",123),e._uU(15,"Account"),e.qZA(),e.TgZ(16,"input",124),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.TRNACName=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.AccountEnterCommand(r))}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw(3);e.xp6(7),e.Q6J("ngModel",t._trnMainService.TrnMainObj.ADVANCE)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||"EDIT"==t._trnMainService.TrnMainObj.Mode),e.xp6(4),e.Q6J("ngModel",t._trnMainService.TrnMainObj.TRNMODE)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||"EDIT"==t._trnMainService.TrnMainObj.Mode&&!t._trnMainService.TrnMainObj.ADVANCE),e.xp6(1),e.Q6J("ngForOf",t.paymentModeList),e.xp6(4),e.Q6J("disabled",t._trnMainService.disableAccountInputField||"VIEW"==t._trnMainService.TrnMainObj.Mode||"EDIT"==t._trnMainService.TrnMainObj.Mode&&!t._trnMainService.TrnMainObj.ADVANCE)("ngModel",t._trnMainService.TrnMainObj.TRNACName)}}function xn(s,c){if(1&s&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&s){const t=c.$implicit;e.s9C("value",t.CURNAME),e.xp6(1),e.hij(" ",t.CURNAME," ")}}function Nn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",94)(1,"label",94),e._uU(2,"Currency :"),e.qZA(),e.TgZ(3,"select",95),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.FCurrency=r)})("change",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onCurrenyChange(r.target.value))})("keydown.Tab",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a.focusToExcRate(r))})("keydown.Enter",function(r){e.CHM(t);const a=e.oxw(3);return r.preventDefault(),e.KtG(a.focusToExcRate(r))}),e.YNc(4,xn,2,2,"option",47),e.qZA()()}if(2&s){const t=e.oxw(3);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.FCurrency)("disabled",t._trnMainService.itemselectevent||"VIEW"==t._trnMainService.TrnMainObj.Mode),e.xp6(1),e.Q6J("ngForOf",t.masterService.Currencies)}}function Pn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",125)(1,"label",96),e._uU(2,"EX Rate :"),e.qZA(),e.TgZ(3,"input",97),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(3);return e.KtG(a._trnMainService.TrnMainObj.EXRATE=r)})("change",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.onEnterExrate())})("keydown.enter",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.onEnterExrate())}),e.qZA()()}if(2&s){const t=e.oxw(3);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.EXRATE)("disabled",t._trnMainService.itemselectevent||"VIEW"==t._trnMainService.TrnMainObj.Mode)}}function Rn(s,c){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,bn,5,3,"div",7),e.YNc(2,fn,17,10,"div",98),e.YNc(3,Cn,7,8,"div",7),e.YNc(4,An,4,1,"div",7),e.YNc(5,Dn,17,7,"ng-container",7),e.TgZ(6,"div",4),e.YNc(7,Nn,5,3,"div",13),e.YNc(8,Pn,4,2,"div",99),e.qZA()()),2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",1==t.userSetting.enabledistributedpurchase),e.xp6(1),e.Q6J("ngIf",(19==t._trnMainService.TrnMainObj.VoucherType||20==t._trnMainService.TrnMainObj.VoucherType)&&1===t.userSetting.EnableDeliveryDateInSOrder),e.xp6(1),e.Q6J("ngIf",19==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE_ORDER"!=t._trnMainService.TrnMainObj.AdditionalObj.tag||20==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf","salesorder"===t.activeurlpath&&t.hideSalesman()),e.xp6(1),e.Q6J("ngIf",20==t._trnMainService.TrnMainObj.VoucherType&&1===t.userSetting.EnableAdvPaymentInSOrder),e.xp6(2),e.Q6J("ngIf",19==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE_ORDER"==t._trnMainService.TrnMainObj.AdditionalObj.tag),e.xp6(1),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE"==t._trnMainService.TrnMainObj.AdditionalObj.tag||19==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE_ORDER"==t._trnMainService.TrnMainObj.AdditionalObj.tag)}}function jn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"span",126),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onAddNewSupplier())}),e.TgZ(1,"p"),e._uU(2,"+"),e.qZA()()}}function In(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Salesman"),e.qZA(),e.TgZ(3,"input",115),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.SALESMAN=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.salesManEnterCommand(r))})("keydown.delete",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.salesmanDelete())}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.SALESMAN)}}function yn(s,c){if(1&s&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&s){const t=c.$implicit;e.s9C("value",t.SHIPPING_ID),e.xp6(1),e.hij(" ",t.ADDRESS," ")}}function Ln(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"span",126),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.onAddNewShippingLocation())}),e.TgZ(1,"p"),e._uU(2,"+"),e.qZA()()}}function wn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Shipping Location"),e.qZA(),e.TgZ(3,"select",127),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.ShippingLocation=r)})("change",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.shippinglocationVoucher(r))}),e.YNc(4,yn,2,2,"option",47),e.qZA(),e.YNc(5,Ln,3,0,"span",17),e.qZA()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.ShippingLocation)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode),e.xp6(1),e.Q6J("ngForOf",t._trnMainService.shippingAddress),e.xp6(1),e.Q6J("ngIf","salesorder"===t.activeurlpath&&1===t.userSetting.EnableShippingAddress)}}function Zn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"span",132),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.onClickAddDiscounts())}),e.TgZ(1,"p"),e._uU(2,"+"),e.qZA(),e.TgZ(3,"span",133),e._uU(4,"Add Additional Discount"),e.qZA()()}}function Un(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",128)(2,"label",94),e._uU(3,"Flat Dis(%)"),e.qZA(),e.TgZ(4,"input",129),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.DCRATE=r)})("keydown.Enter",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.applyFlatDiscount(r))})("keydown.Tab",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.applyFlatDiscount(r))})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return a._trnMainService.callPipe=!a._trnMainService.callPipe,e.KtG(a.validateFlatDiscount(r))})("focusout",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.applyFlatDiscount(r))}),e.qZA()(),e.TgZ(5,"div",128)(6,"label",96),e._uU(7,"Flat Dis(Rs)"),e.qZA(),e.TgZ(8,"input",130),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.FLATDCAMNT=r)})("focusout",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.applyFlatDiscount(r))})("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return a._trnMainService.callPipe=!a._trnMainService.callPipe,e.KtG(a.validateFlatDiscountAmount(r))})("keydown.Enter",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.applyFlatDiscount(r))})("change",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.applyFlatDiscount(r))}),e.qZA(),e.YNc(9,Zn,5,0,"span",131),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t._trnMainService.TrnMainObj.DCRATE)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||t.showDiscountAddButton()||1==(null==t._trnMainService.disableMaster?null:t._trnMainService.disableMaster.FlatDisPer)||t._trnMainService.nullToZeroConverter(t._trnMainService.TrnMainObj.FLATDCAMNT)>0||0==t.userSetting.ENABLEMANUALSALESRETURN&&15==t._trnMainService.TrnMainObj.VoucherType||null==t._trnMainService.TrnMainObj.ProdList[0].MCODE||t._trnMainService.disableOnPerFormaSelect),e.xp6(4),e.Q6J("ngModel",t._trnMainService.TrnMainObj.FLATDCAMNT)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||t.showDiscountAddButton()||1==(null==t._trnMainService.disableMaster?null:t._trnMainService.disableMaster.FlatDisRs)||t._trnMainService.nullToZeroConverter(t._trnMainService.TrnMainObj.DCRATE)>0||0==t.userSetting.ENABLEMANUALSALESRETURN&&15==t._trnMainService.TrnMainObj.VoucherType||null==t._trnMainService.TrnMainObj.ProdList[0].MCODE||t._trnMainService.disableOnPerFormaSelect),e.xp6(1),e.Q6J("ngIf",t.showDiscountAddButton())}}function Fn(s,c){if(1&s&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&s){const t=c.$implicit;e.s9C("value",t.CCID),e.xp6(1),e.hij(" ",t.COSTCENTERNAME,"")}}function Vn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Cost Center"),e.qZA(),e.TgZ(3,"select",70),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.COSTCENTER=r)}),e.YNc(4,Fn,2,2,"option",47),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.COSTCENTER)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||t.disableCostCentreforRefPIWiseLoad()||t._trnMainService.disableCostCenterForCargo||1==t.userSetting.enabledistributedpurchase),e.xp6(1),e.Q6J("ngForOf",t.costlists)}}function Gn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Consignment NO :"),e.qZA(),e.TgZ(3,"input",134),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.DISPENSEBY=r)}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.DISPENSEBY)}}function Bn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"label",5),e._uU(2,"Receive Loc :"),e.qZA(),e.TgZ(3,"input",135),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.TrnMainObj.RECEIVEBY=r)}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t._trnMainService.TrnMainObj.RECEIVEBY)}}function kn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"div",136)(2,"div",137)(3,"div",138)(4,"h6",139),e._uU(5,"Authorization for Negative Stock Entry"),e.qZA(),e.TgZ(6,"button",140),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.closeModal())}),e.TgZ(7,"span",141),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",142)(10,"div",143)(11,"label",144),e._uU(12,"User Name:"),e.qZA(),e.TgZ(13,"div",145)(14,"input",146),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.NegativeBillAuthObj.username=r)}),e.qZA()()(),e.TgZ(15,"div",143)(16,"label",144),e._uU(17,"Password:"),e.qZA(),e.TgZ(18,"div",145)(19,"input",147),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.NegativeBillAuthObj.password=r)}),e.qZA()()()(),e.TgZ(20,"div",148)(21,"button",149),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.NegativeBillAuthConfirm())}),e._uU(22,"Confirm"),e.qZA(),e.TgZ(23,"button",150),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.closeModal())}),e._uU(24,"Cancel"),e.qZA()()()()()}if(2&s){const t=e.oxw(2);e.xp6(14),e.Q6J("ngModel",t.NegativeBillAuthObj.username),e.xp6(5),e.Q6J("ngModel",t.NegativeBillAuthObj.password)}}function Jn(s,c){1&s&&(e.TgZ(0,"p",157),e._uU(1,"Do you want to apply flat discount before or after the individual discount ?"),e.qZA())}function Qn(s,c){1&s&&(e.TgZ(0,"p",157),e._uU(1,"How do you want to apply flat discount?"),e.qZA())}function qn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"button",156),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return r._trnMainService.beforeDiscFlat(),e.KtG(r._trnMainService.showFlatDiscOption=!1)}),e._uU(1,"BEFORE "),e.qZA()}}function Hn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"button",156),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return r._trnMainService.onApplyClicked(),e.KtG(r._trnMainService.showFlatDiscOption=!1)}),e._uU(1,"OVERWRITE"),e.qZA()}}function Kn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",151)(1,"div",152)(2,"div",153)(3,"div",138)(4,"h6",139),e._uU(5,"Confirmation"),e.qZA(),e.TgZ(6,"button",140),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.closeAdditionalFlatDiscOption())}),e.TgZ(7,"span",141),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",142),e.YNc(10,Jn,2,0,"p",154),e.YNc(11,Qn,2,0,"p",154),e.qZA(),e.TgZ(12,"div",148),e.YNc(13,qn,2,0,"button",155),e.TgZ(14,"button",156),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return r._trnMainService.afterDiscFlat(),e.KtG(r._trnMainService.showFlatDiscOption=!1)}),e._uU(15,"AFTER"),e.qZA(),e.YNc(16,Hn,2,0,"button",155),e.TgZ(17,"button",156),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return r._trnMainService.onRevertClicked(),e.KtG(r._trnMainService.showFlatDiscOption=!1)}),e._uU(18,"REVERT"),e.qZA()()()()()}if(2&s){const t=e.oxw(2);e.xp6(10),e.Q6J("ngIf",1==t.userSetting.EnableFDiscountBeforeIDiscount&&t.showBeforeOverwrite()),e.xp6(1),e.Q6J("ngIf",1!=t.userSetting.EnableFDiscountBeforeIDiscount||!t.showBeforeOverwrite()),e.xp6(2),e.Q6J("ngIf",1==t.userSetting.EnableFDiscountBeforeIDiscount&&t.showBeforeOverwrite()),e.xp6(3),e.Q6J("ngIf",t.showBeforeOverwrite())}}function Yn(s,c){1&s&&(e.TgZ(0,"p",157),e._uU(1,"Do you want to apply flat discount before or after the individual discount ?"),e.qZA())}function Wn(s,c){1&s&&(e.TgZ(0,"p",157),e._uU(1,"How do you want to apply flat discount?"),e.qZA())}function Xn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"button",156),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return r.flatDiscountType="before",e.KtG(r.onAddNewDiscounts())}),e._uU(1,"BEFORE "),e.qZA()}}function zn(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"button",156),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return r.flatDiscountType="overwrite",e.KtG(r.onAddNewDiscounts())}),e._uU(1,"OVERWRITE"),e.qZA()}}function $n(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",151)(1,"div",152)(2,"div",153)(3,"div",138)(4,"h6",139),e._uU(5,"Confirmation"),e.qZA(),e.TgZ(6,"button",140),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.closeAdditionalFlatDiscOption())}),e.TgZ(7,"span",141),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",142),e.YNc(10,Yn,2,0,"p",154),e.YNc(11,Wn,2,0,"p",154),e.qZA(),e.TgZ(12,"div",148),e.YNc(13,Xn,2,0,"button",155),e.TgZ(14,"button",156),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return r.flatDiscountType="after",e.KtG(r.onAddNewDiscounts())}),e._uU(15,"AFTER"),e.qZA(),e.YNc(16,zn,2,0,"button",155),e.qZA()()()()}if(2&s){const t=e.oxw(2);e.xp6(10),e.Q6J("ngIf",1==t.userSetting.EnableFDiscountBeforeIDiscount),e.xp6(1),e.Q6J("ngIf",0==t.userSetting.EnableFDiscountBeforeIDiscount),e.xp6(2),e.Q6J("ngIf",1==t.userSetting.EnableFDiscountBeforeIDiscount&&t.showBeforeOverwrite()),e.xp6(3),e.Q6J("ngIf",t.showBeforeOverwrite())}}function et(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",151)(1,"div",158)(2,"div",159)(3,"div",138)(4,"h5",139),e._uU(5,"Discount authorization"),e.qZA(),e.TgZ(6,"button",140),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.closeDisAuthPopup())}),e.TgZ(7,"span",141),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",142)(10,"div",160)(11,"div",161)(12,"div",4)(13,"label",162),e._uU(14,"User Name:"),e.qZA(),e.TgZ(15,"div",163)(16,"input",146),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.disLimitAuthObj.username=r)}),e.qZA()()()(),e.TgZ(17,"div",161)(18,"div",4)(19,"label",162),e._uU(20,"Password:"),e.qZA(),e.TgZ(21,"div",163)(22,"input",147),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.disLimitAuthObj.password=r)}),e.qZA()()()()(),e.TgZ(23,"div",160)(24,"div",161)(25,"div",4)(26,"label",162),e._uU(27,"Discount Percent:"),e.qZA(),e.TgZ(28,"input",164),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.disLimitAuthObj.discountRate=r)}),e.qZA()()(),e.TgZ(29,"div",161)(30,"div",4)(31,"label",162),e._uU(32,"Discount Amount:"),e.qZA(),e.TgZ(33,"input",164),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.disLimitAuthObj.discountAmt=r)}),e.qZA()()()(),e.TgZ(34,"div",165)(35,"fieldset",166)(36,"legend",167),e._uU(37,"Discount authorization remarks:"),e.qZA(),e.TgZ(38,"textarea",168),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a._trnMainService.disLimitAuthObj.remarks=r)}),e.qZA()()()(),e.TgZ(39,"div",148)(40,"button",149),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.discountAuthConfirm())}),e._uU(41,"Confirm"),e.qZA()()()()()}if(2&s){const t=e.oxw(2);e.xp6(16),e.Q6J("ngModel",t._trnMainService.disLimitAuthObj.username),e.xp6(6),e.Q6J("ngModel",t._trnMainService.disLimitAuthObj.password),e.xp6(6),e.Q6J("disabled",t._trnMainService.nullToZeroConverter(t._trnMainService.disLimitAuthObj.discountAmt)>0||1==t.userSetting.enableAdditionalFlatDiscountsInSales)("ngModel",t._trnMainService.disLimitAuthObj.discountRate),e.xp6(5),e.Q6J("disabled",t._trnMainService.nullToZeroConverter(t._trnMainService.disLimitAuthObj.discountRate)>0||1==t.userSetting.enableAdditionalFlatDiscountsInSales)("ngModel",t._trnMainService.disLimitAuthObj.discountAmt),e.xp6(5),e.Q6J("ngModel",t._trnMainService.disLimitAuthObj.remarks)}}function nt(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"label",5),e._uU(5),e.qZA(),e.TgZ(6,"td",6),e._uU(7),e.qZA()(),e.YNc(8,Ze,8,6,"div",7),e.YNc(9,Ue,7,7,"div",7),e.TgZ(10,"div",4)(11,"label",5),e._uU(12),e.qZA(),e.TgZ(13,"td",8)(14,"input",9),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a._trnMainService.TrnMainObj.REFBILL=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.RefBillEnterCommand(r))}),e.qZA()()(),e.YNc(15,Ge,8,8,"div",7),e.YNc(16,Be,4,1,"div",7),e.YNc(17,ke,5,3,"div",7),e.ynx(18),e.YNc(19,Je,7,8,"div",7),e.BQk(),e.YNc(20,qe,9,3,"div",7),e.TgZ(21,"div",4),e.YNc(22,He,1,0,"label",10),e.YNc(23,Ke,4,2,"ng-container",11),e.qZA()(),e.TgZ(24,"div",12),e.YNc(25,Ye,4,2,"div",7),e.YNc(26,We,8,2,"div",7),e.YNc(27,$e,8,8,"div",7),e.YNc(28,en,9,7,"div",7),e.YNc(29,nn,5,5,"div",7),e.YNc(30,tn,5,5,"div",7),e.YNc(31,_n,8,7,"div",7),e.YNc(32,ln,4,2,"div",7),e.YNc(33,dn,4,2,"div",7),e.YNc(34,un,6,4,"div",7),e.YNc(35,hn,5,3,"div",7),e.YNc(36,vn,5,3,"div",7),e.TgZ(37,"div",4),e.YNc(38,mn,5,3,"div",13),e.YNc(39,Sn,4,2,"div",13),e.qZA(),e.YNc(40,Rn,9,7,"div",11),e.qZA(),e.TgZ(41,"div",14)(42,"div",15)(43,"label",5),e._uU(44),e.qZA(),e.TgZ(45,"input",16),e.NdJ("change",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.supplierFieldChange())})("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a._trnMainService.TrnMainObj.BILLTO=r)})("keydown.enter",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.SupplierEnterCommand(r))})("keydown.tab",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.focusToRemarks())})("keyup",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.SupplierEnterCommand(r))}),e.qZA(),e.YNc(46,jn,3,0,"span",17),e.qZA(),e.TgZ(47,"div",4)(48,"label",5),e._uU(49,"Address"),e.qZA(),e.TgZ(50,"input",18),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a._trnMainService.TrnMainObj.BILLTOADD=r)}),e.qZA()(),e.TgZ(51,"div",4)(52,"label",5),e._uU(53,"Vat No "),e.qZA(),e.TgZ(54,"input",19),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a._trnMainService.TrnMainObj.BILLTOTEL=r)}),e.qZA()(),e.TgZ(55,"div",4)(56,"label",5),e._uU(57,"Remarks"),e.qZA(),e.TgZ(58,"textarea",20),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a._trnMainService.TrnMainObj.REMARKS=r)}),e.qZA()(),e.YNc(59,In,4,1,"div",7),e.YNc(60,wn,6,4,"div",7),e.YNc(61,Un,10,5,"div",7),e.YNc(62,Vn,5,3,"div",7),e.YNc(63,Gn,4,1,"div",7),e.YNc(64,Bn,4,1,"div",7),e.TgZ(65,"generic-popup-grid",21,22),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onSupplierSelected(r))}),e.qZA(),e.TgZ(67,"generic-popup-grid",21,23),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onShipNameSelected(r))}),e.qZA(),e.TgZ(69,"generic-popup-grid",21,24),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onRefBillSelected(r))}),e.qZA(),e.TgZ(71,"generic-popup-grid",21,25),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onWarehouseSelected(r))}),e.qZA(),e.TgZ(73,"generic-popup-grid",21,26),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onAccountSelect(r))}),e.qZA(),e.TgZ(75,"generic-popup-grid",21,27),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onPurchaseOrderSelect(r))}),e.qZA(),e.TgZ(77,"generic-multiSelectpopup-grid",28,27),e.NdJ("onImportChalanClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onImportChalanClick(r))}),e.qZA(),e.TgZ(79,"generic-popup-grid",21,29),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onImportPurchaseOrderSelect(r))}),e.qZA(),e.TgZ(81,"file-uploader-popup",30,31),e.NdJ("onUploaded",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onfileUpload(r))}),e.qZA(),e.TgZ(83,"generic-popup-grid",21,32),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onGRNSelect(r))}),e.qZA(),e.TgZ(85,"generic-popup-grid",21,33),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onImportGRNSelect(r))}),e.qZA(),e.TgZ(87,"generic-popup-grid",21,34),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onCustomerSelected(r))}),e.qZA(),e.TgZ(89,"load-purchase-order",35,36),e.NdJ("onLoadPO",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.OKLoadPurchaseOrder(r))}),e.qZA(),e.TgZ(91,"generic-popup-grid",21,37),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onImportAdvanceItemClick(r))}),e.qZA(),e.TgZ(93,"quick-party-master",38,39),e.NdJ("onSaveParty",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onSavePartyMaster(r))}),e.qZA(),e.TgZ(95,"generic-popup-grid",21,40),e.NdJ("onItemDoubleClick",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onSalesManSelect(r))}),e.qZA(),e.TgZ(97,"create-customer-dialog",41,42),e.NdJ("onSave",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onSaveCustomerProfile(r))}),e.qZA(),e.YNc(99,kn,25,2,"div",11),e.YNc(100,Kn,19,4,"div",43),e.YNc(101,$n,17,4,"div",43),e.YNc(102,et,42,7,"div",43),e.qZA()()()}if(2&s){const t=e.oxw();e.xp6(5),e.Oqu(t.billLabel),e.xp6(2),e.hij(" ",t._trnMainService.TrnMainObj.VCHRNO," "),e.xp6(1),e.Q6J("ngIf",1==t.userSetting.enableCostCenter&&15==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",16==t._trnMainService.TrnMainObj.VoucherType||3==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType||19==t._trnMainService.TrnMainObj.VoucherType||20==t._trnMainService.TrnMainObj.VoucherType||31==t._trnMainService.TrnMainObj.VoucherType||40==t._trnMainService.TrnMainObj.VoucherType),e.xp6(3),e.Oqu(t.invNoLabel),e.xp6(2),e.Q6J("ngModel",t._trnMainService.TrnMainObj.REFBILL)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||1==t._trnMainService.disableAllFieldinPurchase||1==t._trnMainService.disableOnGRNload)("readonly",16==t._trnMainService.TrnMainObj.VoucherType&&1==t.userSetting.REFBILLCOMPULSORINDNOTE)("placeholder",16==t._trnMainService.TrnMainObj.VoucherType&&1==t.userSetting.REFBILLCOMPULSORINDNOTE?"Press Enter to select PI bill":""),e.xp6(1),e.Q6J("ngIf","salesorder"===t.activeurlpath&&0!=t.userSetting.ENABLE_QUOTATTION_INSO),e.xp6(1),e.Q6J("ngIf",t.showWholesaleRateOption()),e.xp6(1),e.Q6J("ngIf",16==t._trnMainService.TrnMainObj.VoucherType||40==t._trnMainService.TrnMainObj.VoucherType),e.xp6(2),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType||15==t._trnMainService.TrnMainObj.VoucherType||31==t._trnMainService.TrnMainObj.VoucherType||19==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",t.showPurchaseType()),e.xp6(2),e.Q6J("ngIf",(3==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType||31==t._trnMainService.TrnMainObj.VoucherType||16==t._trnMainService.TrnMainObj.VoucherType||40==t._trnMainService.TrnMainObj.VoucherType)&&"purchase-import"!=t.activeurlpath),e.xp6(1),e.Q6J("ngIf",1==t.userSetting.REFBILLCOMPULSORINDNOTE&&16==t._trnMainService.TrnMainObj.VoucherType),e.xp6(2),e.Q6J("ngIf",4==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",4==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",t.showReferenceBill()&&"asset-purchase-invoice"!==t.activeurlpath&&"salesorder"!==t.activeurlpath),e.xp6(1),e.Q6J("ngIf",(3==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE"==(null==t._trnMainService||null==t._trnMainService.TrnMainObj||null==t._trnMainService.TrnMainObj.AdditionalObj?null:t._trnMainService.TrnMainObj.AdditionalObj.tag)&&0==t._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI||31==t._trnMainService.TrnMainObj.VoucherType&&"GOODS_RECEIVED_NOTE_IMPORT"==(null==t._trnMainService||null==t._trnMainService.TrnMainObj||null==t._trnMainService.TrnMainObj.AdditionalObj?null:t._trnMainService.TrnMainObj.AdditionalObj.tag)&&1==t._trnMainService.userSetting.ENABLE_GRN_IN_IMPORTPI)&&"asset-purchase-invoice"!=t.activeurlpath&&0!=t.userSetting.IMPORTPOBILLMODE),e.xp6(1),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType&&1==t.userSetting.ENABLE_GRN_IN_IMPORTPI&&"purchase-import"==t.activeurlpath),e.xp6(1),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType&&"asset-purchase-invoice"!==t.activeurlpath&&(1==t.userSetting.ENABLE_GRN_IN_PI||1==t.userSetting.ENABLE_GRN_IN_PI&&1==t.userSetting.EnableGRNInPIForCargo)&&"purchase-import"!=t.activeurlpath),e.xp6(1),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType||16==t._trnMainService.TrnMainObj.VoucherType||31==t._trnMainService.TrnMainObj.VoucherType&&"goods-received-note-import"!=t._trnMainService.activeurlpath||40==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE"!=(null==t._trnMainService||null==t._trnMainService.TrnMainObj||null==t._trnMainService.TrnMainObj.AdditionalObj?null:t._trnMainService.TrnMainObj.AdditionalObj.tag)||16==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType||31==t._trnMainService.TrnMainObj.VoucherType&&"goods-received-note-import"!=t._trnMainService.activeurlpath||40==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE"==t._trnMainService.TrnMainObj.AdditionalObj.tag),e.xp6(1),e.Q6J("ngIf",19!=t._trnMainService.TrnMainObj.VoucherType&&20!=t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE"!=(null==t._trnMainService||null==t._trnMainService.TrnMainObj||null==t._trnMainService.TrnMainObj.AdditionalObj?null:t._trnMainService.TrnMainObj.AdditionalObj.tag)&&"goods-received-note-import"!=t._trnMainService.activeurlpath),e.xp6(1),e.Q6J("ngIf",(3==t._trnMainService.TrnMainObj.VoucherType||16==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType||31==t._trnMainService.TrnMainObj.VoucherType||40==t._trnMainService.TrnMainObj.VoucherType||20===t._trnMainService.TrnMainObj.VoucherType&&1==t.userSetting.CheckSaleableQtyInSO)&&"lite"!=t.AppMode&&"asset-purchase-invoice"!=t.activeurlpath),e.xp6(1),e.Q6J("ngIf","asset-purchase-invoice"===t.activeurlpath),e.xp6(2),e.Q6J("ngIf",(3==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType)&&"IMPORT_PURCHASE"==t._trnMainService.TrnMainObj.AdditionalObj.tag||31==t._trnMainService.TrnMainObj.VoucherType&&"GOODS_RECEIVED_NOTE_IMPORT"==t._trnMainService.TrnMainObj.AdditionalObj.tag),e.xp6(1),e.Q6J("ngIf",(3==t._trnMainService.TrnMainObj.VoucherType||37==t._trnMainService.TrnMainObj.VoucherType)&&"IMPORT_PURCHASE"==t._trnMainService.TrnMainObj.AdditionalObj.tag||31==t._trnMainService.TrnMainObj.VoucherType&&"GOODS_RECEIVED_NOTE_IMPORT"==t._trnMainService.TrnMainObj.AdditionalObj.tag),e.xp6(1),e.Q6J("ngIf",19==t._trnMainService.TrnMainObj.VoucherType||20==t._trnMainService.TrnMainObj.VoucherType),e.xp6(4),e.Oqu(t.custsupp),e.xp6(1),e.MGl("placeholder","Press ENTER or TAB to select ",t.custsupp,""),e.Q6J("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||"credit"==t._trnMainService.TrnMainObj.TRNMODE&&"goods-received-note-import"!=t._trnMainService.activeurlpath||1==t._trnMainService.disableAllFieldinPurchase||t._trnMainService.disableSupplierInfo||t._trnMainService.disableCustomerInfo||1===t.userSetting.REFBILLCOMPULSORINDNOTE&&1==t._trnMainService.TrnMainObj.DOFULLRETURN&&16===t._trnMainService.TrnMainObj.VoucherType)("ngModel",t._trnMainService.TrnMainObj.BILLTO),e.xp6(1),e.Q6J("ngIf",t.showAddButton()),e.xp6(4),e.Q6J("ngModel",t._trnMainService.TrnMainObj.BILLTOADD)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||1==t._trnMainService.disableAllFieldinPurchase||t._trnMainService.disableSupplierInfo||t._trnMainService.disableCustomerInfo||1===t.userSetting.REFBILLCOMPULSORINDNOTE&&1==t._trnMainService.TrnMainObj.DOFULLRETURN&&16===t._trnMainService.TrnMainObj.VoucherType),e.xp6(4),e.Q6J("ngModel",t._trnMainService.TrnMainObj.BILLTOTEL)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||1==t._trnMainService.disableAllFieldinPurchase||t._trnMainService.disableSupplierInfo||t._trnMainService.disableCustomerInfo||1===t.userSetting.REFBILLCOMPULSORINDNOTE&&1==t._trnMainService.TrnMainObj.DOFULLRETURN&&16===t._trnMainService.TrnMainObj.VoucherType),e.xp6(4),e.Q6J("ngModel",t._trnMainService.TrnMainObj.REMARKS)("disabled","VIEW"==t._trnMainService.TrnMainObj.Mode||1==t._trnMainService.disableAllFieldinPurchase),e.xp6(1),e.Q6J("ngIf",20==t._trnMainService.TrnMainObj.VoucherType&&"salesorder"!==t.activeurlpath&&t.hideSalesman()),e.xp6(1),e.Q6J("ngIf","salesorder"===t.activeurlpath&&1===t.userSetting.EnableShippingAddress),e.xp6(1),e.Q6J("ngIf",20==t._trnMainService.TrnMainObj.VoucherType),e.xp6(1),e.Q6J("ngIf",0!=t.userSetting.enableCostCenter&&19!=t._trnMainService.TrnMainObj.VoucherType&&20!=t._trnMainService.TrnMainObj.VoucherType&&(3==t._trnMainService.TrnMainObj.VoucherType||16==t._trnMainService.TrnMainObj.VoucherType||31==t._trnMainService.TrnMainObj.VoucherType&&"goods-received-note-import"!=t._trnMainService.activeurlpath)&&"pro"==t.AppMode&&0==t.userSetting.EnableItemWiseCostCenter),e.xp6(1),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE"==t._trnMainService.TrnMainObj.AdditionalObj.tag),e.xp6(1),e.Q6J("ngIf",3==t._trnMainService.TrnMainObj.VoucherType&&"IMPORT_PURCHASE"==t._trnMainService.TrnMainObj.AdditionalObj.tag),e.xp6(1),e.Q6J("popupsettings",t.gridPopupSettingsForSupplier),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForShipName),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForRefBill),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForWarehouse),e.xp6(2),e.Q6J("popupsettings",t.genericGridAccountSetting),e.xp6(2),e.Q6J("popupsettings",t.genericGridPurchaseOrderSetting),e.xp6(2),e.Q6J("popupsettings",t.genericGridPurchaseOrderSetting),e.xp6(2),e.Q6J("popupsettings",t.genericGridImportPurchaseOrderSetting),e.xp6(2),e.Q6J("popupsettings",t.fileUploadPopupSettings),e.xp6(2),e.Q6J("popupsettings",t.genericGridGRNSetting),e.xp6(2),e.Q6J("popupsettings",t.genericGridImportGRNSetting),e.xp6(2),e.Q6J("popupsettings",t.gridPopupSettingsForCustomer),e.xp6(4),e.Q6J("popupsettings",t.gridPopupSettingsForimportAdvanceAc),e.xp6(4),e.Q6J("popupsettings",t.gridPopupSettingsForSalesMan),e.xp6(4),e.Q6J("ngIf",1==t._trnMainService.showNegativeBillingAuthForMain),e.xp6(1),e.Q6J("ngIf",t._trnMainService.showFlatDiscOption),e.xp6(1),e.Q6J("ngIf",t.showAdditionalFlatDiscountPopUp),e.xp6(1),e.Q6J("ngIf",t._trnMainService.showDiscountAuth)}}let tt=(()=>{class s{constructor(t,i,r,a,A,K,Y){this.masterService=t,this._trnMainService=i,this._authService=r,this.dialog=a,this._alertService=A,this._loadingService=K,this.arouter=Y,this.viewDisable=!1,this.gridPopupSettingsForRefBill=new n.im,this.gridPopupSettingsForSupplier=new y.sG,this.gridPopupSettingsForShipName=new n.im,this.gridPopupSettingsForWarehouse=new n.im,this.fileUploadPopupSettings=new U.s,this.genericGridAccountSetting=new n.im,this.genericGridPurchaseOrderSetting=new n.im,this.genericGridImportPurchaseOrderSetting=new n.im,this.gridPopupSettingsForimportAdvanceAc=new n.im,this.genericGridGRNSetting=new n.im,this.genericGridImportGRNSetting=new n.im,this.gridPopupSettingsForCustomer=new n.im,this.gridPopupSettingsForSalesMan=new n.im,this.billLabel="Bill No",this.invNoLabel="Invoice No:",this.invDateLabel="Invoice Date:",this.poNOLabel="PO NO",this.paymentTermLabel="Payment Terms",this.custsupp="Supplier",this.chalanSeries=[],this.isAddressReadOnly=!1,this.isVatNoReadOnly=!1,this.paymentTermList=[],this.paymentModeList=[],this.disableReturnModeInPartialDN=!1,this.showAdditionalFlatDiscountPopUp=!1,this.flatDiscountType="",this.grossAmount=this._trnMainService.TrnMainObj.GROSSAMNT,this.showDiscountPopup=!1,this.totalIndividualDiscount=0,this.NegativeBillAuthObj={username:"",password:"",remarks:""},this.ReffBillObj={},this.tenderMode="",this.appType=this.masterService.appType,this.userProfile=this._authService.getUserProfile(),this.orgType=this.userProfile.CompanyInfo.ORG_TYPE,this.userSetting=this._authService.getSetting(),this.AppMode=Z.N.appMode,"lite"==this.AppMode&&(this.disableForLite=!0),20!=this._trnMainService.TrnMainObj.VoucherType&&(this._trnMainService.TrnMainObj.DOFULLRETURN=1==this.userSetting.REFBILLCOMPULSORINDNOTE?1:0),20==this._trnMainService.TrnMainObj.VoucherType&&(0==this._trnMainService.TrnMainObj.DOFULLRETURN&&0!=this.userSetting.ENABLE_QUOTATTION_INSO?this._trnMainService.TrnMainObj.DOFULLRETURN=0:0!=this.userSetting.ENABLE_QUOTATTION_INSO&&(this._trnMainService.TrnMainObj.DOFULLRETURN=1));var Te=this.masterService.PhiscalObj.BeginDate;Te=Te.substring(0,10),this.date2=Te,this.gridPopupSettingsForShipName={title:"Customer",apiEndpoints:"/getAccountPagedListByPType/PA/C/0",defaultFilterIndex:0,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ACCODE",title:"CODE",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"EMAIL",title:"EMAIL",hidden:!1,noSearch:!1}]},this.gridPopupSettingsForWarehouse={title:2==this.appType?"Godown":"Warehouse",apiEndpoints:"/getDivisionWiseWarehousePagedList",defaultFilterIndex:0,columns:[{key:"NAME",title:"NAME",hidden:!1,noSearch:!1}]},"distributor"==this._trnMainService.userProfile.CompanyInfo.ORG_TYPE&&(this.showRefBill=!0),this._trnMainService.TrnMainObj.CHALANNO="",this.loadCompanyInfo(),this.activeurlpath=Y.snapshot.url[0].path,("purchase-import"==this.activeurlpath||"purchase-import-order"==this.activeurlpath)&&this.masterService.getPaymentTermList().subscribe(W=>{this.paymentTermList=W.result}),this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder&&1===this.userSetting.EnableAdvPaymentInSOrder&&this.masterService.getPaymentModeList("WITHOUTEPAYMENTANDCREDIT").subscribe(W=>{this.paymentModeList=W.result}),"asset-purchase-invoice"===this.activeurlpath&&(this.masterService.GetAssetLocation().subscribe(W=>{"ok"==W.status&&(this.locationList=W.result,this._trnMainService.TrnMainObj.MWAREHOUSE=this.locationList.find(it=>it.IsDefault).LocIDString)}),this.masterService.getMinimumDepValue().subscribe(W=>{this._trnMainService.TrnMainObj.MinDepValue=W}))}ngAfterViewInit(){16==this._trnMainService.TrnMainObj.VoucherType||(20==this._trnMainService.TrnMainObj.VoucherType?setTimeout(()=>{console.log("focus on entry"),document.getElementById("entryDateAD").focus()},1e3):document.getElementById("invoiceNO").focus())}ngOnInit(){this._trnMainService.TrnMainObj.CHALANNO="",this.getDateMiti();const t=new Date;this.currDate=(0,F.p6)(t,"yyyy-MM-dd","en-US"),this.currDateBS=this.convertTOBS(this.currDate),this.masterService.getAllChalanSeries(this._trnMainService.TrnMainObj.VoucherPrefix?this._trnMainService.TrnMainObj.VoucherPrefix:"").subscribe(r=>{r&&"ok"===r.status&&r.result?(this.chalanSeries=r.result?r.result:[],this._trnMainService.TrnMainObj.CHALANNOPREFIX=""):this.chalanSeries=[]},r=>{this.chalanSeries=[]}),this.masterService.getAllCostCenter().subscribe(r=>{r&&(this.costlists=r,(this._trnMainService.TrnMainObj.VoucherType===v.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===v.Km.DebitNote)&&1==this.userSetting.enabledistributedpurchase&&(this._trnMainService.TrnMainObj.COSTCENTER=this.userProfile.costCenter))},r=>{this.costlists=[]}),this._trnMainService.TrnMainObj.VoucherType===v.Km.GoodsReceived&&(this._trnMainService.TrnMainObj.DOFULLRETURN=1,this._trnMainService.TrnMainObj.VATBILL=0),19===this._trnMainService.TrnMainObj.VoucherType?(this.billLabel="PO NO.",this.invNoLabel="Ref No:",this.invDateLabel="Ref Date:"):3==this._trnMainService.TrnMainObj.VoucherType?(this.billLabel="PI No.",this.invNoLabel="Invoice No:",this.invDateLabel="Invoice Date:",this.poNOLabel="PO NO",this.paymentTermLabel="Payment Terms",(0!=this.userSetting.IMPORTPOBILLMODE&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag||0!=this.userSetting.PODELIVERYMODE&&"IMPORT_PURCHASE"!==this._trnMainService.TrnMainObj.AdditionalObj.tag)&&(this._trnMainService.TrnMainObj.DOFULLRETURN=1),this._trnMainService.TrnMainObj.VATBILL=0):16==this._trnMainService.TrnMainObj.VoucherType?(this.billLabel="RETURN NO.",this.invNoLabel="Ref PI No:",this.invDateLabel="Ref PI Date:",this.poNOLabel="Ref Sup Inv NO",this.paymentTermLabel="Return Mode"):20==this._trnMainService.TrnMainObj.VoucherType?(this.billLabel="SO NO.",this.invNoLabel="Ref No:",this.custsupp="Customer",this.poNOLabel="Quotation Ref no.",this._trnMainService.TrnMainObj.DOFULLRETURN=0===this._trnMainService.TrnMainObj.DOFULLRETURN?0:1):this.billLabel="BILL NO.","asset-purchase-invoice"==this.activeurlpath&&(this._trnMainService.TrnMainObj.INVOICETYPE="NONTRADING")}getDateMiti(){this.masterService.getDateMiti(this.userProfile.PhiscalYearInfo.PhiscalID).subscribe(t=>{this.dateMiti=t&&"ok"===t.status&&t.result&&t.result?t.result:[]},t=>{this.dateMiti=[]})}onChangePanBill(){if(this._trnMainService.TrnMainObj.VoucherType!=v.Km.Purchase&&this._trnMainService.TrnMainObj.VoucherType!=v.Km.DebitNote||"MIXED"!=this._trnMainService.TrnMainObj.INVOICETYPE&&"NONTRADING"!=this._trnMainService.TrnMainObj.INVOICETYPE)this._trnMainService.ReCalculateBillWithNormal();else{for(let t=0;t<this._trnMainService.TrnMainObj?.AdditionProdList?.length;t++)this._trnMainService.TrnMainObj.AdditionProdList[t].RATE=this._trnMainService.TrnMainObj.AdditionProdList[t].ALTRATE,this._trnMainService.TrnMainObj.AdditionProdList[t].VAT=this._trnMainService.calculateVATforNonTrading(t);this._trnMainService.ReCalculateBillForNonTradingPurchase(),this._trnMainService.calculateTradingNontradingTotalinDebitNote()}}OnChangePurchaseReturnType(t){("StockIssueApproved"==this._trnMainService.TrnMainObj.AdditionalObj.RETURNTYPE||"DamageSalesReturnApproved"==this._trnMainService.TrnMainObj.AdditionalObj.RETURNTYPE)&&(this.showRefBill=!1),"StockIssueApproved"==this._trnMainService.TrnMainObj.AdditionalObj.RETURNTYPE?this.gridPopupSettingsForRefBill=this.masterService.getGenericGridPopUpSettings("StockTransferForPurchaseReturn"):"DamageSalesReturnApproved"==this._trnMainService.TrnMainObj.AdditionalObj.RETURNTYPE&&(this.gridPopupSettingsForRefBill=this.masterService.getGenericGridPopUpSettings("DamageIssueForPurchaseReturn"))}undo(){this._trnMainService.TrnMainObj.TRNMODE="credit"}showReferenceBill(){return this._trnMainService.TrnMainObj.VoucherType===v.Km.SalesOrder&&(1===this.userSetting.ENABLE_QUOTATTION_INSO||2===this.userSetting.ENABLE_QUOTATTION_INSO)||this._trnMainService.TrnMainObj.VoucherType===v.Km.Purchase&&(1===this.userSetting.PODELIVERYMODE||2===this.userSetting.PODELIVERYMODE)&&"IMPORT_PURCHASE"!==this._trnMainService.TrnMainObj.AdditionalObj.tag&&1!==this.userSetting.ENABLE_GRN_IN_PI||this._trnMainService.TrnMainObj.VoucherType===v.Km.GoodsReceived&&(1===this.userSetting.PODELIVERYMODE||2===this.userSetting.PODELIVERYMODE)&&"GOODS_RECEIVED_NOTE_IMPORT"!==this._trnMainService.TrnMainObj.AdditionalObj.tag&&0!=this.userSetting.ENABLE_GRN_IN_PI}ngOnDestroy(){}getNepaliDate(){if(""!==this._trnMainService.TrnMainObj.TRNDATE&&null!==this._trnMainService.TrnMainObj.TRNDATE){const t=`${this._trnMainService.TrnMainObj.TRNDATE}`,i=_().find(this.dateMiti,["AD",t]);console.log("BSDATE",i),this._trnMainService.TrnMainObj.BSDATE=i&&i.MITI}if(""!==this._trnMainService.TrnMainObj.TRN_DATE&&null!==this._trnMainService.TrnMainObj.TRN_DATE){const t=`${this._trnMainService.TrnMainObj.TRN_DATE}`,i=_().find(this.dateMiti,["AD",t]);this._trnMainService.TrnMainObj.BS_DATE=i&&i.MITI}if(""!==this._trnMainService.TrnMainObj.DeliveryDate&&null!==this._trnMainService.TrnMainObj.DeliveryDate){const t=`${this._trnMainService.TrnMainObj.DeliveryDate}`,i=_().find(this.dateMiti,["AD",t]);this._trnMainService.TrnMainObj.DeliveryMiti=i&&i.MITI}if(""!==this._trnMainService.TrnMainObj.ORDEXPDATE&&null!==this._trnMainService.TrnMainObj.ORDEXPDATE){const t=`${this._trnMainService.TrnMainObj.ORDEXPDATE}`,i=_().find(this.dateMiti,["AD",t]);this._trnMainService.TrnMainObj.ORDEXPMITI=i&&i.MITI}}getEnglishDate(){if(""!==this._trnMainService.TrnMainObj.BSDATE&&null!==this._trnMainService.TrnMainObj.BSDATE){const t=`${this._trnMainService.TrnMainObj.BSDATE}`,i=_().find(this.dateMiti,["MITI",t]);this._trnMainService.TrnMainObj.TRNDATE=i&&i.AD}if(""!==this._trnMainService.TrnMainObj.BS_DATE&&null!==this._trnMainService.TrnMainObj.BS_DATE){const t=`${this._trnMainService.TrnMainObj.BS_DATE}`,i=_().find(this.dateMiti,["MITI",t]);this._trnMainService.TrnMainObj.TRN_DATE=i&&i.AD}if(""!==this._trnMainService.TrnMainObj.DeliveryMiti&&null!==this._trnMainService.TrnMainObj.DeliveryMiti){const t=`${this._trnMainService.TrnMainObj.DeliveryMiti}`,i=_().find(this.dateMiti,["MITI",t]);this._trnMainService.TrnMainObj.DeliveryDate=i&&i.AD}if(""!==this._trnMainService.TrnMainObj.ORDEXPMITI&&null!==this._trnMainService.TrnMainObj.ORDEXPMITI){const t=`${this._trnMainService.TrnMainObj.ORDEXPMITI}`,i=_().find(this.dateMiti,["MITI",t]);this._trnMainService.TrnMainObj.ORDEXPDATE=i&&i.AD}}convertTOBS(t){return this.masterService.toBSDate(t)}formatDate(t){return t.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$2-$1")}changeEntryDate(t,i){"AD"==i?(t>this.currDate&&(t=this.currDate,this._trnMainService.TrnMainObj.TRNDATE=this.currDate),this._trnMainService.TrnMainObj.BSDATE=this.masterService.toBSDate(t)):"BS"==i&&(this.formatDate(t)>this.formatDate(this.currDateBS)&&(this._trnMainService.TrnMainObj.BS_DATE=this.currDateBS,t=this.currDateBS),this._trnMainService.TrnMainObj.TRNDATE=this.masterService.toADDate(t)),"asset-purchase-invoice"===this.activeurlpath&&this.masterService.getAssetDepreciationDoneMonths().subscribe(r=>{const a=this._trnMainService.TrnMainObj.BSDATE.split("/")[1];for(const A of r.result)if(A.MONTHNO===a){this._trnMainService.TrnMainObj.TRNDATE=this.currDate,this._trnMainService.TrnMainObj.BSDATE=this.currDateBS,this._alertService.info(`Depreciation cancellation is required to enter purchase invoice for this month(${A.MONTHNAME.toLowerCase()})`);break}})}changeInvDate(t,i){t>this.currDate&&"AD"==i&&(this._trnMainService.TrnMainObj.TRN_DATE=this.currDate,t=this.currDate),this.formatDate(t)>this.formatDate(this.currDateBS)&&"BS"==i&&(this._trnMainService.TrnMainObj.BS_DATE=this.currDateBS,t=this.currDateBS),"AD"==i?this._trnMainService.TrnMainObj.BS_DATE=this.masterService.toBSDate(t):"BS"==i&&(this._trnMainService.TrnMainObj.TRN_DATE=this.masterService.toADDate(t))}changeExpiryDate(t,i){"AD"==i?this._trnMainService.TrnMainObj.ORDEXPMITI=this.masterService.toBSDate(t):"BS"==i&&(this._trnMainService.TrnMainObj.ORDEXPDATE=this.masterService.toADDate(t))}removeReferenceNumber(){this._trnMainService.TrnMainObj.REFORDBILL=null}dateValidation(t,i){if(t<this.currDate){if("DeliveryDate"==i)return this._alertService.warning("Delivery date shouldnot be entered in back date"),this._trnMainService.TrnMainObj.DeliveryDate=this.currDate,void this.changeDeliveryDate(this._trnMainService.TrnMainObj.DeliveryDate,"AD");if("OrderExpiryDate"==i)return this._alertService.warning("Expiry date shouldnot be entered in back date"),this._trnMainService.TrnMainObj.ORDEXPDATE=this.currDate,void this.changeExpiryDate(this._trnMainService.TrnMainObj.ORDEXPDATE,"AD")}}dateValidationBS(t,i){if(t<this.currDateBS){if("DeliveryDate"==i)return this._alertService.warning("Delivery date shouldnot be entered in back date"),this._trnMainService.TrnMainObj.DeliveryMiti=this.currDateBS,void this.changeDeliveryDate(this._trnMainService.TrnMainObj.DeliveryMiti,"BS");if("OrderExpiryDate"==i)return this._alertService.warning("Expiry date shouldnot be entered in back date"),this._trnMainService.TrnMainObj.ORDEXPMITI=this.currDateBS,void this.changeExpiryDate(this._trnMainService.TrnMainObj.ORDEXPMITI,"BS")}}changeDeliveryDate(t,i,r){"AD"==i?this._trnMainService.TrnMainObj.DeliveryMiti=this.masterService.toBSDate(t):"BS"==i&&(this._trnMainService.TrnMainObj.DeliveryDate=this.masterService.toADDate(t))}SupplierEnterCommand(t){this._trnMainService.customerEvent=!0,this.showPartyMasterPopup=!1,this.showInSupplierPopup=!0,this.showCustomerProfilePopup=!0,"salesorder"==this.activeurlpath?this.getCustomersList("2"):(this.getSupplierList(),this.genericGridSupplier.show())}supplierFieldChange(){this._trnMainService.TrnMainObj.PARAC=null,this._trnMainService.TrnMainObj.TRNAC=null,this._trnMainService.TrnMainObj.BILLTOADD=null,this._trnMainService.TrnMainObj.AdditionalObj.TRNTYPE=null,this._trnMainService.TrnMainObj.TRNMODE=null,this._trnMainService.TrnMainObj.PARTY_ORG_TYPE=null,this._trnMainService.TrnMainObj.CREDITDAYS=0}onSupplierSelected(t){this._trnMainService.TrnMainObj.BILLTO=t.ACNAME,this._trnMainService.TrnMainObj.PARAC=t.ACID,this._trnMainService.TrnMainObj.VoucherType==v.Km.PurchaseOrder&&(this._trnMainService.TrnMainObj.TRNAC=t.ACID),this._trnMainService.TrnMainObj.BILLTOADD=t.ADDRESS,this._trnMainService.TrnMainObj.AdditionalObj.TRNTYPE=null==t.PSTYPE?null:t.PSTYPE.toLowerCase(),this._trnMainService.TrnMainObj.PARTY_ORG_TYPE=t.ORG_TYPE,this._trnMainService.TrnMainObj.CREDITDAYS=t.CRPERIOD,this._trnMainService.TrnMainObj.BILLTOTEL=t.VATNO,this._trnMainService.TrnMainObj.BILLTOMOB=t.PHONE,(this._trnMainService.TrnMainObj.VoucherType===v.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===v.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===v.Km.PurchaseOrder||this._trnMainService.TrnMainObj.VoucherType===v.Km.DebitNote)&&(this._trnMainService.TrnMainObj.VATBILL=t.SUPTYPE,null!=this._trnMainService.TrnMainObj.ProdList[0].MENUCODE&&this.onChangePanBill()),this._trnMainService.TrnMainObj.AdditionalObj.SelectedTermsAndCondition=t.TERMSANDCONDITIONS?JSON.parse(t.TERMSANDCONDITIONS):"","add-purchase-order"==this.activeurlpath&&this._trnMainService.TrnMainObj.AdditionalObj.SelectedTermsAndCondition&&(this._trnMainService.TrnMainObj.AdditionalObj.TermsAndConditionID=this._trnMainService.TrnMainObj.AdditionalObj?.SelectedTermsAndCondition?.find(i=>1==i.isDefault).ID),("purchase-import"==this.activeurlpath||"purchase-import-order"==this.activeurlpath)&&"CREDIT"==this._trnMainService.TrnMainObj.TRNMODE&&(this._trnMainService.TrnMainObj.TRNAC=t.ACID,this._trnMainService.TrnMainObj.TRNACName=t.ACNAME),this.masterService.masterGetmethod("/getPartyBalanceAmount?acid="+t.ACID).subscribe(i=>{"ok"==i.status&&(this._trnMainService.TrnMainObj.BALANCE=this._trnMainService.nullToZeroConverter(i.result))},i=>{}),document.getElementById("remarksid").focus()}shipNameEnterCommand(t){t.preventDefault(),document.getElementById("shipname").blur(),this.genericGridShipName.show()}supplierFieldDisabled(){return null!=this._trnMainService.TrnMainObj.ProdList&&this._trnMainService.TrnMainObj.ProdList.filter(t=>null!=t.MCODE).length>0&&("VIEW"==this._trnMainService.TrnMainObj.Mode||"credit"==this._trnMainService.TrnMainObj.TRNMODE)}onShipNameSelected(t){this._trnMainService.TrnMainObj.AdditionalObj.SHIPNAME=t.ACID,this._trnMainService.TrnMainObj.AdditionalObj.SHIPNAMEVIEW=t.ACNAME,this._trnMainService.TrnMainObj.DeliveryAddress=t.ADDRESS}changeinvalues(){console.log("change in value")}paymentTermsChange(){if(console.log("payment terms change",this._trnMainService.TrnMainObj.TRNMODE),this.flushCreditSelectedData(),this._trnMainService.disableOnCreditSelect=!1,"cash"==this._trnMainService.TrnMainObj.TRNMODE?(this.masterService.focusAnyControl("customerselectid"),this.masterService.userSetting.CASHINHAND_AC?(this._trnMainService.TrnMainObj.TRNAC=this.masterService.userSetting.CASHINHAND_AC,this._trnMainService.TrnMainObj.TRNACName="CASH IN HAND A/C"):(alert("'Default Cash' on database not found. Please Contact to Administrator for this!"),this._trnMainService.TrnMainObj.TRNACName="error...")):this._trnMainService.TrnMainObj.VoucherType===v.Km.Purchase&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag&&this._trnMainService.TrnMainObj.REFORDBILL&&"CREDIT"==this._trnMainService.TrnMainObj.TRNMODE||this._trnMainService.TrnMainObj.VoucherType===v.Km.Purchase&&"IMPORT_PURCHASE"!=this._trnMainService.TrnMainObj.AdditionalObj.tag&&this._trnMainService.TrnMainObj.REFORDBILL&&"credit"==this._trnMainService.TrnMainObj.TRNMODE&&1!=this.userSetting.ENABLE_GRN_IN_PI?(this._trnMainService.TrnMainObj.TRNAC=this._trnMainService.TrnMainObj.PARAC,this._trnMainService.TrnMainObj.TRNACName=this._trnMainService.TrnMainObj.BILLTO,this._trnMainService.disableOnCreditSelect=!0):(this._trnMainService.TrnMainObj.TRNAC="",this._trnMainService.TrnMainObj.TRNACName=""),this._trnMainService.TrnMainObj.VoucherType===v.Km.Purchase&&"IMPORT_PURCHASE"==this._trnMainService.TrnMainObj.AdditionalObj.tag||this._trnMainService.TrnMainObj.VoucherType===v.Km.PurchaseOrder&&"IMPORT_PURCHASE_ORDER"==this._trnMainService.TrnMainObj.AdditionalObj.tag){let t;t=this.paymentTermList.filter(i=>i.PAYMODE==this._trnMainService.TrnMainObj.TRNMODE),this.paymentTermAcid=t&&t[0].ACID}}flushCreditSelectedData(){0!=this.userSetting.IMPORTPOBILLMODE&&"purchase-import"==this.activeurlpath||0!=this.userSetting.ENABLE_GRN_IN_IMPORTPI&&"purchase-import"==this.activeurlpath||0!=this.userSetting.PODELIVERYMODE&&this._trnMainService.TrnMainObj.VoucherType==v.Km.Purchase&&"purchase-import"!=this.activeurlpath||0!=this.userSetting.PODELIVERYMODE&&this._trnMainService.TrnMainObj.VoucherType==v.Km.GoodsReceived||(this._trnMainService.TrnMainObj.PARAC="",this._trnMainService.TrnMainObj.BILLTO="",this._trnMainService.TrnMainObj.BILLTOADD="",this._trnMainService.TrnMainObj.BILLTOTEL="",this._trnMainService.TrnMainObj.MEMBERNO="",this._trnMainService.TrnMainObj.RECEIVEBY="",this._trnMainService.TrnMainObj.TRNAC="",this._trnMainService.TrnMainObj.TRNACName="",this._trnMainService.TrnMainObj.MEMBERNAME="",this._trnMainService.TrnMainObj.SCHEMENAME="")}RefBillEnterCommand(t){this._trnMainService.customerEvent=!0,this._trnMainService.TrnMainObj.VoucherType===v.Km.DebitNote&&(t.preventDefault(),1==this.userSetting.REFBILLCOMPULSORINDNOTE&&(this.genericGridRefBill.show(),"invoiceNO"==t.target.id?this.gridPopupSettingsForRefBill=this.masterService.getGenericGridPopUpSettings("REFBILLOFPURCHASERETURN","",0):"suppBillNo"==t.target.id&&(this.gridPopupSettingsForRefBill=this.masterService.getGenericGridPopUpSettings("REFBILLOFPURCHASERETURN","",2))))}onRefBillSelected(t){this._trnMainService.TrnMainObj.VoucherType!=v.Km.DebitNote||0==t.POST?(console.log("ref bill selectedd in purchase",t),this.ReffBillObj=t,this._trnMainService.TrnMainObj.REFBILL=t.VCHRNO,this._trnMainService.TrnMainObj.PARAC=t.PARAC,this._trnMainService.TrnMainObj.BILLTO=t.BILLTO,this._trnMainService.TrnMainObj.TRNAC=t.TRNAC,this._trnMainService.TrnMainObj.BILLTOADD=t.BILLTOADD,this._trnMainService.TrnMainObj.TRNMODE=t.TRNMODE,this._trnMainService.TrnMainObj.DCRATE=t.DCRATE,this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT=t.TOTALFLATDISCOUNT,this._trnMainService.TrnMainObj.BILLTOTEL=t.BILLTOTEL,this._trnMainService.TrnMainObj.REFORDBILL=t.REFBILL,this._trnMainService.TrnMainObj.COSTCENTER=t.COSTCENTER,this._trnMainService.TrnMainObj.MWAREHOUSE=t.MWAREHOUSE,this._trnMainService.TrnMainObj.INVOICETYPE=null!=t.INVOICETYPE?t.INVOICETYPE:"TRADING",this._trnMainService.TrnMainObj.VoucherType==v.Km.DebitNote&&(this._trnMainService.TrnMainObj.ProdList=[],console.log("invoicetype",this._trnMainService.TrnMainObj.INVOICETYPE),"TRADING"==this._trnMainService.TrnMainObj.INVOICETYPE&&this._trnMainService.addRow(),this._trnMainService.TrnMainObj.CHEQUENO=t.CHEQUENO,this._trnMainService.TrnMainObj.CHEQUEDATE=t.CHEQUEDATE,this._trnMainService.TrnMainObj.VATBILL=t.VATBILL,this._trnMainService.TrnMainObj.AdditionalObj.AFTERFLATDISCRATE=t.AFTERFLATDISCRATE,this._trnMainService.TrnMainObj.AdditionalObj.BEFOREFLATDISCRATE=t.BEFOREFLATDISCRATE,(t.AFTERFLATDISCRATE>0||t.BEFOREFLATDISCRATE>0)&&(this._trnMainService.TrnMainObj.DCRATE=t.AFTERFLATDISCRATE>0?t.AFTERFLATDISCRATE:t.BEFOREFLATDISCRATE)),this.masterService.getAccountNameForMaster(this._trnMainService.TrnMainObj.TRNAC).subscribe(i=>{let r=[];i&&"ok"===i.status&&i.result&&(r=i.result,this._trnMainService.TrnMainObj.TRNACName=r[0].ACNAME)}),16==this._trnMainService.TrnMainObj.VoucherType&&1==this.userSetting.REFBILLCOMPULSORINDNOTE&&(1==this._trnMainService.TrnMainObj.DOFULLRETURN?this._trnMainService.loadDataForPurchaseReturn(t.VCHRNO,t.DIVISION,t.PhiscalID):this.disableReturnModeInPartialDN=!0),"StockIssueApproved"==this.purchaseReturnType?(this._trnMainService.TrnMainObj.REFBILL=t.REFBILL,document.getElementById("poNoId").focus()):null!=document.getElementById("poNoId")&&(this._trnMainService.TrnMainObj.REFBILL=t.VCHRNO,document.getElementById("poNoId").focus())):this._alertService.info(`Voucher Approval for ${t.VCHRNO} is already done!. You are not authorized to reverse this voucher.`)}RefBillFieldDisabled(){return null!=this._trnMainService.TrnMainObj.ProdList&&this._trnMainService.TrnMainObj.ProdList.filter(t=>null!=t.MCODE).length>0}preventInput(t){return t.preventDefault(),!1}WarehouseEnterCommand(t){this.genericGridWarehouse.show()}onWarehouseSelected(t){this._trnMainService.TrnMainObj.MWAREHOUSE=t.NAME}onChangePaymentMode(){this._trnMainService.TrnMainObj.TRNACName=null,this._trnMainService.TrnMainObj.TRNAC=null,this._trnMainService.disableAccountInputField=!1;let t=this.paymentModeList.filter(i=>i.MODEVALUE==this._trnMainService.TrnMainObj.TRNMODE)[0];t&&(t.MODE&&"FIXED"!=t.MODE?.toUpperCase()?(this.tenderMode=t.MODE,this.tenderMode.toUpperCase()):(!t.MODE||"FIXED"==t.MODE?.toUpperCase())&&(this._trnMainService.TrnMainObj.TRNAC=t.ACID,this._trnMainService.TrnMainObj.TRNACName=t.ACNAME,this._trnMainService.disableAccountInputField=!0),"cash"==this._trnMainService.TrnMainObj.TRNMODE&&this._trnMainService.setCashProperty(),this._trnMainService.disableAccountInputField=!!this._trnMainService.TrnMainObj.TRNAC)}getSupplierList(){this.gridPopupSettingsForSupplier={title:"Supplier",apiEndpoints:"/getAccountPagedListByPType/PA/V/0",defaultFilterIndex:0,useDefinefilterValue:this._trnMainService.TrnMainObj.BILLTO,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ACCODE",title:"CODE",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"VATNO",title:"VATNO",hidden:!1,noSearch:!1}]}}showAccountInSO(){return!("OTHERS"!=this.tenderMode&&"CREDITCARD"!=this.tenderMode&&!this._trnMainService.TrnMainObj.TRNACName)}AccountEnterCommand(){this.showPartyMasterPopup=!1,this.showInSupplierPopup=!1;var t="";let i="";(this._trnMainService.TrnMainObj.VoucherType==v.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==v.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType==v.Km.GoodsReceived)&&("cash"==this._trnMainService.TrnMainObj.TRNMODE?t="Bank Deposit Voucher":"credit"==this._trnMainService.TrnMainObj.TRNMODE?(t="Supplier",this.showPartyMasterPopup=!0):t="BankList",i=`/getAccountPagedListByMapId/Master/${t}/`),this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder&&(i="/getpaymentmodepagedlist"),this.genericGridAccountSetting={title:"Accounts",apiEndpoints:i,defaultFilterIndex:1,columns:[{key:"ACCODE",title:"AC CODE",hidden:!1,noSearch:!1},{key:"ACNAME",title:"A/C NAME",hidden:!1,noSearch:!1}]},this.genericGridAccount.show()}onAccountSelect(t){try{this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder&&1==this.userSetting.EnableAdvPaymentInSOrder||this.flushCreditSelectedData(),this._trnMainService.TrnMainObj.TRNAC=t.ACID,this._trnMainService.TrnMainObj.TRNACName=t.ACNAME,"credit"==this._trnMainService.TrnMainObj.TRNMODE&&(this.isAddressReadOnly=!0,this.isVatNoReadOnly=!0,this._trnMainService.TrnMainObj.BILLTO=t.ACNAME,this._trnMainService.TrnMainObj.BILLTOTEL=t.VATNO,this._trnMainService.TrnMainObj.BILLTOADD=t.ADDRESS,this._trnMainService.TrnMainObj.PARAC=t.ACID,this._trnMainService.TrnMainObj.BILLTOMOB=t.PHONE),(this._trnMainService.TrnMainObj.VoucherType===v.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===v.Km.GoodsReceived||this._trnMainService.TrnMainObj.VoucherType===v.Km.PurchaseOrder||this._trnMainService.TrnMainObj.VoucherType===v.Km.DebitNote)&&(this._trnMainService.TrnMainObj.VATBILL=t.SUPTYPE,null!=this._trnMainService.TrnMainObj.ProdList[0]?.MENUCODE&&this.onChangePanBill())}catch(i){alert(i)}1==this.userSetting.ReceiptBasedGRN&&this._trnMainService.TrnMainObj.VoucherType==v.Km.GoodsReceived?document.getElementById("poNoId").focus():document.getElementById("warehouseId").focus()}focusToWarehouse(){(this._trnMainService.TrnMainObj.VoucherType==v.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==v.Km.DebitNote)&&document.getElementById("warehouseId").focus()}focusToSupplier(){(this._trnMainService.TrnMainObj.VoucherType==v.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==v.Km.DebitNote)&&("credit"!=this._trnMainService.TrnMainObj.TRNMODE?document.getElementById("supplierid").focus():document.getElementById("remarksid").focus())}showWholesaleRateOption(){return 1==this.userSetting.LoadWholesaleRateinSalesOrder&&this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder}loadCompanyInfo(){1!=this._trnMainService.inputCode&&this.masterService.loadCompany().subscribe(t=>{this._trnMainService.TrnMainObj.AdditionalObj.BILLFORMATS=t.BILLFORMATS,this._trnMainService.TrnMainObj.AdditionalObj.BILLUNITS=t.BILLUNITS})}openQuickPartyMasterPopup(){"PI"==this._trnMainService.TrnMainObj.VoucherPrefix&&1==this.showPartyMasterPopup&&(this.masterService.isSalesPage=!1,this.CreateQuickParty.show(),this.genericGridAccount.hide())}openQuickPartyInSupplier(){"PI"==this._trnMainService.TrnMainObj.VoucherPrefix&&1==this.showInSupplierPopup&&(this.masterService.isSalesPage=!1,this.CreateQuickParty.show(),this.genericGridSupplier.hide())}openQuickCusProfilePopup(){20==this._trnMainService.TrnMainObj.VoucherType&&(this.CreateCustomerProfile.show(),this.genericGridCustomer.hide(),this.showCustomerProfilePopup=!1)}onSaveCustomerProfile(t){console.log("on save customer",t),this._trnMainService.TrnMainObj.BILLTO=t.name,this._trnMainService.TrnMainObj.BILLTOADD=t.address,this._trnMainService.TrnMainObj.BILLTOTEL=t.pan,this._trnMainService.TrnMainObj.BILLTOMOB=t.mobNo,document.getElementById("remarksid").focus(),this.masterService.getMemershipFromMemberNo(t.memID).subscribe(i=>{this._trnMainService.TrnMainObj.MEMBERNO=i[0].MEMID,this._trnMainService.TrnMainObj.MEMBERNAME=i[0].FNAME,this._trnMainService.TrnMainObj.SCHEMENAME=i[0].SCHEMEID,this._trnMainService.TrnMainObj.RECEIVEBY=i[0].MEMID,i[0].ACCOUNT&&(this._trnMainService.TrnMainObj.PARAC=i[0].ACCOUNT)})}onSavePartyMaster(t){(1==this.showPartyMasterPopup||"credit"==this._trnMainService.TrnMainObj.TRNMODE)&&(this._trnMainService.TrnMainObj.TRNACName=t.ACNAME,this._trnMainService.TrnMainObj.TRNAC=t.ACID,this._trnMainService.TrnMainObj.BILLTO=t.ACNAME,this._trnMainService.TrnMainObj.BILLTOADD=t.ADDRESS,this._trnMainService.TrnMainObj.BILLTOTEL=t.VATNO,1==t.SUPTYPE&&(this._trnMainService.TrnMainObj.VATBILL=1),setTimeout(()=>{this.masterService.focusAnyControl("warehouseId")},500)),1==this.showInSupplierPopup&&("purchase-import"==this.activeurlpath&&(this._trnMainService.TrnMainObj.PARAC=t.ACID),this._trnMainService.TrnMainObj.BILLTO=t.ACNAME,this._trnMainService.TrnMainObj.BILLTOADD=t.ADDRESS,this._trnMainService.TrnMainObj.BILLTOTEL=t.VATNO)}focusToRemarks(){this.masterService.focusAnyControl("remarksid")}ImportGRNEnter(){this.genericGridImportGRNSetting={title:"Good Received Note - Import",apiEndpoints:"/getImportGRNPagedList/GR",defaultFilterIndex:0,columns:[{key:"GRNNUMBER",title:"GRN Number",hidden:!1,noSearch:!1},{key:"DATE",title:"Date",hidden:!1,noSearch:!1},{key:"SUPPLIERNAME",title:"Supplier Name",hidden:!1,noSearch:!1}]},this.genericGridImportGRN.show()}GrnNoEnter(){1==this.userSetting.EnableGRNInPIForCargo?0!=this.userSetting.ENABLE_GRN_IN_PI&&3==this._trnMainService.TrnMainObj.VoucherType&&(this.genericGridGRNSetting={title:"Good Received Note",apiEndpoints:"/getGRNVoucherListFromCargo",defaultFilterIndex:0,columns:[{key:"VCHRNO",title:"GRN Number",hidden:!1,noSearch:!1},{key:"TRNDATE",title:"Date",hidden:!1,noSearch:!1},{key:"BOOKINGID",title:"Booking ID",hidden:!1,noSearch:!1},{key:"SUPPLIER_NAME",title:"Supplier",hidden:!1,noSearch:!1}]}):0!=this.userSetting.ENABLE_GRN_IN_PI&&3==this._trnMainService.TrnMainObj.VoucherType&&(this.genericGridGRNSetting={title:"Good Received Note",apiEndpoints:"/getGRNPagedList/GR",defaultFilterIndex:0,columns:[{key:"GRNNUMBER",title:"GRN Number",hidden:!1,noSearch:!1},{key:"DATE",title:"Date",hidden:!1,noSearch:!1},{key:"SUPPLIERNAME",title:"Supplier Name",hidden:!1,noSearch:!1}]}),this.genericGridGRN.show()}onEnterExrate(){this._trnMainService.TrnMainObj.ProdList.forEach(t=>{t.ALTRATE=this._trnMainService.nullToZeroConverter(t.INVRATE)*this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.EXRATE),t.REALRATE=t.ALTRATE/t.ALTCONFACTOR,t.RATE=t.ALTRATE/t.ALTCONFACTOR}),this._trnMainService.ReCalculateBillWithNormal()}PurchaseOrderEnter(){if(console.log("usersetting",this.userSetting.PODELIVERYMODE,"vouchertype",this._trnMainService.TrnMainObj.VoucherType),1!=this.userSetting.ReceiptBasedGRN||this._trnMainService.TrnMainObj.TRNAC){if(0!=this.userSetting.PODELIVERYMODE||0!=this.userSetting.ENABLE_QUOTATTION_INSO){let t;this.genericGridPurchaseOrderSetting=20==this._trnMainService.TrnMainObj.VoucherType?{title:"Quotation",apiEndpoints:`/getPurchaseOrderPagedList/${t}/QT`,defaultFilterIndex:2,columns:[{key:"PONUMBER",title:"Quotation No.",hidden:!1,noSearch:!1},{key:"DATE",title:"Date",hidden:!1,noSearch:!1},{key:"SUPPLIERNAME",title:"Customer Name",hidden:!1,noSearch:!1}]}:{title:"Purchase Order",apiEndpoints:1==this.userSetting.ReceiptBasedGRN?`/getPOPagedListInGRN/${this._trnMainService.TrnMainObj.TRNAC}`:`/getPurchaseOrderPagedList/${t}/PO`,selectAllApiEndpoint:1==this.userSetting.ReceiptBasedGRN?`/getAllPOListInGRNSupplierWise?acid=${this._trnMainService.TrnMainObj.TRNAC}`:"",defaultFilterIndex:0,columns:[{key:1==this.userSetting.ReceiptBasedGRN?"VCHRNO":"PONUMBER",title:"PO Number",hidden:!1,noSearch:!1},{key:1==this.userSetting.ReceiptBasedGRN?"TRNDATE":"DATE",title:"Date",hidden:!1,noSearch:!1},{key:1==this.userSetting.ReceiptBasedGRN?"ACNAME":"SUPPLIERNAME",title:"Supplier Name",hidden:!1,noSearch:!1},{key:"NETAMNT",title:"Amount",hidden:!1,noSearch:!1}]},this.genericGridPurchaseOrder.map(i=>{(i instanceof n.Zl&&!this.userSetting.IsBBSM||i instanceof V&&this.userSetting.IsBBSM)&&i.show()})}}else this._alertService.info("Please select account first!")}onPurchaseOrderSelect(t){t&&(this._trnMainService.TrnMainObj.REFORDBILL=t.PONUMBER,this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE="FROMPO",this._trnMainService.TrnMainObj.TRNACName=t.SUPPLIERNAME,this._trnMainService.TrnMainObj.BILLTO=t.SUPPLIERNAME,this._trnMainService.TrnMainObj.BILLTOADD=t.ADDRESS,this._trnMainService.TrnMainObj.BILLTOTEL=t.VATNO,this._trnMainService.TrnMainObj.VATBILL=t.VATBILL,this._trnMainService.TrnMainObj.TRNMODE="credit",this._trnMainService.disableSupplierInfo=!0,this._trnMainService.disableOnCreditSelect=!0,this._trnMainService.disablePaymentTerms=!0,this._trnMainService.disableCustomerInputField=!0,this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow(),this._trnMainService.TrnMainObj.TOTALSQTY=0,this._trnMainService.TrnMainObj.GROSSAMNT=0,this._trnMainService.TrnMainObj.TAXABLE=0,this._trnMainService.TrnMainObj.NONTAXABLE=0,this._trnMainService.TrnMainObj.VATAMNT=0,this._trnMainService.TrnMainObj.NETWITHOUTROUNDOFF=0,this._trnMainService.TrnMainObj.INVOICETYPE="TRADING",((this._trnMainService.TrnMainObj.VoucherType===v.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType===v.Km.GoodsReceived)&&0!==this.userSetting.PODELIVERYMODE||this._trnMainService.TrnMainObj.VoucherType===v.Km.SalesOrder)&&(this._trnMainService.TrnMainObj.PARAC=t.ACID,this._trnMainService.TrnMainObj.TRNAC=t.ACID),this._trnMainService.TrnMainObj.VoucherType===v.Km.SalesOrder&&(this._trnMainService.TrnMainObj.SALESMAN=t.SALESMAN,this._trnMainService.TrnMainObj.SALESMANID=t.SALESMANID,this._trnMainService.disableCustomerInfo=!0,0==this._trnMainService.TrnMainObj.DOFULLRETURN&&(this._trnMainService.disableAllFieldinPurchase=!1,this._trnMainService.TrnMainObj.RECEIVEBY=t.CUSTID,this._trnMainService.TrnMainObj.PARAC=t.ACID,this._trnMainService.TrnMainObj.AdditionalObj.AFTERFLATDISCRATE=t.AFTERFLATDISCRATE,this._trnMainService.TrnMainObj.AdditionalObj.BEFOREFLATDISCRATE=t.BEFOREFLATDISCRATE,this._trnMainService.isRatePartial=this._trnMainService.TrnMainObj.DCRATE>0,(t.AFTERFLATDISCRATE>0||t.BEFOREFLATDISCRATE>0)&&(this._trnMainService.TrnMainObj.DCRATE=t.AFTERFLATDISCRATE>0?t.AFTERFLATDISCRATE:t.BEFOREFLATDISCRATE))),this._trnMainService.TrnMainObj.VoucherType===v.Km.Purchase&&1===this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.loadDataForPurchaseFromPOORDER(t.PONUMBER,t.DIVISION,t.PHISCALID,"POINPI"),this._trnMainService.TrnMainObj.VoucherType===v.Km.GoodsReceived&&1===this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.loadDataForGRNFromPOORDER(t.PONUMBER,t.DIVISION,t.PHISCALID,"POINPI"),this._trnMainService.TrnMainObj.VoucherType===v.Km.SalesOrder&&1===this._trnMainService.TrnMainObj.DOFULLRETURN&&this._trnMainService.loadDataForSalesOrderFromQuotation(t.PONUMBER,t.DIVISION,t.PHISCALID,""),20!=this._trnMainService.TrnMainObj.VoucherType&&1==this._trnMainService.DOFULLRETURN&&(this._trnMainService.disableRateOnPOselect=!0,this._trnMainService.disableItemSelectOnPOselect=!0),(1==this._trnMainService.userSetting.ENABLE_GRN_IN_PI&&"goods-received-note"==this._trnMainService.activeurlpath||0==this._trnMainService.userSetting.ENABLE_GRN_IN_PI&&"add-purchase-invoice"==this._trnMainService.activeurlpath)&&1==this._trnMainService.userSetting.PODELIVERYMODE&&(this._trnMainService.disableAllFieldinPurchase=!0,this._trnMainService.disableRateOnGRNload=!0),this._trnMainService.TrnMainObj.VoucherType===v.Km.SalesOrder&&0!=this.userSetting.enableCostCenter?setTimeout(()=>{document.getElementById("CCenter").focus()}):setTimeout(()=>{document.getElementById("remarksid").focus()},500),null!=this._trnMainService.TrnMainObj.ProdList[0].MENUCODE&&this._trnMainService.ReCalculateBillWithNormal())}onImportChalanClick(t){let i="";t.forEach(r=>{i+=`${r},`}),i=i.substring(0,i.length-1),this.fileUploadPopupSettings=Object.assign(new U.s,{title:"GRN Upload",uploadEndpoints:`/importFileForGRN?voucherList=${i}`,sampleFileUrl:"/downloadSampleExcelforMasterMigration?importName=Goods Received Note",allowMultiple:!1,acceptFormat:".xlsx",vchrlist:t,voucherUpload:!0,filename:"GRN Upload Sample"}),this.fileUploadPopup.show()}onfileUpload(t){console.log("data",t),"ok"==t.status&&(this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.TrnMainObj.ProdList=t.result,this._trnMainService.TrnMainObj.ProdList.forEach(i=>{i.RATE=i.ALTRATE}),this._trnMainService.ReCalculateBillWithNormal())}PurchaseOrderDelete(t){null!=this._trnMainService.TrnMainObj.REFORDBILL&&(this._trnMainService.TrnMainObj.REFORDBILL=null,this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE=null,this._trnMainService.TrnMainObj.TRNACName=null,this._trnMainService.TrnMainObj.BILLTO=null,this._trnMainService.TrnMainObj.BILLTOADD=null,this._trnMainService.TrnMainObj.BILLTOTEL=null,this._trnMainService.TrnMainObj.FCurrency=null,this._trnMainService.TrnMainObj.EXRATE=null,this._trnMainService.TrnMainObj.TRNMODE="credit",this._trnMainService.TrnMainObj.TRNAC=null,this._trnMainService.TrnMainObj.PARAC=null,this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow(),this._trnMainService.TrnMainObj.TOTALSQTY=0,this._trnMainService.TrnMainObj.GROSSAMNT=0,this._trnMainService.TrnMainObj.TAXABLE=0,this._trnMainService.TrnMainObj.NONTAXABLE=0,this._trnMainService.TrnMainObj.VATAMNT=0,this._trnMainService.TrnMainObj.NETWITHOUTROUNDOFF=0,this._trnMainService.disableSupplierInfo=!1,this._trnMainService.disableCustomerInfo=!1,this._trnMainService.disableOnCreditSelect=!1,this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder&&(this._trnMainService.TrnMainObj.TRNMODE=null,this._trnMainService.TrnMainObj.DeliveryDate=null,this._trnMainService.TrnMainObj.DeliveryMiti=null,this._trnMainService.TrnMainObj.ORDEXPDATE=null,this._trnMainService.TrnMainObj.ORDEXPMITI=null))}ImportPurchaseOrderEnter(t){if(0!==this.userSetting.IMPORTPOBILLMODE||1==this.userSetting.ENABLE_GRN_IN_IMPORTPI){let i;this.genericGridImportPurchaseOrderSetting={title:"Import Purchase Order",apiEndpoints:`/getImportPurchaseOrderPagedList/${i}/PO`,defaultFilterIndex:0,columns:[{key:"PONUMBER",title:"Import PO Number",hidden:!1,noSearch:!1},{key:"DATE",title:"Date",hidden:!1,noSearch:!1},{key:"SUPPLIERNAME",title:"Supplier Name",hidden:!1,noSearch:!1}]},this.genericGridImportPurchaseOrder.show()}}onImportPurchaseOrderSelect(t){t&&(this._trnMainService.TrnMainObj.REFORDBILL=t.PONUMBER,this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE="FROMIMPORTPO",this._trnMainService.TrnMainObj.TRNACName="",this._trnMainService.TrnMainObj.BILLTO=t.SUPPLIERNAME,this._trnMainService.TrnMainObj.BILLTOADD=t.ADDRESS,this._trnMainService.TrnMainObj.BILLTOTEL=t.VATNO,this._trnMainService.TrnMainObj.FCurrency=t.FCurrency,this._trnMainService.TrnMainObj.EXRATE=t.EXRATE,this._trnMainService.TrnMainObj.TRNAC="",this._trnMainService.TrnMainObj.PARAC=t.ACID,this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow(),this._trnMainService.disableSupplierInfo=!0,this._trnMainService.TrnMainObj.TOTALSQTY=0,this._trnMainService.TrnMainObj.GROSSAMNT=0,this._trnMainService.TrnMainObj.TAXABLE=0,this._trnMainService.TrnMainObj.NONTAXABLE=0,this._trnMainService.TrnMainObj.VATAMNT=0,this._trnMainService.TrnMainObj.NETWITHOUTROUNDOFF=0,this._trnMainService.purchaseOrderQty=null,this._trnMainService.produstWiseOrderUnit="",this._trnMainService.purchaseOrderRate=null,this._trnMainService.TrnMainObj.VoucherType===v.Km.Purchase&&"IMPORT_PURCHASE"===this._trnMainService.TrnMainObj.AdditionalObj.tag&&1===this._trnMainService.TrnMainObj.DOFULLRETURN&&(this._trnMainService.loadDataForImportPurchaseFromIMPORDER(t.PONUMBER,t.DIVISION,t.PhiscalID,"POINPI"),setTimeout(()=>{document.getElementById("paymentTerms").focus()},500)),this._trnMainService.TrnMainObj.VoucherType===v.Km.GoodsReceived&&"GOODS_RECEIVED_NOTE_IMPORT"===this._trnMainService.TrnMainObj.AdditionalObj.tag&&1===this._trnMainService.TrnMainObj.DOFULLRETURN&&(this._trnMainService.loadDataForImportGRNFromIMPORDER(t.PONUMBER,t.DIVISION,t.PhiscalID,"POINPI"),setTimeout(()=>{document.getElementById("paymentTerms").focus()},500)),setTimeout(()=>{document.getElementById("paymentTerms").focus()},100))}ImportPOdelete(t){if(null!=this._trnMainService.TrnMainObj.REFORDBILL)return this._trnMainService.TrnMainObj.REFORDBILL=null,this._trnMainService.TrnMainObj.AdditionalObj.INVOICETYPE=null,this._trnMainService.TrnMainObj.TRNACName=null,this._trnMainService.TrnMainObj.BILLTO=null,this._trnMainService.TrnMainObj.BILLTOADD=null,this._trnMainService.TrnMainObj.BILLTOTEL=null,this._trnMainService.TrnMainObj.FCurrency=null,this._trnMainService.TrnMainObj.EXRATE=null,this._trnMainService.TrnMainObj.TRNMODE=null,this._trnMainService.TrnMainObj.TRNAC=null,this._trnMainService.TrnMainObj.PARAC=null,this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow(),this._trnMainService.TrnMainObj.TOTALSQTY=0,this._trnMainService.TrnMainObj.GROSSAMNT=0,this._trnMainService.TrnMainObj.TAXABLE=0,this._trnMainService.TrnMainObj.NONTAXABLE=0,this._trnMainService.TrnMainObj.VATAMNT=0,this._trnMainService.TrnMainObj.NETWITHOUTROUNDOFF=0,this._trnMainService.disableSupplierInfo=!1,void(this._trnMainService.disableCustomerInfo=!1)}onImportGRNSelect(t){this._loadingService.show("Loading details, please wait..."),this.masterService.LoadTransaction(t.GRNNUMBER,t.DIVISION,t.PhiscalID,"","","","","isFilterFiscalID").subscribe(i=>{if("ok"==i.status){this._loadingService.hide();const r=g(67816);this._trnMainService.TrnMainObj=i.result,this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.guid=r(),this._trnMainService.TrnMainObj.REFORDBILL=t.GRNNUMBER,this._trnMainService.TrnMainObj.VoucherType=v.Km.Purchase,this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.TRNMODE=i.result.TRNMODE,this._trnMainService.TrnMainObj.CNDN_MODE=10,this._trnMainService.TrnMainObj.AdditionalObj.tag="IMPORT_PURCHASE",this._trnMainService.TrnMainObj.INVOICETYPE="TRADING",this._trnMainService.TrnMainObj.TRNAC=null,this._trnMainService.TrnMainObj.TRNACName=null,this._trnMainService.TrnMainObj.TRN_DATE=null==i.result.TRN_DATE?"":i.result.TRN_DATE.toString().substring(0,10),this.masterService.getCurrentDate().subscribe(A=>{this._trnMainService.TrnMainObj.TRNDATE=A.Date.substring(0,10),this._trnMainService.TrnMainObj.BSDATE=this._trnMainService.getBsDate(this._trnMainService.TrnMainObj.TRNDATE)}),this._trnMainService.getVoucherNumber(),this._trnMainService.TrnMainObj.GROSSAMNT=this._trnMainService.TrnMainObj.VoucherType==v.Km.Purchase&&1==i.result.VATBILL?i.result.NONTAXABLE:i.result.TAXABLE,this._trnMainService.TrnMainObj.TOTALSQTY=0,this._trnMainService.TrnMainObj.ProdList.forEach(A=>{this._trnMainService.TrnMainObj.TOTALSQTY+=A.Quantity});for(let A in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[A].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[A].MFGDATE?"":0==this.userSetting.enableDayWiseMfgEXPDate?this._trnMainService.TrnMainObj.ProdList[A].MFGDATE.toString().substring(0,7):this._trnMainService.TrnMainObj.ProdList[A].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[A].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[A].EXPDATE?"":0==this.userSetting.enableDayWiseMfgEXPDate?this._trnMainService.TrnMainObj.ProdList[A].EXPDATE.toString().substring(0,7):this._trnMainService.TrnMainObj.ProdList[A].EXPDATE.toString().substring(0,10);this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.disableOnGRNload=!0,this._trnMainService.disableSupplierInfo=!0,""==this._trnMainService.activeurlpath&&(this._trnMainService.disableRateOnPOselect=!0,this._trnMainService.disableItemSelectOnPOselect=!0);let a=this.masterService.userProfile.roleRights.find(A=>"ALLOWRATECHANGEINPI"==A.right);(0==this.userSetting.RATECHANGE_IN_POBASEPI||1==this.userSetting.RATECHANGE_IN_POBASEPI&&0==a.value)&&(this._trnMainService.disableRateOnGRNload=!0),this._trnMainService.addRowForAdditionalProdList()}},i=>{this._loadingService.hide(),this._alertService.error(i._body)},()=>{this._loadingService.hide()})}onGRNSelect(t){this._loadingService.show("Loading details, please wait..."),1==this.userSetting.EnableGRNInPIForCargo&&1==this.userSetting.ENABLE_GRN_IN_PI?this.onGrnSelectForCargo(t):this.onGRNSelectForNonCargo(t)}onGrnSelectForCargo(t){this.masterService.LoadTransactionForCargo(t.VCHRNO).subscribe(i=>{if("ok"==i.status){this._loadingService.hide();const r=g(67816);this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.guid=r(),this._trnMainService.TrnMainObj.REFORDBILL=i.result[0].VCHRNO,this._trnMainService.TrnMainObj.VoucherType=v.Km.Purchase,this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.TRNMODE=i.result.TRNMODE,this._trnMainService.TrnMainObj.CNDN_MODE=0,this._trnMainService.TrnMainObj.ProdList=i.result,this._trnMainService.TrnMainObj.AdditionalObj.tag="LOCAL_PURCHASE",console.log("Trn Main",this._trnMainService.TrnMainObj.ProdList,this._trnMainService.TrnMainObj.REFORDBILL,i.result[0].BOOKINGID,this._trnMainService.TrnMainObj.REFBILL,this._trnMainService.TrnMainObj.COSTCENTER,this._trnMainService.nullToZeroConverter(t.BILLDATE)),this._trnMainService.getVoucherNumber(),this._trnMainService.TrnMainObj.TRN_DATE=0!=this._trnMainService.nullToZeroConverter(t.BILLDATE)?t.BILLDATE:t.TRNDATE,this.getNepaliDate(),this._trnMainService.TrnMainObj.REFBILL=0!=this._trnMainService.nullToZeroConverter(t.BILLNO)?t.BILLNO:"",this.masterService.getAllCostCenter().subscribe(A=>{if(A){this.costlists=A;let K=this.costlists.filter(Y=>Y.COSTCENTERNAME==i.result[0].BOOKINGID);K&&(this._trnMainService.TrnMainObj.COSTCENTER=K[0].CCID)}},A=>{this.costlists=[]}),this._trnMainService.TrnMainObj.GROSSAMNT=this._trnMainService.TrnMainObj.VoucherType==v.Km.Purchase&&1==i.result.VATBILL?i.result.NONTAXABLE:i.result.TAXABLE,this._trnMainService.TrnMainObj.TOTALSQTY=0,this._trnMainService.TrnMainObj.ProdList.forEach(A=>{this._trnMainService.TrnMainObj.TOTALSQTY+=A.Quantity});for(let A in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[A].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[A].MFGDATE?"":0==this.userSetting.enableDayWiseMfgEXPDate?this._trnMainService.TrnMainObj.ProdList[A].MFGDATE.toString().substring(0,7):this._trnMainService.TrnMainObj.ProdList[A].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[A].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[A].EXPDATE?"":0==this.userSetting.enableDayWiseMfgEXPDate?this._trnMainService.TrnMainObj.ProdList[A].EXPDATE.toString().substring(0,7):this._trnMainService.TrnMainObj.ProdList[A].EXPDATE.toString().substring(0,10);this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.disableSupplierInfo=!0,this._trnMainService.disableCostCenterForCargo=!0;let a=this.masterService.userProfile.roleRights.find(A=>"ALLOWRATECHANGEINPI"==A.right);(0==this.userSetting.RATECHANGE_IN_POBASEPI||1==this.userSetting.RATECHANGE_IN_POBASEPI&&0==a.value)&&(this._trnMainService.disableRateOnGRNload=!0)}},i=>{this._loadingService.hide(),this._alertService.error(i)},()=>{this._loadingService.hide()})}onGRNSelectForNonCargo(t){this.masterService.LoadTransaction(t.GRNNUMBER,t.DIVISION,t.PhiscalID,"","","","","isFilterFiscalID").subscribe(i=>{if("ok"==i.status){this._loadingService.hide();const r=g(67816);this._trnMainService.TrnMainObj=i.result,this._trnMainService.TrnMainObj.Mode="NEW",this._trnMainService.TrnMainObj.guid=r(),this._trnMainService.TrnMainObj.REFORDBILL=t.GRNNUMBER,this._trnMainService.TrnMainObj.VoucherType=v.Km.Purchase,this._trnMainService.TrnMainObj.VoucherPrefix="PI",this._trnMainService.TrnMainObj.TRNMODE=i.result.TRNMODE,this._trnMainService.TrnMainObj.CNDN_MODE=0,this._trnMainService.TrnMainObj.AdditionalObj.tag="LOCAL_PURCHASE",this._trnMainService.TrnMainObj.INVOICETYPE="TRADING",this._trnMainService.TrnMainObj.TRN_DATE=null==i.result.TRN_DATE?"":i.result.TRN_DATE.toString().substring(0,10),this.masterService.getCurrentDate().subscribe(A=>{this._trnMainService.TrnMainObj.TRNDATE=A.Date.substring(0,10),this._trnMainService.TrnMainObj.BSDATE=this._trnMainService.getBsDate(this._trnMainService.TrnMainObj.TRNDATE)}),this._trnMainService.getVoucherNumber(),this._trnMainService.TrnMainObj.GROSSAMNT=this._trnMainService.TrnMainObj.VoucherType==v.Km.Purchase&&1==i.result.VATBILL?i.result.NONTAXABLE:i.result.TAXABLE,this._trnMainService.TrnMainObj.TOTALSQTY=0,this._trnMainService.TrnMainObj.ProdList.forEach(A=>{this._trnMainService.TrnMainObj.TOTALSQTY+=A.Quantity});for(let A in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.TrnMainObj.ProdList[A].MFGDATE=null==this._trnMainService.TrnMainObj.ProdList[A].MFGDATE?"":0==this.userSetting.enableDayWiseMfgEXPDate?this._trnMainService.TrnMainObj.ProdList[A].MFGDATE.toString().substring(0,7):this._trnMainService.TrnMainObj.ProdList[A].MFGDATE.toString().substring(0,10),this._trnMainService.TrnMainObj.ProdList[A].EXPDATE=null==this._trnMainService.TrnMainObj.ProdList[A].EXPDATE?"":0==this.userSetting.enableDayWiseMfgEXPDate?this._trnMainService.TrnMainObj.ProdList[A].EXPDATE.toString().substring(0,7):this._trnMainService.TrnMainObj.ProdList[A].EXPDATE.toString().substring(0,10);this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.disableOnGRNload=!0,this._trnMainService.disableSupplierInfo=!0;let a=this.masterService.userProfile.roleRights.find(A=>"ALLOWRATECHANGEINPI"==A.right);(0==this.userSetting.RATECHANGE_IN_POBASEPI||1==this.userSetting.RATECHANGE_IN_POBASEPI&&0==a.value)&&(this._trnMainService.disableRateOnGRNload=!0),this._trnMainService.addRowForAdditionalProdList(),this._trnMainService.disableAllFieldinPurchase=!0}},i=>{this._loadingService.hide(),this._alertService.error(i._body)},()=>{this._loadingService.hide()})}OKLoadPurchaseOrder(t){for(let i in t)this._trnMainService.TrnMainObj.ProdList[i].MENUCODE=this._trnMainService.TrnMainObj.PODetailList[i].MENUCODE,this._trnMainService.TrnMainObj.ProdList[i].MCODE=this._trnMainService.TrnMainObj.PODetailList[i].MCODE,this._trnMainService.TrnMainObj.ProdList[i].ITEMDESC=this._trnMainService.TrnMainObj.PODetailList[i].DESCA,this._trnMainService.TrnMainObj.ProdList[i].ALTUNIT=this._trnMainService.TrnMainObj.PODetailList[i].UNIT,this._trnMainService.TrnMainObj.ProdList[i].BASEUNIT=this._trnMainService.TrnMainObj.PODetailList[i].UNIT,this._trnMainService.TrnMainObj.ProdList[i].ALTERNATEQUANTIY=this._trnMainService.TrnMainObj.PODetailList[i].DELIVERQTY,this._trnMainService.TrnMainObj.ProdList[i].ALTRATE=this._trnMainService.TrnMainObj.PODetailList[i].DELIVERRATE,this._trnMainService.TrnMainObj.ProdList[i].RATE=this._trnMainService.TrnMainObj.PODetailList[i].DELIVERRATE,this._trnMainService.TrnMainObj.ProdList[i].AMOUNT=this._trnMainService.TrnMainObj.PODetailList[i].AMOUNT,this._trnMainService.TrnMainObj.ProdList[i].NETAMOUNT=this._trnMainService.TrnMainObj.PODetailList[i].AMOUNT,this._trnMainService.TrnMainObj.ProdList[i].NETAMNT=this._trnMainService.TrnMainObj.PODetailList[i].AMOUNT,this._trnMainService.TrnMainObj.ProdList[i].MFGDATE=this._trnMainService.TrnMainObj.PODetailList[i].MFGDATE,this._trnMainService.TrnMainObj.ProdList[i].EXPDATE=this._trnMainService.TrnMainObj.PODetailList[i].EXPIRYDATE,this._trnMainService.TrnMainObj.ProdList[i].INDDISCOUNTRATE=this._trnMainService.TrnMainObj.PODetailList[i].DISCOUNT_RATE,this._trnMainService.TrnMainObj.ProdList[i].INDDISCOUNT=this._trnMainService.TrnMainObj.PODetailList[i].DISCOUNT_AMOUNT,this._trnMainService.TrnMainObj.ProdList[i].CRATE=this._trnMainService.TrnMainObj.PODetailList[i].NET_RATE,this._trnMainService.TrnMainObj.ProdList[i].SELLRATEBEFORETAX=this._trnMainService.TrnMainObj.PODetailList[i].SELLRATEBEFORETAX,this._trnMainService.TrnMainObj.ProdList[i].W_SELLRATEBEFORETAX=this._trnMainService.TrnMainObj.PODetailList[i].W_SELLRATEBEFORETAX,this._trnMainService.TrnMainObj.ProdList[i].isPurchaseOrderItem=!0,this._trnMainService.getAllUnitsOfItem(i),this._trnMainService.calculateNetRATE(i),this._trnMainService.addRow();this._trnMainService.ReCalculateBillWithNormal(),this._trnMainService.TrnMainObj.ProdList.splice(-1),this.LoadPurchaseOrder.hide()}showPopup(){this._trnMainService.TrnMainObj.AdditionalObj.PONO&&this.LoadPurchaseOrder.show()}onCurrenyChange(t){let i=this.masterService.Currencies.filter(r=>r.CURNAME==t)[0];console.log("SELECTEDCURRENCY",i),this._trnMainService.TrnMainObj.EXRATE=i.EXRATE}onImportAdvanceEnterClicked(){null==this.paymentTermAcid||void 0===this.paymentTermAcid||""===this.paymentTermAcid?(this.getSupplierList(),this.genericGridSupplier.show()):(this.gridPopupSettingsForimportAdvanceAc={title:"Import Advance A/C",apiEndpoints:`/getImportAdvanceAcPagedList/${this.paymentTermAcid}`,defaultFilterIndex:0,columns:[{key:"ACNAME",title:"A/C Name",hidden:!1,noSearch:!1},{key:"ACID",title:"ACID",hidden:!0,noSearch:!0}]},this.importAdvanceAcGrid.show())}onImportAdvanceItemClick(t){console.log("r1",this._trnMainService.TrnMainObj.TRNACName),this._trnMainService.TrnMainObj.TRNAC=t.ACID,this._trnMainService.TrnMainObj.TRNACName=t.ACNAME,console.log("acname",this._trnMainService.TrnMainObj.TRNACName),this.masterService.focusAnyControl(""==this._trnMainService.TrnMainObj.REFORDBILL?"remarksid":"currency")}updown(t){"Insert"===t.code&&("NEW"==this._trnMainService.TrnMainObj.Mode||"EDIT"==this._trnMainService.TrnMainObj.Mode)&&(t.preventDefault(),this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder&&0==this.userSetting?.EnableCusProfileInSOrder||(1==this.showPartyMasterPopup&&this.openQuickPartyMasterPopup(),1==this.showInSupplierPopup&&this.openQuickPartyInSupplier(),1==this.showCustomerProfilePopup&&this.openQuickCusProfilePopup())),"Escape"==t.code&&(t.preventDefault(),1==this._trnMainService.showNegativeBillingAuthForMain&&this.closeModal())}getCustomersList(t="0"){this.gridPopupSettingsForCustomer={title:"Customers",apiEndpoints:`/getAccountPagedListByPType/PA/C/${t}`,defaultFilterIndex:this.userSetting.FilterIndexForCustomer,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"ACCODE",title:"CODE",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"EMAIL",title:"EMAIL",hidden:!1,noSearch:!1}]},this.genericGridCustomer.show()}GetShippingAddress(t){this.masterService.getAllShippingList(t).subscribe(i=>{i&&(this._trnMainService.shippingAddress=i.result,this._trnMainService.TrnMainObj.ShippingLocation=this._trnMainService.shippingAddress.find(r=>1==r.ISDEFAULT)?.NAME)},i=>{this._trnMainService.shippingAddress=[]})}GetShippingLocation(t){this.masterService.getShippingLocationList(t).subscribe(i=>{i&&(this._trnMainService.shippingAddress=i.result)},i=>{this._trnMainService.shippingAddress=[]})}shippinglocationVoucher(t){console.log("event",t),this._trnMainService.TrnMainObj.ShippingLocation=t.target.value}onCustomerSelected(t){if(1==this.userSetting.EnableContractPrice&&(this._trnMainService.TrnMainObj.VoucherType==v.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==v.Km.PerformaSalesInvoice||this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder)&&this._trnMainService.TrnMainObj.PARAC&&this._trnMainService.TrnMainObj.ProdList.find(i=>i.MCODE)&&t.ACID!=this._trnMainService.TrnMainObj.PARAC&&t.CUSTID!=this._trnMainService.TrnMainObj.PARAC){if(!confirm("Are you sure you want to change customer? This will empty product selection grid."))return;this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow()}if(this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder&&1===this._trnMainService.userSetting.EnableShippingAddress&&this.GetShippingLocation(t.CUSTID),this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder&&!this._trnMainService.TrnMainObj.TRNMODE&&0==this._trnMainService.userSetting.EnableCusProfileInSOrder&&(this._trnMainService.TrnMainObj.TRNAC=t.ACID,this._trnMainService.TrnMainObj.TRNMODE="credit"),this._trnMainService.TrnMainObj.MEMBERNO=t.CUSTID,this._trnMainService.TrnMainObj.RECEIVEBY=t.CUSTID,this._trnMainService.TrnMainObj.PARAC=t.ACID,this._trnMainService.TrnMainObj.MEMBERNAME=t.CUSTNAME,this._trnMainService.TrnMainObj.SCHEMENAME=t.SCHEMEID,this._trnMainService.TrnMainObj.SALESMAN=t.SALESMAN,this._trnMainService.TrnMainObj.SALESMANID=t.SALESMANID,this._trnMainService.TrnMainObj.CREDITLIMIT=t.CRLIMIT,"B2C"==this.userSetting.CompanyType&&14==this._trnMainService.TrnMainObj.VoucherType&&"cash"==this._trnMainService.TrnMainObj.TRNMODE)return this._trnMainService.TrnMainObj.BILLTO=t.CUSTNAME,this._trnMainService.TrnMainObj.BILLTOADD=t.ADDRESS,this._trnMainService.TrnMainObj.BILLTOMOB=t.MOBILENO,this._trnMainService.TrnMainObj.BILLTOTEL=t.VATNO,this._trnMainService.vatFreeBill(),null!=this._trnMainService.TrnMainObj.ProdList[0].MENUCODE&&this._trnMainService.ReCalculateBillWithNormal(),void document.getElementById("remarksid").focus();this._trnMainService.TrnMainObj.PRICEMODE=t.PRICEMODE?t.PRICEMODE:1,this._trnMainService.TrnMainObj.BILLTO=t.ACNAME,this._trnMainService.TrnMainObj.BILLTOTEL=t.VATNO,this._trnMainService.TrnMainObj.BILLTOADD=t.ADDRESS,this._trnMainService.TrnMainObj.AdditionalObj.TRNTYPE=null==t.PSTYPE?null:t.PSTYPE.toLowerCase(),this._trnMainService.TrnMainObj.PARTY_ORG_TYPE=t.ORG_TYPE,this._trnMainService.TrnMainObj.CREDITDAYS=t.CRPERIOD,this._trnMainService.TrnMainObj.CUS_FIX_DISCOUNT_PER=t.CUS_FIX_DISCOUNT_PER,this._trnMainService.TrnMainObj.CUS_Remote_Discount=t.CUS_Remote_Discount,this._trnMainService.TrnMainObj.CUS_Remote_Discount=t.CUS_Remote_Discount,this._trnMainService.getCustomerwiseCreditLimit(this._trnMainService.TrnMainObj.PARAC,this._trnMainService.TrnMainObj.TRN_DATE),this._trnMainService.vatFreeBill(),null!=this._trnMainService.TrnMainObj.ProdList[0].MENUCODE&&this._trnMainService.ReCalculateBillWithNormal(),document.getElementById("remarksid").focus()}salesManEnterCommand(){this.getSalesManList(),this.genericGridSalesMan.show()}getSalesManList(){this.gridPopupSettingsForSalesMan=this.masterService.getGenericGridPopUpSettings("SalesManList")}onSalesManSelect(t){this._trnMainService.TrnMainObj.SALESMANID=t.SALESMANID,this._trnMainService.TrnMainObj.SALESMAN=t.NAME,console.log("trnmain on sales man slect",this._trnMainService.TrnMainObj.SALESMANID,this._trnMainService.TrnMainObj.SALESMAN),this._trnMainService.TrnMainObj.VoucherType==v.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==v.Km.CreditNote?this.masterService.focusAnyControl("barcode0"):this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder&&this.masterService.focusAnyControl("itemDesc0")}salesmanDelete(){null!=this._trnMainService.TrnMainObj.SALESMAN&&(this._trnMainService.TrnMainObj.SALESMAN=null,this._trnMainService.TrnMainObj.SALESMANID=null)}focusToExcRate(t){t.preventDefault(),this.masterService.focusAnyControl("exchangerateid")}closeModal(){this._trnMainService.showNegativeBillingAuthForMain=!1,this._trnMainService.TrnMainObj.VoucherType==v.Km.DebitNote&&(this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(t=>t.Quantity<=t.STOCK))}NegativeBillAuthConfirm(){this._loadingService.show("Authorizing Please wait"),this.masterService.NegativeBillingAuth(this.NegativeBillAuthObj).subscribe(t=>{this.NegativeBillAuthObj={username:"",password:"",remarks:""},console.log("Negative stock responee",t),this._loadingService.hide(),"ok"==t.status?"ALLOW"==t.result?(this._alertService.success("User Right Granted !"),this._trnMainService.showNegativeBillingAuthForMain=!1):(this._alertService.warning("this user has no rights to do negative stock billing !"),this._trnMainService.showNegativeBillingAuthForMain=!1,this._trnMainService.TrnMainObj.VoucherType==v.Km.DebitNote&&(this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(i=>i.Quantity<=i.STOCK))):(this._alertService.warning("Authorization Failed"),this._trnMainService.showNegativeBillingAuthForMain=!1,this._trnMainService.TrnMainObj.VoucherType==v.Km.DebitNote&&(this._trnMainService.TrnMainObj.ProdList=this._trnMainService.TrnMainObj.ProdList.filter(i=>i.Quantity<=i.STOCK)))},t=>{this._loadingService.hide(),this._alertService.error(t)})}DoFullReturn(t){if(null!=this._trnMainService.TrnMainObj.REFBILL&&""!=this._trnMainService.TrnMainObj.REFBILL&&null!=this._trnMainService.TrnMainObj.REFBILL){if(this.checkDNFullReturn())return this._alertService.warning("Cannot change full return status on Edit. This Debit Note Can only be reversed"),void(t.target.checked=!t.target.checked);if(this._trnMainService.TrnMainObj.DOFULLRETURN=1==t.target.checked?1:0,this._trnMainService.DOFULLRETURN=this._trnMainService.TrnMainObj.DOFULLRETURN,this._trnMainService.TrnMainObj.ProdList?.length>0){if(!confirm("Below data will be refresh. Do you want to continue?"))return;this.ConfirmChangeReturnMode()}else this.ConfirmChangeReturnMode()}}checkDNFullReturn(){return"EDIT"==this._trnMainService.TrnMainObj.Mode&&"add-debitnote-itembase"==this._trnMainService.activeurlpath&&this._trnMainService.TrnMainObj.VoucherType===v.Km.DebitNote}ConfirmChangeReturnMode(){0==this._trnMainService.DOFULLRETURN?(this._trnMainService.TrnMainObj.ProdList=[],this._trnMainService.addRow(),this._trnMainService.DOFULLRETURN=1):""!=this.ReffBillObj&&this.onRefBillSelected(this.ReffBillObj)}onChangeOnMixedPurchaseType(t){1==this.userSetting.EnableNonTradingModule&&(this._trnMainService.TrnMainObj.VoucherType==v.Km.Purchase||this._trnMainService.TrnMainObj.VoucherType==v.Km.DebitNote)&&"asset-purchase-invoice"!==this.activeurlpath&&("NONTRADING"==this._trnMainService.TrnMainObj.INVOICETYPE?this._trnMainService.TrnMainObj.ProdList=[]:0==this._trnMainService.TrnMainObj.ProdList.length&&this._trnMainService.addRow(),"TRADING"==this._trnMainService.TrnMainObj.INVOICETYPE?this._trnMainService.TrnMainObj.AdditionProdList=[]:0==this._trnMainService.TrnMainObj.AdditionProdList.length&&this._trnMainService.addRowForAdditionalProdList())}disableCostCentreforRefPIWiseLoad(){if(1==this.userSetting.REFBILLCOMPULSORINDNOTE&&"add-debitnote-itembase"==this.activeurlpath)return!0}showPurchaseType(){if("add-purchase-invoice"==this.activeurlpath||this._trnMainService.TrnMainObj.VoucherType==v.Km.DebitNote||this._trnMainService.TrnMainObj.VoucherType==v.Km.ReverseDebitNote)return"add-purchase-invoice"!=this.activeurlpath||0===this.userSetting.ENABLE_GRN_IN_PI&&0===this.userSetting.PODELIVERYMODE||null===this._trnMainService.TrnMainObj.REFORDBILL||""===this._trnMainService.TrnMainObj.REFORDBILL||void 0===this._trnMainService.TrnMainObj.REFORDBILL||1===this.userSetting.ENABLE_GRN_IN_PI&&null!==this._trnMainService.TrnMainObj.REFORDBILL}onAddNewSupplier(){this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder&&1==this.userSetting.EnableCusProfileInSOrder?this.openQuickCusProfilePopup():this.CreateQuickParty.show()}onAddNewShippingLocation(){if(!this._trnMainService.TrnMainObj.BILLTO)return void this._alertService.info("Customer is not selected");const t=this._trnMainService.TrnMainObj.ShippingLocation?this._trnMainService.shippingAddress.find(r=>r.SHIPPING_ID===this._trnMainService.TrnMainObj.ShippingLocation):null;this.dialog.open(Me,{data:{CUSTID:this._trnMainService.TrnMainObj.MEMBERNO,shippingLocation:t,mode:this._trnMainService.TrnMainObj.Mode}}).afterClosed().subscribe(r=>{r&&(this.GetShippingLocation(this._trnMainService.TrnMainObj.MEMBERNO),this._trnMainService.TrnMainObj.ShippingLocation=r)})}showAddButton(){return!!((this._trnMainService.TrnMainObj.VoucherType==v.Km.Purchase&&0==this.userSetting.ENABLE_GRN_IN_PI&&0==this.userSetting.PODELIVERYMODE||"goods-received-note"===this.activeurlpath)&&1==this._trnMainService.userProfile.ISMAIN&&"view"!=this._trnMainService.TrnMainObj.Mode?.toLowerCase()&&this.onPurchaseOrderSelect&&!this._trnMainService.disableCustomerInputField||this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder&&1==this.userSetting.EnableCusProfileInSOrder&&"view"!=this._trnMainService.TrnMainObj.Mode?.toLowerCase())}hideSalesman(){return 0!=this.userSetting.enablesalesman}applyFlatDiscount(t){this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT=this._trnMainService.TrnMainObj.FLATDCAMNT?this._trnMainService.TrnMainObj.FLATDCAMNT:0,this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.FLATDCAMNT)>0||this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.DCRATE)>0&&this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.DCRATE)<100?this._trnMainService.showFlatDiscOption=!0:this._trnMainService.beforeDiscFlat()}validateFlatDiscount(t){let i;return i=t instanceof Event?this._trnMainService.nullToZeroConverter(t.target.value):this._trnMainService.nullToZeroConverter(t),i>100?(this._trnMainService.TrnMainObj.DCRATE=0,void this._alertService.info("Flat discount rate cannot be greater than 100%")):i<0?(this._alertService.info("Flat discount rate cannot be less than 0%"),void(this._trnMainService.TrnMainObj.DCRATE=0)):void(0==this._trnMainService.nullToZeroConverter(i)&&this._trnMainService.discountsOnFlatZero())}validateFlatDiscountAmount(t){let i;i=t instanceof Event?this._trnMainService.nullToZeroConverter(t.target.value):this._trnMainService.nullToZeroConverter(t);let r=this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.NETAMNT/1.13);return i>=r?(this._alertService.info(`Flat discount amount cannot be greater than or equal to total amount: ${r}`),void(this._trnMainService.TrnMainObj.FLATDCAMNT=0)):i<0?(this._alertService.info("Flat discount amount cannot be less than 0"),void(this._trnMainService.TrnMainObj.FLATDCAMNT=0)):void(0==this._trnMainService.nullToZeroConverter(i)&&this._trnMainService.discountsOnFlatZero())}showDiscountAddButton(){if(this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder&&1==this.userSetting.enableAdditionalFlatDiscountsInSales)return!0}onClickAddDiscounts(){if(this.totalIndividualDiscount=this._trnMainService.TrnMainObj.ProdList.reduce((t,i)=>t+(i.INDDISCOUNT??0),0),this.previousTotalIndividualDiscount=this.masterService.getPreviousTotalIndividualDiscount()?this.masterService.getPreviousTotalIndividualDiscount():0,this._trnMainService.TrnMainObj.GROSSAMNT)return"VIEW"==this._trnMainService.TrnMainObj.Mode?(this.onAddNewDiscounts(),!0):"EDIT"==this._trnMainService.TrnMainObj.Mode&&this._trnMainService.TrnMainObj.VoucherType==v.Km.SalesOrder?(this._trnMainService.discountSelectionEdit=!0,this.savedDiscountObj=this._trnMainService.TrnMainObj.DiscountObj,this.onAddNewDiscounts(),!0):this.totalIndividualDiscount?"overwrite"===this.flatDiscountType&&0==this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.discountObj?.totalDiscountAmount)?(this._trnMainService.onFlatDiscountClear(),this.savedDiscountObj=this._trnMainService.TrnMainObj.DiscountObj,this.onAddNewDiscounts(),!0):this.savedDiscountObj?.discountRowDetail?.find(t=>t.discountAmount)&&this.previousTotalIndividualDiscount==this.totalIndividualDiscount?(this.onAddNewDiscounts(),!0):(this.masterService.setPreviousTotalIndividualDiscount(this.totalIndividualDiscount),void(this.showAdditionalFlatDiscountPopUp=!0)):(this.flatDiscountType="after",this.onAddNewDiscounts(),!0);this._alertService.info("Please Select Product to apply additional discount!!!")}onAddNewDiscounts(){this.showAdditionalFlatDiscountPopUp=!1,!this.flatDiscountType&&"EDIT"==this._trnMainService.TrnMainObj.Mode&&(this.flatDiscountType=this._trnMainService.TrnMainObj.AdditionalObj.BEFOREFLATDISCRATE?"before":"after"),this._trnMainService.TrnMainObj.DiscountObj?.discountRowDetail.some(i=>i.discountAmount>0&&null!=i.discountAmount)||(this.savedDiscountObj={}),0===this._trnMainService.TrnMainObj.FLATDCAMNT&&(this.savedDiscountObj={}),this.dialog.open(pe.C,{data:{object:this._trnMainService.TrnMainObj,grossAmount:this._trnMainService.TrnMainObj.GROSSAMNT,discountAmount:this._trnMainService.TrnMainObj.FLATDCAMNT,discountRate:this._trnMainService.TrnMainObj.DCRATE,ecsAmount:this._trnMainService.TrnMainObj.TOTALECS,listDiscounts:this.savedDiscountObj?.discountRowDetail?.find(i=>i.discountAmount>0||null!=i.discountAmount)?this.savedDiscountObj:this._trnMainService.TrnMainObj.DiscountObj,totalIndDiscount:this.totalIndividualDiscount,flatDisCalcType:this.flatDiscountType,formMode:this._trnMainService.TrnMainObj.Mode,urlPath:this.activeurlpath}}).afterClosed().subscribe(i=>{null===i?this._trnMainService.TrnMainObj.DiscountObj=null:(this._trnMainService.TrnMainObj.DiscountObj=i,this._trnMainService.TrnMainObj.FLATDCAMNT=i.totalDiscountAmount?i.totalDiscountAmount:0,this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT=i.totalDiscountAmount?i.totalDiscountAmount:0,"after"===this.flatDiscountType?this._trnMainService.afterDiscFlat():"before"===this.flatDiscountType?this._trnMainService.beforeDiscFlat():"overwrite"===this.flatDiscountType&&this._trnMainService.onApplyClicked(),this.savedDiscountObj="overwrite"!=this.flatDiscountType?i:this._trnMainService.TrnMainObj.DiscountObj),0==this._trnMainService.nullToZeroConverter(i?.totalDiscountAmount)&&(this._trnMainService.onFlatDiscountClear(),this._trnMainService.clearDisAuthValues(),this._trnMainService.callPipe=!this._trnMainService.callPipe),this._trnMainService.callPipe=!this._trnMainService.callPipe})}closeAdditionalFlatDiscOption(){this.showAdditionalFlatDiscountPopUp=!1,this._trnMainService.showFlatDiscOption=!1,this._trnMainService.onFlatDiscountClear()}showBeforeOverwrite(){return this.totalIndividualDiscount=this._trnMainService.TrnMainObj.ProdList.reduce((t,i)=>t+(i.INDDISCOUNT??0),0),this.totalIndividualDiscount>0}closeDisAuthPopup(){this._trnMainService.onFlatDiscountClear(),this._trnMainService.clearDisAuthValues(),this._trnMainService.showDiscountAuth=!1}discountAuthConfirm(){this._trnMainService.disLimitAuthObj.isAuthDisLim=!0,this._loadingService.show("Authorizing Please wait");let t=this._trnMainService.TrnMainObj.ProdList.reduce((i,r)=>i+(r.INDDISCOUNT??0),0);this.masterService.authorizeDiscountLimitInSO(this._trnMainService.disLimitAuthObj).subscribe(i=>{if(this._loadingService.hide(),"ok"==i.status){let r=0!=this._trnMainService.nullToZeroConverter(i.result.userDisLimit)?i.result.userDisLimit:i.result.roleDisLimit;this._trnMainService.nullToZeroConverter(this._trnMainService.disLimitAuthObj.discountAmt)>0&&(this._trnMainService.limitValue=100*(t+Number(this._trnMainService.disLimitAuthObj.discountAmt))/this._trnMainService.TrnMainObj.GROSSAMNT),this._trnMainService.nullToZeroConverter(this._trnMainService.disLimitAuthObj.discountRate)>0&&(this._trnMainService.limitValue=100*(t+this._trnMainService.disLimitAuthObj.discountRate*this._trnMainService.TrnMainObj.GROSSAMNT/100)/this._trnMainService.TrnMainObj.GROSSAMNT),this._trnMainService.limitValue>r?(this._alertService.error("Specified discount value exceeded authorized discount limit!!!"),this._trnMainService.clearDisAuthValues(),this._trnMainService.onFlatDiscountClear(),this.savedDiscountObj=this._trnMainService.TrnMainObj.DiscountObj):(this._alertService.success("Authorization Sucessfull"),this._trnMainService.TrnMainObj.FLATDCAMNT=this._trnMainService.disLimitAuthObj.discountAmt,this._trnMainService.TrnMainObj.DCRATE=this._trnMainService.disLimitAuthObj.discountRate,this._trnMainService.resetDisLimitAuthObj()),this._trnMainService.showDiscountAuth=!1}else this._trnMainService.clearDisAuthValues(),this._trnMainService.onFlatDiscountClear()})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ae.P),e.Y36(he.p),e.Y36(T.e),e.Y36(b.uw),e.Y36(f.c),e.Y36(oe.V),e.Y36(_e.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["trnmain-purchase-entry"]],viewQuery:function(t,i){if(1&t&&(e.Gf(te,5),e.Gf(le,5),e.Gf(ge,5),e.Gf(me,5),e.Gf(Se,5),e.Gf(Oe,5),e.Gf(be,5),e.Gf(fe,5),e.Gf(Ce,5),e.Gf(Ae,5),e.Gf(Ee,5),e.Gf(De,5),e.Gf(xe,5),e.Gf(Ne,5),e.Gf(Pe,5),e.Gf(Re,5),e.Gf(je,5),e.Gf(Ie,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.genericGridSupplier=r.first),e.iGM(r=e.CRH())&&(i.genericGridShipName=r.first),e.iGM(r=e.CRH())&&(i.genericGridRefBill=r.first),e.iGM(r=e.CRH())&&(i.genericGridWarehouse=r.first),e.iGM(r=e.CRH())&&(i.fileUploadPopup=r.first),e.iGM(r=e.CRH())&&(i.genericGridAccount=r.first),e.iGM(r=e.CRH())&&(i.genericGridImportPurchaseOrder=r.first),e.iGM(r=e.CRH())&&(i.CreateQuickParty=r.first),e.iGM(r=e.CRH())&&(i.LoadPurchaseOrder=r.first),e.iGM(r=e.CRH())&&(i.importAdvanceAcGrid=r.first),e.iGM(r=e.CRH())&&(i.genericGridCustomer=r.first),e.iGM(r=e.CRH())&&(i.focusInputFormat=r.first),e.iGM(r=e.CRH())&&(i.genericGridGRN=r.first),e.iGM(r=e.CRH())&&(i.genericGridImportGRN=r.first),e.iGM(r=e.CRH())&&(i.genericGridSalesMan=r.first),e.iGM(r=e.CRH())&&(i.CreateCustomerProfile=r.first),e.iGM(r=e.CRH())&&(i.CreateShippingLocation=r.first),e.iGM(r=e.CRH())&&(i.genericGridPurchaseOrder=r)}},hostBindings:function(t,i){1&t&&e.NdJ("keydown",function(a){return i.updown(a)},!1,e.evT)},inputs:{viewDisable:"viewDisable"},decls:1,vars:1,consts:[["class","pd0 mr5 plainBackGround",4,"ngIf"],[1,"pd0","mr5","plainBackGround"],[1,"row","col-md-12",2,"padding","15px"],[1,"col-md-4","col-sm-6",2,"max-height","160px","overflow-y","scroll"],[1,"row"],[2,"width","25%"],[2,"float","right","width","73%","margin-top","0px","font-weight","bold"],["class","row",4,"ngIf"],[2,"float","right","width","73%"],["id","invoiceNO","type","text","autocomplete","off",2,"width","86%",3,"ngModel","disabled","readonly","placeholder","ngModelChange","keydown.enter"],["style","width: 25%;",4,"ngIf"],[4,"ngIf"],[1,"col-md-4","col-sm-6",2,"max-height","160px","overflow","hidden","overflow-y","auto"],["style","width: 50%",4,"ngIf"],[1,"col-md-4","col-sm-6",2,"max-height","160px","overflow-y","auto"],[1,"row","cell-with-comment"],["id","customerselectid","type","text","autocomplete","off",2,"width","69%",3,"disabled","ngModel","placeholder","change","ngModelChange","keydown.enter","keydown.tab","keyup"],["style","margin-left: 2px;","class","add",3,"click",4,"ngIf"],["type","text","readonly","",2,"width","70%",3,"ngModel","disabled","ngModelChange"],["id","vatId","type","text","readonly","",2,"width","70%",3,"ngModel","disabled","ngModelChange"],["id","remarksid","type","text",2,"width","70%","height","24px","min-height","24px","max-height","55px",3,"ngModel","disabled","ngModelChange"],[3,"popupsettings","onItemDoubleClick"],["genericGridSupplier",""],["genericGridShipName",""],["genericGridRefBill",""],["genericGridWarehouse",""],["genericGridAccount",""],["genericGridPurchaseOrder",""],[3,"popupsettings","onImportChalanClick"],["genericGridImportPurchaseOrder",""],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],["genericGridGRN",""],["genericGridImportGRN",""],["genericGridCustomer",""],[3,"onLoadPO"],["LoadPurchaseOrder",""],["importAdvanceAcGrid",""],[3,"onSaveParty"],["CreateQuickParty",""],["genericGridSalesMan",""],[3,"onSave"],["CreateCustomerProfile",""],["class","backdrop",4,"ngIf"],["name","prefix","id","prefix",2,"width","35%",3,"ngModel","disabled","ngModelChange"],["value","",4,"ngIf"],["type","text",2,"width","51%",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["value",""],[2,"float","right","width","34%"],["id","entryDateAD","type","date",2,"width","100%",3,"ngModel","disabled","max","ngModelChange","change"],[2,"float","right","width","26%"],["name","InvnepaliDateFrom",3,"id","label","disable","ngModel","change","ngModelChange"],[2,"float","right","width","39%"],["id","poNoId","type","text","autocomplete","off","placeholder","Enter to Select PO no.","readonly","",3,"ngStyle","ngModel","disabled","ngModelChange","keydown.enter","keydown.delete"],["type","checkbox",2,"width","17px","height","19px","margin-top","-8px",3,"ngModel","disabled","change","ngModelChange"],[2,"width","auto","font-size","12px"],[2,"width","25%","font-size","11px","margin-top","0px"],["type","checkbox",2,"width","17px","height","19px","margin-top","2px","margin-right","9px",3,"ngModel","change","ngModelChange"],["id","suppBillNo","type","text","autocomplete","off",2,"width","86%",3,"ngModel","disabled","placeholder","ngModelChange","keydown.enter"],["type","date",2,"width","100%",3,"ngModel","disabled","max","ngModelChange","change"],["id","purchasetype",2,"width","62.5%",3,"ngModel","disabled","ngModelChange","change"],["value","TRADING"],["value","NONTRADING",4,"ngIf"],["value","MIXED"],["value","NONTRADING"],["type","checkbox",2,"width","25px","height","19px","margin-top","4px","margin-right","9px",3,"ngModel","disabled","change","click","ngModelChange"],[2,"width","31%"],["id","refbill","type","text",2,"width","70%",3,"disabled","ngModel","ngModelChange","keydown.enter","keydown.tab"],[2,"width","70%",3,"ngModel","disabled","ngModelChange"],["value","credit"],["value","cash"],["type","checkbox",2,"width","17px","height","19px","margin-top","-8px",3,"ngModel","disabled","change","ngModelChange","keydown.delete"],["id","ImportPOno","type","text","placeholder","Enter to select Import PO No.","autocomplete","off","readonly","",3,"ngStyle","ngModel","disabled","ngModelChange","keydown.enter","keydown.delete"],["id","GRNNoId","type","text","autocomplete","off","placeholder","Press Enter to load Import GRN Bill","readonly","",3,"ngStyle","ngModel","disabled","ngModelChange","keydown.enter"],["id","GRNNoId","type","text","autocomplete","off","placeholder","Press Enter to load GRN Bill","readonly","",3,"ngStyle","ngModel","disabled","ngModelChange","keydown.enter"],["id","paymentTerms",2,"width","70%",3,"ngModel","disabled","ngModelChange","change"],["value","credit",4,"ngIf"],["value","cash",4,"ngIf"],["value","cheque",4,"ngIf"],["value","cheque"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],["type","text","id","accountfield","autocomplete","off","placeholder","Press Enter to select Account",2,"width","70%",3,"disabled","ngModel","ngModelChange","keydown.enter","keydown.tab","keydown"],["type","text","autocomplete","off","placeholder","Press Enter to Select Account",2,"width","70%",3,"disabled","ngModel","ngModelChange","keydown.Enter","keydown.tab","keydown"],["type","text",2,"width","52%",3,"ngModel","disabled","ngModelChange"],["type","date",2,"width","44%",3,"ngModel","disabled","ngModelChange","change"],["id","warehouseId","type","text","style","width:70%;","autocomplete","off","readonly","",3,"disabled","ngModel","ngModelChange","keydown.enter",4,"ngIf"],["id","warehouseId","type","text","style","width:70%;","autocomplete","off",3,"disabled","ngModel","ngModelChange","keydown.enter",4,"ngIf"],["id","warehouseId","type","text","autocomplete","off","readonly","",2,"width","70%",3,"disabled","ngModel","ngModelChange","keydown.enter"],["id","warehouseId","type","text","autocomplete","off",2,"width","70%",3,"disabled","ngModel","ngModelChange","keydown.enter"],["id","locationID",2,"width","70%",3,"disabled","ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[2,"width","50%"],["id","currency",2,"width","47%",3,"ngModel","disabled","ngModelChange","change","keydown.Tab","keydown.Enter"],[2,"width","40%"],["id","exchangerateid","type","number",2,"width","50%",3,"ngModel","disabled","ngModelChange","change","keydown.enter"],["class","row p-0",4,"ngIf"],["style","width: 42%",4,"ngIf"],["id","CCenter",2,"width","69%",3,"ngModel","disabled","ngModelChange"],[1,"row","p-0"],[1,"col-12","px-0"],[1,"col-3","px-0"],[1,"col-6",2,"padding-left","2px","padding-right","0px"],["type","date",2,"width","78%",3,"ngModel","disabled","min","ngModelChange","change","focusout"],[1,"col-3","px-0",2,"margin-left","-3vw"],["name","DeliveryDate",3,"id","label","ngModel","max","disable","change","ngModelChange","focusout"],[1,"col-11","px-0"],[1,"col-3","p-0"],[1,"col-6",2,"padding-left","11px"],["type","time",2,"width","97%",3,"disabled","ngModel","ngModelChange"],[2,"float","right","width","41%"],["type","date",2,"width","100%",3,"ngModel","disabled","min","ngModelChange","change","focusout"],["name","DeliveryDate",3,"id","label","disable","ngModel","max","change","ngModelChange","focusout"],["id","salesmanselect","type","text","autocomplete","off","placeholder","Press Enter to select salesman","autocomplete","off","readonly","",2,"width","70%",3,"ngModel","ngModelChange","keydown.enter","keydown.delete"],[2,"border-color","#c0c0c0"],[1,"legend-class",2,"font-size","13px","width","110px"],[1,"col-md-12"],[2,"margin-top","-18px","margin-left","-14px","width","27%"],["type","number",2,"width","75%","margin-top","-25px",3,"ngModel","disabled","ngModelChange"],[1,"col-md-12",2,"margin-top","8px"],[2,"width","75%","margin-top","-25px",3,"ngModel","disabled","ngModelChange","change"],[2,"width","27%","margin-top","-18px","margin-left","-14px"],["id","accountField","type","text","autocomplete","off","placeholder","Press Enter to Select Account","readonly","",2,"width","75%","margin-top","-25px",3,"disabled","ngModel","ngModelChange","keydown.enter"],[2,"width","42%"],[1,"add",2,"margin-left","2px",3,"click"],["id","shiplocation",2,"width","65%",3,"ngModel","disabled","ngModelChange","change"],[1,"col-md-6",2,"padding","0px"],["type","number","id","flatDis1",2,"width","46%",3,"ngModel","disabled","ngModelChange","keydown.Enter","keydown.Tab","focusout"],["type","number",2,"width","48%",3,"ngModel","disabled","ngModelChange","focusout","keydown.Enter","change"],["class","add-discount-button add",3,"click",4,"ngIf"],[1,"add-discount-button","add",3,"click"],[1,"tooltip-text"],["id","consignmentnumid","type","text",2,"width","70%",3,"ngModel","ngModelChange"],["id","receivelocationid","type","text",2,"width","70%",3,"ngModel","ngModelChange"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","-6vh","margin-right","20vw"],[1,"modal-content","modal-content-main-area",2,"width","70%","height","auto"],[1,"modal-header",2,"padding","0px","background","#c0c0c0"],[1,"modal-title",2,"padding-left","5px"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group","row",2,"margin","0.5rem"],[1,"col-sm-4","form-control-label",2,"font-size","13px"],[1,"col-sm-7",2,"padding","0px"],["type","text","id","Parent","autocomplete","off",1,"form-control",2,"height","4vh","font-size","13px",3,"ngModel","ngModelChange"],["type","password","id","Parent","autocomplete","off",1,"form-control",2,"height","4vh","font-size","13px",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","submit",1,"btn","btn-sm","btn-info",2,"font-size","12px",3,"click"],["type","button",1,"btn","btn-sm","btn-info",2,"font-size","12px",3,"click"],[1,"backdrop"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","0rem","margin-right","-1rem"],[1,"modal-content","modal-content-main-area",2,"width","53%"],["class"," form-control-label","style","font-size: 14px;",4,"ngIf"],["type","button","class","btn btn-sm btn-info","style","font-size: 10px;padding:6px",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-info",2,"font-size","10px","padding","6px",3,"click"],[1,"form-control-label",2,"font-size","14px"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","-4rem","margin-right","20rem"],[1,"modal-content","modal-content-main-area",2,"width","auto","height","auto"],[1,"form-group","row","mb-2",2,"margin","0.5rem"],[1,"col-md-6","col-sm-12"],[1,"col-5","form-control-label","p-0","m-0",2,"font-size","13px"],[1,"col-6",2,"padding","0px"],["type","number","id","Parent","autocomplete","off",1,"col-6","form-control",2,"height","4vh","font-size","13px",3,"disabled","ngModel","ngModelChange"],[1,"form-group-row",2,"margin","0.5rem"],[2,"border","2px solid #d9d9d9","width","100%"],[2,"font-size","13px","text-align","left","margin-bottom","3px","width","auto"],[1,"form-control",2,"width","100%",3,"ngModel","ngModelChange"]],template:function(t,i){1&t&&e.YNc(0,nt,103,66,"div",0),2&t&&e.Q6J("ngIf",1==i.masterService.ShowMore)},dependencies:[F.sg,F.O5,F.PC,O.YN,O.Kr,O.Fj,O.wV,O.Wl,O.EJ,O.JJ,O.On,n.Zl,U.U,V,P.X,o.c,m.r,p.v,S.u],styles:['.btn[_ngcontent-%COMP%] {\n        width: 65px;\n    }\n\n.add[_ngcontent-%COMP%]{\n  color: #2E8B57;\n  border: 2px solid #2E8B57;\n  margin-left: 2px;\n}\n\nspan.add[_ngcontent-%COMP%]:hover{\ncolor: #04AA6D;\nborder-color:#04AA6D;\n}\n\nspan.add[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{\n  position: absolute;\n  left: 50%;\n  top:50%;\n  transform: translate(-50%, -50%);\n}\n\nspan.add[_ngcontent-%COMP%]{\n  display: inline-block;\n    width: 15px;\n    height: 15px;\n    text-align: center;\n    font-size: 16px;\n    font-family: "Roboto";\n    border-radius: 50%;\n    background: #F7F7F7;\n    position: relative;\n    cursor: pointer;\n    margin-top: 7px;\n}\n\n.add-discount-button[_ngcontent-%COMP%] {\n      position: relative;\n      display: inline-block;\n      cursor: pointer;\n    }\n\n.add-discount-button[_ngcontent-%COMP%]   .tooltip-text[_ngcontent-%COMP%] {\n  visibility: hidden;\n  width: 100px;\n  background-color: #555;\n  color: #fff;\n  text-align: center;\n  border-radius: 5px;\n  padding: 5px;\n  position: absolute;\n  z-index: 1;\n  bottom: 125%;\n  right: 50%;\n  opacity: 0;\n  transition: opacity 0.3s;\n}\n\n.add-discount-button[_ngcontent-%COMP%]:hover   .tooltip-text[_ngcontent-%COMP%] {\n  visibility: visible;\n  opacity: 1;\n}\n\n.backdrop[_ngcontent-%COMP%] {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(61, 60, 60, 0.5);\n    z-index: 9999;\n  }']}),s})()},3047:(re,q,g)=>{g.d(q,{d:()=>he});var n=g(36336),y=g(28698),H=g(92340),_=g(42326),v=g(53074),F=g(87584),Z=g(45365),U=g(67311),k=g(67297),e=g(92752),w=g(63504),G=g(14970);function J(T,P){if(1&T&&(n.ynx(0),n.TgZ(1,"option",21),n._uU(2),n.qZA(),n.BQk()),2&T){const o=P.$implicit;n.xp6(1),n.Q6J("ngValue",o.SCHEMEID),n.xp6(1),n.Oqu(o.NAME)}}function b(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"h5",4),n._uU(4,"CREATE MEMBERSHIP"),n.qZA(),n.TgZ(5,"div",5)(6,"form",6),n.NdJ("ngSubmit",function(){n.CHM(o);const p=n.oxw();return n.KtG(p.onSave())}),n.TgZ(7,"button",7),n._uU(8,"SAVE"),n.qZA(),n.TgZ(9,"button",8),n.NdJ("click",function(){n.CHM(o);const p=n.oxw();return n.KtG(p.cancelPopup())}),n._uU(10,"CANCEL"),n.qZA()()()(),n.TgZ(11,"div",9)(12,"form",10)(13,"div",11)(14,"label",12),n._uU(15,"First Name:"),n.qZA(),n.TgZ(16,"div",13),n._UZ(17,"input",14),n.qZA()(),n.TgZ(18,"div",11)(19,"label",12),n._uU(20,"Last Name:"),n.qZA(),n.TgZ(21,"div",13),n._UZ(22,"input",15),n.qZA()(),n.TgZ(23,"div",11)(24,"label",12),n._uU(25,"Mobile No:"),n.qZA(),n.TgZ(26,"div",13),n._UZ(27,"input",16),n.qZA()(),n.TgZ(28,"div",11)(29,"label",12),n._uU(30,"Address:"),n.qZA(),n.TgZ(31,"div",13),n._UZ(32,"input",17),n.qZA()(),n.TgZ(33,"div",11)(34,"label",12),n._uU(35,"Scheme:"),n.qZA(),n.TgZ(36,"div",13)(37,"select",18),n.YNc(38,J,3,2,"ng-container",19),n.qZA()()(),n.TgZ(39,"div",11)(40,"label",12),n._uU(41,"Account:"),n.qZA(),n.TgZ(42,"div",13),n._UZ(43,"input",20),n.qZA()()()()()()}if(2&T){const o=n.oxw();n.xp6(6),n.Q6J("formGroup",o.membershipForm),n.xp6(1),n.Q6J("disabled",!o.membershipForm.valid),n.xp6(5),n.Q6J("formGroup",o.membershipForm),n.xp6(26),n.Q6J("ngForOf",o.schemeList)}}let f=(()=>{class T{constructor(o,m,p,S,te){this._trnMainService=o,this.fb=m,this.masterService=p,this.spinnerService=S,this.alertService=te,this.schemeList=[],this.mode="add",this.membershipObj={},this.onsubmit=new n.vpe,this.masterService.getMemCatList().subscribe(le=>{this.schemeList=le})}ngOnInit(){this.membershipForm=this.fb.group({FNAME:["",[w.kI.required]],LNAME:["",[w.kI.required]],MOBILE:["",[w.kI.required]],ADDRESS:[""],SCHEMEID:[""],ACCNAME:[""]})}show(){this.isActive=!0}cancelPopup(){this.isActive=!1,this._trnMainService.inputCode=!1,this.membershipForm.reset()}closeDialog(){this.isActive=!1}onSave(){let o=Object.assign(this.membershipObj,this.membershipForm.value);const m={mode:this.mode,data:o};this.spinnerService.show("Data is Saving ..."),this.masterService.postMembershipGroup(m).subscribe(p=>{"ok"==p.status?(this.closeDialog(),this.spinnerService.hide(),"ProceedConfirmation"==p.result?confirm("Member is not Created in  Server.Do you want to Process..")?(this.membershipForm.value.FurtherProceed="ProceedConfirmationYes",this.onSave()):(this.membershipForm.reset(),this.alertService.hide()):(this.membershipForm.reset(),this.alertService.info(p.result),setTimeout(()=>{this.alertService.hide()},500),this.onsubmit.emit(p.result2))):(this.alertService.info(p.result),this.spinnerService.hide())},p=>{this.spinnerService.hide()})}}return T.\u0275fac=function(o){return new(o||T)(n.Y36(F.p),n.Y36(w.qu),n.Y36(v.P),n.Y36(G.V),n.Y36(U.c))},T.\u0275cmp=n.Xpm({type:T,selectors:[["create-membership-dialog"]],outputs:{onsubmit:"onsubmit"},decls:1,vars:1,consts:[["class","membership_container","role","document","style","max-width: 100%; max-height: 500px; overflow:hidden",4,"ngIf"],["role","document",1,"membership_container",2,"max-width","100%","max-height","500px","overflow","hidden"],[1,"card"],[1,"card-header"],[1,"page-title"],[1,"button-group"],[3,"formGroup","ngSubmit"],["title","Save","type","submit",1,"btn","btn-info",2,"margin-right","2px",3,"disabled"],["type","button","title","Cancel",1,"btn","btn-info",3,"click"],[1,"card-body"],[1,"form-horizontal",2,"margin-top","15px",3,"formGroup"],[1,"form-group","row"],[1,"col-sm-2","form-control-label"],[1,"col-sm-5",2,"padding-left","1px"],["type","text","formControlName","FNAME","autocomplete","off",1,"form-control"],["type","text","formControlName","LNAME","autocomplete","off",1,"form-control"],["type","text","formControlName","MOBILE","autocomplete","off",1,"form-control"],["type","text","formControlName","ADDRESS","autocomplete","off",1,"form-control"],["formControlName","SCHEMEID",1,"form-control",2,"padding","0px 10px"],[4,"ngFor","ngForOf"],["type","text","formControlName","ACCNAME","autocomplete","off",1,"form-control"],[3,"ngValue"]],template:function(o,m){1&o&&n.YNc(0,b,44,4,"div",0),2&o&&n.Q6J("ngIf",m.isActive)},dependencies:[e.sg,e.O5,w._Y,w.YN,w.Kr,w.Fj,w.EJ,w.JJ,w.JL,w.sg,w.u],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{border:1px solid #cbcbcb;border-radius:2px;height:30px;color:#000}.page-title[_ngcontent-%COMP%]{text-align:center}.form-control[_ngcontent-%COMP%]{font-size:14px}.button-group[_ngcontent-%COMP%]{position:absolute;right:3%;top:3%}.card-body[_ngcontent-%COMP%]{line-height:.4rem}","td[_ngcontent-%COMP%] {\n      border: 1px solid #e6e6e6;\n    }\n  \n    input[_ngcontent-%COMP%] {\n      padding: 8px;\n    }\n  \n    .form-group[_ngcontent-%COMP%] {\n      margin-bottom: 1rem;\n    }\n  \n    .membership_container[_ngcontent-%COMP%] {\n      position: fixed !important;\n      transform: translate(0px, -35px);\n      background: #ffffff;\n      z-index: 99999;\n      width: 65%;\n      top: 22.5%;\n      left: 16%;\n    }\n\n    label[_ngcontent-%COMP%]{\n      \n      font-size: 14px;\n      margin-left: 5rem;\n      margin-top: 10px;\n    }"]}),T})();var O=g(89952);let I=(()=>{class T{constructor(o){this.authService=o,this.userSetting=this.authService.getSetting()}transform(o,m,p){let S=!1;return"VIEW"===m?(S=!0,S):0===this.userSetting.REFBILLCOMPULSORINDNOTE&&_.Km.DebitNote?S:o==_.Km.TaxInvoice||o==_.Km.Sales||o==_.Km.PerformaSalesInvoice||(-1!==[_.Km.DebitNote,_.Km.CreditNote].indexOf(o)&&(0===this.userSetting.ENABLEMANUALSALESRETURN||1===this.userSetting.REFBILLCOMPULSORINDNOTE)&&-1!==["NEW"].indexOf(m)&&1===p&&(S=!0),S)}}return T.\u0275fac=function(o){return new(o||T)(n.Y36(k.e,16))},T.\u0275pipe=n.Yjl({name:"roundingEnableDisable",type:T,pure:!0}),T})();const D=["CreateMembership"],R=["genericGridTDSAccount"],M=["genericGridTDSAccountSubLedger"];function N(T,P){1&T&&n._UZ(0,"div",7)}function C(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"Flat Dis%"),n.qZA(),n.TgZ(3,"td")(4,"input",20),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.DCRATE=p)})("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return S.checkFlatDiscountRate(p),n.KtG(S._trnMainService.callPipe=!S._trnMainService.callPipe)}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode&&(61==o._trnMainService.TrnMainObj.VoucherType||3==o._trnMainService.TrnMainObj.VoucherType||31==o._trnMainService.TrnMainObj.VoucherType||20==o._trnMainService.TrnMainObj.VoucherType||16==o._trnMainService.TrnMainObj.VoucherType||19==o._trnMainService.TrnMainObj.VoucherType)||16==o._trnMainService.TrnMainObj.VoucherType&&o._trnMainService.TrnMainObj.REFBILL&&1==o.masterService.userSetting.REFBILLCOMPULSORINDNOTE||null!=o._trnMainService.TrnMainObj.FLATDCAMNT&&0!=o._trnMainService.TrnMainObj.FLATDCAMNT)("ngModel",o._trnMainService.TrnMainObj.DCRATE)}}function x(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"Flat Dis Amount:"),n.qZA(),n.TgZ(3,"td")(4,"input",21),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.FLATDCAMNT=p)})("change",function(){n.CHM(o);const p=n.oxw(3);return n.KtG(p.onChangeFlatDiscount())})("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return S.checkFlatDiscountAmnt(p),n.KtG(S._trnMainService.callPipe=!S._trnMainService.callPipe)}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode&&(61==o._trnMainService.TrnMainObj.VoucherType||3==o._trnMainService.TrnMainObj.VoucherType||31==o._trnMainService.TrnMainObj.VoucherType||20==o._trnMainService.TrnMainObj.VoucherType||16===o._trnMainService.TrnMainObj.VoucherType||19===o._trnMainService.TrnMainObj.VoucherType)||16==o._trnMainService.TrnMainObj.VoucherType&&o._trnMainService.TrnMainObj.REFBILL&&1==o.masterService.userSetting.REFBILLCOMPULSORINDNOTE||null!=o._trnMainService.TrnMainObj.DCRATE&&0!=o._trnMainService.TrnMainObj.DCRATE)("ngModel",o._trnMainService.TrnMainObj.FLATDCAMNT)}}function Q(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"button",26),n.NdJ("click",function(){n.CHM(o);const p=n.oxw(4);return n.KtG(p.onFlatDiscApply())}),n._uU(1," APPLY "),n.qZA()}if(2&T){const o=n.oxw(4);n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode||(0==o._trnMainService.TrnMainObj.DCRATE||null==o._trnMainService.TrnMainObj.DCRATE)&&(0==o._trnMainService.TrnMainObj.FLATDCAMNT||null==o._trnMainService.TrnMainObj.FLATDCAMNT)||16==o._trnMainService.TrnMainObj.VoucherType&&o._trnMainService.TrnMainObj.REFBILL&&1==o.masterService.userSetting.REFBILLCOMPULSORINDNOTE)}}function X(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"button",26),n.NdJ("click",function(){n.CHM(o);const p=n.oxw(4);return n.KtG(p._trnMainService.onApplyClicked())}),n._uU(1," OVERWRITE "),n.qZA()}if(2&T){const o=n.oxw(4);n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode||(0==o._trnMainService.TrnMainObj.DCRATE||null==o._trnMainService.TrnMainObj.DCRATE)&&(0==o._trnMainService.TrnMainObj.FLATDCAMNT||null==o._trnMainService.TrnMainObj.FLATDCAMNT)||16==o._trnMainService.TrnMainObj.VoucherType&&o._trnMainService.TrnMainObj.REFBILL&&1==o.masterService.userSetting.REFBILLCOMPULSORINDNOTE||o._trnMainService.disableOverwriteButton)}}function z(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr",22)(1,"td",23),n.YNc(2,Q,2,1,"button",24),n.qZA(),n.TgZ(3,"td",23),n.YNc(4,X,2,1,"button",25),n.qZA(),n.TgZ(5,"td",23)(6,"button",26),n.NdJ("click",function(){n.CHM(o);const p=n.oxw(3);return n.KtG(p._trnMainService.onRevertClicked())}),n._uU(7," REVERT "),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(2),n.Q6J("ngIf",3==o._trnMainService.TrnMainObj.VoucherType||19==o._trnMainService.TrnMainObj.VoucherType||16==o._trnMainService.TrnMainObj.VoucherType||31==o._trnMainService.TrnMainObj.VoucherType),n.xp6(2),n.Q6J("ngIf",!o.allIndDiscountsMissing),n.xp6(2),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode||16==o._trnMainService.TrnMainObj.VoucherType&&o._trnMainService.TrnMainObj.REFBILL&&1==o.masterService.userSetting.REFBILLCOMPULSORINDNOTE)}}function $(T,P){if(1&T&&(n.TgZ(0,"div",18),n.YNc(1,C,5,2,"tr",17),n.YNc(2,x,5,2,"tr",17),n.YNc(3,z,8,3,"tr",19),n.qZA()),2&T){const o=n.oxw(2);n.xp6(1),n.Q6J("ngIf",3==o._trnMainService.TrnMainObj.VoucherType||19==o._trnMainService.TrnMainObj.VoucherType||16==o._trnMainService.TrnMainObj.VoucherType||20==o._trnMainService.TrnMainObj.VoucherType||31==o._trnMainService.TrnMainObj.VoucherType),n.xp6(1),n.Q6J("ngIf",3==o._trnMainService.TrnMainObj.VoucherType||19==o._trnMainService.TrnMainObj.VoucherType||16==o._trnMainService.TrnMainObj.VoucherType||20==o._trnMainService.TrnMainObj.VoucherType||31==o._trnMainService.TrnMainObj.VoucherType),n.xp6(1),n.Q6J("ngIf",3==o._trnMainService.TrnMainObj.VoucherType||16==o._trnMainService.TrnMainObj.VoucherType||19==o._trnMainService.TrnMainObj.VoucherType||20==o._trnMainService.TrnMainObj.VoucherType||31==o._trnMainService.TrnMainObj.VoucherType)}}function ee(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"Gross Amount:"),n.qZA(),n.TgZ(3,"td",28)(4,"input",29),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.GROSSAMNT=p)}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)("ngModel",o._trnMainService.TrnMainObj.GROSSAMNT)("readonly",!0)}}function ne(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"Total Discount:"),n.qZA(),n.TgZ(3,"td")(4,"input",29),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.TOTALDISCOUNT=p)}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)("ngModel",o._trnMainService.TrnMainObj.TOTALDISCOUNT)("readonly",!0)}}function j(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"Total Taxable:"),n.qZA(),n.TgZ(3,"td",28)(4,"input",29),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.TAXABLE=p)}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)("ngModel",o._trnMainService.TrnMainObj.TAXABLE)("readonly",!0)}}function B(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"Total Non-Taxable:"),n.qZA(),n.TgZ(3,"td",28)(4,"input",29),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.NONTAXABLE=p)}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)("ngModel",o._trnMainService.TrnMainObj.NONTAXABLE)("readonly",!0)}}function d(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"VAT Amount:"),n.qZA(),n.TgZ(3,"td",28)(4,"input",29),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.VATAMNT=p)}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)("ngModel",o._trnMainService.TrnMainObj.VATAMNT)("readonly",!0)}}function u(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"Net Amount:"),n.qZA(),n.TgZ(3,"td",28)(4,"input",29),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.NETAMNT=p)}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)("ngModel",o._trnMainService.TrnMainObj.NETAMNT)("readonly",!0)}}function h(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"Rounding:"),n.qZA(),n.TgZ(3,"td")(4,"input",30),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.ROUNDAMTMANUAL=p)})("keydown.enter",function(){n.CHM(o);const p=n.oxw(3);return n.KtG(p.changeAfterRoundAmt())})("keydown.alt.enter",function(){n.CHM(o);const p=n.oxw(3);return n.KtG(p.rounding())}),n.ALo(5,"roundingEnableDisable"),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled",n.Dn7(5,2,o._trnMainService.TrnMainObj.VoucherType,o._trnMainService.TrnMainObj.Mode,o._trnMainService.TrnMainObj.DOFULLRETURN))("ngModel",o._trnMainService.TrnMainObj.ROUNDAMTMANUAL)}}function l(T,P){if(1&T&&(n.TgZ(0,"div",27),n.YNc(1,ee,5,3,"tr",17),n.YNc(2,ne,5,3,"tr",17),n.YNc(3,j,5,3,"tr",17),n.YNc(4,B,5,3,"tr",17),n.YNc(5,d,5,3,"tr",17),n.YNc(6,u,5,3,"tr",17),n.YNc(7,h,6,6,"tr",17),n.qZA()),2&T){const o=n.oxw(2);n.xp6(1),n.Q6J("ngIf","add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath||"purchase-import"==o.activeurlpath),n.xp6(1),n.Q6J("ngIf",("add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath)&&"lite"==o.AppMode),n.xp6(1),n.Q6J("ngIf","add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath||"purchase-import"==o.activeurlpath),n.xp6(1),n.Q6J("ngIf","add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath||"purchase-import"==o.activeurlpath),n.xp6(1),n.Q6J("ngIf","add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath||"purchase-import"==o.activeurlpath),n.xp6(1),n.Q6J("ngIf","add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath||"purchase-import"==o.activeurlpath),n.xp6(1),n.Q6J("ngIf",("add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath||"purchase-import"==o.activeurlpath)&&"pro"==o.AppMode)}}function E(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"Discount:"),n.qZA(),n.TgZ(3,"td",28)(4,"input",20),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.AdditionalObj.AFTERVATDISCOUNT=p)})("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S.checkAfterVatDiscount(p))}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)("ngModel",o._trnMainService.TrnMainObj.AdditionalObj.AFTERVATDISCOUNT)}}function L(T,P){if(1&T&&(n.TgZ(0,"tr")(1,"td"),n._uU(2,"Net Amount "),n._UZ(3,"br"),n._uU(4," after Discount:"),n.qZA(),n.TgZ(5,"td",28),n._UZ(6,"input",32),n.qZA()()),2&T){const o=n.oxw(3);n.xp6(6),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)("readonly",!0)("ngModel",o._trnMainService.TrnMainObj.NETAMNT-o._trnMainService.TrnMainObj.AdditionalObj.AFTERVATDISCOUNT)}}function V(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"TDS Amount:"),n.qZA(),n.TgZ(3,"td",28)(4,"input",20),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.AdditionalObj.TDSAMOUNT=p)}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)("ngModel",o._trnMainService.TrnMainObj.AdditionalObj.TDSAMOUNT)}}function ce(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"TDS Account:"),n.qZA(),n.TgZ(3,"td",28)(4,"input",33),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.AdditionalObj.TDSACCOUNTNAME=p)})("keydown.enter",function(){n.CHM(o);const p=n.oxw(3);return n.KtG(p.onTDSAccountEnter())})("keyup",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S.onTDSAccountEnter(p))})("keypress",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S.keyPress(p))}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)("ngModel",o._trnMainService.TrnMainObj.AdditionalObj.TDSACCOUNTNAME)}}function ie(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2,"TDS Sub Ledger Account:"),n.qZA(),n.TgZ(3,"td",28)(4,"input",34),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw(3);return n.KtG(S._trnMainService.TrnMainObj.AdditionalObj.SL_ACNAME=p)}),n.qZA()()()}if(2&T){const o=n.oxw(3);n.xp6(4),n.Q6J("disabled",!0)("ngModel",o._trnMainService.TrnMainObj.AdditionalObj.SL_ACNAME)}}function ve(T,P){if(1&T&&(n.TgZ(0,"div",31),n.YNc(1,E,5,2,"tr",17),n.YNc(2,L,7,3,"tr",17),n.YNc(3,V,5,2,"tr",17),n.YNc(4,ce,5,2,"tr",17),n.YNc(5,ie,5,2,"tr",17),n.qZA()),2&T){const o=n.oxw(2);n.xp6(1),n.Q6J("ngIf","add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath),n.xp6(1),n.Q6J("ngIf",("add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath)&&"pro"==o.AppMode),n.xp6(1),n.Q6J("ngIf",("add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath)&&"pro"==o.AppMode),n.xp6(1),n.Q6J("ngIf","add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath),n.xp6(1),n.Q6J("ngIf",("add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath)&&o._trnMainService.TrnMainObj.AdditionalObj.SL_ACNAME)}}function de(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"div")(1,"div",35)(2,"div",36)(3,"div",37)(4,"h6",38),n._uU(5,"Confirmation"),n.qZA(),n.TgZ(6,"button",39),n.NdJ("click",function(){n.CHM(o);const p=n.oxw(2);return n.KtG(p.closeModal())}),n.TgZ(7,"span",40),n._uU(8,"\xd7"),n.qZA()()(),n.TgZ(9,"div",41)(10,"p",42),n._uU(11,"Do you want to apply flat discount before or after the individual discount ?"),n.qZA()(),n.TgZ(12,"div",43)(13,"button",44),n.NdJ("click",function(){n.CHM(o);const p=n.oxw(2);return p._trnMainService.beforeDiscFlat(),n.KtG(p.showConfirm=!1)}),n._uU(14,"BEFORE "),n.qZA(),n.TgZ(15,"button",44),n.NdJ("click",function(){n.CHM(o);const p=n.oxw(2);return p._trnMainService.afterDiscFlat(),n.KtG(p.showConfirm=!1)}),n._uU(16,"AFTER"),n.qZA()()()()()}}const ae=function(T){return{"mySidenav-show":T}},oe=function(T){return{"toggler-btn-icon-reverse":T}};function _e(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"div",8)(1,"button",9),n.NdJ("click",function(){n.CHM(o);const p=n.oxw();return p.toggleVisibility(),n.KtG(p.showOverWrite())}),n._uU(2," F10 "),n._UZ(3,"i",10),n.qZA(),n.TgZ(4,"div",11)(5,"table",12),n.YNc(6,$,4,3,"div",13),n.qZA(),n.TgZ(7,"table",14)(8,"div"),n.YNc(9,l,8,7,"div",15),n.YNc(10,ve,6,5,"div",16),n.qZA()()(),n.YNc(11,de,17,0,"div",17),n.qZA()}if(2&T){const o=n.oxw();n.Q6J("ngClass",n.VKq(6,ae,o.hideShow)),n.xp6(3),n.Q6J("ngClass",n.VKq(8,oe,o.hideShow)),n.xp6(3),n.Q6J("ngIf",3==o._trnMainService.TrnMainObj.VoucherType&&"purchase-import"!=o.activeurlpath||16==o._trnMainService.TrnMainObj.VoucherType||19==o._trnMainService.TrnMainObj.VoucherType||20==o._trnMainService.TrnMainObj.VoucherType||31==o._trnMainService.TrnMainObj.VoucherType||57==o._trnMainService.TrnMainObj.VoucherType),n.xp6(3),n.Q6J("ngIf","add-purchase-invoice"==o.activeurlpath||"purchase-import"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath),n.xp6(1),n.Q6J("ngIf","add-purchase-invoice"==o.activeurlpath||"add-debitnote-itembase"==o.activeurlpath),n.xp6(1),n.Q6J("ngIf",o.showConfirm)}}function ue(T,P){if(1&T&&(n.TgZ(0,"tr")(1,"td"),n._uU(2,"Prior Earned Points:"),n.qZA(),n.TgZ(3,"td",56),n._uU(4),n.ALo(5,"twoDigitNumber"),n.qZA()()),2&T){const o=n.oxw(2);n.xp6(4),n.hij("",n.lcZ(5,1,o._trnMainService.TrnMainObj.TOTMEMPOINTS)," ")}}function Me(T,P){1&T&&(n.TgZ(0,"span"),n._uU(1,"-"),n.qZA())}function pe(T,P){if(1&T){const o=n.EpF();n.TgZ(0,"div",8)(1,"button",45),n.NdJ("click",function(p){n.CHM(o);const S=n.oxw();return S.hideShow=!S.hideShow,S.onClickToolTip(p),n.KtG(S.doautomaticRounding())}),n._uU(2," F10 "),n._UZ(3,"i",10),n.qZA(),n.TgZ(4,"table",46)(5,"div",47)(6,"tr")(7,"td"),n._uU(8,"Membership ID"),n.qZA(),n.TgZ(9,"td")(10,"input",48),n.NdJ("click",function(){n.CHM(o);const p=n.oxw();return n.KtG(p.onClicked())})("focusout",function(p){n.CHM(o);const S=n.oxw();return n.KtG(S.memberFocusOut(p))})("focusin",function(p){n.CHM(o);const S=n.oxw();return n.KtG(S.memberFocusIN(p))})("ngModelChange",function(p){n.CHM(o);const S=n.oxw();return n.KtG(S._trnMainService.TrnMainObj.MEMBERNO=p)}),n.qZA()()(),n.TgZ(11,"tr")(12,"td"),n._uU(13,"Member Name:"),n.qZA(),n.TgZ(14,"td",49),n._uU(15),n.qZA()(),n.TgZ(16,"tr")(17,"td",50),n._uU(18,"Scheme:"),n.qZA(),n.TgZ(19,"td",51),n._uU(20),n.qZA()(),n.TgZ(21,"tr")(22,"td"),n._uU(23,"Referred By ID:"),n.qZA(),n.TgZ(24,"td")(25,"input",52),n.NdJ("focusout",function(p){n.CHM(o);const S=n.oxw();return n.KtG(S.memberReferFocusOut(p))})("focusin",function(p){n.CHM(o);const S=n.oxw();return n.KtG(S.memberReferFocusIN(p))})("ngModelChange",function(p){n.CHM(o);const S=n.oxw();return n.KtG(S._trnMainService.TrnMainObj.REFERMEMBERNO=p)}),n.qZA()()(),n.TgZ(26,"tr")(27,"td"),n._uU(28,"Referred By Name:"),n.qZA(),n.TgZ(29,"td",49),n._uU(30),n.qZA()(),n.YNc(31,ue,6,3,"tr",17),n.TgZ(32,"tr")(33,"td"),n._uU(34,"Earned Point in Bill:"),n.qZA(),n.TgZ(35,"td",53),n.YNc(36,Me,2,0,"span",17),n._uU(37),n.ALo(38,"twoDigitNumber"),n.qZA()(),n.TgZ(39,"tr")(40,"td"),n._uU(41,"Bill Amount:"),n.qZA(),n.TgZ(42,"td"),n._uU(43),n.ALo(44,"twoDigitNumber"),n.qZA()()(),n.TgZ(45,"div",47)(46,"tr")(47,"td"),n._uU(48,"Net Amount:"),n.qZA(),n.TgZ(49,"td",28)(50,"input",54),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw();return n.KtG(S._trnMainService.TrnMainObj.NETAMNT=p)}),n.qZA()()(),n.TgZ(51,"tr")(52,"td"),n._uU(53,"Rounding:"),n.qZA(),n.TgZ(54,"td")(55,"input",55),n.NdJ("ngModelChange",function(p){n.CHM(o);const S=n.oxw();return n.KtG(S._trnMainService.TrnMainObj.ROUNDAMTMANUAL=p)})("keydown.enter",function(){n.CHM(o);const p=n.oxw();return n.KtG(p.changeAfterRoundAmt())})("keydown.alt.enter",function(){n.CHM(o);const p=n.oxw();return n.KtG(p.rounding())}),n.ALo(56,"roundingEnableDisable"),n.qZA()()()()()()}if(2&T){const o=n.oxw();n.Q6J("ngClass",n.VKq(25,ae,o.hideShow)),n.xp6(3),n.Q6J("ngClass",n.VKq(27,oe,o.hideShow)),n.xp6(7),n.Q6J("ngModel",o._trnMainService.TrnMainObj.MEMBERNO),n.xp6(5),n.hij(" ",o._trnMainService.TrnMainObj.MEMBERNAME," "),n.xp6(5),n.hij(" ",o._trnMainService.TrnMainObj.SCHEMENAME," "),n.xp6(5),n.Q6J("ngModel",o._trnMainService.TrnMainObj.REFERMEMBERNO)("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode),n.xp6(5),n.hij(" ",o._trnMainService.TrnMainObj.REFERMEMBERNAME," "),n.xp6(1),n.Q6J("ngIf",15!==o._trnMainService.TrnMainObj.VoucherType),n.xp6(5),n.Q6J("ngIf",15==o._trnMainService.TrnMainObj.VoucherType),n.xp6(1),n.hij("",n.lcZ(38,17,o._trnMainService.TrnMainObj.EARNPOINS)," "),n.xp6(6),n.hij(" ",n.lcZ(44,19,o._trnMainService.TrnMainObj.NETAMNT)," "),n.xp6(7),n.Q6J("disabled","VIEW"==o._trnMainService.TrnMainObj.Mode)("ngModel",o._trnMainService.TrnMainObj.NETAMNT)("readonly",!0),n.xp6(5),n.Q6J("disabled",n.Dn7(56,21,o._trnMainService.TrnMainObj.VoucherType,o._trnMainService.TrnMainObj.Mode,o._trnMainService.TrnMainObj.DOFULLRETURN))("ngModel",o._trnMainService.TrnMainObj.ROUNDAMTMANUAL)}}let he=(()=>{class T{constructor(o,m,p,S,te){this.masterService=o,this._trnMainService=m,this.arouter=p,this.alertservice=S,this._authService=te,this.hideShow=!1,this.focusOut=!1,this.focusOutReferNo=!1,this.roundingHover=!1,this.allIndDiscountsMissing=!1,this.genericGridTDSAccountSetting=new y.im,this.genericGridTDSAccountSubLedgerSetting=new y.im,this.onMemberIDSearch=new n.vpe,this.onMemberReferIDSearch=new n.vpe,this.onClickSlider=new n.vpe,this.showConfirm=!1,this.appType=this.masterService.appType,this.userSetting=te.getSetting(),console.log("callf10"),this.activeurlpath=p.snapshot.url[0].path,this.showOverWrite()}EnableMinusKeyPress(o){"Minus"===o.code&&o.stopPropagation()}ngOnInit(){this.AppMode=H.N.appMode}memberFocusOut(o){this.focusOut=!1,this._trnMainService.memberPopupForRefer=!1}memberReferFocusOut(o){this.focusOutReferNo=!1}memberReferFocusIN(o){this.focusOutReferNo=!0}memberFocusIN(o){this.focusOut=!0}onClickToolTip(o){this.onClickSlider.emit()}openCreateMembershipPopup(){"TI"==this._trnMainService.TrnMainObj.VoucherPrefix&&this.CreateMembership.show()}onClicked(){this._trnMainService.inputCode=!0}onSaveMembership(o){}onChangeFlatDiscount(){this._trnMainService.TrnMainObj.TOTALFLATDISCOUNT=this._trnMainService.TrnMainObj.FLATDCAMNT}onFlatDiscApply(){let o=this._trnMainService.TrnMainObj.ProdList?.filter(p=>0!=p.INDDISCOUNTRATE&&null!=p.INDDISCOUNTRATE&&null!=p.INDDISCOUNTRATE||0!=p.INDDISCOUNT&&null!=p.INDDISCOUNT&&null!=p.INDDISCOUNT),m=this._trnMainService.TrnMainObj.AdditionProdList?.filter(p=>0!=p.INDDISCOUNTRATE&&null!=p.INDDISCOUNTRATE&&null!=p.INDDISCOUNTRATE||0!=p.INDDISCOUNT&&null!=p.INDDISCOUNT&&null!=p.INDDISCOUNT);1==this.userSetting.EnableFDiscountBeforeIDiscount&&(o.length>0||m.length>0)?this.showConfirm=!0:this._trnMainService.afterDiscFlat()}closeModal(){this.showConfirm=!1}checkFlatDiscountRate(o){return console.log("check discount rate",o),o>100?(this.alertservice.info("Flat discount rate cannot be greater than 100%"),void(this._trnMainService.TrnMainObj.DCRATE=0)):o<0?(this.alertservice.info("Flat discount rate cannot be less than 0%"),void(this._trnMainService.TrnMainObj.DCRATE=0)):void((0==o||null==o||null==o)&&this._trnMainService.onFlatDiscountClear())}checkFlatDiscountAmnt(o){let m=this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.NETAMNT/1.13);return o>=m?(this.alertservice.info(`Flat discount amount cannot be greater than or equal to total amount: ${m}`),void(this._trnMainService.TrnMainObj.FLATDCAMNT=0)):o<0?(this.alertservice.info("Flat discount amount cannot be less than 0"),void(this._trnMainService.TrnMainObj.FLATDCAMNT=0)):void((0==o||null==o||null==o)&&this._trnMainService.onFlatDiscountClear())}checkAfterVatDiscount(o){return this._trnMainService.TrnMainObj.NETAMNT-this._trnMainService.TrnMainObj.AdditionalObj.AFTERVATDISCOUNT<=0?(this.alertservice.info(`Discount amount cannot be more than or equal to Net Amount: ${this._trnMainService.TrnMainObj.NETAMNT}`),void(this._trnMainService.TrnMainObj.AdditionalObj.AFTERVATDISCOUNT=0)):o<0?(this.alertservice.info("Discount amount cannot be less than 0"),void(this._trnMainService.TrnMainObj.AdditionalObj.AFTERVATDISCOUNT=0)):void 0}onTDSAccountEnter(){this.reIntialiseTDSData(),this.genericGridTDSAccountSetting={title:"TDS Accounts",apiEndpoints:"/getTDSAccountPagedList",defaultFilterIndex:1,columns:[{key:"ACCODE",title:"AC CODE",hidden:!1,noSearch:!1},{key:"ACNAME",title:"A/C NAME",hidden:!1,noSearch:!1}]},this.genericGridTDSAccount.show()}onTDSAccountSelect(o){this._trnMainService.TrnMainObj.AdditionalObj.SL_ACNAME=null,1==o.HASSUBLEDGER?(this._trnMainService.TrnMainObj.AdditionalObj.SubLedgerValidation=!0,this.showSubLedger()):(this._trnMainService.TrnMainObj.AdditionalObj.SubLedgerValidation=!1,this._trnMainService.TrnMainObj.AdditionalObj.SL_ACNAME=null,this._trnMainService.TrnMainObj.AdditionalObj.SL_ACID=null),this._trnMainService.TrnMainObj.AdditionalObj.TDSACCOUNTNAME=o.ACNAME,this._trnMainService.TrnMainObj.AdditionalObj.TDSACCOUNT=o.ACID}reIntialiseTDSData(){this._trnMainService.TrnMainObj.AdditionalObj.TDSACCOUNTNAME=null,this._trnMainService.TrnMainObj.AdditionalObj.TDSACCOUNT=null,this._trnMainService.TrnMainObj.AdditionalObj.SL_ACNAME=null,this._trnMainService.TrnMainObj.AdditionalObj.SL_ACID=null}showSubLedger(){this.genericGridTDSAccountSubLedgerSetting={title:"TDS Sub Ledger Accounts",apiEndpoints:"/getTDSAccountPagedListWithSubLedger",defaultFilterIndex:1,columns:[{key:"SL_ACID",title:"AC CODE",hidden:!1,noSearch:!1},{key:"SL_ACNAME",title:"A/C NAME",hidden:!1,noSearch:!1}]},this.genericGridTDSAccountSubLedger.show()}onTDSAccountSubLedgerSelect(o){console.log("jjsjs",o),this._trnMainService.TrnMainObj.AdditionalObj.SL_ACNAME=o.SL_ACNAME,this._trnMainService.TrnMainObj.AdditionalObj.SL_ACID=o.SL_ACID,this._trnMainService.TrnMainObj.AdditionalObj.SubLedgerValidation=!1}handleKeyDownboardEvent(o){"F10"==o.code&&(o.preventDefault(),this.hideShow=!this.hideShow,this.hideShow||(this.genericGridTDSAccount.hide(),this.genericGridTDSAccountSubLedger.hide())),"Enter"==o.code&&(this.focusOut&&this.onMemberIDSearch.emit(),this.focusOutReferNo&&this.onMemberReferIDSearch.emit()),"Insert"===o.code&&(o.preventDefault(),this._trnMainService.inputCode&&this.openCreateMembershipPopup())}hoverRounding(){this.roundingHover=!0}hoverRoundingLeave(){this.roundingHover=!1}changeAfterRoundAmt(){Math.abs(this.masterService.nullToZeroConverter(this._trnMainService.TrnMainObj.ROUNDAMTMANUAL))>0?this._trnMainService.TrnMainObj.ROUNDOFF?alert("Rounding amount has already been applied."):(this._trnMainService.TrnMainObj.ROUNDOFF=this._trnMainService.TrnMainObj.ROUNDAMTMANUAL,this._trnMainService.TrnMainObj.NETAMNT=this._trnMainService.TrnMainObj.NETAMNT+this._trnMainService.TrnMainObj.ROUNDAMTMANUAL):(this._trnMainService.TrnMainObj.ROUNDOFF=0,this._trnMainService.ReCalculateBillWithNormal())}doautomaticRounding(){console.log("rounding"),57==this._trnMainService.TrnMainObj.VoucherType&&this.rounding()}toggleVisibility(){this.hideShow=!this.hideShow}rounding(){this._trnMainService.TrnMainObj.VoucherType==_.Km.Sales||this._trnMainService.TrnMainObj.VoucherType==_.Km.TaxInvoice||this._trnMainService.TrnMainObj.VoucherType==_.Km.PerformaSalesInvoice||(this._trnMainService.TrnMainObj.ROUNDOFF&&(this._trnMainService.TrnMainObj.NETAMNT=this._trnMainService.TrnMainObj.NETAMNT-this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.ROUNDAMTMANUAL),this._trnMainService.TrnMainObj.ROUNDOFF=0),this._trnMainService.TrnMainObj.NETWITHOUTROUNDOFF=Math.round(this._trnMainService.nullToZeroConverter(this._trnMainService.TrnMainObj.NETAMNT)),this._trnMainService.TrnMainObj.ROUNDOFF=this._trnMainService.TrnMainObj.NETWITHOUTROUNDOFF-this._trnMainService.TrnMainObj.NETAMNT,this._trnMainService.TrnMainObj.ROUNDAMTMANUAL=parseFloat(this._trnMainService.TrnMainObj.ROUNDOFF.toFixed(2)),this._trnMainService.TrnMainObj.NETAMNT=this._trnMainService.TrnMainObj.NETWITHOUTROUNDOFF)}keyPress(o){const p=String.fromCharCode(o.charCode);/[\b]/.test(p)||o.preventDefault()}showOverWrite(){if(this.allIndDiscountsMissing=!0,this._trnMainService.disableOverwriteButton=!1,this._trnMainService.TrnMainObj&&this._trnMainService.TrnMainObj.ProdList)for(const o of this._trnMainService.TrnMainObj.ProdList)if(null!=o.INDDISCOUNT&&0!==o.INDDISCOUNT){this.allIndDiscountsMissing=!1;break}}}return T.\u0275fac=function(o){return new(o||T)(n.Y36(v.P),n.Y36(F.p),n.Y36(Z.gz),n.Y36(U.c),n.Y36(k.e))},T.\u0275cmp=n.Xpm({type:T,selectors:[["voucher-sidebar-billdetail"]],viewQuery:function(o,m){if(1&o&&(n.Gf(D,5),n.Gf(R,5),n.Gf(M,5)),2&o){let p;n.iGM(p=n.CRH())&&(m.CreateMembership=p.first),n.iGM(p=n.CRH())&&(m.genericGridTDSAccount=p.first),n.iGM(p=n.CRH())&&(m.genericGridTDSAccountSubLedger=p.first)}},hostBindings:function(o,m){1&o&&n.NdJ("keydown",function(S){return m.EnableMinusKeyPress(S)})("keydown",function(S){return m.handleKeyDownboardEvent(S)},!1,n.evT)},outputs:{onMemberIDSearch:"onMemberIDSearch",onMemberReferIDSearch:"onMemberReferIDSearch",onClickSlider:"onClickSlider"},decls:9,vars:5,consts:[["class","backdrop",4,"ngIf"],["class","toggable-sidebar",3,"ngClass",4,"ngIf"],[3,"onsubmit"],["CreateMembership",""],[3,"popupsettings","onItemDoubleClick"],["genericGridTDSAccount",""],["genericGridTDSAccountSubLedger",""],[1,"backdrop"],[1,"toggable-sidebar",3,"ngClass"],["id","toggleButton",1,"btn","btn-info","btn-toggler",3,"click"],[1,"fa","fa-angle-double-left",3,"ngClass"],[1,"sidebar"],[1,"table","table-summary",2,"margin-bottom","0"],["class","mx-auto my-1 mt-2 box1",4,"ngIf"],[1,"table","table-summary"],["class","mx-auto my-1 mb-3 box1",4,"ngIf"],["class","mx-auto my-1 mb-2 box1",4,"ngIf"],[4,"ngIf"],[1,"mx-auto","my-1","mt-2","box1"],["class","buttons",4,"ngIf"],["type","number",2,"height","23px","width","95%",3,"disabled","ngModel","ngModelChange"],["type","number",2,"height","23px","width","95%",3,"disabled","ngModel","ngModelChange","change"],[1,"buttons"],[1,"actionbtn"],["class","btn btn-info ",3,"disabled","click",4,"ngIf"],["class","btn btn-info",3,"disabled","click",4,"ngIf"],[1,"btn","btn-info",3,"disabled","click"],[1,"mx-auto","my-1","mb-3","box1"],[1,"widthField"],["type","number",2,"height","23px","width","95%",3,"disabled","ngModel","readonly","ngModelChange"],["type","number","placeholder","Press Alt+Enter for Rounding",2,"height","23px","width","95%","font-size","12px",3,"disabled","ngModel","ngModelChange","keydown.enter","keydown.alt.enter"],[1,"mx-auto","my-1","mb-2","box1"],["type","number",2,"height","23px","width","95%",3,"disabled","readonly","ngModel"],["type","text","placeholder","Press Enter to select Account",2,"height","23px","width","95%",3,"disabled","ngModel","ngModelChange","keydown.enter","keyup","keypress"],["type","text","readonly","",2,"height","23px","width","95%","font-size","12px",3,"disabled","ngModel","ngModelChange"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","0rem","margin-right","-1rem"],[1,"modal-content","modal-content-main-area",2,"width","53%"],[1,"modal-header",2,"padding","0px","background","#c0c0c0"],[1,"modal-title",2,"padding-left","5px"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-control-label",2,"font-size","14px"],[1,"modal-footer"],["type","button",1,"btn","btn-sm","btn-info",2,"font-size","10px","padding","6px",3,"click"],[1,"btn","btn-info","btn-toggler",3,"click"],[1,"table","table-summary",2,"text-align","left","white-space","nowrap"],[1,"box1","my-1","mx-auto"],["type","text","disabled","_trnMainService.TrnMainObj.VoucherType == 15",2,"height","23px","width","7.5rem",3,"ngModel","click","focusout","focusin","ngModelChange"],[2,"font-weight","500"],[2,"border-top","none"],[2,"border-top","none","font-weight","500"],["type","text","placeholder","Press Enter to Select",2,"height","23px","width","7.5rem",3,"ngModel","disabled","focusout","focusin","ngModelChange"],[2,"color","brown"],["type","number",2,"height","23px","width","85%","margin-right","5rem",3,"disabled","ngModel","readonly","ngModelChange"],["id","roundOffInput","type","number","placeholder","Press Alt+Enter for Rounding",2,"height","23px","width","95%","font-size","12px",3,"disabled","ngModel","ngModelChange","keydown.enter","keydown.alt.enter"],[2,"color","green"]],template:function(o,m){1&o&&(n.YNc(0,N,1,0,"div",0),n.YNc(1,_e,12,10,"div",1),n.YNc(2,pe,57,29,"div",1),n.TgZ(3,"create-membership-dialog",2,3),n.NdJ("onsubmit",function(S){return m.onSaveMembership(S)}),n.qZA(),n.TgZ(5,"generic-popup-grid",4,5),n.NdJ("onItemDoubleClick",function(S){return m.onTDSAccountSelect(S)}),n.qZA(),n.TgZ(7,"generic-popup-grid",4,6),n.NdJ("onItemDoubleClick",function(S){return m.onTDSAccountSubLedgerSelect(S)}),n.qZA()),2&o&&(n.Q6J("ngIf",m.hideShow),n.xp6(1),n.Q6J("ngIf",14!=m._trnMainService.TrnMainObj.VoucherType&&"purchase-import-order"!=m.activeurlpath&&"asset-purchase-invoice"!=m.activeurlpath),n.xp6(1),n.Q6J("ngIf",(14==m._trnMainService.TrnMainObj.VoucherType||57==m._trnMainService.TrnMainObj.VoucherType||"abbreviated-sales-invoice"==m.activeurlpath||15==m._trnMainService.TrnMainObj.VoucherType)&&"self-billing"!=m.activeurlpath),n.xp6(3),n.Q6J("popupsettings",m.genericGridTDSAccountSetting),n.xp6(2),n.Q6J("popupsettings",m.genericGridTDSAccountSubLedgerSetting))},dependencies:[e.mk,e.O5,w.Fj,w.wV,w.JJ,w.On,y.Zl,f,O.g,I],styles:[".toggable-sidebar[_ngcontent-%COMP%]{position:fixed;right:-22%;transition:.3s;width:260px;text-decoration:none;font-size:11px;font-weight:600;border-radius:0 5px 5px 0;color:#000;height:100%;width:22%;margin:0;z-index:2}@media (max-width: 1191px){.toggable-sidebar[_ngcontent-%COMP%]{right:-20%}}.mySidenav-show[_ngcontent-%COMP%]{right:0}@media (max-width: 1074px){.mySidenav-show[_ngcontent-%COMP%]{right:1rem}}.btn-toggler[_ngcontent-%COMP%]{position:absolute;left:-45px;top:-3px;background:#81DAAC!important;border-color:#81daac!important;padding:5px!important;font-size:10px!important;width:45px!important;z-index:3}.toggler-btn-icon-reverse[_ngcontent-%COMP%]{transform:rotate(180deg)}.table[_ngcontent-%COMP%], .billTender[_ngcontent-%COMP%]{background:#c0c0c0}.table-summary[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{font-size:12px;font-weight:700}.table-summary[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child{text-align:left!important}.actionbtn[_ngcontent-%COMP%]{padding:.25rem}.btn-info[_ngcontent-%COMP%]{font-size:9px}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:11px;border:none!important}.box[_ngcontent-%COMP%]{border:1px solid grey;border-radius:1px}.hoverRounding[_ngcontent-%COMP%]{background:#17a2b8;position:fixed;border-radius:11px;text-align:center;vertical-align:middle;color:#fff;margin-top:-3.5%;right:26px;height:48px;font-size:12px;font-weight:500;line-height:23px;width:40px}@media (min-width: 1370px){.hoverRounding[_ngcontent-%COMP%]{right:42px;margin-top:-3.2%}}@media (max-height: 670px){.sidebar[_ngcontent-%COMP%]{height:526px;overflow-y:auto}}.box1[_ngcontent-%COMP%]{border:2px solid #e9e9e9;width:87%;border-radius:15px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:24%;padding:7px 5px!important}.buttons[_ngcontent-%COMP%]{display:flex;align-content:center;justify-content:space-evenly}input[_ngcontent-%COMP%]::placeholder{font-size:smaller}.backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#3d3c3c80;z-index:1}"]}),T})()},471:(re,q,g)=>{g.d(q,{X:()=>d});var n=g(36336),y=g(63504),H=g(92340),_=g(53074),v=g(87584),F=g(67311),Z=g(14970),U=g(92752);const k=["customerName"];function e(u,h){1&u&&(n.TgZ(0,"span"),n._uU(1,"Name is required."),n.qZA())}function w(u,h){if(1&u&&(n.TgZ(0,"div",25),n.YNc(1,e,2,0,"span",26),n.qZA()),2&u){const l=n.oxw(2);n.xp6(1),n.Q6J("ngIf",l.form.controls.name.errors.required)}}function G(u,h){1&u&&(n.TgZ(0,"span"),n._uU(1,"Name is required."),n.qZA())}function J(u,h){if(1&u&&(n.TgZ(0,"div",25),n.YNc(1,G,2,0,"span",26),n.qZA()),2&u){const l=n.oxw(2);n.xp6(1),n.Q6J("ngIf",l.form.controls.name.errors.required)}}function b(u,h){1&u&&(n.TgZ(0,"span"),n._uU(1,"Address is required."),n.qZA())}function f(u,h){if(1&u&&(n.TgZ(0,"div",25),n.YNc(1,b,2,0,"span",26),n.qZA()),2&u){const l=n.oxw(2);n.xp6(1),n.Q6J("ngIf",l.form.controls.address.errors.required)}}function O(u,h){1&u&&(n.TgZ(0,"span"),n._uU(1,"Pan No is required."),n.qZA())}function I(u,h){if(1&u&&(n.TgZ(0,"div",25),n.YNc(1,O,2,0,"span",26),n.qZA()),2&u){const l=n.oxw(2);n.xp6(1),n.Q6J("ngIf",l.form.controls.pan.errors.required)}}function D(u,h){1&u&&(n.TgZ(0,"span"),n._uU(1,"Pan No is required."),n.qZA())}function R(u,h){if(1&u&&(n.TgZ(0,"div",25),n.YNc(1,D,2,0,"span",26),n.qZA()),2&u){const l=n.oxw(2);n.xp6(1),n.Q6J("ngIf",l.form.controls.pan.errors.required)}}function M(u,h){1&u&&(n.TgZ(0,"span"),n._uU(1,"PAN No must be 9 digit long."),n.qZA())}function N(u,h){if(1&u&&(n.TgZ(0,"div",25),n.YNc(1,M,2,0,"span",26),n.qZA()),2&u){const l=n.oxw(2);n.xp6(1),n.Q6J("ngIf",l.form.controls.pan.errors.minlength||l.form.controls.pan.errors.maxlength)}}function C(u,h){1&u&&(n.TgZ(0,"span"),n._uU(1,"Mobile No is required."),n.qZA())}function x(u,h){if(1&u&&(n.TgZ(0,"div",25),n.YNc(1,C,2,0,"span",26),n.qZA()),2&u){const l=n.oxw(2);n.xp6(1),n.Q6J("ngIf",l.form.controls.mobNo.errors.required)}}function Q(u,h){1&u&&(n.TgZ(0,"span"),n._uU(1,"Mobile No is required."),n.qZA())}function X(u,h){if(1&u&&(n.TgZ(0,"div",25),n.YNc(1,Q,2,0,"span",26),n.qZA()),2&u){const l=n.oxw(2);n.xp6(1),n.Q6J("ngIf",l.form.controls.mobNo.errors.required)}}function z(u,h){1&u&&(n.TgZ(0,"span"),n._uU(1,"Mobile No must be 10 digit long."),n.qZA())}function $(u,h){if(1&u&&(n.TgZ(0,"div",25),n.YNc(1,z,2,0,"span",26),n.qZA()),2&u){const l=n.oxw(2);n.xp6(1),n.Q6J("ngIf",l.form.controls.mobNo.errors.minlength||l.form.controls.mobNo.errors.maxlength)}}function ee(u,h){1&u&&(n.TgZ(0,"div",11)(1,"label",12),n._uU(2,"MOBILE NO REGISTER IN:"),n.qZA(),n.TgZ(3,"div",13)(4,"select",27),n._UZ(5,"option",28),n.TgZ(6,"option",29),n._uU(7,"Viber"),n.qZA(),n.TgZ(8,"option",30),n._uU(9,"Whatsapp"),n.qZA()()()())}function ne(u,h){if(1&u&&(n.ynx(0),n.TgZ(1,"option",31),n._uU(2),n.qZA(),n.BQk()),2&u){const l=h.$implicit;n.xp6(1),n.Q6J("ngValue",l.SCHEMEID),n.xp6(1),n.Oqu(l.NAME)}}function j(u,h){if(1&u){const l=n.EpF();n.TgZ(0,"div",11)(1,"div",13)(2,"input",32),n.NdJ("change",function(L){n.CHM(l);const V=n.oxw(2);return n.KtG(V.form.value.createMember=L.target.checked?1:0)}),n.qZA(),n.TgZ(3,"label",33),n._uU(4,"Create Customer Profile as Member Also"),n.qZA()(),n._UZ(5,"div",34),n.qZA()}}function B(u,h){if(1&u){const l=n.EpF();n.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"h5",4),n._uU(4,"CREATE CUSTOMER PROFILE"),n.qZA(),n.TgZ(5,"div",5)(6,"button",6),n.NdJ("keydown.F6",function(){n.CHM(l);const L=n.oxw();return n.KtG(L.submit(L.form.value))})("click",function(){n.CHM(l);const L=n.oxw();return n.KtG(L.submit(L.form.value))}),n._uU(7,"SAVE [End]"),n.qZA(),n.TgZ(8,"button",7),n.NdJ("click",function(){n.CHM(l);const L=n.oxw();return n.KtG(L.onclear())})("keydown.F3",function(){n.CHM(l);const L=n.oxw();return n.KtG(L.onclear())}),n._uU(9,"RESET"),n.qZA(),n.TgZ(10,"button",8),n.NdJ("click",function(){n.CHM(l);const L=n.oxw();return n.KtG(L.closeDialog())}),n._uU(11,"CANCEL"),n.qZA()()(),n.TgZ(12,"div",9)(13,"form",10)(14,"div",11)(15,"label",12),n._uU(16,"NAME:"),n.qZA(),n.TgZ(17,"div",13),n._UZ(18,"input",14,15),n.YNc(20,w,2,1,"div",16),n.YNc(21,J,2,1,"div",16),n.qZA()(),n.TgZ(22,"div",11)(23,"label",12),n._uU(24,"ADDRESS:"),n.qZA(),n.TgZ(25,"div",13),n._UZ(26,"input",17),n.YNc(27,f,2,1,"div",16),n.qZA()(),n.TgZ(28,"div",11)(29,"label",12),n._uU(30,"PANNO:"),n.qZA(),n.TgZ(31,"div",13)(32,"input",18),n.NdJ("keypress",function(L){n.CHM(l);const V=n.oxw();return n.KtG(V.keyPress(L))}),n.qZA(),n.YNc(33,I,2,1,"div",16),n.YNc(34,R,2,1,"div",16),n.YNc(35,N,2,1,"div",16),n.qZA()(),n.TgZ(36,"div",11)(37,"label",12),n._uU(38,"PHONE NO:"),n.qZA(),n.TgZ(39,"div",13),n._UZ(40,"input",19),n.qZA()(),n.TgZ(41,"div",11)(42,"label",12),n._uU(43,"MOBILE NO:"),n.qZA(),n.TgZ(44,"div",13)(45,"input",20),n.NdJ("keypress",function(L){n.CHM(l);const V=n.oxw();return n.KtG(V.keyPress(L))}),n.qZA(),n.YNc(46,x,2,1,"div",16),n.YNc(47,X,2,1,"div",16),n.YNc(48,$,2,1,"div",16),n.qZA()(),n.YNc(49,ee,10,0,"div",21),n.TgZ(50,"div",11)(51,"label",12),n._uU(52,"EMAIL:"),n.qZA(),n.TgZ(53,"div",13),n._UZ(54,"input",22),n.qZA()(),n.TgZ(55,"div",11)(56,"label",12),n._uU(57,"Scheme:"),n.qZA(),n.TgZ(58,"div",13)(59,"select",23),n.YNc(60,ne,3,2,"ng-container",24),n.qZA()()(),n.YNc(61,j,6,0,"div",21),n.qZA()()()()}if(2&u){const l=n.oxw();n.xp6(6),n.Q6J("disabled",l.form.invalid),n.xp6(7),n.Q6J("formGroup",l.form),n.xp6(7),n.Q6J("ngIf",!l.isSubmitting&&l.form.controls.name.invalid&&(l.form.controls.name.dirty||l.form.controls.name.touched)),n.xp6(1),n.Q6J("ngIf",l.isSubmitting&&l.form.controls.name.invalid),n.xp6(6),n.Q6J("ngIf",!l.isSubmitting&&l.form.controls.address.invalid&&(l.form.controls.address.dirty||l.form.controls.address.touched)),n.xp6(6),n.Q6J("ngIf",!l.isSubmitting&&l.form.controls.pan.invalid&&(l.form.controls.pan.dirty||l.form.controls.pan.touched)),n.xp6(1),n.Q6J("ngIf",l.isSubmitting&&l.form.controls.pan.invalid),n.xp6(1),n.Q6J("ngIf",!l.isSubmitting&&l.form.controls.pan.invalid&&(l.form.controls.pan.dirty||l.form.controls.pan.touched)),n.xp6(11),n.Q6J("ngIf",!l.isSubmitting&&l.form.controls.mobNo.invalid&&(l.form.controls.mobNo.dirty||l.form.controls.mobNo.touched)),n.xp6(1),n.Q6J("ngIf",l.isSubmitting&&l.form.controls.mobNo.invalid),n.xp6(1),n.Q6J("ngIf",!l.isSubmitting&&l.form.controls.mobNo.invalid&&(l.form.controls.mobNo.dirty||l.form.controls.mobNo.touched)),n.xp6(1),n.Q6J("ngIf",l.form.controls.mobNo.valid&&"lite"!=l.AppMode),n.xp6(11),n.Q6J("ngForOf",l.schemeList),n.xp6(1),n.Q6J("ngIf",1==l.masterservice.userSetting.CREATE_CPROFILE_AS_MEMBER&&"lite"!=l.AppMode)}}let d=(()=>{class u{constructor(l,E,L,V,ce){this.fb=l,this.masterservice=E,this._trnMainService=L,this.alertService=V,this.spinnerService=ce,this.isSubmitting=!1,this.isSubmitted=!1,this.onSave=new n.vpe,this.mode="add",this.dropdownList=[],this.selectedItems=[],this.activerowIndex=0,this.AppMode=H.N.appMode,this.masterservice.getAllDivisions().subscribe(ie=>{this.dropdownList=ie}),this.masterservice.getMemCatList().subscribe(ie=>{this.schemeList=ie})}ngOnInit(){this.dropdownSettings={singleSelection:!1,idField:"INITIAL",textField:"NAME",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:3,allowSearchFilter:!1,maxHeight:100}}forminit(){this.form=this.fb.group({name:["",[y.kI.required]],address:[""],pan:["",[y.kI.minLength(9),y.kI.maxLength(9)]],phoneNo:[""],mobNo:["",[y.kI.minLength(10),y.kI.maxLength(10)]],email:[""],createMember:[""],MOBILENO_REG_IN:[""],FurtherProceed:[""],divisionMapping:[""],ShippingList:[[]],VehicleList:[[]],STATUS:[1],SCHEMEID:[""]}),this.form.controls.createMember.patchValue(1==this.masterservice.userSetting.CREATE_CPROFILE_AS_MEMBER?1:0)}submit(l){this.isSubmitting=!0,1!=this.masterservice.userSetting.CREATE_CPROFILE_AS_MEMBER||1!=this.form.value.createMember||14===this._trnMainService.TrnMainObj.VoucherType||1===this._trnMainService.TrnMainObj.VoucherType||""!=this.form.value.mobNo?((""==this.form.value.mobNo||null==this.form.value.mobNo)&&(this.form.value.MOBILENO_REG_IN=""),"B2B"!==this.masterservice.userSetting.CompanyType||""!=this.form.value.pan?(this.spinnerService.show("Please Wait Data is Saving"),console.log("saveing cutomer prodile",this.form.value),this.masterservice.saveCustomerProfile(this.form.value,this.mode).subscribe(E=>{"ok"==E.status?(this.closeDialog(),this.spinnerService.hide(),"ProceedConfirmation"==E.result?confirm("Member is not Created in  Server.Do you want to Process..")?(this.form.value.FurtherProceed="ProceedConfirmationYes",this.submit(this.form.value)):(this.onclear(),this.alertService.hide()):(this.onclear(),this.alertService.info(E.result),setTimeout(()=>{this.alertService.hide()},500),this.alertService.emitShowHideSubject.subscribe(L=>{setTimeout(()=>{document.getElementById("barcode"+this.activerowIndex).focus()},0)}),this.onSave.emit(E.result2))):(this.alertService.info(E.result),this.spinnerService.hide())},E=>{this.spinnerService.hide()})):this.alertService.info("PAN/VAT No is Required")):this.alertService.info("Please Enter Mobile No. First!")}onclear(){this.form.reset(),1==this.masterservice.userSetting.CREATE_CPROFILE_AS_MEMBER&&this.form.controls.createMember.patchValue(!0)}closeDialog(){this.isActive=!1,this.masterservice.customerpopup=!1}keyPress(l){const L=String.fromCharCode(l.charCode);/[0-9]/.test(L)||l.preventDefault()}show(){this.isActive=!0,this.forminit(),this.masterservice.customerpopup=!0,setTimeout(()=>{this.customerName.nativeElement.focus()},10)}hide(){this.isActive=!1,this.masterservice.customerpopup=!1}handleKeyDownboardEvent(l){"Escape"==l.code&&(l.preventDefault(),this.closeDialog()),"End"==l.code&&(this.form.invalid||(l.preventDefault(),this.submit(this.form.value)))}onItemSelect(l){console.log(l)}onSelectAll(l){console.log(l)}}return u.\u0275fac=function(l){return new(l||u)(n.Y36(y.qu),n.Y36(_.P),n.Y36(v.p),n.Y36(F.c),n.Y36(Z.V))},u.\u0275cmp=n.Xpm({type:u,selectors:[["create-customer-dialog"]],viewQuery:function(l,E){if(1&l&&n.Gf(k,5),2&l){let L;n.iGM(L=n.CRH())&&(E.customerName=L.first)}},hostBindings:function(l,E){1&l&&n.NdJ("keydown",function(V){return E.handleKeyDownboardEvent(V)},!1,n.evT)},outputs:{onSave:"onSave"},decls:1,vars:1,consts:[["class","customer_container",4,"ngIf"],[1,"customer_container"],[1,"card"],[1,"card-header"],[1,"page-title"],[1,"button-group"],["title","Save","type","submit",1,"btn","btn-info",2,"margin-right","2px",3,"disabled","keydown.F6","click"],["type","button","title","reset",1,"btn","btn-info",2,"margin-right","2px",3,"click","keydown.F3"],["type","button","title","Cancel",1,"btn","btn-info",3,"click"],[1,"card-body"],[1,"form-horizontal",2,"margin-top","15px",3,"formGroup"],[1,"form-group","row"],[1,"col-sm-3","form-control-label",2,"margin-left","-12px"],[1,"col-sm-5"],["type","text","placeholder","NAME","formControlName","name",1,"form-control"],["customerName",""],["class","invalid-feedback d-block",4,"ngIf"],["type","text","placeholder","ADDRESS","formControlName","address",1,"form-control"],["type","text","placeholder","PANNO","formControlName","pan","maxlength","9","minlength","9",1,"form-control",3,"keypress"],["type","text","placeholder","PHONE NO","formControlName","phoneNo",1,"form-control"],["type","text","placeholder","MOBILE NO","formControlName","mobNo","maxlength","10","minlength","10",1,"form-control",3,"keypress"],["class","form-group row",4,"ngIf"],["type","email","placeholder","EMAIL","formControlName","email",1,"form-control"],["formControlName","SCHEMEID",1,"form-control",2,"padding","0px 5px"],[4,"ngFor","ngForOf"],[1,"invalid-feedback","d-block"],[4,"ngIf"],["formControlName","MOBILENO_REG_IN",1,"form-control",2,"padding","0px 5px"],["value",""],["value","VIBER"],["value","WHATSAPP"],[3,"ngValue"],["type","checkbox","id","createMember","formControlName","createMember",1,"form-control",2,"height","59%","width","5%",3,"change"],[1,"form-control-label",2,"width","100%","margin-top","-3%","margin-left","6%"],[1,"col-sm-3"]],template:function(l,E){1&l&&n.YNc(0,B,62,14,"div",0),2&l&&n.Q6J("ngIf",E.isActive)},dependencies:[U.sg,U.O5,y._Y,y.YN,y.Kr,y.Fj,y.Wl,y.EJ,y.JJ,y.JL,y.wO,y.nD,y.sg,y.u],styles:[".customer_container[_ngcontent-%COMP%]{position:fixed!important;transform:translate(-50px,-50px);background:#ffffff;z-index:99999;width:60%;top:14.5%;left:22%;border-radius:.65rem}.card[_ngcontent-%COMP%]{box-shadow:#00000026 0 2px 8px;border-radius:.65rem}.page-title[_ngcontent-%COMP%]{text-align:center}.form-control[_ngcontent-%COMP%]{font-size:12px;height:25px}.button-group[_ngcontent-%COMP%]{position:absolute;right:3%;top:3%}.card-body[_ngcontent-%COMP%]{line-height:.4rem}.custom-asset-dropdown[_ngcontent-%COMP%]    {line-height:13px;font-size:14px}.selectbox[_ngcontent-%COMP%]{padding:0 8px}"]}),u})()},65705:(re,q,g)=>{g.d(q,{C:()=>w});var n=g(92752),y=g(53181),H=g(42326),_=g(36336),v=g(53074),F=g(67311),Z=g(87584),U=g(63504),k=g(89952);function e(G,J){if(1&G){const b=_.EpF();_.TgZ(0,"tr")(1,"td")(2,"input",21),_.NdJ("ngModelChange",function(O){const D=_.CHM(b).$implicit;return _.KtG(D.sno=O)}),_.qZA()(),_.TgZ(3,"td"),_._UZ(4,"input",22),_.qZA(),_.TgZ(5,"td")(6,"input",23),_.NdJ("ngModelChange",function(O){const D=_.CHM(b).$implicit;return _.KtG(D.discountRate=O)})("blur",function(){const I=_.CHM(b).index,D=_.oxw();return _.KtG(D.onChangeDiscountRate(I))}),_.qZA()(),_.TgZ(7,"td")(8,"input",23),_.NdJ("ngModelChange",function(O){const D=_.CHM(b).$implicit;return _.KtG(D.discountAmount=O)})("blur",function(){const I=_.CHM(b).index,D=_.oxw();return _.KtG(D.calculateAmount(I))}),_.qZA()(),_.TgZ(9,"td"),_._UZ(10,"input",24),_.qZA()()}if(2&G){const b=J.$implicit,f=J.index,O=_.oxw();_.xp6(2),_.MGl("id","sno",f,""),_.Q6J("ngModel",b.sno),_.xp6(2),_.MGl("id","discountName",f,""),_.Q6J("value",b.discountName),_.xp6(2),_.MGl("id","discountRate",f,""),_.Q6J("ngModel",b.discountRate)("disabled",O.disableContent()||O.shouldDisableRow(f)),_.xp6(2),_.MGl("id","discountAmount",f,""),_.Q6J("ngModel",b.discountAmount)("disabled",O.disableContent()||O.shouldDisableRow(f)),_.xp6(2),_.MGl("id","amountAfterDiscount",f,""),_.Q6J("value",b.amountAfterDiscount)}}let w=(()=>{class G{constructor(b,f,O,I,D,R){this.dialogRef=b,this.masterService=f,this._alertService=O,this._trnMainService=I,this.decimalPipe=D,this.discountNameList=[],this.DiscountObj={discountRowDetail:[],totalAmount:0,totalDiscountAmount:0,netAmount:0},this.totalAmount=0,this.discountableAmount=0,this.totalDiscount=0,this.netAmount=0,this.originalNetAmount=0,this.mode="ADD",this.flatRate=0,this.indDiscountSum=0,this.totalECSAmount=0,this.isDiscountsAvailable=!1,this.isSO=!1,this.data=R,this.totalAmount=R.grossAmount?R.grossAmount:0,this.DiscountObj.totalAmount=R.grossAmount?R.grossAmount:0,this.indDiscountSum=R.totalIndDiscount?R.totalIndDiscount:0,this.totalECSAmount=R.ecsAmount?R.ecsAmount:0,this.flatDiscountCalcType=R.flatDisCalcType,this.formMode=R.object.Mode,this.voucherabbName=R.object.VoucherAbbName,this.trnObject=R.object,this.activeurlpath=R.urlPath,this._trnMainService.TrnMainObj.VoucherType=R.object.VoucherType,this.trnObject.ProdList.forEach("after"===this.flatDiscountCalcType?M=>{this._trnMainService.checkDiscountMode(M)&&null!=M.MENUCODE&&null!=M.MENUCODE&&(this.discountableAmount+=this._trnMainService.nullToZeroConverter(M.ALTERNATEQUANTIY*M.ALTRATE)+this._trnMainService.nullToZeroConverter(M.ECSAMOUNT)-this._trnMainService.nullToZeroConverter(M.RATEDISCOUNT)-this._trnMainService.nullToZeroConverter(M.INDDISCOUNT))}:M=>{this._trnMainService.checkDiscountMode(M)&&null!=M.MENUCODE&&null!=M.MENUCODE&&(this.discountableAmount+=this._trnMainService.nullToZeroConverter(M.ALTERNATEQUANTIY*M.ALTRATE)+this._trnMainService.nullToZeroConverter(M.ECSAMOUNT)-this._trnMainService.nullToZeroConverter(M.RATEDISCOUNT))}),this.netAmount=this.discountableAmount,this.originalNetAmount=this.discountableAmount,this.isSO=!(!this.trnObject.REFORDBILL||!this.trnObject.REFORDBILL.startsWith("SO")),this.initialDiscountObj?.discountRowDetail.forEach(M=>{M.discountAmount=0,M.discountRate=0,M.amountAfterDiscount=0}),this.initialDiscountObj=R.listDiscounts}ngOnInit(){this.masterService.getDiscountNames().subscribe(b=>{this.discountNameList=b.result,this.populateDiscountDetails()})}onKeydownHandler(b){this.cancel()}cancel(){this.DiscountObj.totalDiscountAmount=this.totalDiscount?this.totalDiscount:0,this.DiscountObj.netAmount=this.netAmount?this.netAmount:0;const b=Array.isArray(this.initialDiscountObj?.discountRowDetail)&&this.initialDiscountObj.discountRowDetail.some(f=>f.discountAmount>0&&null!=f.discountAmount);("abbreviated-sales-invoice"===this.activeurlpath||"add-sales-invoice-wholesale"==this.activeurlpath||"add-sales-invoice"==this.activeurlpath)&&this.isSO||this._trnMainService.TrnMainObj.VoucherType!=H.Km.PerformaSalesInvoice&&"PP"==this._trnMainService.TrnMainObj.VoucherAbbName||"VIEW"==this.formMode?this.dialogRef.close(this.DiscountObj):"NEW"!=this.formMode&&"EDIT"!=this.formMode||!b?this.dialogRef.close(null):(this.initialDiscountObj.totalDiscountAmount=this.initialDiscountObj?.discountRowDetail.reduce((f,O)=>f+(O.discountAmount??0),0),this.dialogRef.close(this.initialDiscountObj))}apply(){this.DiscountObj.discountRowDetail.some(f=>f.discountAmount>0&&null!=f.discountAmount)?(this.DiscountObj.totalDiscountAmount=parseFloat(Number(this.totalDiscount?this.totalDiscount:0).toFixed(2)),this.DiscountObj.netAmount=parseFloat(Number(this.netAmount?this.netAmount:0).toFixed(2))):(this.resetDiscountDetails(),this.DiscountObj.totalDiscountAmount=0),this.dialogRef.close(this.DiscountObj)}resetDiscountDetails(){this.DiscountObj.discountRowDetail.forEach(b=>{b.discountAmount=0,b.discountRate=0,b.amountAfterDiscount=0}),this.updateTotalDiscountAndNetAmount()}populateDiscountDetails(){this.data.listDiscounts&&this.data.listDiscounts.discountRowDetail&&this.data.listDiscounts.discountRowDetail.length>0?(this.DiscountObj.discountRowDetail=this.data.listDiscounts.discountRowDetail.map((b,f)=>({sno:f+1,discountName:b.discountName,discountAmount:b.discountAmount,discountRate:b.discountRate,amountAfterDiscount:b.amountAfterDiscount})),this.mode="VIEW"):this.discountNameList.forEach(b=>{this.DiscountObj.discountRowDetail.push({sno:this.DiscountObj.discountRowDetail.length+1,discountName:b.discountName,discountAmount:0,discountRate:0,amountAfterDiscount:0})}),this.updateTotalDiscountAndNetAmount()}calculateAmount(b,f=!0){const O=this.DiscountObj.discountRowDetail[b];let I=O.discountAmount;if(I<0&&(this._alertService.info("Discount amount cannot be negative!!!"),O.discountAmount=0,I=0),I>this.netAmount)return this._alertService.info("Discount amount cannot be greater than the total amount!!!"),void(O.discountAmount=0);this.changedAmount!=I&&(0===b?O.amountAfterDiscount=this.originalNetAmount-I:(O.amountAfterDiscount=(this.DiscountObj.discountRowDetail[b-1].amountAfterDiscount||this.originalNetAmount)-I,O.amountAfterDiscount=parseFloat(O.amountAfterDiscount.toFixed(2))),f&&(O.discountRate=100*I/(0===b?this.originalNetAmount:this.DiscountObj.discountRowDetail[b-1].amountAfterDiscount||this.originalNetAmount),O.discountRate=parseFloat(O.discountRate.toFixed(2))),this.updateTotalDiscountAndNetAmount())}onChangeDiscountRate(b){const f=this.DiscountObj.discountRowDetail[b];let O=f.discountRate;if(O<0)return this._alertService.info("Discount rate cannot be negative!!!"),f.discountRate=0,void(O=0);if(O>100)return this._alertService.info("Discount rate cannot be more than 100%!!!"),void(f.discountRate=0);if(0===b)f.discountAmount=parseFloat((O/100*this.originalNetAmount).toFixed(2)),f.amountAfterDiscount=parseFloat((this.originalNetAmount-f.discountAmount).toFixed(2));else{const I=this.DiscountObj.discountRowDetail[b-1];f.discountAmount=parseFloat((O/100*(I.amountAfterDiscount||this.originalNetAmount)).toFixed(2)),f.amountAfterDiscount=parseFloat(((I.amountAfterDiscount||this.originalNetAmount)-f.discountAmount).toFixed(2))}this.changedAmount=f.discountAmount,this.updateTotalDiscountAndNetAmount()}updateTotalDiscountAndNetAmount(){this.totalDiscount=this.DiscountObj.discountRowDetail.reduce((b,f)=>b+(f.discountAmount||0),0),this.netAmount=parseFloat((this.originalNetAmount-this.totalDiscount).toFixed(2)),this.DiscountObj.discountRowDetail.forEach((b,f)=>{0===f&&b.discountAmount>0?b.amountAfterDiscount=parseFloat((this.originalNetAmount-b.discountAmount).toFixed(2)):b.discountAmount>0&&(b.amountAfterDiscount=parseFloat(((this.DiscountObj.discountRowDetail[f-1].amountAfterDiscount||this.originalNetAmount)-b.discountAmount).toFixed(2))),b.discountAmount=parseFloat((b.discountAmount||0).toFixed(2))})}shouldDisableRow(b){for(let f=b+1;f<this.DiscountObj.discountRowDetail.length;f++){const O=this.DiscountObj.discountRowDetail[f];if(0!=O.discountAmount||0!=O.discountRate)return!0}return!1}disableContent(){return!("abbreviated-sales-invoice"!==this.activeurlpath&&"add-sales-invoice-wholesale"!=this.activeurlpath&&"add-sales-invoice"!=this.activeurlpath||!this.isSO)||("EDIT"!=this.formMode||"PP"!=this.voucherabbName)&&("VIEW"==this.formMode||"PP"==this.voucherabbName)}}return G.\u0275fac=function(b){return new(b||G)(_.Y36(y.so),_.Y36(v.P),_.Y36(F.c),_.Y36(Z.p),_.Y36(n.JJ),_.Y36(y.WI))},G.\u0275cmp=_.Xpm({type:G,selectors:[["app-discount-detail-popup"]],hostBindings:function(b,f){1&b&&_.NdJ("keydown.escape",function(I){return f.onKeydownHandler(I)},!1,_.evT)},features:[_._Bn([n.JJ])],decls:64,vars:16,consts:[[1,"backdrop","mt-5","pt-5"],[1,"container","main-container"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-lg-7","col-md-7","col-sm-12"],[1,"legend-class"],[1,"col-lg-6","col-md-6","col-sm-12"],[1,"m-0"],[1,"ml-2"],[1,"col-lg-5","col-md-5","col-sm-12"],[1,"btn","btn-info","pull-right",3,"disabled","click"],[1,"btn","btn-info","pull-right",3,"click"],[1,"table-wrap","col-md-12"],[1,"input-width","table","table-striped"],[1,"snWidth"],[4,"ngFor","ngForOf"],[1,"card-footer"],[1,"col-md-12"],[1,"ml-5","mr-5","pull-right"],["disabled","",1,"input-width","input-number",3,"id","ngModel","ngModelChange"],["type","text","disabled","",1,"input-width",3,"id","value"],["type","number",1,"input-width","input-number",3,"id","ngModel","disabled","ngModelChange","blur"],["type","number","disabled","",1,"input-width","input-number",3,"id","value"]],template:function(b,f){1&b&&(_.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4"),_._uU(5,"Additional Discount Detail"),_.qZA()(),_.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"fieldset")(10,"legend",7),_._uU(11,"Discount Details :"),_.qZA(),_.TgZ(12,"div",5)(13,"div",8)(14,"p",9),_._uU(15,"Gross Amount:"),_.TgZ(16,"span",10),_._uU(17),_.ALo(18,"twoDigitNumber"),_.qZA()()(),_.TgZ(19,"div",8)(20,"p",9),_._uU(21,"Discountable Amount:"),_.TgZ(22,"span",10),_._uU(23),_.ALo(24,"twoDigitNumber"),_.qZA()()()()()(),_.TgZ(25,"div",11)(26,"button",12),_.NdJ("click",function(){return f.apply()}),_._uU(27,"Apply"),_.qZA(),_.TgZ(28,"button",12),_.NdJ("click",function(){return f.resetDiscountDetails()}),_._uU(29,"Reset"),_.qZA(),_.TgZ(30,"button",13),_.NdJ("click",function(){return f.cancel()}),_._uU(31,"Cancel"),_.qZA()()(),_.TgZ(32,"div",5)(33,"div",14)(34,"table",15)(35,"thead")(36,"tr")(37,"th",16),_._uU(38,"S.No."),_.qZA(),_.TgZ(39,"th"),_._uU(40,"Discount Name"),_.qZA(),_.TgZ(41,"th"),_._uU(42,"Discount Rate"),_.qZA(),_.TgZ(43,"th"),_._uU(44,"Discount Amount"),_.qZA(),_.TgZ(45,"th"),_._uU(46,"Amount(After Discount)"),_.qZA()()(),_.TgZ(47,"tbody"),_.YNc(48,e,11,12,"tr",17),_.qZA()()()()(),_.TgZ(49,"div",18)(50,"div",5)(51,"div",19)(52,"div",20)(53,"p"),_._uU(54,"Net Amount:"),_.TgZ(55,"span",10),_._uU(56),_.ALo(57,"number"),_.qZA()()(),_.TgZ(58,"div",20)(59,"p"),_._uU(60,"Total Additional Discount:"),_.TgZ(61,"span",10),_._uU(62),_.ALo(63,"twoDigitNumber"),_.qZA()()()()()()()()()),2&b&&(_.xp6(17),_.Oqu(_.lcZ(18,7,f.DiscountObj.totalAmount)),_.xp6(6),_.Oqu(_.lcZ(24,9,f.discountableAmount)),_.xp6(3),_.Q6J("disabled",f.disableContent()),_.xp6(2),_.Q6J("disabled",f.disableContent()),_.xp6(20),_.Q6J("ngForOf",f.DiscountObj.discountRowDetail),_.xp6(8),_.Oqu(_.xi3(57,11,f.netAmount,"1.2-2")),_.xp6(6),_.Oqu(_.lcZ(63,14,f.totalDiscount)))},dependencies:[n.sg,U.Fj,U.wV,U.JJ,U.On,n.JJ,k.g],styles:[".main-container[_ngcontent-%COMP%]{height:auto}.card[_ngcontent-%COMP%]{height:auto;margin-left:auto;margin-right:auto}.backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#3d3c3c80;z-index:9999}legend[_ngcontent-%COMP%]{font-size:11px;font-weight:700;color:#222;width:auto}fieldset[_ngcontent-%COMP%]{margin-bottom:1%;border:1px solid #dbd7d7}.legend-class[_ngcontent-%COMP%]{font-size:13px;font-weight:700;width:auto;margin-bottom:-4px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:26px;font-size:14px;padding-top:0;padding-bottom:0}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:.2rem;vertical-align:top;border-top:1px solid #dee2e6;font-size:14px}th[_ngcontent-%COMP%]{position:sticky;top:-1px;z-index:1;background-color:#6599ff;color:#fff}th[_ngcontent-%COMP%]:first-child{border-bottom:1px solid #dee2e6}.input-width[_ngcontent-%COMP%]{width:100%}.input-number[_ngcontent-%COMP%], .footer-number[_ngcontent-%COMP%]{text-align:right}.btn-info[_ngcontent-%COMP%]{padding:8px 20px;border-radius:2px;font-size:12px;margin:13px 3px!important}.snWidth[_ngcontent-%COMP%]{width:8%}"]}),G})()},9267:(re,q,g)=>{g.d(q,{r:()=>ne});var n=g(36336),y=g(53074),H=g(67311),_=g(87584),v=g(14970),F=g(67297),Z=g(92752),U=g(63504);const k=function(){return{width:"80px"}},e=function(){return{width:"118px"}};function w(j,B){if(1&j&&(n.TgZ(0,"th",21),n._uU(1,"Dis%"),n.qZA()),2&j){const d=n.oxw(2);n.Q6J("ngStyle",1==d.masterService.is_PurchaseOrder?n.DdM(1,k):n.DdM(2,e))}}function G(j,B){if(1&j&&(n.TgZ(0,"th",21),n._uU(1,"Dis Amt"),n.qZA()),2&j){const d=n.oxw(2);n.Q6J("ngStyle",1==d.masterService.is_PurchaseOrder?n.DdM(1,k):n.DdM(2,e))}}function J(j,B){if(1&j&&(n.TgZ(0,"th",21),n._uU(1,"Net Rate"),n.qZA()),2&j){const d=n.oxw(2);n.Q6J("ngStyle",1==d.masterService.is_PurchaseOrder?n.DdM(1,k):n.DdM(2,e))}}function b(j,B){if(1&j){const d=n.EpF();n.TgZ(0,"td",31)(1,"input",42),n.NdJ("ngModelChange",function(h){n.CHM(d);const l=n.oxw().$implicit;return n.KtG(l.DISCOUNT_RATE=h)})("change",function(){n.CHM(d);const h=n.oxw().index,l=n.oxw(2);return n.KtG(l.DiscountPercentChange(h))})("keyup.Tab",function(){n.CHM(d);const h=n.oxw().index,l=n.oxw(2);return n.KtG(l.DiscountPercentChange(h))})("keyup.Enter",function(){n.CHM(d);const h=n.oxw().index,l=n.oxw(2);return n.KtG(l.DiscountPercentChange(h))}),n.qZA()()}if(2&j){const d=n.oxw().$implicit;n.xp6(1),n.Q6J("ngModel",d.DISCOUNT_RATE)}}function f(j,B){if(1&j){const d=n.EpF();n.TgZ(0,"td",31)(1,"input",48),n.NdJ("ngModelChange",function(h){n.CHM(d);const l=n.oxw().$implicit;return n.KtG(l.DISCOUNT_AMOUNT=h)}),n.qZA()()}if(2&j){const d=n.oxw().$implicit;n.xp6(1),n.Q6J("ngModel",d.DISCOUNT_AMOUNT)}}function O(j,B){if(1&j){const d=n.EpF();n.TgZ(0,"td",31)(1,"input",48),n.NdJ("ngModelChange",function(h){n.CHM(d);const l=n.oxw().$implicit;return n.KtG(l.NET_RATE=h)}),n.qZA()()}if(2&j){const d=n.oxw().$implicit;n.xp6(1),n.Q6J("ngModel",d.NET_RATE)}}const I=function(){return{width:"150px"}},D=function(){return{width:"165px"}};function R(j,B){if(1&j){const d=n.EpF();n.TgZ(0,"tr")(1,"td",29)(2,"label",30),n._uU(3),n.qZA()(),n.TgZ(4,"td",31)(5,"input",32),n.NdJ("ngModelChange",function(h){const E=n.CHM(d).$implicit;return n.KtG(E.MENUCODE=h)}),n.qZA()(),n.TgZ(6,"td",33)(7,"input",34),n.NdJ("ngModelChange",function(h){const E=n.CHM(d).$implicit;return n.KtG(E.DESCA=h)}),n.qZA()(),n.TgZ(8,"td",35)(9,"input",32),n.NdJ("ngModelChange",function(h){const E=n.CHM(d).$implicit;return n.KtG(E.UNIT=h)}),n.qZA()(),n.TgZ(10,"td",36)(11,"input",37),n.NdJ("ngModelChange",function(h){const E=n.CHM(d).$implicit;return n.KtG(E.RATE=h)}),n.qZA()(),n.TgZ(12,"td",38)(13,"input",39),n.NdJ("ngModelChange",function(h){const E=n.CHM(d).$implicit;return n.KtG(E.ORDERQTY=h)}),n.qZA()(),n.TgZ(14,"td",40)(15,"input",41),n.NdJ("ngModelChange",function(h){const E=n.CHM(d).$implicit;return n.KtG(E.DELIVERQTY=h)})("change",function(){const l=n.CHM(d).index,E=n.oxw(2);return n.KtG(E.ValidateDeliverQty(l))})("keyup.Tab",function(){const l=n.CHM(d).index,E=n.oxw(2);return n.KtG(E.ValidateDeliverQty(l))})("keyup.Enter",function(){const l=n.CHM(d).index,E=n.oxw(2);return n.KtG(E.ValidateDeliverQty(l))}),n.qZA()(),n.TgZ(16,"td",31)(17,"input",42),n.NdJ("ngModelChange",function(h){const E=n.CHM(d).$implicit;return n.KtG(E.DELIVERRATE=h)})("change",function(){const l=n.CHM(d).index,E=n.oxw(2);return n.KtG(E.ValidateDeliverRate(l))})("keyup.Tab",function(){const l=n.CHM(d).index,E=n.oxw(2);return n.KtG(E.ValidateDeliverRate(l))})("keyup.Enter",function(){const l=n.CHM(d).index,E=n.oxw(2);return n.KtG(E.ValidateDeliverRate(l))}),n.qZA()(),n.YNc(18,b,2,1,"td",43),n.YNc(19,f,2,1,"td",43),n.YNc(20,O,2,1,"td",43),n.TgZ(21,"td",44)(22,"input",45),n.NdJ("ngModelChange",function(h){const E=n.CHM(d).$implicit;return n.KtG(E.AMOUNT=h)}),n.qZA()(),n.TgZ(23,"td",46)(24,"input",47),n.NdJ("ngModelChange",function(h){const E=n.CHM(d).$implicit;return n.KtG(E.MFGDATE=h)}),n.qZA()(),n.TgZ(25,"td",46)(26,"input",47),n.NdJ("ngModelChange",function(h){const E=n.CHM(d).$implicit;return n.KtG(E.EXPIRYDATE=h)}),n.qZA()()()}if(2&j){const d=B.$implicit,u=B.index,h=n.oxw(2);n.xp6(3),n.Oqu(u+1),n.xp6(2),n.Q6J("ngModel",d.MENUCODE),n.xp6(2),n.Q6J("ngModel",d.DESCA),n.xp6(2),n.Q6J("ngModel",d.UNIT),n.xp6(2),n.Q6J("ngModel",d.RATE),n.xp6(2),n.Q6J("ngModel",d.ORDERQTY),n.xp6(2),n.Q6J("ngModel",d.DELIVERQTY),n.xp6(2),n.Q6J("ngModel",d.DELIVERRATE),n.xp6(1),n.Q6J("ngIf",h.masterService.is_PurchaseOrder),n.xp6(1),n.Q6J("ngIf",h.masterService.is_PurchaseOrder),n.xp6(1),n.Q6J("ngIf",h.masterService.is_PurchaseOrder),n.xp6(2),n.Q6J("ngModel",d.AMOUNT)("readonly",!0),n.xp6(2),n.Q6J("ngStyle",1==h.masterService.is_PurchaseOrder?n.DdM(17,I):n.DdM(18,D))("ngModel",d.MFGDATE),n.xp6(2),n.Q6J("ngStyle",1==h.masterService.is_PurchaseOrder?n.DdM(19,I):n.DdM(20,D))("ngModel",d.EXPIRYDATE)}}const M=function(){return{width:"45px"}},N=function(){return{width:"0px"}},C=function(){return{width:"60px"}},x=function(){return{width:"100px"}},Q=function(){return{width:"65px"}},X=function(){return{width:"55px"}},z=function(){return{width:"70px"}},$=function(){return{width:"180px"}};function ee(j,B){if(1&j){const d=n.EpF();n.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h4",5),n._uU(5),n.qZA()()(),n.TgZ(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",7)(10,"div",9)(11,"label"),n._uU(12,"Order No. :"),n.qZA(),n.TgZ(13,"label",10),n._uU(14),n.qZA()()(),n.TgZ(15,"div",7)(16,"div",9)(17,"label"),n._uU(18,"Order Date :"),n.qZA(),n.TgZ(19,"label",10),n._uU(20),n.qZA()()()(),n.TgZ(21,"div",8)(22,"div",7)(23,"div")(24,"label"),n._uU(25,"Supplier Name :"),n.qZA(),n.TgZ(26,"label",11),n._uU(27),n.qZA()()()(),n.TgZ(28,"div",8)(29,"div",7)(30,"div",9)(31,"input",12),n.NdJ("ngModelChange",function(h){n.CHM(d);const l=n.oxw();return n.KtG(l.sameQty=h)})("change",function(){n.CHM(d);const h=n.oxw();return n.KtG(h.QtySameAsOrderQty(h.sameQty))}),n.qZA(),n.TgZ(32,"label",10),n._uU(33,"Qty Same as Order Qty"),n.qZA()()(),n.TgZ(34,"div",7)(35,"div",9)(36,"input",12),n.NdJ("ngModelChange",function(h){n.CHM(d);const l=n.oxw();return n.KtG(l.sameRate=h)})("change",function(){n.CHM(d);const h=n.oxw();return n.KtG(h.QtySameAsOrderRate(h.sameRate))}),n.qZA(),n.TgZ(37,"label",10),n._uU(38,"Rate Same as Order Rate"),n.qZA()()()()(),n.TgZ(39,"table",13)(40,"thead",14)(41,"tr")(42,"th",15),n._uU(43,"SI NO "),n.qZA(),n.TgZ(44,"th",16),n._uU(45,"Item Code"),n.qZA(),n.TgZ(46,"th",17),n._uU(47,"Item Name"),n.qZA(),n.TgZ(48,"th",18),n._uU(49,"Unit"),n.qZA(),n.TgZ(50,"th",19),n._uU(51,"Order Rate"),n.qZA(),n.TgZ(52,"th",20),n._uU(53,"Order Qty"),n.qZA(),n.TgZ(54,"th",20),n._uU(55,"Deliver Qty"),n.qZA(),n.TgZ(56,"th",21),n._uU(57,"Rate"),n.qZA(),n.YNc(58,w,2,3,"th",22),n.YNc(59,G,2,3,"th",22),n.YNc(60,J,2,3,"th",22),n.TgZ(61,"th",23),n._uU(62,"Amount"),n.qZA(),n.TgZ(63,"th",24),n._uU(64,"Mfg Date"),n.qZA(),n.TgZ(65,"th",24),n._uU(66,"Exp Date"),n.qZA()()(),n.TgZ(67,"tbody",25),n.YNc(68,R,27,21,"tr",26),n.qZA()()(),n.TgZ(69,"div",27)(70,"button",28),n.NdJ("click",function(){n.CHM(d);const h=n.oxw();return n.KtG(h.OkCommand())}),n._uU(71,"Ok"),n.qZA(),n.TgZ(72,"button",28),n.NdJ("click",function(){n.CHM(d);const h=n.oxw();return n.KtG(h.hide())}),n._uU(73,"Cancel"),n.qZA()()()()}if(2&j){const d=n.oxw();n.xp6(5),n.Oqu(d.masterService.Popup_Heading),n.xp6(9),n.Oqu(d.masterService.PO_Voucherno),n.xp6(6),n.Oqu(d.masterService.PO_Date),n.xp6(7),n.Oqu(d.masterService.SupplierName),n.xp6(4),n.Q6J("ngModel",d.sameQty),n.xp6(5),n.Q6J("ngModel",d.sameRate),n.xp6(6),n.Q6J("ngStyle",1==d.masterService.is_PurchaseOrder?n.DdM(19,M):n.DdM(20,N)),n.xp6(2),n.Q6J("ngStyle",1==d.masterService.is_PurchaseOrder?n.DdM(21,C):n.DdM(22,x)),n.xp6(2),n.Q6J("ngStyle",1==d.masterService.is_PurchaseOrder?n.DdM(23,x):n.DdM(24,I)),n.xp6(2),n.Q6J("ngStyle",n.DdM(1==d.masterService.is_PurchaseOrder?25:26,Q)),n.xp6(2),n.Q6J("ngStyle",1==d.masterService.is_PurchaseOrder?n.DdM(27,k):n.DdM(28,N)),n.xp6(2),n.Q6J("ngStyle",1==d.masterService.is_PurchaseOrder?n.DdM(29,X):n.DdM(30,N)),n.xp6(2),n.Q6J("ngStyle",1==d.masterService.is_PurchaseOrder?n.DdM(31,C):n.DdM(32,N)),n.xp6(2),n.Q6J("ngStyle",1==d.masterService.is_PurchaseOrder?n.DdM(33,z):n.DdM(34,e)),n.xp6(2),n.Q6J("ngIf",d.masterService.is_PurchaseOrder),n.xp6(1),n.Q6J("ngIf",d.masterService.is_PurchaseOrder),n.xp6(1),n.Q6J("ngIf",d.masterService.is_PurchaseOrder),n.xp6(1),n.Q6J("ngStyle",1==d.masterService.is_PurchaseOrder?n.DdM(35,k):n.DdM(36,$)),n.xp6(7),n.Q6J("ngForOf",d._trnMainService.TrnMainObj.PODetailList)}}let ne=(()=>{class j{constructor(d,u,h,l,E){this.masterService=d,this.alertService=u,this._trnMainService=h,this.spinnerService=l,this._authService=E,this.onLoadPO=new n.vpe,this.userSetting=E.getSetting()}ngOnInit(){}show(){this.isActive=!0}hide(){this.isActive=!1}CalculateAmount(d){this._trnMainService.TrnMainObj.PODetailList[d].DELIVERRATE&&(this._trnMainService.TrnMainObj.PODetailList[d].AMOUNT=this._trnMainService.TrnMainObj.PODetailList[d].DELIVERQTY*this._trnMainService.TrnMainObj.PODetailList[d].DELIVERRATE)}ValidateDeliverRate(d){if(this._trnMainService.TrnMainObj.PODetailList[d].DELIVERRATE&&this._trnMainService.TrnMainObj.PODetailList[d].DELIVERRATE<this._trnMainService.TrnMainObj.PODetailList[d].RATE){if(!confirm("Deliver Rate is less than Order Rate.Do you want to continue?"))return;1==this.masterService.is_PurchaseOrder&&1===this.userSetting.HALTSPRICECHAGEDASKED&&(this._trnMainService.showPriceChangeDetail=!0,this._trnMainService.showPriceChangeDetailINDisc=!0,this._trnMainService.getAllSelingPriceOfItem(d)),this.CalculateAmount(d)}if(this._trnMainService.TrnMainObj.PODetailList[d].DELIVERRATE>this._trnMainService.TrnMainObj.PODetailList[d].RATE)return this.alertService.info("Deliver Rate is greater than Order Rate"),void this.alertService.emitShowHideSubject.subscribe(u=>{setTimeout(()=>{this._trnMainService.TrnMainObj.PODetailList[d].DELIVERRATE=0,this.CalculateAmount(d)},0)});this.CalculateAmount(d)}ValidateDeliverQty(d){if(this._trnMainService.TrnMainObj.PODetailList[d].DELIVERQTY&&this._trnMainService.TrnMainObj.PODetailList[d].DELIVERQTY<this._trnMainService.TrnMainObj.PODetailList[d].ORDERQTY){if(!confirm("Deliver Qty is less than Order Qty.Do you want to continue?"))return;this.CalculateAmount(d)}if(this._trnMainService.TrnMainObj.PODetailList[d].DELIVERQTY>this._trnMainService.TrnMainObj.PODetailList[d].ORDERQTY)return this.alertService.info("Deliver Qty is greater than Order Qty"),void this.alertService.emitShowHideSubject.subscribe(u=>{setTimeout(()=>{this._trnMainService.TrnMainObj.PODetailList[d].DELIVERQTY=0,this.CalculateAmount(d)},0)});this.CalculateAmount(d)}OkCommand(){this._trnMainService.TrnMainObj.PODetailList.forEach(h=>h.MCODE=h.MCODE),this._trnMainService.TrnMainObj.PODetailList.forEach(h=>h.VCHRNO=this.masterService.PO_Voucherno);let d=this._trnMainService.TrnMainObj.PODetailList.filter(h=>h.DELIVERRATE==h.RATE);if(d.length>0)for(let h in d)if(d[h].DELIVERRATE==d[h].DELIVERRATE&&!confirm(`Same rate detected in ${d[h].DESCA} . Do you want to continue?`))return;let u=this._trnMainService.TrnMainObj.PODetailList.filter(h=>0==h.DELIVERRATE||null==h.DELIVERRATE||null==h.DELIVERRATE);if(u.length>0){for(let l in u)if(!confirm(`Rate not entered in ${u[l].DESCA} . Do you want to assign it with Order Rate?`))return;u.forEach(l=>l.DELIVERRATE=l.RATE),u.filter(l=>0==l.DELIVERQTY||null==l.DELIVERQTY||null==l.DELIVERQTY).length>0&&u.forEach(l=>l.DELIVERQTY=l.ORDERQTY),u.forEach(l=>l.AMOUNT=l.DELIVERRATE*l.DELIVERQTY)}this.onLoadPO.emit(this._trnMainService.TrnMainObj.PODetailList)}QtySameAsOrderQty(d){1==d?(this._trnMainService.TrnMainObj.PODetailList.forEach(u=>u.DELIVERQTY=u.ORDERQTY),this._trnMainService.TrnMainObj.PODetailList.forEach(u=>u.AMOUNT=u.DELIVERQTY*u.DELIVERRATE)):(this._trnMainService.TrnMainObj.PODetailList.forEach(u=>u.DELIVERQTY=0),this._trnMainService.TrnMainObj.PODetailList.forEach(u=>u.AMOUNT=u.DELIVERQTY*u.DELIVERRATE))}QtySameAsOrderRate(d){1==d?(this._trnMainService.TrnMainObj.PODetailList.forEach(u=>u.DELIVERRATE=u.RATE),this._trnMainService.TrnMainObj.PODetailList.forEach(u=>u.AMOUNT=u.DELIVERQTY*u.DELIVERRATE)):(this._trnMainService.TrnMainObj.PODetailList.forEach(u=>u.DELIVERRATE=0),this._trnMainService.TrnMainObj.PODetailList.forEach(u=>u.AMOUNT=u.DELIVERQTY*u.DELIVERRATE))}DiscountPercentChange(d){this._trnMainService.TrnMainObj.PODetailList[d].DISCOUNT_AMOUNT=this._trnMainService.TrnMainObj.PODetailList[d].DISCOUNT_RATE/100*this._trnMainService.TrnMainObj.PODetailList[d].DELIVERRATE,this._trnMainService.TrnMainObj.PODetailList[d].NET_RATE=this._trnMainService.TrnMainObj.PODetailList[d].DELIVERRATE-this._trnMainService.TrnMainObj.PODetailList[d].DISCOUNT_RATE/100*this._trnMainService.TrnMainObj.PODetailList[d].DELIVERRATE,this._trnMainService.TrnMainObj.PODetailList[d].AMOUNT=this._trnMainService.TrnMainObj.PODetailList[d].NET_RATE*this._trnMainService.TrnMainObj.PODetailList[d].DELIVERQTY}}return j.\u0275fac=function(d){return new(d||j)(n.Y36(y.P),n.Y36(H.c),n.Y36(_.p),n.Y36(v.V),n.Y36(F.e))},j.\u0275cmp=n.Xpm({type:j,selectors:[["load-purchase-order"]],outputs:{onLoadPO:"onLoadPO"},decls:1,vars:1,consts:[["class","purchaseorder_container","role","document","style","max-width: 100%; max-height: 500px; overflow:hidden",4,"ngIf"],["role","document",1,"purchaseorder_container",2,"max-width","100%","max-height","500px","overflow","hidden"],[1,"modal-content",2,"padding","14px 16px 10px 16px","margin","0","width","90vw","height","70vh"],[1,"modal-header","row"],[1,"col-md-7"],[1,"modal-title","pull-right"],[1,"table-responsive"],[1,"row"],[1,"col-md-4"],[1,"col"],[1,"label-class"],[2,"width","200px !important"],["type","checkbox",3,"ngModel","ngModelChange","change"],[1,"table","columformat-class",2,"display","grid","font-size","12px"],[2,"background-color","rgb(184, 184, 184)"],[2,"width","80px",3,"ngStyle"],["scope","col",2,"width","100px","text-align","center",3,"ngStyle"],["scope","col",2,"width","150px","text-align","center",3,"ngStyle"],["scope","col",2,"width","65px","text-align","center",3,"ngStyle"],["scope","col",2,"width","120px","text-align","center",3,"ngStyle"],["scope","col",2,"width","90px","text-align","center",3,"ngStyle"],["scope","col",2,"width","118px","text-align","center",3,"ngStyle"],["scope","col","style","width: 118px; text-align: center;",3,"ngStyle",4,"ngIf"],["scope","col",2,"width","180px","text-align","center",3,"ngStyle"],["scope","col",2,"width","150px","text-align","center"],[2,"font-size","17px","height","190px"],[4,"ngFor","ngForOf"],[1,"modal-footer",2,"height","20px"],["type","button",1,"btn","btn-primary",3,"click"],[1,"columformat-class",2,"width","60px"],[2,"font-size","12px","width","10px"],[1,"columformat-class",2,"width","120px","line-height","32px"],["type","text",1,"form-control",2,"height","26px","margin-top","2px","font-size","12px",3,"ngModel","ngModelChange"],[1,"columformat-class",2,"width","150px","line-height","32px"],["type","text",1,"form-control",2,"color","black","height","26px","margin-top","2px","font-size","12px",3,"ngModel","ngModelChange"],[1,"columformat-class",2,"width","85px","line-height","32px"],[1,"columformat-class",2,"width","110px","line-height","32px"],["type","text",1,"form-control","number-field",2,"height","26px","margin-top","2px","font-size","12px",3,"ngModel","ngModelChange"],[1,"columformat-class",2,"width","90px","line-height","32px","font-size","12px"],["type","number",1,"form-control",2,"height","26px","margin-top","2px","font-size","12px",3,"ngModel","ngModelChange"],[1,"columformat-class",2,"width","90px","line-height","32px"],["type","number",1,"form-control",2,"height","26px","margin-top","2px","font-size","12px",3,"ngModel","ngModelChange","change","keyup.Tab","keyup.Enter"],["type","number",1,"form-control","number-field",2,"height","26px","margin-top","2px","font-size","12px",3,"ngModel","ngModelChange","change","keyup.Tab","keyup.Enter"],["style","width: 120px;line-height: 32px; ","class","columformat-class",4,"ngIf"],[1,"columformat-class",2,"width","180px","line-height","32px"],["type","number",1,"form-control","number-field",2,"height","26px","margin-top","2px","font-size","12px",3,"ngModel","readonly","ngModelChange"],[1,"columformat-class",2,"line-height","32px"],["type","month","max","2999-12-31",1,"form-control",2,"height","26px","margin-top","2px","font-size","12px","width","165px",3,"ngStyle","ngModel","ngModelChange"],["type","number",1,"form-control","number-field",2,"height","26px","margin-top","2px","font-size","12px",3,"ngModel","ngModelChange"]],template:function(d,u){1&d&&n.YNc(0,ee,74,37,"div",0),2&d&&n.Q6J("ngIf",u.isActive)},dependencies:[Z.sg,Z.O5,Z.PC,U.Fj,U.wV,U.Wl,U.JJ,U.On],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{border:1px solid #cbcbcb;border-radius:3px;height:23px;color:#000}","td[_ngcontent-%COMP%] {\n        border: 1px solid #e6e6e6;\n        padding: 1px !important;\n    }\n    \n    input[_ngcontent-%COMP%] {\n        padding: 8px;\n    }\n    \n    .form-group[_ngcontent-%COMP%] {\n        margin-bottom: 0rem;\n    }\n    \n    .purchaseorder_container[_ngcontent-%COMP%] {\n        position: fixed !important;\n        transform: translate(0px, -35px);\n        background: #ffffff;\n        z-index: 99999;\n        width: 90%;\n        top: 22.5%;\n        left: 5%;\n    }\n    \n    .label-class[_ngcontent-%COMP%] {\n        width: 135px;\n    }\n    \n    .btn[_ngcontent-%COMP%] {\n        margin-top: 60px;\n    }\n\n    .number-field[_ngcontent-%COMP%]{\n        text-align: right;\n    }"]}),j})()},90253:(re,q,g)=>{g.d(q,{c:()=>I});var n=g(36336),y=g(53074),H=g(67311),_=g(87584),v=g(14970),F=g(92752),Z=g(63504);const U=["partyGroup"];function k(D,R){if(1&D&&(n.TgZ(0,"option",43),n._uU(1),n.qZA()),2&D){const M=R.$implicit;n.s9C("value",M.ACID),n.xp6(1),n.Oqu(M.ACNAME)}}function e(D,R){if(1&D&&(n.TgZ(0,"option",43),n._uU(1),n.qZA()),2&D){const M=R.$implicit;n.s9C("value",M.OrgTypeCode),n.xp6(1),n.Oqu(M.OrgTypeName)}}function w(D,R){if(1&D){const M=n.EpF();n.TgZ(0,"div",18)(1,"div",26)(2,"label",31),n._uU(3,"PARTY CAT: "),n.qZA()(),n.TgZ(4,"div",44)(5,"select",45),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw(2);return n.KtG(x.partymasterObj.GEO=C)}),n.YNc(6,e,2,2,"option",17),n.qZA()()()}if(2&D){const M=n.oxw(2);n.xp6(5),n.Q6J("ngModel",M.partymasterObj.GEO),n.xp6(1),n.Q6J("ngForOf",M.GeoList)}}function G(D,R){if(1&D&&(n.TgZ(0,"option",43),n._uU(1),n.qZA()),2&D){const M=R.$implicit;n.s9C("value",M.AREANAME),n.xp6(1),n.Oqu(M.AREANAME)}}function J(D,R){if(1&D){const M=n.EpF();n.TgZ(0,"div",18)(1,"div",26)(2,"label",31),n._uU(3,"AREA:"),n.qZA()(),n.TgZ(4,"div",46)(5,"input",47),n.NdJ("change",function(C){n.CHM(M);const x=n.oxw(2);return n.KtG(x.onChangeArea(C))})("ngModelChange",function(C){n.CHM(M);const x=n.oxw(2);return n.KtG(x.partymasterObj.CITY=C)}),n.qZA(),n.TgZ(6,"datalist",48),n.YNc(7,G,2,2,"option",17),n.qZA()()()}if(2&D){const M=n.oxw(2);n.xp6(5),n.Q6J("ngModel",M.partymasterObj.CITY),n.xp6(2),n.Q6J("ngForOf",M.areaList)}}function b(D,R){if(1&D){const M=n.EpF();n.TgZ(0,"div",18),n._UZ(1,"div",26),n.TgZ(2,"div",32)(3,"input",49),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw(2);return n.KtG(x.createMember=C)}),n.qZA(),n.TgZ(4,"label",50),n._uU(5,"Create Customer A/C as Member Also"),n.qZA()()()}if(2&D){const M=n.oxw(2);n.xp6(3),n.Q6J("ngModel",M.createMember)("disabled","V"==M.partymasterObj.PType)}}function f(D,R){if(1&D){const M=n.EpF();n.TgZ(0,"div",51)(1,"fieldset",52)(2,"legend",53),n._uU(3,"Supplier Type :"),n.qZA(),n.TgZ(4,"div",54)(5,"div",55)(6,"input",56),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw(2);return n.KtG(x.partymasterObj.SUPTYPE=C)})("change",function(){n.CHM(M);const C=n.oxw(2);return n.KtG(C.onSupplierTypeChange())}),n.qZA(),n.TgZ(7,"label",57),n._uU(8,"Is VAT Supplier"),n.qZA()(),n.TgZ(9,"div",55)(10,"input",58),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw(2);return n.KtG(x.partymasterObj.SUPTYPE=C)})("change",function(){n.CHM(M);const C=n.oxw(2);return n.KtG(C.onSupplierTypeChange())}),n.qZA(),n.TgZ(11,"label",57),n._uU(12,"Is PAN Supplier"),n.qZA()()()()()}if(2&D){const M=n.oxw(2);n.xp6(6),n.Q6J("ngModel",M.partymasterObj.SUPTYPE),n.xp6(4),n.Q6J("ngModel",M.partymasterObj.SUPTYPE)}}function O(D,R){if(1&D){const M=n.EpF();n.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h4",5),n._uU(5,"PARTY MASTER"),n.qZA()(),n.TgZ(6,"div",6)(7,"button",7),n.NdJ("click",function(){n.CHM(M);const C=n.oxw();return n.KtG(C.cancelPartyPopup())}),n._uU(8,"Cancel"),n.qZA(),n.TgZ(9,"button",8),n.NdJ("click",function(){n.CHM(M);const C=n.oxw();return n.KtG(C.savePartyMaster())}),n._uU(10," Save "),n.qZA()()(),n.TgZ(11,"div",9)(12,"div",10)(13,"div")(14,"div",11)(15,"div",12)(16,"label",13),n._uU(17,"PARTY GROUP:"),n.qZA()(),n.TgZ(18,"div",14)(19,"select",15,16),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.partymasterObj.ACID=C)}),n.YNc(21,k,2,2,"option",17),n.qZA()()(),n.TgZ(22,"div",18)(23,"div",12)(24,"label",19),n._uU(25,"PARTY NAME:"),n.qZA()(),n.TgZ(26,"div",20)(27,"input",21),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.partymasterObj.ACNAME=C)}),n.qZA()()(),n.TgZ(28,"div",18)(29,"div",12)(30,"label",22),n._uU(31,"ADDRESS:"),n.qZA()(),n.TgZ(32,"div",20)(33,"textarea",23),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.partymasterObj.ADDRESS=C)}),n.qZA()()()(),n.TgZ(34,"div",24)(35,"div",25)(36,"div",18)(37,"div",26)(38,"label",27),n._uU(39,"VAT NO:"),n.qZA()(),n.TgZ(40,"div",28)(41,"input",29),n.NdJ("keypress",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.keyPress(C))})("ngModelChange",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.partymasterObj.VATNO=C)}),n.qZA()()(),n.YNc(42,w,7,2,"div",30),n.YNc(43,J,8,2,"div",30),n.TgZ(44,"div",18)(45,"div",26)(46,"label",31),n._uU(47," CREDIT LIMIT:"),n.qZA()(),n.TgZ(48,"div",32)(49,"input",21),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.partymasterObj.CRLIMIT=C)}),n.qZA()()(),n.TgZ(50,"div",18)(51,"div",26)(52,"label",31),n._uU(53,"CREDIT DAYS:"),n.qZA()(),n.TgZ(54,"div",32)(55,"input",21),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.partymasterObj.CRPERIOD=C)}),n.qZA()()(),n.YNc(56,b,6,2,"div",30),n.qZA(),n.TgZ(57,"div",33)(58,"fieldset",34)(59,"legend",35),n._uU(60,"Party Type:"),n.qZA(),n.TgZ(61,"input",36),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.partymasterObj.PType=C)}),n.qZA(),n.TgZ(62,"label"),n._uU(63,"\xa0Customer"),n.qZA(),n._UZ(64,"br"),n.TgZ(65,"input",37),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.partymasterObj.PType=C)}),n.qZA(),n.TgZ(66,"label"),n._uU(67,"\xa0Supplier"),n.qZA()()()(),n.YNc(68,f,13,2,"div",38),n.qZA(),n.TgZ(69,"div",12)(70,"div",18)(71,"label",39),n._uU(72,"PARTY CODE:"),n.qZA(),n.TgZ(73,"input",40),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.partymasterObj.ACCODE=C)}),n.qZA()(),n.TgZ(74,"div",18)(75,"label",41),n._uU(76,"Mobile No.:"),n.qZA(),n.TgZ(77,"input",42),n.NdJ("ngModelChange",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.partymasterObj.MOBILE=C)})("keypress",function(C){n.CHM(M);const x=n.oxw();return n.KtG(x.keyPress(C))}),n.qZA()()()()()()}if(2&D){const M=n.oxw();n.xp6(19),n.Q6J("ngModel",M.partymasterObj.ACID),n.xp6(2),n.Q6J("ngForOf",M.PartyGroupPartyMaster),n.xp6(6),n.Q6J("ngModel",M.partymasterObj.ACNAME),n.xp6(6),n.Q6J("ngModel",M.partymasterObj.ADDRESS),n.xp6(8),n.Q6J("ngModel",M.partymasterObj.VATNO),n.xp6(1),n.Q6J("ngIf","pro"==M.AppMode),n.xp6(1),n.Q6J("ngIf","pro"==M.AppMode),n.xp6(6),n.Q6J("ngModel",M.partymasterObj.CRLIMIT),n.xp6(6),n.Q6J("ngModel",M.partymasterObj.CRPERIOD),n.xp6(1),n.Q6J("ngIf",1==M.masterService.userSetting.CREATE_CPROFILE_AS_MEMBER&&1==M.masterService.isSalesPage),n.xp6(5),n.Q6J("ngModel",M.partymasterObj.PType)("disabled",0==M.masterService.isSalesPage),n.xp6(4),n.Q6J("ngModel",M.partymasterObj.PType)("disabled",1==M.masterService.isSalesPage),n.xp6(3),n.Q6J("ngIf","V"===M.partymasterObj.PType),n.xp6(5),n.Q6J("ngModel",M.partymasterObj.ACCODE),n.xp6(4),n.Q6J("ngModel",M.partymasterObj.MOBILE)}}let I=(()=>{class D{constructor(M,N,C,x){this.masterService=M,this.alertService=N,this._trnMainService=C,this.spinnerService=x,this.PartyGroupPartyMaster=[],this.GeoList=[],this.areaList=[],this.partymasterObj={ACID:"",ACCODE:"",ACNAME:"",ADDRESS:"",VATNO:"",GEO:"",CRLIMIT:"",CRPERIOD:"",PType:"",MOBILE:"",SUPTYPE:""},this.newAccountDetails=[],this.onSaveParty=new n.vpe,this.partymasterObj.CRLIMIT=0,this.partymasterObj.CRPERIOD=0,"TI"==this._trnMainService.TrnMainObj.VoucherPrefix&&(this.partymasterObj.PType="C"),"PI"==this._trnMainService.TrnMainObj.VoucherPrefix&&(this.masterService.isSalesPage=!1,this.partymasterObj.PType="V"),this.masterService.getAreaDetail().subscribe(Q=>{this.areaList=Q.result}),this.masterService.getPartyGroupForQuickPartyMaster().subscribe(Q=>{this.PartyGroupPartyMaster=Q.result}),this.masterService.getGeoList().subscribe(Q=>{"ok"==Q.status&&(this.GeoList=Q.result)}),1==this.masterService.userSetting.CREATE_CPROFILE_AS_MEMBER&&"C"==this.partymasterObj.PType&&(this.createMember=!0)}ngOnInit(){}resetPartyAccount(){this.partymasterObj.ACID="",this.partymasterObj.ACCODE="",this.partymasterObj.ACNAME="",this.partymasterObj.ADDRESS="",this.partymasterObj.VATNO="",this.partymasterObj.GEO="",this.partymasterObj.CITY="",this.partymasterObj.CRLIMIT=0,this.partymasterObj.CRPERIOD=0,this.partymasterObj.MOBILE="",this.partymasterObj.PType=1==this.masterService.isSalesPage?"C":"V"}savePartyMaster(){let M=Object.assign({},this.partymasterObj);if(M.PARENT=this.partymasterObj.ACID,M.CRLIMIT=this.partymasterObj.CRLIMIT?this.partymasterObj.CRLIMIT:0,M.CRPERIOD=this.partymasterObj.CRPERIOD?this.partymasterObj.CRPERIOD:0,M.CATEGORY=this.partymasterObj.GEO,M.ISACTIVE=1,M.PCL="pc002",null!=this.partymasterObj.CITY){let C=this.areaList.filter(x=>x.AREANAME.toUpperCase()==this.partymasterObj.CITY.toUpperCase());M.AREA_ID=C[0]?C[0].AREAID:null}""!=M.ACID?""!=M.ACNAME?""!=M.ADDRESS?("TI"==this._trnMainService.TrnMainObj.VoucherPrefix?(this.partymasterObj.PType="C",M.PType="C"):"PI"==this._trnMainService.TrnMainObj.VoucherPrefix&&(this.partymasterObj.PType="V",M.PType="V",M.SUPTYPE=this.partymasterObj.SUPTYPE),"credit"==this._trnMainService.TrnMainObj.TRNMODE&&(this._trnMainService.TrnMainObj.BILLTO=this.partymasterObj.ACNAME,this._trnMainService.TrnMainObj.BILLTOTEL=this.partymasterObj.VATNO,this._trnMainService.TrnMainObj.BILLTOADD=this.partymasterObj.ADDRESS,this._trnMainService.TrnMainObj.PARAC=this.partymasterObj.ACID,this._trnMainService.TrnMainObj.BILLTOMOB=this.partymasterObj.PHONE),("V"!=M.PType||""!=M.VATNO||confirm("VAT NO. is empty!! Are you sure you want to continue ?"))&&(""==M.VATNO||9==M.VATNO.length?1!=this.masterService.userSetting.CREATE_CPROFILE_AS_MEMBER||1!=this.createMember||"C"!=M.PType||""!=M.MOBILE?""==M.MOBILE||10==M.MOBILE.length?("V"==this.partymasterObj.PType&&(this.createMember=!1),this.mode="add",this.spinnerService.show("Data is saving Please Wait.."),this.masterService.savePartyMaster(this.mode,M,this.createMember).subscribe(C=>{"ok"==C.status?"ProceedConfirmation"==C.result?confirm("Member is not Creadted on server.Do you want to Proced")?(this.createMember=!1,this.savePartyMaster()):this.spinnerService.hide():(this.cancelPartyPopup(),this.alertService.success("Data Saved Successfully"),this.spinnerService.hide(),setTimeout(()=>{this.alertService.hide()},500),this.onSaveParty.emit(C.result2)):(this.spinnerService.hide(),this.alertService.info("Error in Saving Data:"+C))},C=>{this.alertService.info(C.error),this.spinnerService.hide()})):alert("Mobile No. should be nine digit length!"):alert("Please Enter Mobile No. First!"):alert("VAT NO should be nine digit length!"))):alert("Please Enter Address First!"):alert("Please Enter Party Name First!"):alert("Please Select Party Group First!")}cancelPartyPopup(){this.isActive=!1,this.resetPartyAccount()}keyPress(M){const C=String.fromCharCode(M.charCode);/[0-9]/.test(C)||M.preventDefault()}onChangeArea(M){let N=M.target.value,C=[];null!=N&&(C=this.areaList.filter(x=>x.AREANAME.toUpperCase()==N.toUpperCase()),0==C.length&&confirm("Do you want to add new Area"))}show(){this.isActive=!0,setTimeout(()=>{this.partyGroup.nativeElement.focus()},10)}hide(){this.isActive=!1}onSupplierTypeChange(){this.partymasterObj.PType="V"}}return D.\u0275fac=function(M){return new(M||D)(n.Y36(y.P),n.Y36(H.c),n.Y36(_.p),n.Y36(v.V))},D.\u0275cmp=n.Xpm({type:D,selectors:[["quick-party-master"]],viewQuery:function(M,N){if(1&M&&n.Gf(U,5),2&M){let C;n.iGM(C=n.CRH())&&(N.partyGroup=C.first)}},outputs:{onSaveParty:"onSaveParty"},decls:1,vars:1,consts:[["class","party_container","role","document","style","max-width: 100%; max-height: 500px;",4,"ngIf"],["role","document",1,"party_container",2,"max-width","100%","max-height","500px"],[1,"modal-content",2,"padding","14px 16px 10px 16px","margin","0","width","77vw","height","65vh"],[1,"modal-header","row"],[1,"col-md-7"],[1,"modal-title","pull-right"],[1,"col-md-5"],["type","button",1,"btn","btn-info","pull-right",2,"width","80px",3,"click"],["type","button","title","onSave",1,"btn","btn-info","pull-right",2,"margin-right","10px","width","80px","margin-top","15px",3,"click"],[1,"row",2,"overflow-y","auto","overflow-x","hidden"],[1,"col-md-8"],[1,"form-group","row",2,"margin-left","4px"],[1,"col-md-4"],[1,"pull-right","required",2,"font-weight","bold","text-align","right","margin-top","24px","width","92px"],[1,"col-md-8",2,"width","65%","margin-top","20px"],["id","partygroup",1,"form-control",2,"padding","0px 8px",3,"ngModel","ngModelChange"],["partyGroup",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-group","row"],[1,"pull-right","required",2,"font-weight","bold","text-align","right","margin-top","4px"],[1,"col-md-8",2,"width","65%","margin-top","4px"],["type","text",1,"form-control",2,"color","black",3,"ngModel","ngModelChange"],[1,"pull-right","required",2,"margin-top","4px","text-align","right","font-weight","bold"],["rows","2","cols","50",1,"form-control",2,"width","100%","height","40px",3,"ngModel","ngModelChange"],[1,"row"],[1,"col-md-9",2,"padding","0px"],[1,"col-md-5",2,"padding","0px"],[1,"pull-right","required",2,"margin-top","7px","text-align","right","font-weight","bold"],[1,"col-md-7",2,"width","54%","margin-top","9px","padding-left","29px"],["type","text","placeholder","Enter 9 digit vat no.","required","","maxlength","9",1,"form-control",2,"color","black",3,"ngModel","keypress","ngModelChange"],["class","form-group row",4,"ngIf"],[1,"pull-right",2,"margin-top","4px","text-align","right","font-weight","bold"],[1,"col-md-7",2,"width","54%","margin-top","4px","padding-left","30px"],[1,"col-md-3"],[2,"width","125px","height","100px","margin-top","5px"],[2,"font-size","13px","font-weight","bold","text-align","center"],["type","radio","value","C","name","pTypeCustomer",2,"padding-right","15px","height","13px",3,"ngModel","disabled","ngModelChange"],["type","radio","value","V","name","pTypeSupplier",2,"padding-right","15px","height","13px",3,"ngModel","disabled","ngModelChange"],["class","row","style","margin-bottom: 10px !important; padding-left: 270px;",4,"ngIf"],[1,"label","required",2,"margin-top","20px","font-weight","bold"],["type","text",1,"form-control",2,"color","black","width","60%","margin-top","20px",3,"ngModel","ngModelChange"],[1,"label",2,"margin-top","20px","font-weight","bold"],["type","text","maxlength","10",1,"form-control",2,"color","black","width","60%","margin-top","20px",3,"ngModel","ngModelChange","keypress"],[3,"value"],[1,"col-md-7",2,"width","54%","margin-top","5px","padding-left","29px"],[1,"form-control","form-control-sm",2,"padding","0px 8px",3,"ngModel","ngModelChange"],[1,"col-md-7",2,"width","54%","margin-top","4px","padding-left","29px"],["type","text","name","product","list","areaName",1,"form-control",3,"ngModel","change","ngModelChange"],["id","areaName"],["type","checkbox","id","createMember",1,"form-control",2,"height","59%","width","5%",3,"ngModel","disabled","ngModelChange"],[1,"form-control-label",2,"width","100%","margin-top","-12%","margin-left","7%"],[1,"row",2,"margin-bottom","10px !important","padding-left","270px"],[1,"fieldset",2,"width","97%"],[1,"legend",2,"font-size","13px","font-weight","bold","text-align","center"],[1,"row",2,"margin-top","2%","margin-bottom","2%"],[1,"col-sm-6"],["type","radio","value","0","name","supTypeisVAT",2,"height","13px","font-size","12px !important","width","20%",3,"ngModel","ngModelChange","change"],[2,"width","70%","margin-left","-5px","padding-top","7px"],["type","radio","value","1","name","supTypeisPAN",2,"height","13px","font-size","12px !important","width","20%",3,"ngModel","ngModelChange","change"]],template:function(M,N){1&M&&n.YNc(0,O,78,17,"div",0),2&M&&n.Q6J("ngIf",N.isActive)},dependencies:[F.sg,F.O5,Z.YN,Z.Kr,Z.Fj,Z.Wl,Z.EJ,Z._,Z.JJ,Z.Q7,Z.nD,Z.On],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{border:1px solid #cbcbcb;border-radius:3px;height:23px;color:#000}",'td[_ngcontent-%COMP%] {\n    border: 1px solid #e6e6e6;\n  }\n\n  input[_ngcontent-%COMP%] {\n    padding: 8px;\n  }\n\n  .form-group[_ngcontent-%COMP%] {\n    margin-bottom: 0rem;\n  }\n\n  .party_container[_ngcontent-%COMP%] {\n    position: fixed !important;\n    transform: translate(0px, -35px);\n    background: #ffffff;\n    z-index: 99999;\n    width: 77%;\n    top: 22.5%;\n    left: 10%;\n  }\n  .required[_ngcontent-%COMP%]:after {\n  content:" *";\n  color: red;\n}']}),D})()}}]);