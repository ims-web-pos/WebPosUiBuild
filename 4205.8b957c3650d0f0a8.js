"use strict";(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[4205],{62490:(N,M,s)=>{s.d(M,{VO:()=>S,gB:()=>C});var v=s(36336);let C=(()=>{class e{transform(m,c,g){return null==c||null==c||""==c||null==g||null==g||""==g?m:g?m.filter(f=>null!=f[c]&&null!=f[c]&&-1!==f[c].toLowerCase().indexOf(g.toLowerCase())):m}}return e.\u0275fac=function(m){return new(m||e)},e.\u0275pipe=v.Yjl({name:"filter",type:e,pure:!1}),e})(),S=(()=>{class e{transform(m,c){let g=[];for(let f in m)g.push(f);return g}}return e.\u0275fac=function(m){return new(m||e)},e.\u0275pipe=v.Yjl({name:"keys",type:e,pure:!0}),e})()},55618:(N,M,s)=>{s.d(M,{c:()=>b});var v=s(92752),C=s(71800),x=s(72533),S=s(18488),e=s(53074),u=s(63504),m=s(47766),c=s(36336);let g=(()=>{class d{static forRoot(){return{ngModule:d}}}return d.\u0275fac=function(E){return new(E||d)},d.\u0275mod=c.oAB({type:d}),d.\u0275inj=c.cJS({imports:[v.ez,u.u5,u.UX,x.JX]}),d})();var f=s(48496);let b=(()=>{class d{static forRoot(){return{ngModule:d,providers:[e.P,S.G]}}}return d.\u0275fac=function(E){return new(E||d)},d.\u0275mod=c.oAB({type:d}),d.\u0275inj=c.cJS({imports:[v.ez,C.zk.forRoot(),x.JX,v.ez,u.u5,u.UX,m.e,g.forRoot(),f.z.forRoot()]}),d})()},48496:(N,M,s)=>{s.d(M,{z:()=>m});var v=s(92752),C=s(71800),x=s(72533),S=s(83972),e=s(63504),u=s(36336);let m=(()=>{class c{static forRoot(){return{ngModule:c}}}return c.\u0275fac=function(f){return new(f||c)},c.\u0275mod=u.oAB({type:c}),c.\u0275inj=u.cJS({imports:[v.ez,C.zk.forRoot(),x.JX,S.Cl,e.u5]}),c})()},94205:(N,M,s)=>{s.r(M),s.d(M,{MasterMigrationModule:()=>_e});var v=s(92752),C=s(3629),x=s(40216),S=s(49457),e=s(36336),u=s(248),m=s(67311),c=s(14970),g=s(53074),f=s(76165),b=s(92340),d=s(79765),y=s(67297),E=s(71180);let I=(()=>{class o{constructor(t,n,i,l){this.http=t,this.activatedRoute=n,this.authService=i,this.state=l}get apiUrl(){return b.N.apiUrl}get accountApiUrl(){return b.N.accountApiUrl}loadConfig(t){return this.http.get(this.apiUrl+`/getConfig/${t}`)}downloadConfigCSV(t){return console.log("api"+this.apiUrl),this.http.get(this.apiUrl+`/downloadCSV/${t}`).map(n=>({content:new Blob([n._body],{type:n.headers.get("Content-Type")}),filename:`${t}.csv`}))}downloadConfigExcel(t){const i={headers:this.authService.getRequestOption(),method:"get"};return this.http.get(this.apiUrl+`/downloadExcel/${t}`,i).map(l=>({content:new Blob([l._body],{type:l.headers.get("Content-Type")}),filename:`${t}.xlsx`}))}downloadExcelErrorStatus(t){return this.http.get(this.apiUrl+`/downloadExcelErrorStatus/${t}`,{responseType:"blob"})}downloadSampleExcel(t){return this.http.get(this.apiUrl+`/downloadSampleExcelforMasterMigration?importName=${t}`,{responseType:"blob"})}saveConfig(t){let n={status:"error",result:""},i=new d.xQ;const l={headers:this.authService.getRequestOption(),methos:"post"};return this.http.post(this.apiUrl+"/saveConfig",{mode:"EDIT",data:t},l).subscribe(p=>{let _=p.json();"ok"==_.status?(n.status="ok",n.result=_.result,i.next(n),i.unsubscribe()):(n.status="error1",n.result=_.result,console.log(n),i.next(n),i.unsubscribe())},p=>{n.status="error2",n.result=p,console.log(n),i.next(n),i.unsubscribe()}),i}importConfig(t,n,i){let l={status:"error",result:"error"},a=new d.xQ;const p={headers:this.getRequestOptionWithoutContent(),method:"post"};let _=this.apiUrl;return"PARTYLEDGER"===n?_=this.accountApiUrl+"/masterImport/PARTYLEDGER":_+=`/masterImport/${n}/${i}`,this.http.post(_,t,p).subscribe(T=>{a.next(T),a.unsubscribe()},T=>{l.status="error",l.result=T,a.next(l),a.unsubscribe()}),a}loadImportErrorList(t){return this.http.get(this.apiUrl+`/masterImportErrorList/${t}`).map(n=>n.json()||[])}saveCorrectedList(t,n){let i={status:"error",result:""},l=new d.xQ;const a={headers:this.authService.getRequestOption(),method:"post"};return this.http.post(this.apiUrl+`/masterImportCorrection/${n}`,t,a).subscribe(p=>{let _=p.json();"ok"==_.status?(i.status="ok",i.result=_.result,l.next(i),l.unsubscribe()):(i.status="error1",i.result=_.result,console.log(i),l.next(i),l.unsubscribe())},p=>{i.status="error2",i.result=p,console.log(i),l.next(i),l.unsubscribe()}),l}getRequestOptionWithoutContent(){return new f.WM({Authorization:this.authService.getAuth().token})}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(f.eN),e.LFG(C.gz),e.LFG(y.e),e.LFG(E.q))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})();var h=s(63504),A=s(87584),F=s(62490);const w=["fileSelector_Import"],P=["fileUploadPopup"];function L(o,r){if(1&o&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function J(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",36)(1,"label",37),e._uU(2,"Select a Master "),e.qZA(),e.TgZ(3,"div",13)(4,"select",38),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.selectedMasterName=i)}),e.YNc(5,L,2,2,"option",23),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.selectedMasterName),e.xp6(1),e.Q6J("ngForOf",t.masterList)}}function O(o,r){if(1&o&&(e.TgZ(0,"div",20),e.YNc(1,J,6,2,"div",35),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.excelImportConfig.length)}}function Y(o,r){if(1&o&&(e.TgZ(0,"div",20)(1,"label",40),e._uU(2),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.hij("Master :: ",t.selectedMasterName,"")}}function q(o,r){if(1&o){const t=e.EpF();e.ynx(0,43),e.TgZ(1,"tr",44)(2,"td"),e._UZ(3,"input",45),e.qZA(),e.TgZ(4,"td"),e._UZ(5,"input",46),e.qZA(),e.TgZ(6,"td"),e._UZ(7,"input",47),e.qZA(),e.TgZ(8,"td"),e._UZ(9,"input",48),e.qZA(),e.TgZ(10,"td")(11,"input",49),e.NdJ("change",function(i){const a=e.CHM(t).index,p=e.oxw(2);return e.KtG(p.MandatoryChanged(i,a))}),e.qZA()(),e.TgZ(12,"td")(13,"input",50),e.NdJ("change",function(i){const a=e.CHM(t).index,p=e.oxw(2);return e.KtG(p.AddToSheetChanged(i,a))}),e.qZA()(),e.TgZ(14,"td"),e._UZ(15,"input",51),e.qZA()(),e.BQk()}if(2&o){const t=r.index;e.xp6(1),e.Q6J("formGroupName",t)}}function k(o,r){if(1&o&&(e.TgZ(0,"table",41)(1,"thead")(2,"tr")(3,"th"),e._uU(4,"SI NO"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Caption Name"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Column Size"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Data Type"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Mandatory"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Add to Sheet"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Column Value"),e.qZA()()(),e.TgZ(17,"tbody"),e.YNc(18,q,16,1,"ng-container",42),e.qZA()()),2&o){const t=e.oxw();e.xp6(18),e.Q6J("ngForOf",t.form.get("items").controls)}}function Q(o,r){if(1&o&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function R(o,r){if(1&o&&(e.TgZ(0,"option",54),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("ngValue",t.CURNAME),e.xp6(1),e.hij("",t.CURNAME," ")}}function $(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",21)(1,"label"),e._uU(2,"Currency"),e.qZA(),e.TgZ(3,"select",52),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.FCurrency=i)})("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.CurrencyChange())}),e.YNc(4,R,2,2,"option",53),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngModel",t.FCurrency),e.xp6(1),e.Q6J("ngForOf",t.masterService.Currencies)}}function B(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",21)(1,"label"),e._uU(2,"EX Rate"),e.qZA(),e.TgZ(3,"input",55),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.EXRATE=i)}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngModel",t.EXRATE)}}function D(o,r){if(1&o&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function j(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",36)(1,"label",37),e._uU(2,"Select a Master "),e.qZA(),e.TgZ(3,"div",13)(4,"select",38),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.selectedMasterName=i)}),e.YNc(5,D,2,2,"option",23),e.qZA()(),e.TgZ(6,"div",20)(7,"button",56),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.downloadErrorStatus())}),e._uU(8," Download Status "),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.selectedMasterName),e.xp6(1),e.Q6J("ngForOf",t.masterList)}}function G(o,r){if(1&o&&(e.TgZ(0,"div",20),e.YNc(1,j,9,2,"div",35),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.excelImportConfig.length)}}function z(o,r){if(1&o&&(e.TgZ(0,"div",20)(1,"label",40),e._uU(2),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.hij("Master :: ",t.selectedMasterName,"")}}function K(o,r){if(1&o&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.xp6(1),e.hij(" ",t," ")}}function V(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"td")(1,"input",59),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit,p=e.oxw().$implicit;return e.KtG(p[a]=i)}),e.qZA()()}if(2&o){const t=r.$implicit,n=r.index,i=e.oxw(),l=i.index,a=i.$implicit;e.xp6(1),e.hYB("name","",l,"_",n,""),e.Q6J("ngModel",a[t])}}function W(o,r){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,V,2,3,"td",58),e.ALo(2,"keys"),e.qZA()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t))}}function H(o,r){if(1&o&&(e.TgZ(0,"div",57)(1,"table",41)(2,"thead")(3,"tr"),e.YNc(4,K,2,1,"th",58),e.ALo(5,"keys"),e.qZA()(),e.TgZ(6,"tbody"),e.YNc(7,W,3,3,"tr",58),e.qZA()()()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",e.lcZ(5,2,t.importErrorList[0])),e.xp6(3),e.Q6J("ngForOf",t.importErrorList)}}function X(o,r){if(1&o&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.xp6(1),e.hij(" ",t," ")}}function ee(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"td")(1,"input",59),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit,p=e.oxw().$implicit;return e.KtG(p[a]=i)}),e.qZA()()}if(2&o){const t=r.$implicit,n=r.index,i=e.oxw(),l=i.index,a=i.$implicit;e.xp6(1),e.hYB("name","",l,"_",n,""),e.Q6J("ngModel",a[t])}}function te(o,r){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,ee,2,3,"td",58),e.ALo(2,"keys"),e.qZA()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t))}}function oe(o,r){if(1&o&&(e.TgZ(0,"div",57)(1,"table",41)(2,"thead")(3,"tr"),e.YNc(4,X,2,1,"th",58),e.ALo(5,"keys"),e.qZA()(),e.TgZ(6,"tbody"),e.YNc(7,te,3,3,"tr",58),e.qZA()()()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",e.lcZ(5,2,t.importErrorList[0])),e.xp6(3),e.Q6J("ngForOf",t.importErrorList)}}function ie(o,r){if(1&o&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.xp6(1),e.hij(" ",t," ")}}function ne(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"td")(1,"input",59),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit,p=e.oxw().$implicit;return e.KtG(p[a]=i)}),e.qZA()()}if(2&o){const t=r.$implicit,n=r.index,i=e.oxw(),l=i.index,a=i.$implicit;e.xp6(1),e.hYB("name","",l,"_",n,""),e.Q6J("ngModel",a[t])}}function re(o,r){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,ne,2,3,"td",58),e.ALo(2,"keys"),e.qZA()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t))}}function le(o,r){if(1&o&&(e.TgZ(0,"div",57)(1,"table",41)(2,"thead")(3,"tr"),e.YNc(4,ie,2,1,"th",58),e.ALo(5,"keys"),e.qZA()(),e.TgZ(6,"tbody"),e.YNc(7,re,3,3,"tr",58),e.qZA()()()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",e.lcZ(5,2,t.importErrorList[0])),e.xp6(3),e.Q6J("ngForOf",t.importErrorList)}}function se(o,r){if(1&o&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.xp6(1),e.hij(" ",t," ")}}function ae(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"td")(1,"input",59),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit,p=e.oxw().$implicit;return e.KtG(p[a]=i)}),e.qZA()()}if(2&o){const t=r.$implicit,n=r.index,i=e.oxw(),l=i.index,a=i.$implicit;e.xp6(1),e.hYB("name","",l,"_",n,""),e.Q6J("ngModel",a[t])}}function ce(o,r){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,ae,2,3,"td",58),e.ALo(2,"keys"),e.qZA()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t))}}function pe(o,r){if(1&o&&(e.TgZ(0,"div",57)(1,"table",41)(2,"thead")(3,"tr"),e.YNc(4,se,2,1,"th",58),e.ALo(5,"keys"),e.qZA()(),e.TgZ(6,"tbody"),e.YNc(7,ce,3,3,"tr",58),e.qZA()()()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",e.lcZ(5,2,t.importErrorList[0])),e.xp6(3),e.Q6J("ngForOf",t.importErrorList)}}let de=(()=>{class o{constructor(t,n,i,l,a,p,_,T,Z){this.preventNavigationService=t,this.alertService=n,this.loadingService=i,this.masterService=l,this.service=a,this.router=p,this._activatedRoute=_,this.fb=T,this._trnMainService=Z,this.fileUploadPopupSettings=new x.s,this.excelImportConfig=[],this.initialTextReadOnly=!1,this.subcriptions=[],this.FCurrency="",this.importErrorList=[],this.fileList=null,this.getAllMasterList(),this.masterService.Currencies=[],this.masterService.getCurrencies().subscribe(ve=>{this.masterService.Currencies=ve})}ngOnInit(){try{this.resetConfig(),this.onFormChanges()}catch(t){console.log(t),this.alertService.info(t)}}showImportScheme(){this.activeurlpath=this._activatedRoute.snapshot.url[0].path,this.fileUploadPopupSettings=Object.assign(new x.s,{title:"Import Scheme",sampleFileUrl:"/downloadSampleFile/scheme",uploadEndpoints:"/InsertPrimarySecondarySchemes",allowMultiple:!1,acceptFormat:".csv"}),this.fileUploadPopup.show()}UpdateSchemeImport(){this.fileUploadPopupSettings=Object.assign(new x.s,{title:"Update Scheme",sampleFileUrl:"/downloadSampleFile/",uploadEndpoints:"/UpdatePrimarySecondarySchemes",allowMultiple:!1,acceptFormat:".csv"}),this.fileUploadPopup.show()}showImportMargin(){this.fileUploadPopupSettings=Object.assign(new x.s,{title:"Import Margin",uploadEndpoints:"/insertMargins",allowMultiple:!1,acceptFormat:".csv"}),this.fileUploadPopup.show()}UpdateMarginImport(){this.fileUploadPopupSettings=Object.assign(new x.s,{title:"Update Margin",uploadEndpoints:"/UpdateMargins",allowMultiple:!1,acceptFormat:".csv"}),this.fileUploadPopup.show()}fileUploadSuccessStatus(t){"ok"==t.status?this.alertService.success("Upload Successfully"):this.alertService.info("error"==t.status?"Some of the rows cannot be saved. Please check 'Upload Status' for more details.":"Could not uploaded"),this.fileSelector_Import.nativeElement.value=null}fileUploadSuccess(t){if(t&&null!=t&&null!=t&&"ok"==t.status){let n=t.result;console.log("productList"+n),this._trnMainService.TrnMainObj.ProdList=n;for(let i in this._trnMainService.TrnMainObj.ProdList)this._trnMainService.setAltunitDropDownForView(i),this._trnMainService.getPricingOfItem(i,"",!1),this._trnMainService.TrnMainObj.ProdList[i].inputMode=!1,this._trnMainService.TrnMainObj.ProdList[i].VCHRNO=this._trnMainService.TrnMainObj.VCHRNO;this._trnMainService.ReCalculateBillWithNormal()}}createFormItem(t){return this.fb.group({ImportName:[t.ImportName],ColumnName:[t.ColumnName],SNO:[t.SNO],ColumnSize:[t.ColumnSize],DataType:[t.DataType],ColumnValue:[t.ColumnValue],Mandatory:[t.Mandatory],AddToSheet:[t.AddToSheet]})}addItemsToForm(){let t=this.form.get("items");this.excelImportConfig.forEach(n=>{t.push(this.createFormItem(n))})}onFormChanges(){this.form.valueChanges.subscribe(t=>{this.form.dirty&&this.preventNavigationService.preventNavigation(!0)})}cancel(){try{this.router.navigate(["/pages/dashboard"])}catch(t){console.log(t),this.alertService.info(t)}}ngOnDestroy(){try{this.subcriptions.forEach(t=>{t.unsubscribe()})}catch(t){console.log(t),this.alertService.info(t)}}onSave(){try{if(!this.form.valid)return void this.alertService.info("Invalid Request, Please enter all required fields.");this.onsubmit()}catch(t){console.log(t),this.alertService.info(t)}}onsubmit(){try{let t=this.form.get("items").value;if(console.log(t),null==t||0==t.length)return;this.loadingService.show("Saving Config. Please Wait...");let n=this.service.saveConfig(t).subscribe(i=>{if(this.loadingService.hide(),"ok"==i.status)this.alertService.success("Config Saved Successfully"),this.preventNavigationService.preventNavigation(!1);else{if("The ConnectionString property has not been initialized."==i.result._body)return void this.router.navigate(["/login",this.router.url]);this.alertService.info(`Error in Saving Data: ${i.result._body}`)}},i=>{this.loadingService.hide(),this.alertService.info(i)});this.subcriptions.push(n)}catch(t){this.alertService.info(t)}}getAllMasterList(){this.masterService.getAllExcelImportMasterList().subscribe(t=>{this.masterList=t,console.log("masterList",this.masterList)},t=>{this.masterList=[]})}loadConfig(){this.selectedMasterName&&null!=this.selectedMasterName&&null!=this.selectedMasterName&&""!=this.selectedMasterName?(this.loadingService.show("Loading Config. Please Wait..."),this.service.loadConfig(this.selectedMasterName).subscribe(t=>{this.loadingService.hide(),this.excelImportConfig=t,this.addItemsToForm()},t=>{this.loadingService.hide(),this.excelImportConfig=[]})):this.alertService.info("Please Select a Master")}downloadConfigCSV(){this.selectedMasterName&&null!=this.selectedMasterName&&null!=this.selectedMasterName&&""!=this.selectedMasterName?(this.loadingService.show("Downloading..."),this.service.downloadConfigCSV(this.selectedMasterName).subscribe(t=>{this.loadingService.hide(),this.downloadFile(t)},t=>{this.loadingService.hide()})):this.alertService.info("Please Select a Master")}downloadConfigExcel(){this.selectedMasterName&&null!=this.selectedMasterName&&null!=this.selectedMasterName&&""!=this.selectedMasterName?(console.log("masterName",this.selectedMasterName),this.loadingService.show("Sample excel file is downloading..Please wait"),this.service.downloadSampleExcel(this.selectedMasterName).subscribe(n=>{let i=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});S.saveAs(i,`${this.selectedMasterName} Sample.xlsx`),this.loadingService.hide()},n=>{console.log("Error message for excel",n),this.alertService.info("This sample excel file download is not possible."),this.loadingService.hide()})):this.alertService.info("Please Select a Master")}downloadFile(t){const n=document.createElement("a");n.href=URL.createObjectURL(t.content),n.download=t.filename,document.body.appendChild(n),n.click()}onFileChange(t){console.log("filteupload",t.target.files),this.fileList=t.target.files}clearFile(){this.fileList=null}importConfig(){if(null!=this.fileList&&0!=this.fileList.length)if(null!=this.selectedMasterName&&""!=this.selectedMasterName){if(this.fileList.length>0){let t=this.fileList[0],n=new FormData;n.append("config",t,t.name),this.loadingService.show("Uploading. Please Wait...this may take some time"),this.service.importConfig(n,this.selectedMasterName,this.FCurrency).subscribe(i=>{this.loadingService.hide(),console.log("result"),"ok"==i.status?(this.alertService.success("Request Successful"),this.selectedMasterName="",this.fileList=null,this.fileSelector_Import.nativeElement.value=null):"errorfile"==i.status?this.alertService.info("Some of the rows cannot be saved.Please check 'Upload Status' for more details."):"error"===i.status?(this.alertService.info("string"==typeof i.result?"Error :"+i.result:"Error in File Upload or File Type Mismatched!!"),this.fileSelector_Import.nativeElement.value=null,this.clearFile()):"File Changed After Select"===i.status?(this.loadingService.hide(),this.fileSelector_Import.nativeElement.value=null,this.clearFile(),this.alertService.info("File Changed after selection. Please select file again.")):(this.loadingService.hide(),this.alertService.info(i.result))},i=>{console.log("R",i),this.loadingService.hide(),this.alertService.info(i)})}}else this.alertService.info("Please Select Master.");else this.alertService.info("Please Select File.")}resetConfig(){this.form=this.fb.group({items:this.fb.array([])}),this.excelImportConfig=[],this.selectedMasterName="",this.importErrorList=[],this.preventNavigationService.preventNavigation(!1)}CurrencyChange(t){let n=this.masterService.Currencies.filter(i=>i.CURNAME==this.FCurrency)[0];this.EXRATE=n.EXRATE}MandatoryChanged(t,n){let i=this.form.get("items");!t.target.checked||i.at(n).patchValue({AddToSheet:!0})}AddToSheetChanged(t,n){let i=this.form.get("items");if(!i.controls[n].get("Mandatory").value)return!0;i.at(n).patchValue({AddToSheet:!0})}onLoadMaster(){null!=this.selectedMasterName&&""!=this.selectedMasterName?(this.loadingService.show("Loading Master Data. Please Wait..."),this.service.loadImportErrorList(this.selectedMasterName).subscribe(t=>{this.loadingService.hide(),this.importErrorList=t},t=>{this.loadingService.hide(),this.alertService.info("No Data Found"),console.log(t)})):this.alertService.info("Please Select Master.")}onLoadMargin(){}downloadErrorStatus(){this.selectedMasterName&&null!=this.selectedMasterName&&null!=this.selectedMasterName&&""!=this.selectedMasterName?(console.log("masterName",this.selectedMasterName),this.loadingService.show("Excel file is downloading..Please wait"),this.service.downloadExcelErrorStatus(this.selectedMasterName).subscribe(n=>{console.log("Res ko result",n),this.loadingService.hide();let i=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});S.saveAs(i,`${this.selectedMasterName}.xlsx`)},n=>{console.log("Error message for excel",n),this.alertService.info("This excel file download is not possible."),this.loadingService.hide()})):this.alertService.info("Please Select a Master")}onSaveMaster(){null!=this.selectedMasterName&&""!=this.selectedMasterName?(this.loadingService.show("Saving Master Data. Please Wait..."),this.service.saveCorrectedList(this.importErrorList,this.selectedMasterName).subscribe(t=>{this.loadingService.hide(),this.alertService.success("Successfully Saved.")},t=>{this.loadingService.hide(),this.alertService.info("No Data Found"),console.log(t)})):this.alertService.info("Please Select Master.")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.d),e.Y36(m.c),e.Y36(c.V),e.Y36(g.P),e.Y36(I),e.Y36(C.F0),e.Y36(C.gz),e.Y36(h.qu),e.Y36(A.p))},o.\u0275cmp=e.Xpm({type:o,selectors:[["excel-import-config"]],viewQuery:function(t,n){if(1&t&&(e.Gf(w,5),e.Gf(P,5)),2&t){let i;e.iGM(i=e.CRH())&&(n.fileSelector_Import=i.first),e.iGM(i=e.CRH())&&(n.fileUploadPopup=i.first)}},decls:89,vars:15,consts:[[1,"main-container",2,"margin-top","0px","; margin-bottom","0px","height","auto"],[1,"row"],[1,"col-md-12"],["id","sheet-generation-tabs",1,"tabbable"],[1,"nav","nav-tabs",2,"background-color","#d9e5e7"],[1,"nav-item"],["href","#sheet-generation","data-toggle","tab",1,"nav-link","active"],["href","#upload-sheet","data-toggle","tab",1,"nav-link"],["href","#update-status","data-toggle","tab",1,"nav-link"],[1,"tab-content"],["id","sheet-generation",1,"tab-pane","active"],[1,"row","clearfix"],["class","col-md-4",4,"ngIf"],[1,"col-md-8"],["type","button",1,"btn","btn-info",2,"margin-right","10px",3,"click"],["type","button ",1,"btn","btn-info",2,"margin-right","10px",3,"click"],[1,"form-horizontal",3,"formGroup"],[1,"col-md-12",2,"height","400px","overflow-y","auto"],["class","table",4,"ngIf"],["id","upload-sheet",1,"tab-pane"],[1,"col-md-4"],[1,"form-group"],["name","selectedMaster",1,"form-control",2,"height","35px",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],["type","file","accept",".xlsx, .csv",1,"form-control",2,"height","41px","font-size","14px",3,"change"],["fileSelector_Import",""],[1,"btn","btn-info",3,"click"],["id","update-status",1,"tab-pane"],["class","col-md-12","style","width: 100%; height: 400px;  overflow: auto;",4,"ngIf"],["id","Margin",1,"tab-pane"],["id","Scheme",1,"tab-pane"],["id","Product",1,"tab-pane"],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],["class","form-group row",4,"ngIf"],[1,"form-group","row"],[1,"col-md-4","form-control-label"],["name","selectedMaster",1,"form-control",2,"color","black",3,"ngModel","ngModelChange"],[3,"value"],[1,"col-md-6"],[1,"table"],["formArrayName","items",4,"ngFor","ngForOf"],["formArrayName","items"],[3,"formGroupName"],["formControlName","SNO","readonly","",1,"non-editable"],["formControlName","ColumnName","readonly","",1,"non-editable"],["formControlName","ColumnSize","readonly","",1,"non-editable"],["formControlName","DataType","readonly","",1,"non-editable"],["type","checkbox","formControlName","Mandatory",1,"non-editable",3,"change"],["type","checkbox","formControlName","AddToSheet",1,"non-editable",3,"change"],["formControlName","ColumnValue","readonly","",1,"non-editable"],[1,"form-control",2,"color","black","height","35px",3,"ngModel","ngModelChange","change"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],["type","number",1,"form-control",2,"color","black","height","35px",3,"ngModel","ngModelChange"],["type","button ",1,"btn","btn-info",3,"click"],[1,"col-md-12",2,"width","100%","height","400px","overflow","auto"],[4,"ngFor","ngForOf"],["type","text",1,"form-control",3,"ngModel","name","ngModelChange"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"ul",4)(5,"li",5)(6,"a",6),e._uU(7,"Sheet Generation"),e.qZA()(),e.TgZ(8,"li",5)(9,"a",7),e._uU(10,"Upload Sheet"),e.qZA()(),e.TgZ(11,"li",5)(12,"a",8),e._uU(13,"Upload Status"),e.qZA()()(),e.TgZ(14,"div",9)(15,"div",10)(16,"div",11)(17,"div",2),e.YNc(18,O,2,1,"div",12),e.YNc(19,Y,3,1,"div",12),e.TgZ(20,"div",13)(21,"button",14),e.NdJ("click",function(){return n.downloadConfigExcel()}),e._uU(22," Download Sample Excel "),e.qZA(),e.TgZ(23,"button",14),e.NdJ("click",function(){return n.resetConfig()}),e._uU(24," Clear Config "),e.qZA(),e.TgZ(25,"button",15),e.NdJ("click",function(){return n.cancel()}),e._uU(26," Back "),e.qZA()()()(),e._UZ(27,"hr"),e.TgZ(28,"form",16)(29,"div",17),e.YNc(30,k,19,1,"table",18),e.qZA()()(),e.TgZ(31,"div",19)(32,"div",11)(33,"div",2)(34,"div",20)(35,"div",2)(36,"div",21)(37,"label"),e._uU(38,"Select a Master "),e.qZA(),e.TgZ(39,"select",22),e.NdJ("ngModelChange",function(l){return n.selectedMasterName=l}),e.YNc(40,Q,2,2,"option",23),e.qZA()(),e.YNc(41,$,5,2,"div",24),e.YNc(42,B,4,1,"div",24),e.TgZ(43,"div",21)(44,"label"),e._uU(45,"Choose a Path "),e.qZA(),e.TgZ(46,"input",25,26),e.NdJ("change",function(l){return n.onFileChange(l)}),e.qZA()(),e.TgZ(48,"button",27),e.NdJ("click",function(){return n.importConfig()}),e._uU(49," Upload File "),e.qZA(),e.TgZ(50,"button",15),e.NdJ("click",function(){return n.cancel()}),e._uU(51," Back "),e.qZA()()()()()(),e.TgZ(52,"div",28)(53,"div",11)(54,"div",2),e.YNc(55,G,2,1,"div",12),e.YNc(56,z,3,1,"div",12),e.qZA(),e._UZ(57,"hr"),e.YNc(58,H,8,4,"div",29),e.qZA()(),e.TgZ(59,"div",30)(60,"div",11)(61,"div",2)(62,"div",13)(63,"button",14),e.NdJ("click",function(){return n.UpdateMarginImport()}),e._uU(64," Upload Margin "),e.qZA()()(),e._UZ(65,"hr"),e.YNc(66,oe,8,4,"div",29),e.qZA()(),e.TgZ(67,"div",31)(68,"div",11)(69,"div",2)(70,"div",13)(71,"button",14),e.NdJ("click",function(){return n.showImportScheme()}),e._uU(72," Load "),e.qZA(),e.TgZ(73,"button",14),e.NdJ("click",function(){return n.UpdateSchemeImport()}),e._uU(74," Update "),e.qZA()()(),e._UZ(75,"hr"),e.YNc(76,le,8,4,"div",29),e.qZA()(),e.TgZ(77,"div",32)(78,"div",11)(79,"div",2)(80,"div",13)(81,"button",14),e.NdJ("click",function(){return n.showImportScheme()}),e._uU(82," Load "),e.qZA(),e.TgZ(83,"button",14),e.NdJ("click",function(){return n.UpdateSchemeImport()}),e._uU(84," Update "),e.qZA()()(),e._UZ(85,"hr"),e.YNc(86,pe,8,4,"div",29),e.qZA()()()()()()(),e.TgZ(87,"file-uploader-popup",33,34),e.NdJ("onUploaded",function(l){return n.fileUploadSuccess(l)}),e.qZA()),2&t&&(e.xp6(18),e.Q6J("ngIf",!n.excelImportConfig.length),e.xp6(1),e.Q6J("ngIf",n.excelImportConfig.length),e.xp6(9),e.Q6J("formGroup",n.form),e.xp6(2),e.Q6J("ngIf",n.excelImportConfig.length),e.xp6(9),e.Q6J("ngModel",n.selectedMasterName),e.xp6(1),e.Q6J("ngForOf",n.masterList),e.xp6(1),e.Q6J("ngIf","Import Purchase"==n.selectedMasterName),e.xp6(1),e.Q6J("ngIf","Import Purchase"==n.selectedMasterName),e.xp6(13),e.Q6J("ngIf",!n.importErrorList.length),e.xp6(1),e.Q6J("ngIf",n.importErrorList.length),e.xp6(2),e.Q6J("ngIf",n.importErrorList.length),e.xp6(8),e.Q6J("ngIf",n.importErrorList.length),e.xp6(10),e.Q6J("ngIf",n.importErrorList.length),e.xp6(10),e.Q6J("ngIf",n.importErrorList.length),e.xp6(1),e.Q6J("popupsettings",n.fileUploadPopupSettings))},dependencies:[v.sg,v.O5,h._Y,h.YN,h.Kr,h.Fj,h.wV,h.Wl,h.EJ,h.JJ,h.JL,h.On,h.sg,h.u,h.x0,h.CE,x.U,F.VO],styles:["input.non-editable[_ngcontent-%COMP%] {\n      border: none;\n      background: #f1f1f1;\n      text-align: left;\n    }\n  \n    .table[_ngcontent-%COMP%]    > thead[_ngcontent-%COMP%]    > tr[_ngcontent-%COMP%]    > th[_ngcontent-%COMP%]:first-child {\n      text-align: left;\n    }\n  \n    input[_ngcontent-%COMP%] {\n      min-width: 90px;\n      height: 23px;\n    }\n  \n    tr[_ngcontent-%COMP%] {\n      height: 30px;\n      line-height: 30px;\n      text-align: center;\n    }"]}),o})();var U=s(82661);const me=[{path:"",component:de,canActivate:[U.C]}];let ue=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[C.Bz.forChild(me),C.Bz]}),o})();var he=s(69401),ge=s(53181),fe=s(55618);let _e=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[U.C,A.p,I],imports:[v.ez,he.m,ue,ge.Is,fe.c.forRoot()]}),o})()}}]);