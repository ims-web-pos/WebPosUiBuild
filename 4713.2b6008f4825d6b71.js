"use strict";(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[4713],{18488:(Z,f,o)=>{o.d(f,{G:()=>T});var p=o(76165),w=o(79765),u=o(36336),v=o(3629),y=o(67297),C=o(71180);let T=(()=>{class d{constructor(c,e,g,l){this.http=c,this.activatedRoute=e,this.authService=g,this.state=l;const h=this.state.getGlobalSetting("apiUrl");h&&h.length>0&&(this.apiUrl=h)}getRequestOption(){return new p.WM({"Content-type":"application/csv",Authorization:this.authService.getAuth().token,"X-Requested-With":"XMLHttpRequest"})}RequestOptionForCSV(){return{headers:new p.WM({Authorization:this.authService.getAuth().token})}}downloadSampleFile(c,e="download"){return this.http.get(this.apiUrl+`${c}`,{headers:this.getRequestOption(),responseType:"blob"})}downloadSampleExcelforPIImport(c){return this.http.post(this.apiUrl+"/downloadSampleExcelforPIImport",c,{responseType:"blob"})}cancelPhysicalStock(c){return this.http.post(`${this.apiUrl}/physicalStockCancel/${c}`,null)}importSelectedFiles(c,e){let g={status:"error",result:"error"},l=new w.xQ;return this.http.post(this.apiUrl+`${c}`,e).subscribe(h=>{l.next(h),l.unsubscribe()},h=>{g.status="error",g.result=h,l.next(g),l.unsubscribe()}),l}}return d.\u0275fac=function(c){return new(c||d)(u.LFG(p.eN),u.LFG(v.gz),u.LFG(y.e),u.LFG(C.q))},d.\u0275prov=u.Yz7({token:d,factory:d.\u0275fac}),d})()},34365:(Z,f,o)=>{o.r(f),o.d(f,{BranchWisePriceModule:()=>Y});var p=o(92752),w=o(53181),u=o(82738),v=o(69401),y=o(72533),C=o(12640),T=o(59629),d=o(88465),O=o(55618),c=o(79765),e=o(36336),g=o(76165),l=o(67297),h=o(71180);let M=(()=>{class r{constructor(i,t,n){this.http=i,this.authService=t,this.state=n,this.userProfile={};const a=this.state.getGlobalSetting("apiUrl");a&&a.length>0&&(this.apiUrl=a),this.userProfile=t.getUserProfile()}getBranchwisePriceByID(i){return new c.xQ,this.http.post(this.apiUrl+"/getRateGroupByID",{mode:"query",data:{BranchwisePriceID:i}})}getBranchwisePriceList(i,t,n,a){return this.http.get(`${this.apiUrl}/getBranchwisePriceList?Mode=${i}&RateType=${t}&ID=${n}&INITIAL=${a}`)}downloadRateGroupExcel(i,t,n,a){return this.http.get(this.apiUrl+`/getExcelForBranchWisePriceList?mode=${i}&rateType=${t}&ID=${n}&INITIAL=${a}`,{responseType:"blob"})}}return r.\u0275fac=function(i){return new(i||r)(e.LFG(g.eN),e.LFG(l.e),e.LFG(h.q))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac}),r})();var P=o(3629),A=o(28698),S=o(49457),E=o(87584),U=o(248),j=o(67311),x=o(14970),R=o(53074),b=o(63504);const D=["genericGrid"];function W(r,s){if(1&r&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&r){const i=s.$implicit;e.s9C("value",i.Division),e.xp6(1),e.hij(" ",i.NAME," ")}}function N(r,s){if(1&r){const i=e.EpF();e.TgZ(0,"div",35)(1,"label",9),e._uU(2,"Group Name:"),e.qZA(),e.TgZ(3,"input",36),e.NdJ("keydown.Tab",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.parentKeyEvent())})("ngModelChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.branchwisePriceObj.DESCAGroup=n)})("keydown.enter",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.parentKeyEvent())}),e.qZA()()}if(2&r){const i=e.oxw();e.xp6(3),e.Q6J("ngModel",i.branchwisePriceObj.DESCAGroup)("disabled",i.disableOnView)}}function I(r,s){if(1&r){const i=e.EpF();e.TgZ(0,"div",35)(1,"label",14),e._uU(2,"Category:"),e.qZA(),e.TgZ(3,"input",37),e.NdJ("keydown.Tab",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.CatkeyEvent())})("ngModelChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.branchwisePriceObj.MCATCategory=n)})("keydown.enter",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.CatkeyEvent())}),e.qZA()()}if(2&r){const i=e.oxw();e.xp6(3),e.Q6J("ngModel",i.branchwisePriceObj.MCATCategory)("disabled",i.disableOnView)}}function L(r,s){if(1&r&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&r){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(i.DESCA)}}function F(r,s){if(1&r&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&r){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(i.DESCA)}}function G(r,s){if(1&r&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&r){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(i.DESCA)}}function k(r,s){if(1&r){const i=e.EpF();e.TgZ(0,"tr",38),e.NdJ("keydown.Shift.delete",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.deleteRow())}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.YNc(5,L,2,1,"td",39),e.YNc(6,F,2,1,"td",39),e.YNc(7,G,2,1,"td",39),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"number"),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.ALo(19,"number"),e.qZA(),e.TgZ(20,"td"),e._uU(21),e.qZA()()}if(2&r){const i=s.$implicit,t=s.index,n=e.oxw();e.xp6(2),e.Oqu(t+1),e.xp6(2),e.Oqu(i.MENUCODE),e.xp6(1),e.Q6J("ngIf","bygroupname"==n.flag),e.xp6(1),e.Q6J("ngIf","bycategory"==n.flag),e.xp6(1),e.Q6J("ngIf","byitemname"==n.flag),e.xp6(2),e.Oqu(i.BASEUNIT),e.xp6(2),e.Oqu(e.xi3(12,11,i.BranchRate,"1.2-2")),e.xp6(3),e.Oqu(i.confactor),e.xp6(2),e.Oqu(i.RATE),e.xp6(2),e.Oqu(e.xi3(19,14,i.SalesRate,"1.2-2")),e.xp6(3),e.Oqu(i.LabeledMRP)}}const q=[{path:"",component:(()=>{class r{constructor(i,t,n,a,B,m,_,Q,$,K){this._trnMainService=i,this.preventNavigationService=t,this.alertService=n,this.loadingService=a,this.masterService=B,this.router=m,this.activatedRoute=_,this.fb=Q,this.branchwisepriceService=$,this._spinnerservice=K,this.gridPopupSettings=new A.im,this.enableTable=!1,this.divisionList=[],this.branchwisePriceObj={},this.mode="",this.branchwisepriceList=[],this.branchwisepriceListData=[],this.disableOnView=!1,this.activerowIndex=0,this.masterService.getDivisionForTrnPrivilege().subscribe(z=>{this.divisionList=z,console.log("divisionList",this.divisionList)})}ngOnInit(){this.modeTitle="Branch Wise Price List"}dblClickPopupItem(i){switch(console.log(i,"value"),this.flag){case"bygroupname":this.branchwisePriceObj.BranchwisePrice_ID=i.MCODE,this.branchwisePriceObj.DESCAGroup=i.DESCA;break;case"bycategory":this.branchwisePriceObj.BranchwisePrice_ID=i.MCAT,this.branchwisePriceObj.MCATCategory=i.MCAT}}ChangeRateType(i){this.disableOfferOn=!1,console.log("change rete",i),this.branchwisePriceObj.BranchwisePrice_Detail=[],this.Offeron="rate",this.addRow(),"bycategory"==i?this.flag="bycategory":"bygroupname"==i?this.flag="bygroupname":"byitemname"==i&&(this.flag="byitemname")}addRow(){try{this.branchwisePriceObj.BranchwisePrice_Detail.push({})}catch(t){console.log(t),alert(t)}}parentKeyEvent(){console.log("parent key event"),this.disableOfferOn=!0,this.gridPopupSettings={title:"Parent",apiEndpoints:"/getMenuitemPagedListForScheme/Parent",defaultFilterIndex:0,columns:[{key:"MENUCODE",title:"MENU CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"NAME",hidden:!1,noSearch:!1},{key:"PARENT",title:"PARENT",hidden:!1,noSearch:!1}]},this.genericGrid.show()}CatkeyEvent(){this.PlistTitle="Category List",this.disableOfferOn=!0,this.gridPopupSettings={title:"Category",apiEndpoints:"/getMenuitemPagedListForScheme/Category",defaultFilterIndex:0,columns:[{key:"MCAT",title:"Category",hidden:!1,noSearch:!1}]},this.genericGrid.show()}checkValidation(){return null==this.branchwisePriceObj.BranchwisePrice_Name||""==this.branchwisePriceObj.BranchwisePrice_Name||null==this.branchwisePriceObj?(this.alertService.warning("Branch Name is empty"),!1):""==this.branchwisePriceObj.BranchwisePrice_RateType||null==this.branchwisePriceObj.BranchwisePrice_RateType||null==this.branchwisePriceObj?(this.alertService.warning("Rate Type Name is empty"),!1):""==this.branchwisePriceObj.BranchwisePrice_Mode||null==this.branchwisePriceObj.BranchwisePrice_Mode||null==this.branchwisePriceObj?(this.alertService.warning("Mode Name is empty"),!1):"bygroupname"==this.branchwisePriceObj.BranchwisePrice_Mode&&""==this.branchwisePriceObj.DESCAGroup||"bygroupname"==this.branchwisePriceObj.BranchwisePrice_Mode&&null==this.branchwisePriceObj.DESCAGroup?(this.alertService.warning("Group cannot be empty"),!1):!("bycategory"==this.branchwisePriceObj.BranchwisePrice_Mode&&""==this.branchwisePriceObj.MCATCategory||"bycategory"==this.branchwisePriceObj.BranchwisePrice_Mode&&null==this.branchwisePriceObj.MCATCategory)||(this.alertService.warning("Category cannot be empty"),!1)}exportClick(){if(!this.checkValidation())return;let t=this.branchwisePriceObj.BranchwisePrice_RateType,n=this.branchwisePriceObj.BranchwisePrice_ID,a=this.branchwisePriceObj.BranchwisePrice_Mode,B=this.branchwisePriceObj.BranchwisePrice_Name;console.log("blobmew1"),this.loadingService.show("Excel file is downloading..Please wait"),this.branchwisepriceService.downloadRateGroupExcel(a,t,n,B).subscribe(m=>{0==m?.length&&this.alertService.info("No Data Available");let _=new Blob([m],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});console.log("blobkm",_,m),S.saveAs(_,"BrancWisePriceList.xlsx"),this.loadingService.hide()},m=>{this.alertService.info("No Data Available"),this._spinnerservice.hide()})}applyClick(){try{if(!this.checkValidation())return;this._spinnerservice.show("Getting data please wait.."),this.branchwisepriceService.getBranchwisePriceList(this.branchwisePriceObj.BranchwisePrice_Mode,this.branchwisePriceObj.BranchwisePrice_RateType,this.branchwisePriceObj.BranchwisePrice_ID,this.branchwisePriceObj.BranchwisePrice_Name).subscribe(i=>{this.branchwisepriceListData=i,0==this.branchwisepriceListData?.length&&(this.alertService.info("No Data Available"),this._spinnerservice.hide()),this.Salesrates=this.branchwisepriceListData.forEach(t=>t.SalesRate=t.BranchRate*t.confactor),this._spinnerservice.hide()},i=>{this.alertService.info("No Data Available"),this._spinnerservice.hide()})}catch(i){alert(i)}}onReset(){this.branchwisePriceObj={},this.branchwisepriceListData=[]}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(E.p),e.Y36(U.d),e.Y36(j.c),e.Y36(x.V),e.Y36(R.P),e.Y36(P.F0),e.Y36(P.gz),e.Y36(b.qu),e.Y36(M),e.Y36(x.V))},r.\u0275cmp=e.Xpm({type:r,selectors:[["branchwise-price"]],viewQuery:function(i,t){if(1&i&&e.Gf(D,5),2&i){let n;e.iGM(n=e.CRH())&&(t.genericGrid=n.first)}},decls:70,vars:12,consts:[[1,"sticky-top","row"],[1,"col-md-4"],[1,"col-md-7"],[1,"row","pull-right"],["type","button",1,"btn","btn-info","btn-sm",3,"click"],["type","submit",1,"btn","btn-info","btn-sm",3,"disabled","click"],["type","submit",1,"btn","btn-info","btn-sm",3,"click"],[1,"row","plainBackGround",2,"margin-top","0.5rem","padding-top","1rem"],[1,"form-group","row"],[1,"col-md-4","form-control-label",2,"font-size","16px","white-space","nowrap"],[1,"col-md-6"],[1,"form-control","input-text",2,"width","16.2rem","height","30px",3,"ngModel","ngModelChange"],["value","%"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-4","form-control-label",2,"font-size","16px"],["name","rateType","id","rateType",2,"width","16.2rem","height","30px",3,"ngModel","disabled","ngModelChange"],["value","wholesale"],["value","retail"],[2,"width","55%","height","30px","margin-left","-10px",3,"ngModel","disabled","ngModelChange"],["value","bygroupname"],["value","bycategory"],["value","byitemname"],["style","margin-top: 15px;",4,"ngIf"],[1,"row",2,"margin-left","10px","margin-right","0px","background","white","color","#666666","background-color","#ffffff","border","0","border-radius","5px","position","relative","box-shadow","0 5px 5px 0 rgba(0, 0, 0, 0.25)","height","65vh","margin-top","10px"],[1,"col-md-12","row"],[1,"col-md-12",2,"height","55vh","overflow-y","scroll","overflow-x","hidden"],[1,"table"],[2,"border-bottom","2px solid #E6E6E6","border-top","1px solid #E6E6E6","height","30px","background","#9ccae4","color","black","font-size","15px"],["scope","col",2,"width","4%"],["scope","col"],[2,"background-color","aliceblue"],["style","height: 28px;",3,"keydown.Shift.delete",4,"ngFor","ngForOf"],[3,"popupsettings","onItemDoubleClick"],["genericGrid",""],[3,"value"],[2,"margin-top","15px"],["type","text","id","parentCode","placeholder","Press Enter to select Group","autocomplete","off",2,"margin-left","-10px","height","30px","width","55%","white-space","nowrap",3,"ngModel","disabled","keydown.Tab","ngModelChange","keydown.enter"],["type","text","id","category","placeholder","Press Enter to select Category","autocomplete","off",2,"margin-left","-10px","height","30px","width","55%","white-space","nowrap",3,"ngModel","disabled","keydown.Tab","ngModelChange","keydown.enter"],[2,"height","28px",3,"keydown.Shift.delete"],[4,"ngIf"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5"),e._uU(3),e.qZA()(),e.TgZ(4,"div",2)(5,"div",3)(6,"button",4),e.NdJ("click",function(){return t.exportClick()}),e._uU(7,"Export "),e.qZA(),e.TgZ(8,"button",5),e.NdJ("click",function(){return t.applyClick()}),e._uU(9,"Apply"),e.qZA(),e.TgZ(10,"button",6),e.NdJ("click",function(){return t.onReset()}),e._uU(11,"Reset"),e.qZA()()()(),e.TgZ(12,"div",7)(13,"div",1)(14,"div",8)(15,"label",9),e._uU(16,"Branch Name:"),e.qZA(),e.TgZ(17,"div",10)(18,"select",11),e.NdJ("ngModelChange",function(a){return t.branchwisePriceObj.BranchwisePrice_Name=a}),e.TgZ(19,"option",12),e._uU(20,"ALL"),e.qZA(),e.YNc(21,W,2,2,"option",13),e.qZA()()(),e.TgZ(22,"div",8)(23,"label",14),e._uU(24,"Rate Type: "),e.qZA(),e.TgZ(25,"div",10)(26,"select",15),e.NdJ("ngModelChange",function(a){return t.branchwisePriceObj.BranchwisePrice_RateType=a}),e.TgZ(27,"option",16),e._uU(28,"Whole Sale "),e.qZA(),e.TgZ(29,"option",17),e._uU(30,"Retail"),e.qZA()()()()(),e.TgZ(31,"div",1)(32,"label",14),e._uU(33,"Price Mode:"),e.qZA(),e.TgZ(34,"select",18),e.NdJ("ngModelChange",function(a){return t.branchwisePriceObj.BranchwisePrice_Mode=a})("ngModelChange",function(){return t.ChangeRateType(t.branchwisePriceObj.BranchwisePrice_Mode)}),e.TgZ(35,"option",19),e._uU(36," Group Name"),e.qZA(),e.TgZ(37,"option",20),e._uU(38," Category Name"),e.qZA(),e.TgZ(39,"option",21),e._uU(40," Item Name"),e.qZA()(),e.YNc(41,N,4,2,"div",22),e.YNc(42,I,4,2,"div",22),e.qZA()(),e.TgZ(43,"div",23)(44,"div",24)(45,"div",25)(46,"table",26)(47,"tr",27)(48,"th",28),e._uU(49,"S.no."),e.qZA(),e.TgZ(50,"th",29),e._uU(51,"Item Code"),e.qZA(),e.TgZ(52,"th",29),e._uU(53,"Item Name"),e.qZA(),e.TgZ(54,"th",29),e._uU(55,"Unit"),e.qZA(),e.TgZ(56,"th",29),e._uU(57,"Base Unit Rate"),e.qZA(),e.TgZ(58,"th",29),e._uU(59,"Conversion Factor"),e.qZA(),e.TgZ(60,"th",29),e._uU(61,"Rate Adjustment %"),e.qZA(),e.TgZ(62,"th",29),e._uU(63,"Sales Rate"),e.qZA(),e.TgZ(64,"th",29),e._uU(65,"LABEL MRP"),e.qZA()(),e.TgZ(66,"tbody",30),e.YNc(67,k,22,17,"tr",31),e.qZA()()()()(),e.TgZ(68,"generic-popup-grid",32,33),e.NdJ("onItemDoubleClick",function(a){return t.dblClickPopupItem(a)}),e.qZA()),2&i&&(e.xp6(3),e.Oqu(t.modeTitle),e.xp6(5),e.Q6J("disabled",t.disableOnView),e.xp6(10),e.Q6J("ngModel",t.branchwisePriceObj.BranchwisePrice_Name),e.xp6(3),e.Q6J("ngForOf",t.divisionList),e.xp6(5),e.Q6J("ngModel",t.branchwisePriceObj.BranchwisePrice_RateType)("disabled",t.disableOnView),e.xp6(8),e.Q6J("ngModel",t.branchwisePriceObj.BranchwisePrice_Mode)("disabled",t.disableOnView),e.xp6(7),e.Q6J("ngIf","bygroupname"==t.branchwisePriceObj.BranchwisePrice_Mode),e.xp6(1),e.Q6J("ngIf","bycategory"==t.branchwisePriceObj.BranchwisePrice_Mode),e.xp6(25),e.Q6J("ngForOf",t.branchwisepriceListData),e.xp6(1),e.Q6J("popupsettings",t.gridPopupSettings))},dependencies:[p.sg,p.O5,b.YN,b.Kr,b.Fj,b.EJ,b.JJ,b.On,A.Zl,p.JJ]}),r})()}];let J=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[P.Bz.forChild(q),P.Bz]}),r})(),Y=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[M],imports:[p.ez,J,v.m,y.JX,C.Xd,w.Is,u.b.forRoot(),d.x.forRoot(),O.c.forRoot(),T.Z]}),r})()}}]);